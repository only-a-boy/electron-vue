!function(Q,n,i){"use strict";var D="ht";if(!Q[D]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),Q.performance&&Q.performance.now||function(){var I=Date.now();Q.performance||(Q.performance={}),Q.performance.now=function(){return Date.now()-I}}();for(var r=Date.now(),V=16,R=["ms","moz","webkit","o"],W=0;W<R.length&&!Q.requestAnimationFrame;++W)Q.requestAnimationFrame=Q[R[W]+"RequestAnimationFrame"],Q.cancelAnimationFrame=Q[R[W]+"CancelAnimationFrame"]||Q[R[W]+"CancelRequestAnimationFrame"];Q.requestAnimationFrame||(Q.requestAnimationFrame=function(q){var F=Date.now(),v=V+r-F;return 0>v&&(v=0),r=F,Q.setTimeout(function(){r=Date.now(),q(performance.now())},v)}),Q.cancelAnimationFrame||(Q.cancelAnimationFrame=function(n){return Q.clearTimeout(n)}),n.assign===i&&(n.assign=function(X){if(X===i||null===X)throw new TypeError("Cannot convert undefined or null to object");for(var J=n(X),C=1;C<arguments.length;C++){var x=arguments[C];if(x!==i&&null!==x)for(var d in x)n.prototype.hasOwnProperty.call(x,d)&&(J[d]=x[d])}return J})}();var H=Q.document,a=null,S=Q[D]={},N=Q[D+"config"],x=S.Default=N&&N.Default||{},W=S.Style=N&&N.Style||{},u=S.Attr=N&&N.Attr||{},e=S.Color=N&&N.Color||{},r=S.IsGetter=N&&N.IsGetter||{};!function(){var Z=!1;try{var z=n.defineProperty({},"passive",{get:function(){Z=!0}});Q.addEventListener("test",z,z),Q.removeEventListener("test",z,z)}catch(q){Z=!1}x.passiveSupported=Z}();var h,j,l,A,p=x.passiveSupported,E=x.eventListenerOptionsFalse=p?{passive:!1,capture:!1}:!1,I=x.eventListenerOptionsTrue=p?{passive:!1,capture:!0}:!0,y=Math,B=y.round,P=y.floor,F=y.ceil,C=y.sqrt,w=y.max,t=y.min,G=y.abs,b=y.cos,v=y.acos,M=y.sin,m=y.pow,d=y.asin,O=y.PI,$=2*O,K=O/2,k=y.tan,J=y.atan2,X=y.random,g=y.log,L=!1,c=!1,s=Q.parseInt||global.parseInt,U="2019-06-03",R=Q.navigator?Q.navigator.platform.indexOf("Win")>-1:!1,T=function(O){return O*O},q=Q.setTimeout,Y=Q.clearTimeout,Z=Q.location,f=Q.navigator?Q.navigator.userAgent.toLowerCase():"",_=function(o){return o.test(f)},z=_(/msie/),o=_(/msie/)||_(/trident/),V=_(/msie 10/),oo=_(/edge/),Pg=_(/firefox/),Ti=_(/mac/),Ye=x.isTouchable===i?R?!1:H?"ontouchend"in H:!1:x.isTouchable,nn="default",Om="single",fp="multiple",Ie="front",No="back",ce="left",_i="right",Se="top",ep="bottom",$i="center",Ck="eye",no="middle",md="east",Nn="west",gp="north",Uh="none",Af="px",Sq="absolute",Ml="border",Ng="triangle",is="rect",Wj="circle",fl="cylinder",vp="shape",pm="items",Tj="normal",rc="remove",Sg="clear",Lc="width",ss="height",jn="ingroup",xn="check",cf="uncheck",qd="radio",xe="radioOn",od="radioOff",Yk="points",Jl="values",Xh="series",kq="body",Bn="label",pe="label2",Co="note",mg="note2",Xj="icons",Jn="labelFont",Bd="labelColor",Lr="labelSelectColor",Zl="note.expanded",wk="note2.expanded",$k="edge.expanded",Wd="edge.points",xi="edge.type",Do="rotation",Gk="hidden",ic="visible",Lo="tuv",Ph="no",Pl="draw",Eh="select",oc="currentSubGraph",Wf="selectBackground",Xf="autoMakeVisible",wj="autoHideScrollBar",Re="scrollBarColor",cj="scrollBarSize",gk="indent",Vp="rowHeight",yl="columnLineColor",cr="rowLineColor",re="columnLineVisible",nh="rowLineVisible",Fp="visibleFunc",Zh="expandIcon",Pq="collapseIcon",aq="checkMode",sd="sortFunc",Wp="editable",gh="batchEditable",ik="tristate",ko="asc",Er="desc",ec="position",mi="elevation",Wq="children",nb="translateX",rl="translateY",tf="dataModel",cn="maxSize",Bs="shape3d",Xb="shape3d.resolution",ff="shape3d.visible",Al="shape3d.from.visible",Xc="shape3d.to.visible",cq="shape3d.top.visible",Cj="shape3d.bottom.visible",Em="repeat.uv.length",Mn="serializeValue",$o="deserializeValue",lr="centerUniform",Me="uniform",uq="rgba(255,255,255,0)",rm="style",xk="attr",Yn="field",kd="string",Fn="boolean",dr="color",dn="int",ii="number",fk="ew-resize",yo="ns-resize",Rr="pointer",Ok="auto",gn="mousedown",jo="mousemove",Uq="mouseup",Md="mouseout",jj="touchstart",fb="touchmove",Sn="touchend",Ld="keydown",yc="keyup",Vl=["DOMMouseScroll","mousewheel"],em=Pg?Vl[0]:Vl[1],$e=Ye?[jj,fb,Sn,Ld,yc,"keypress","input","contextmenu","compositionstart","compositionupdate","compositionend"]:[Ld,yc,"keypress","input",gn,jo,Uq,Md,em,"wheel","contextmenu","mouseenter","mouseleave","mouseover","compositionstart","compositionupdate","compositionend"],th=a,Hd=a,qh=a,rn=Uq.length,ir=function(){qh&&(Y(qh.timeout),qh=a)},ap=function(){qh&&mc(qh.e,qh.info)};Q.addEventListener&&(Ye||(Q.addEventListener(Md,function(){ir()},E),Q.addEventListener(em,function(){el()},E)),Q.addEventListener(yc,function(v){91===v.keyCode?Oh={}:delete Oh[v.keyCode]},I),Q.addEventListener(Ld,function(Z){Oh[Z.keyCode]=!0},I),Q.addEventListener("blur",function(){Oh={}},E));var Mf,Bf,Bh,$j=0,dm=a,le=function(F,s){var v=q(function(){delete dm[v],je(dm)&&(dm=a),F()},s);return v},Kj=a,Im=a,br={},li={},Dp={},Zj={},Zr={},Oh={},qf={},Hp={},bk={},en={},Yb=/.json$/,kk=/^data:image\/svg\+xml/,Dg={},Lb=[],xh={},dj=a,Kq=a,ns=function(){},os=function(){throw"Oops!"},ah=[0,0,0],Sr={x:0,y:0,width:0,height:0},Pr=a,Hb=a,Dj=a,kr=function(d,m){li[d]=m,m&&m.comps&&!m.uuid&&(m.uuid=S.Math.generateUUID()),Hh[d]&&(m.cacheRule=Hh[d],delete Hh[d])},rg=function(x){Hb&&!x._72O&&(Dj||(Dj={}),Dj[x._72O=Vd()]=x),Mf!=a?Jh()<.05&&A&&!Bf&&(or=ir):or=Xq},wh=function(w,U,m,A){Hb||(Hb={});var L=Hb[w];if(L){if(L.url===U)return;L.image?(L.image.onload=ns,L.image.onerror=ns):L.request&&(L.request.onload=ns,L.request.onerror=ns)}if(Yb.test(U)){var G=new wm;if(Hb[w]={request:G,url:U},U=x.beforeLoadURL(U),U.data){var S=x.parse(U.data);dc(w,S),x.handleImageLoaded(w,S)}else{G.onload=function(I){if(200===this.status||0===this.status){var Q=x.parse(I.target.response||I.target.responseText);dc(w,Q),x.handleImageLoaded(w,Q)}else dc(w,x.handleUnfoundImage(w,U)||a)},G.onerror=function(){dc(w,x.handleUnfoundImage(w,U)||a)};var Y={};Y.url=encodeURI(U),Y.sync=!1,G.send(Y)}}else{var S=new Image;Hb[w]={image:S,url:U},/^data:image/.test(U)||(U=x.beforeLoadURL(U),U=x.appendTimeStamp(U),U=encodeURI(U),S.crossOrigin=x.crossOrigin),x.convertImageSrc(U,function(R){o&&(U.toLowerCase().indexOf(".svg")>0||kk.test(U))?(H.body.appendChild(S),S.style.visibility="hidden",S.onload=function(){q(function(){if(m&&(S.width=m),A&&(S.height=A),!S.width||!S.height){var D=S.width||S.clientWidth,_=S.height||S.clientHeight;S.width=D,S.height=_}x.handleImageLoaded(w,S),dc(w,S),H.body.removeChild(S),S.style.visibility=""},180)},S.onerror=function(){dc(w,x.handleUnfoundImage(w,U)||a),H.body.removeChild(S),S.style.visibility=""}):(S.onload=function(){m&&(S.width=m),A&&(S.height=A),x.handleImageLoaded(w,S),dc(w,S)},S.onerror=function(){dc(w,x.handleUnfoundImage(w,U)||a)}),S.src=R})}},dc=function(x,j){if(kr(x,j),delete Hb[x],je(Hb)&&(Hb=a,Dj)){for(var Y in Dj){var z=Dj[Y];z._2O&&z._2O[x]&&(z.deleteTexture(x),delete z._2O[x]),z.invalidateAll&&z.invalidateAll(i,"imageLoaded",x),z.redraw&&z.redraw(),z.iv(),delete z._72O}Dj=a}if(j&&Dj)for(var Y in Dj){var z=Dj[Y];z.invalidateAll&&z.invalidateAll(i,"imageLoading",x),z.redraw&&z.redraw(),z.iv()}},qj=function(){return g=y&&Date,function(){return Q.performance&&Q.performance.now?Q.performance.now():Date.now()}}(),To=function(v,q){q?Y(v):Q.cancelAnimationFrame(v)},Wo=function(q,G,Q){return{width:q,height:G,comps:mr(Q)?Q:[Q]}},pk=function(d,P){return{type:Wj,rect:[d,P,1.6,1.6],borderWidth:1,borderColor:Mh,gradient:ge,gradientColor:xj,background:Mh}},Jr=function(G,b){return Wo(16,16,{type:Ng,rect:[4,4,10,8],background:G,rotation:b?1.57:3.14})},Hg=function(D,e){return Wo(16,16,{type:Ng,rect:[4,4,8,7],background:D,rotation:e?3.14:0})},Ik=function(S){var o=S._orientation;return"horizontal"===o||"h"===o},Ui=function(v){var T=a||4,t=a||1,J=a||1;0>T?T=0:T>.25&&(T=.25);var D,m,A,U,e,w,H,x=.5,S=[],Z=[],P=[],f=$/J,g=$/t,y=x-T;for(m=0;t>=m;m++)for(U=-O+m*g,w=b(U),e=M(U),D=0;J>=D;D++)A=D*f,H=y+T*w,S.push(b(A)*H,e*T,-M(A)*H),(j=v)&&Z.push(D/J,1-m/t);for(m=0;t>m;m++){var n=m*(J+1),i=(m+1)*(J+1);for(D=0;J>D;D++)P.push(n+D,i+D+1,i+D,n+D,n+D+1,i+D+1),oh.z=kf.z=v}},qk=function(H){var d=2,A=0;for(var b in H)b.length===d&&s(b,32)===cd&&(dj=Kq=H[b]),A++;return A},bg=function(q,Y,k,U){return k||(k=Ye?5:3,k/=U||1),{x:q-k,y:Y-k,width:2*k,height:2*k}},Aq=function(W,C,f,x){var i=this;C||(C=Ye?5:3,f=20,x=20);var o={x:W,y:C,width:f,height:x};if(f)for(var K=0;f>K;K++)if(3===f)x=20;else for(var _=0;x>_;_++)i=Q?Q:f;var U={x:O,y:2*O};if(dh(o,U)){var d=ss[0]+Se[0]+Sg[1]+(ko.length-1);Hq[Ck]=i[d],i[d]=vs[Ck]}},ar=function(w){return(/ble$/.test(w)||/ed$/.test(w)||r[w]?"is":"get")+w.charAt(0).toUpperCase()+w.slice(1)},vs=function(B){return"set"+B.charAt(0).toUpperCase()+B.slice(1)},Tp=function(x){return typeof x===kd||x instanceof String},Sm=function(q){return typeof q===ii},Xq=function(B){return typeof B===Fn},$p=function(T){return T&&"object"==typeof T},nk=function(g){return"function"==typeof g},mr=function(p){return p instanceof Array},Zm=function(A){return A instanceof kg},zd=function(A){return mr(A)?new kg(A):A},Td=function(q){return q instanceof Jq},ck=function(H){return H instanceof wf},Uk=function(J){return J instanceof an},ue=function(B,T){if(!(B instanceof S.Group))return!1;if(!T)return B.isExpanded();var w=T.getDataUI(B);return w&&w._88I?!0:!1},db=function(f){return f instanceof Be},vj=function(r){return r&&"IFRAME"===r.tagName},il=function(V){return V==a||x.numberDigits==a?V:parseFloat(V.toFixed(x.numberDigits))},On=function(n,v,z){var X,y=v.length;if(z)for(var b=0;z>b;b++)if(3===y)n.push(v[0]),n.push(v[1]),n.push(v[2]);else for(X=0;y>X;X++)n.push(v[X]);else if(3===y)n.push(v[0]),n.push(v[1]),n.push(v[2]);else for(X=0;y>X;X++)n.push(v[X])},ve=function($){return $?$p($)?$:{}:!1},Gh=function(y,$,x){var V,o=$p(y)?y:y.prototype;for(V in $)x&&o[V]!==i||(o[V]=$[V]);return y},Km=function(i){return String.fromCharCode(i)},on=function(f){for(var e,D=0,$="";D<f.length;D++)e=f[f.length-1-D],"%"===e?e="'":"a"===e?e='"':"]"===e&&(e="\\"),$+=Km(e.charCodeAt(0)-1);return $},fm=function(X,f,y){X.superClass.constructor.apply(f,y)},je=function(G){for(var e in G)return!1;return!0},Qp=function(D){return D?0===D.length:!0},$l=function(){var k="";return[cf[0],cr[0],Bn[0]].forEach(function(F){k+=vs(F).slice(3)}),Me=H&&H[k]||lr,function(u,s){return u===s?!0:u.x===s.x&&u.y===s.y&&u.width===s.width&&u.height===s.height}}(),Nm=function(l,M,I){return M>l?M:l>I?I:l},ch=function(C){return 0>C?-1:C>0?1:0},Jh=function(){var Q=1e4*M(rn++);return Q-P(Q)},Ed=function(o,N,d){return rs(o.x,o.y,N.x,N.y,d.x,d.y,d.x+d.width,d.y,!0)||rs(o.x,o.y,N.x,N.y,d.x+d.width,d.y,d.x+d.width,d.y+d.height,!0)||rs(o.x,o.y,N.x,N.y,d.x+d.width,d.y+d.height,d.x,d.y+d.height,!0)||rs(o.x,o.y,N.x,N.y,d.x,d.y+d.height,d.x,d.y,!0)},rs=function(s,B,b,u,n,m,f,W,F){var e=(f-n)*(B-m)-(W-m)*(s-n),V=(W-m)*(b-s)-(f-n)*(u-B);if(0!==V){var j=e/V,y=s+j*(b-s),J=B+j*(u-B);return F&&(y+go<t(s,b)||y-go>w(s,b)||y+go<t(n,f)||y-go>w(n,f)||J+go<t(B,u)||J-go>w(B,u)||J+go<t(m,W)||J-go>w(m,W))?a:[y,J]}return a},Bm=function(F,C,Z){if(F&&Z)if(C){if(C===rm)return F.getStyle(Z);if(C===xk)return F.getAttr(Z);if(C===Yn)return F[Z]}else if(Z=ar(Z),F[Z])return F[Z]();return i},rr=function(B,Q,U,b){if(B&&U)if(Q){if(Q===rm)B.s(U,b);else if(Q===xk)B.a(U,b);else if(Q===Yn){var H=B[U];B[U]=b,B.fp("f:"+U,H,b)}}else U=vs(U),B[U]&&B[U](b)},Vr=function(D,p,C){return p&&"top"!==p?"bottom"===p?{x:D.x,y:D.y,width:D.width,height:D.height*C}:"right"===p?{x:D.x,y:D.y,width:D.width*C,height:D.height}:"left"===p?{x:D.x+D.width*(1-C),y:D.y,width:D.width*C,height:D.height}:void 0:{x:D.x,y:D.y+D.height*(1-C),width:D.width,height:D.height*C}},vc=function(S,v,o,x,t){v&&vm(S,o,x,1,t,v)},Nh=function(E,c,g,t){var w=1-E;return w*w*c+2*E*w*g+E*E*t},oh=function(Z,p,C,x,A){var l=1-Z;return l*l*l*p+3*l*l*Z*C+3*l*Z*Z*x+Z*Z*Z*A},Ir=function(H){var R,Z,f,g,B=0;return H.forEach(function(t){if(R=t.length,R>0)for(Z=t[0],g=1;R>g;g++)f=t[g],B+=Og(Z,f),Z=f}),B},aj=function(x,Q,Z){var i="__"+x,L=function(F){Z.disabled||Z["handle_"+x](F)};Z[i]||(Z[i]=L,Q.addEventListener(x,L,E))},Df=function(P,V,e){var s="__"+P,C=e[s];C&&(V.removeEventListener(P,C,E),delete e[s])},er=function(d,X){var P="_"+X;d[ar(X)]=function(){return this[P]},d[vs(X)]=function(C){var J=this[P];this[P]=C,this.fp(X,J,C)}},Ni=function(g){return n.create(g)},Zd=function(i){if(!i.element){var $,R;($=i.textField)?R=bi(tn.TextField,$):($=i.textArea)?R=bi(tn.TextArea,$):($=i.button)?R=bi(tn.Button,$):($=i.comboBox)?R=bi(tn.ComboBox,$):($=i.checkBox)?R=bi(tn.CheckBox,$):($=i.radioButton)?R=bi(tn.RadioButton,$):($=i.slider)?R=bi(tn.Slider,$):($=i.colorPicker)?R=bi(tn.ColorPicker,$):($=i.image)&&(R=bi(tn.Image,$)),R&&(i.element=R)}},Qm=function(y,I){var K=we(y);return K._ht=I,K},we=function(v,W){var Z=H.createElement("div"),u=Z.style;return Z.tabIndex=-1,Z.onkeydown=yn,u.msTouchAction=Uh,Gq(Z,a,0),Ye&&u.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",a),v&&(u.overflow=Gk),W&&Oc(W,Z),Z},xp=function(P,u){var I=H.createElement("canvas"),z=I.style;return z.msTouchAction=Uh,u||(z.pointerEvents=Uh),Gq(I,a,0),P&&Oc(P,I),I},Gq=function(Y,g,q){var t=Y.style;t.border=g?g+" solid 1px":0,t.outline=0,t.padding=q?"0 "+q+Af:0,rb(Y)},rb=function(F){var V=F.style;V.position=Sq,V.margin=0,V.setProperty("box-sizing","border-box",a),V.setProperty("-moz-box-sizing","border-box",a)},ms=function(s,B,k,y){y||(y=Gl),B!=a&&(s.width=B*y,s.style.width=B+Af),k!=a&&(s.height=k*y,s.style.height=k+Af)},Oc=function(Y,X,q){Y.appendChild(X),q&&(X.style.position=Sq)},Dq=function(b,u){u.split||(u+="");for(var e,I=u.split("\n"),l=0,F=I.length,v=0;F>v;v++){var A=Lm(b.font,I[v]);A.width>l&&(l=A.width),e||(e=A.height)}return b.ss=I,{width:l,height:e*F}},ae=function(Y,s,S,T,f,i){var R=s.length;if(1===R)Bk(Y,s[0],S,T,f);else for(var J=S.height/R,Z={x:S.x,y:S.y,width:S.width,height:J},l=0;l<s.length;l++)i?sp(Y,s[l],T,f,Z.x,Z.y,Z.width,Z.height,i):Bk(Y,s[l],Z,T,f),Z.y+=J},Bk=function(l,c,I,t,U){l.font=t?t:Bg,l.fillStyle=U?U:An,l.textAlign=$i,l.textBaseline=no;var T,r;I?I.width===i?(T=I.x,r=I.y):(T=I.x+I.width/2,r=I.y+I.height/2):(T=0,r=0),l.fillText(c,B(T),B(r))},Rh=function($){$.getView&&($=$.getView());var o=$.offsetWidth||$.scrollWidth;return!o&&$.style.width&&(o=s($.style.width)),o},hm=function(g){g.getView&&(g=g.getView());var o=g.offsetHeight||g.scrollHeight;return!o&&g.style.height&&(o=s(g.style.height)),o},pn=function(d,V,U){var $=V[0].toUpperCase()+V.substring(1,V.length);d["webkit"+$]=U,d["moz"+$]=U,d["ms"+$]=U,d["o"+$]=U,d[V]=U},rd=function(){var H=function(W){yn(W),W.stopPropagation()},S=function(a){yn(a)},q=Ye?[jj]:[Ld,gn];return function(G,O){var _=we(),Y=_.style;return Y.backgroundColor=x.disabledBackground,G&&(Y.backgroundImage="url("+G+")",Y.backgroundPosition="50% 50%",Y.backgroundRepeat="no-repeat no-repeat"),O===!1?q.forEach(function(U){_.addEventListener(U,S,E)}):q.forEach(function(Z){_.addEventListener(Z,H,E)}),_}}(),wo=function(P){var l=P.getContext("2d");return l.save(),l.lineCap=hf,l.lineJoin=og,l},or=function(Y,M,K,X){$b(Y,M*Gl,K*Gl),X*=Gl,1!==X&&Y.scale(X,X)},$b=function(c,_,h){c.translate(_,h)},Hr=function(o,$){$&&o.rotate($)},Yj=function(q,j,E){j===i&&(j=1),E===i&&(E=1),(1!==j||1!==E)&&q.scale(j,E)},eo=!1,Rk=function(R){var W=H.activeElement;if(H.activeElement!==R){W&&W.forceOnblur&&W.forceOnblur();for(var P=[],J=R.parentNode;J;)P.push([J,J.scrollLeft,J.scrollTop]),J=J.parentNode;if(!eo){var $=[],g=[];try{for(var S=Q.parent,m=Q;S!==m;)$.push([S,S.scrollX,S.scrollY]),m=S,S=Q.parent;var l=Q.frameElement;if(l)for(var F=l.parentNode;F;)g.push([F,F.scrollLeft,F.scrollTop]),F=F.parentNode}catch(k){eo=!0}}if(Ye)R.focus();else{var U=Ii(),a=U.target;R.focus(),a.scrollLeft=U.left,a.scrollTop=U.top}P.forEach(function(w){w[0].scrollLeft=w[1],w[0].scrollTop=w[2]}),eo||($.forEach(function(c){c[0].scrollTo(c[1],c[2])}),g.forEach(function(a){a[0].scrollLeft=a[1],a[0].scrollTop=a[2]}))}},Xk=function(h){return h&&h.getView?h.getView():h},dp=function(J,u,V,T,B){if(2===arguments.length&&(V=u.y,T=u.width,B=u.height,u=u.x),J.isSelfViewEvent)J.setX(u),J.setY(V),J.setWidth(T),J.setHeight(B);else{var s=Xk(J),N=s.style;if((H.fullscreenElement||H.mozFullScreenElement||H.webkitFullscreenElement||H.msFullscreenElement)!==s)u!==i&&(N.left=u+Af),V!==i&&(N.top=V+Af),T!==i&&(N.width=T+Af),B!==i&&(N.height=B+Af);else{var F=x.getWindowInfo();N.left=(u=F.left)+Af,N.top=(V=F.top)+Af,N.width=(T=F.width)+Af,N.height=(B=F.height)+Af}J.endEditing&&!Ye&&J.endEditing(),J.redraw&&J.redraw(),J.invalidate&&J.invalidate(),J.onLayouted&&J.onLayouted(u,V,T,B),J.fireViewEvent&&J.fireViewEvent("layout")}},Si=function(D){if(!D.touches)return D;var w=D.touches[0];return w?w:D.changedTouches[0]},Hl=function(o){return Ye?Si(o).target:o.target},vf=function(A){x.popup&&x.popup.close(),x.popup=A},ye=a,Zp=function(N){ye.handleWindowTouchMove(N)},Kg=function(o){ye.handleWindowTouchEnd(o),Q.removeEventListener(fb,Zp,E),Q.removeEventListener(Sn,Kg,E),ye=a},zk=function(g){ye.handleWindowMouseMove(g)},Pn=function(K){ye.handleWindowMouseUp(K),Q.removeEventListener(jo,zk,E),Q.removeEventListener(Uq,Pn,E),ye=a},Nq=function(S){return 1===zg(S)},_d=function(u,P){return P?P.keyCode===u:Oh[u]},Mq=function(j){return Ql(j)&&_d(65,j)},ll=function(c){return _d(46,c)||_d(8,c)},Tg=function(E){return function(G){return G?G.keyCode===E:Oh[E]}},cd=573,Ep=[65,83,68,87,37,38,39,40,32,13,27],Hm=Tg(Ep[0]),ki=Tg(Ep[1]),Gc=Tg(Ep[2]),Bq=Tg(Ep[3]),Mb=Tg(Ep[4]),ee=Tg(Ep[5]),xr=Tg(Ep[6]),Rf=Tg(Ep[7]),oj=Tg(Ep[8]),Jc=Tg(Ep[9]),Te=Tg(Ep[10]),nc={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},ze=[2,2,2,2,2,2,2,2,2,2,2,3,3,3,5,5,5,5,5,5,5,19,19],qi=a,kj=a,So=function(R,u){qi||(qi=xp()),ms(qi,R,u,1);var r=wo(qi);return r.clearRect(0,0,R,u),r},Yl=function(){var j,g={};for(var w in Q){var l=fp.length;if(w.length==l&&w[0]===fp[2]&&w[1]===Uh[1]&&w[4]===fp[3]&&w[5]===fp[4]&&w.substr(l-2)===Uh[1]+Uh[2]){var d=Q[w];for(var t in d)t.length===l&&t.substr(0,3)===_i[3]+rc[3]+Eh[0]&&t.substr(l-2)===fp[0]+Co[3]&&(Vl=d[t])}}return function(D){var z,n=g[D];return n||(j||(j=xp(),ms(j,1,1,1)),z=j.getContext("2d"),z.clearRect(0,0,1,1),vm(z,0,0,1,1,D),n=z.getImageData(0,0,1,1).data,n=g[D]=[n[0],n[1],n[2],n[3]]),n}}(),gi=function(F){if(!Tp(F))return F;var J=Yl(F);return J.CA||(J.CA=[J[0]/255,J[1]/255,J[2]/255,J[3]/255]),J.CA},Zb=function(q,_,Y,j,m){var x=xp();x.width=Y,x.height=j;var A=x.getContext("2d");A.drawImage(q,0,0,Y,j);try{for(var c=A.getImageData(0,0,Y,j),S=c.data,U=0,E=S.length;E>U;U+=4){var L=S[U+0],r=S[U+1],f=S[U+2],W=S[U+3];"override_a"===m?S[U+3]=255*_[3]:"override_rgb"===m?(S[U+0]=255*_[0],S[U+1]=255*_[1],S[U+2]=255*_[2]):"override"===m?(S[U+0]=255*_[0],S[U+1]=255*_[1],S[U+2]=255*_[2],S[U+3]=255*_[3]):(S[U+0]=_[0]*L,S[U+1]=_[1]*r,S[U+2]=_[2]*f,S[U+3]=_[3]*W)}A.putImageData(c,0,0)}catch(P){return q}return x},Hq=function(i,u,K){return u&&(u="miter"===K?8*u+20:u+1,i&&de(i,u)),u},Oi=function(C,T){if(T){var S=new $r(T),j=C.width/2,X=C.height/2,Q=sq([S.tf(-j,-X),S.tf(j,-X),S.tf(j,X),S.tf(-j,X)]);return Q.x+=C.x+j,Q.y+=C.y+X,Q}return C},ln=function(o,J,v,A,I,C,d,t){A*=Math.PI/180;var T={x:Math.cos(A)*(o.x-d.x)/2+Math.sin(A)*(o.y-d.y)/2,y:-Math.sin(A)*(o.x-d.x)/2+Math.cos(A)*(o.y-d.y)/2},G=Math.pow(T.x,2)/Math.pow(J,2)+Math.pow(T.y,2)/Math.pow(v,2);G>1&&(J*=Math.sqrt(G),v*=Math.sqrt(G));var B=(I==C?-1:1)*Math.sqrt((Math.pow(J,2)*Math.pow(v,2)-Math.pow(J,2)*Math.pow(T.y,2)-Math.pow(v,2)*Math.pow(T.x,2))/(Math.pow(J,2)*Math.pow(T.y,2)+Math.pow(v,2)*Math.pow(T.x,2)));isNaN(B)&&(B=0);var R={x:B*J*T.y/v,y:B*-v*T.x/J},g={x:(o.x+d.x)/2+Math.cos(A)*R.x-Math.sin(A)*R.y,y:(o.y+d.y)/2+Math.sin(A)*R.x+Math.cos(A)*R.y},K=function(Q){return Math.sqrt(Math.pow(Q[0],2)+Math.pow(Q[1],2))},D=function(O,p){return(O[0]*p[0]+O[1]*p[1])/(K(O)*K(p))},N=function(j,J){return(j[0]*J[1]<j[1]*J[0]?-1:1)*Math.acos(D(j,J))},Q=N([1,0],[(T.x-R.x)/J,(T.y-R.y)/v]),x=[(T.x-R.x)/J,(T.y-R.y)/v],O=[(-T.x-R.x)/J,(-T.y-R.y)/v],z=N(x,O);D(x,O)<=-1&&(z=Math.PI),D(x,O)>=1&&(z=0);var D=J>v?J:v,u=J>v?1:J/v,F=J>v?v/J:1;if(null==t){var m={x:0,y:0,width:0,height:0};de(m,D),m.x*=u,m.width*=u,m.y*=F,m.height*=F;var w=new $r(A);return m=sq([w.tf(m.x,m.y),w.tf(m.x+m.width,m.y),w.tf(m.x+m.width,m.y+m.height),w.tf(m.x,m.y+m.height)]),m.x+=g.x,m.y+=g.y,[{x:m.x,y:m.y},{x:m.x+m.width,y:m.y},{x:m.x+m.width,y:m.y+m.height},{x:m.x,y:m.y+m.height}]}t.translate(g.x,g.y),t.rotate(A),t.scale(u,F),t.arc(0,0,D,Q,Q+z,1-C),t.scale(1/u,1/F),t.rotate(-A),t.translate(-g.x,-g.y)},zn=function(b,H){b&&b.beginPath();for(var w,U,G,C=[],a=function(O){for(var $,o=/(\-{0,1}[\d\.]+)/gi,b=[];$=o.exec(O);)b.push(parseFloat($[0]));return b},$=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,j={x:0,y:0};w=$.exec(H);){var T=w[0],d=T.substr(0,1);if("M"===d||"m"===d){for(var Y=a(T),O=0;O<Y.length;O+=2){var v=Y[O],M=Y[O+1];"m"===d&&(v+=j.x,M+=j.y),b&&b.moveTo(v,M),C.push({x:v,y:M}),j.x=v,j.y=M}U=G=null}else if("H"===d||"h"===d){for(var Y=a(T),O=0;O<Y.length;O+=1){var v=Y[O];"h"===d&&(v+=j.x),b&&b.lineTo(v,j.y),C.push({x:v,y:j.y}),j.x=v}U=G=null}else if("C"===d||"c"===d){for(var Y=a(T),O=0;O<Y.length;O+=6){var o=Y[O],P=Y[O+1],_=Y[O+2],e=Y[O+3],v=Y[O+4],M=Y[O+5];"c"===d&&(o+=j.x,P+=j.y,_+=j.x,e+=j.y,v+=j.x,M+=j.y),b&&b.bezierCurveTo(o,P,_,e,v,M),C.push({x:o,y:P}),C.push({x:_,y:e}),C.push({x:v,y:M}),j.x=v,j.y=M}U=[o,P,_,e,v,M],G=null}else if("S"===d||"s"===d){for(var Y=a(T),O=0;O<Y.length;O+=4){var o,P;U?(o=2*U[4]-U[2],P=2*U[5]-U[3]):(o=j.x,P=j.y);var _=Y[O],e=Y[O+1],v=Y[O+2],M=Y[O+3];"s"===d&&(_+=j.x,e+=j.y,v+=j.x,M+=j.y),b&&b.bezierCurveTo(o,P,_,e,v,M),C.push({x:o,y:P}),C.push({x:_,y:e}),C.push({x:v,y:M}),j.x=v,j.y=M}U=[o,P,_,e,v,M],G=null}else if("Q"===d||"q"===d){for(var Y=a(T),O=0;O<Y.length;O+=4){var o=Y[O],P=Y[O+1],v=Y[O+2],M=Y[O+3];"q"===d&&(o+=j.x,P+=j.y,v+=j.x,M+=j.y),b&&b.quadraticCurveTo(o,P,v,M),C.push({x:o,y:P}),C.push({x:v,y:M}),j.x=v,j.y=M}U=null,G=[o,P,v,M]}else if("T"===d||"t"===d){for(var Y=a(T),O=0;O<Y.length;O+=2){var o,P;G?(o=2*G[2]-G[0],P=2*G[3]-G[1]):(o=j.x,P=j.y);var v=Y[O],M=Y[O+1];"t"===d&&(v+=j.x,M+=j.y),b&&b.quadraticCurveTo(o,P,v,M),C.push({x:o,y:P}),C.push({x:v,y:M}),j.x=v,j.y=M}U=null,G=[o,P,v,M]}else if("V"===d||"v"===d){for(var Y=a(T),O=0;O<Y.length;O+=1){var M=Y[O];"v"===d&&(M+=j.y),b&&b.lineTo(j.x,M),C.push({x:j.x,y:M}),j.y=M}U=G=null}else if("L"===d||"l"===d){for(var Y=a(T),O=0;O<Y.length;O+=2){var v=Y[O],M=Y[O+1];"l"===d&&(v+=j.x,M+=j.y),b&&b.lineTo(v,M),C.push({x:v,y:M}),j.x=v,j.y=M}U=G=null}else if("A"===d||"a"===d){for(var Y=a(T),O=0;O<Y.length;O+=7){var F=Y[O],W=Y[O+1],J=Y[O+2],X=Y[O+3],t=Y[O+4],v=Y[O+5],M=Y[O+6];"a"===d&&(v+=j.x,M+=j.y);var z=ln(j,F,W,J,X,t,{x:v,y:M},b);z&&(C=C.concat(z)),j.x=v,j.y=M}U=G=null}var N=T.substr(T.length-1);("z"===N||"Z"===N)&&b&&b.closePath()}return C},Bb=function(L,u){var h,T,G="L"===u[0],Y=u.length;L.save(),G?(L.transform(u[5],u[6],u[7],u[8],u[9],u[10]),h=L.createLinearGradient(u[1],u[2],u[3],u[4]),T=11):(L.transform(u[7],u[8],u[9],u[10],u[11],u[12]),h=L.createRadialGradient(u[1],u[2],u[3],u[4],u[5],u[6]),T=13);for(var H=L.compGray;Y>T;)h.addColorStop(u[T],H?x.toGrayColor(u[T+1]):u[T+1]),T+=2;L.fillStyle=h},kf=function(d,Q){var o=d.s("shape.gradient.pack");if(o){for(var n=o.length,H=new Array(n),p=0;n>p;p++)H[p]=o[p];var G,q,U,O,y,W,C,F,v,a,w,h,M,B="L"===H[0];G=B?5:7,q=H[G],U=H[G+1],O=H[G+2],y=H[G+3],W=H[G+4],C=H[G+5],F=Q[0],v=Q[1],a=Q[2],w=Q[3],h=Q[4],M=Q[5],H[G]=F*q+a*U,H[G+1]=v*q+w*U,H[G+2]=F*O+a*y,H[G+3]=v*O+w*y,H[G+4]=F*W+a*C+h,H[G+5]=v*W+w*C+M,d.s("shape.gradient.pack",H)}},Nr=function(J,U,p,M){var H=!1;if(J.beginPath?J.beginPath():H=!0,Zm(U)&&(U=U._as),Zm(p)&&(p=p._as),p&&p.length){for(var L,d,n,s,m=0,R=0,h=p.length;h>R;R++)L=p[R],1===L?(d=U[m++],J.moveTo(d.x,H?-d.y:d.y)):2===L?(d=U[m++],J.lineTo(d.x,H?-d.y:d.y)):3===L?(d=U[m++],n=U[m++],J.quadraticCurveTo(d.x,H?-d.y:d.y,n.x,H?-n.y:n.y)):4===L?(d=U[m++],n=U[m++],s=U[m++],J.bezierCurveTo(d.x,H?-d.y:d.y,n.x,H?-n.y:n.y,s.x,H?-s.y:s.y)):5===L&&J.closePath();M&&5!==L&&J.closePath()}else{var A,g,k,l=U.length;if(l>0){for(A=U[0],J.moveTo(A.x,H?-A.y:A.y),g=1;l>g;g++)k=U[g],J.lineTo(k.x,H?-k.y:k.y);M&&J.closePath()}}},vl=function(b,M,d,i){if(Zm(b)&&(b=b._as),Zm(M)&&(M=M._as),M&&M.length){d=d||nr;for(var F,r,P,k,_,Y,V,z,T=[],C=a,K=0,u=0,g=M.length;g>u;u++)if(F=M[u],1===F)T.push(C=[]),C.push(b[K++]);else if(2===F)C.push(b[K++]);else if(3===F){for(r=C[C.length-1],P=b[K++],k=b[K++],Y=1;d>Y;Y++)V=Nh(Y/d,r.x,P.x,k.x),z=Nh(Y/d,r.y,P.y,k.y),C.push({x:V,y:z,b:!0});C.push(k)}else if(4===F){for(r=C[C.length-1],P=b[K++],k=b[K++],_=b[K++],Y=1;d>Y;Y++)V=oh(Y/d,r.x,P.x,k.x,_.x),z=oh(Y/d,r.y,P.y,k.y,_.y),C.push({x:V,y:z,b:!0});C.push(_)}else 5===F&&C.push(C[0]);return i&&5!==F&&C&&C.length>2&&C.push(C[0]),T}return i&&b.length>2&&(b=b.slice(),b.push(b[0])),b?[b]:[]},Kc=function(w,E,Z,k,n,T){var D,H,z,l=Yl(E),m=k,h=l[0],R=l[1],I=l[2];if(Z){var p=Yl(Z);D=p[0]-h,H=p[1]-R,z=p[2]-I}else D=255-h,H=255-R,z=255-I;for(T||(T=k>10?1:.5,T=1>n?t(T/n,2):T);(k-=T)>0;){var v=1-k/m,P=h+D*v,X=R+H*v,Q=I+z*v;P=t(F(P),255),X=t(F(X),255),Q=t(F(Q),255),w.strokeStyle="rgb("+P+","+X+","+Q+")",w.lineWidth=k,w.stroke()}},Zg=function(){var C={};return function(u,c){var p=u+"-"+c,B=C[p];if(B)return B;var j,Z,U,A=Yl(u);return 0>c?(c=(100+c)/100,j=F(A[0]*c),Z=F(A[1]*c),U=F(A[2]*c)):(c/=100,j=A[0],Z=A[1],U=A[2],j+=(255-j)*c,Z+=(255-Z)*c,U+=(255-U)*c,j=t(F(j),255),Z=t(F(Z),255),U=t(F(U),255)),C[p]="rgb("+j+","+Z+","+U+")"}}(),vm=function(q,X,S,e,R,u){u&&(q.fillStyle=u),q.beginPath(),q.rect(X,S,e,R),q.fill()},km=function(D,v,b,y,K,Q,j){D.beginPath(),hd[v](D,b.x,b.y,b.width,b.height,y,K,Q,j)},Fo=function(b,d,T,u,m){var V=hd[T];b.fillStyle=V?V(b,d,u?u:xj,m.x,m.y,m.width,m.height):d},hh=function(t,J,C,F,B,m){try{if(!J.tagName&&J.comps){J._cacheImage_||(J._cacheImage_={});var d;d="override"===F?"colors_override":"override_rgb"===F?"colors_override_rgb":"override_a"===F?"colors_override_a":"colors",J._cacheImage_[d]||(J._cacheImage_[d]={__count__:0});var E=J._cacheImage_[d][C];E||(J._cacheImage_[d].__count__>x.imageCacheThreshold&&(J._cacheImage_[d]={__count__:0}),E=S.Default.toCanvas(J,sr(J),Qo(J),null,B,m,C,null,F),J._cacheImage_[d][C]=E,J._cacheImage_[d].__count__++),J=E}t.fillStyle=t.createPattern(J,"repeat")}catch(w){t.fillStyle="black"}},sf=function(O,b,V,E,c,B,$){O.save(),O.translate(b,V),O.scale(1,$/B),O.arc(0,0,B,E,c),O.restore()},Ln=function(C,B,t,R,L,T,f,j){var I,A,w,S,p,E,d,P,H,K,Y;if(G(L)>2*O&&(L=2*O),p=F(G(L)/(O/4)),I=L/p,A=-I,w=-R,p>0){E=B+b(R)*T,d=t+M(-R)*f,j?C.lineTo(E,d):C.moveTo(E,d);for(var N=0;p>N;N++)w+=A,S=w-A/2,P=B+b(w)*T,H=t+M(w)*f,K=B+b(S)*(T/b(A/2)),Y=t+M(S)*(f/b(A/2)),C.quadraticCurveTo(K,Y,P,H)}},be=function(N,g,z,t,M,u,j,s,S){6===arguments.length&&(j=u,s=u,S=u);var v=g+t,y=z+M,G=M>t?2*t:2*M;u=G>u?u:G,j=G>j?j:G,s=G>s?s:G,S=G>S?S:G;var D=.29*S,Q=.58*S;N.moveTo(v,y-S),N.quadraticCurveTo(v,y-Q,v-D,y-D),N.quadraticCurveTo(v-Q,y,v-S,y),D=.29*s,Q=.58*s,N.lineTo(g+s,y),N.quadraticCurveTo(g+Q,y,g+D,y-D),N.quadraticCurveTo(g,y-Q,g,y-s),D=.29*u,Q=.58*u,N.lineTo(g,z+u),N.quadraticCurveTo(g,z+Q,g+D,z+D),N.quadraticCurveTo(g+Q,z,g+u,z),D=.29*j,Q=.58*j,N.lineTo(v-j,z),N.quadraticCurveTo(v-Q,z,v-D,z+D),N.quadraticCurveTo(v,z+Q,v,z+j),N.lineTo(v,y-S)},yb=function(w,j,O,H,e,J,a){j&&(O=B(O),H=B(H),a||(a=1),w.fillStyle=j,w.beginPath(),w.rect(O,H,a,J),w.rect(O,H,e,a),J-a>0&&w.rect(O,H+J-a,e,a),e-a>0&&w.rect(O+e-a,H,a,J),w.fill())},ao=function(u,r,s,N){var L=N.x,V=N.y,p=N.width,q=N.height;if(!(!r||!s||0>=p||0>=q)){var E,F=Vq(r),Z=wi(r),g=s>0;1===s||-1===s?(u.fillStyle=g?F:Z,u.beginPath(),u.rect(L,V,1,q),u.rect(L,V,p,1),u.fill(),u.fillStyle=g?Z:F,u.beginPath(),u.rect(L,V+q-1,p,1),u.rect(L+p-1,V,1,q),u.fill()):(s=t(G(s),t(p/2,q/2)),E=u.createLinearGradient(L,V,L+s,V),E.addColorStop(0,g?F:Z),E.addColorStop(1,r),u.fillStyle=E,u.beginPath(),u.moveTo(L,V),u.lineTo(L+s,V+s),u.lineTo(L+s,V+q-s),u.lineTo(L,V+q),u.lineTo(L,V),u.fill(),E=u.createLinearGradient(L,V,L,V+s),E.addColorStop(0,g?F:Z),E.addColorStop(1,r),u.fillStyle=E,u.beginPath(),u.moveTo(L,V),u.lineTo(L+s,V+s),u.lineTo(L+p-s,V+s),u.lineTo(L+p,V),u.lineTo(L,V),u.fill(),E=u.createLinearGradient(L,V+q,L,V+q-s),E.addColorStop(0,g?Z:F),E.addColorStop(1,r),u.fillStyle=E,u.beginPath(),u.moveTo(L,V+q),u.lineTo(L+s,V+q-s),u.lineTo(L+p-s,V+q-s),u.lineTo(L+p,V+q),u.lineTo(L,V+q),u.fill(),E=u.createLinearGradient(L+p,V,L+p-s,V),E.addColorStop(0,g?Z:F),E.addColorStop(1,r),u.fillStyle=E,u.beginPath(),u.moveTo(L+p,V),u.lineTo(L+p-s,V+s),u.lineTo(L+p-s,V+q-s),u.lineTo(L+p,V+q),u.lineTo(L+p,V),u.fill())}},ad=function(J,V,b,W,D,O,s){var c=J.createLinearGradient(W,D,O,s);return c.addColorStop(0,b),c.addColorStop(1,V),c},Uo=function(P,x,k,Q,W,Y,u){var L=P.createLinearGradient(Q,W,Y,u);return L.addColorStop(0,x),L.addColorStop(.5,k),L.addColorStop(1,x),L},_n=function(X,F,A,M,K,S,e){var G=X.createLinearGradient(M,K,S,e);return G.addColorStop(0,F),G.addColorStop(1/3,A),G.addColorStop(2/3,F),G.addColorStop(1,A),G},yk=function(z,i,b,G,p,d,V,k,W){var L=z.createRadialGradient(G+d*k,p+V*W,t(d,V)/24,G+d/2,p+V/2,w(d,V)/2);return L.addColorStop(0,b),L.addColorStop(1,i),L},Cc=[0,-1,.22451398828979272,-.30901699437494734,.9510565162951535,-.30901699437494745,.3632712640026804,.11803398874989468,.5877852522924731,.8090169943749473,-1.1102230246251565e-16,.38196601125010515,-.587785252292473,.8090169943749475,-.3632712640026805,.1180339887498949,-.9510565162951536,-.3090169943749473,-.22451398828979285,-.30901699437494734],hd={polygon:function(e,U,f,c,A,g){(g==a||3>g)&&(g=6);for(var N,$,v=t(c,A)/2,K=U+c/2,D=f+A/2,C=0,Y=2*O/g,Z=0;g>Z;Z++)N=K+b(C)*v,$=D+M(C)*v,0===Z?e.moveTo(N,$):e.lineTo(N,$),C+=Y;e.closePath()},arc:function(c,n,d,T,v,A,S,J,q){A==a&&(A=O),S==a&&(S=$),J==a&&(J=!0);var Q=n+T/2,L=d+v/2;J&&c.moveTo(Q,L),q?sf(c,Q,L,A,S,T/2,v/2):c.arc(Q,L,t(T,v)/2,A,S),J&&c.closePath()},rect:function(k,B,F,i,e){k.rect(B,F,i,e)},circle:function(H,Y,J,h,_){H.arc(Y+h/2,J+_/2,t(h,_)/2,0,$,!0)},oval:function(W,b,k,K,r){sf(W,b+K/2,k+r/2,0,$,K/2,r/2)},roundRect:function(x,y,Y,A,Q,m){m==a&&(m=t(t(A,Q)/4,8)),be(x,y,Y,A,Q,m)},star:function(j,E,r,e,I){var D=2*e,h=2*I,W=E+e/2,i=r+I/2;j.moveTo(W-D/4,i-h/12),j.lineTo(E+.306*e,r+.579*I),j.lineTo(W-D/6,i+h/4),j.lineTo(E+e/2,r+.733*I),j.lineTo(W+D/6,i+h/4),j.lineTo(E+.693*e,r+.579*I),j.lineTo(W+D/4,i-h/12),j.lineTo(E+.611*e,r+.332*I),j.lineTo(W+0,i-h/4),j.lineTo(E+.388*e,r+.332*I),j.closePath()},pentagram:function(Y,r,L,D,x){var l=.5*x,V=r+.5*D,g=L+l,u=.5257311121191336*D;u>l&&(u=l);var j=Cc,B=0;for(Y.moveTo(V+u*j[B++],g+u*j[B++]);20>B;)Y.lineTo(V+u*j[B++],g+u*j[B++]);Y.closePath()},triangle:function(U,A,I,l,b){U.moveTo(A+l/2,I),U.lineTo(A+l,I+b),U.lineTo(A,I+b),U.closePath()},hexagon:function(z,k,N,b,Q){z.moveTo(k,N+Q/2),z.lineTo(k+b/4,N+Q),z.lineTo(k+3*b/4,+N+Q),z.lineTo(k+b,N+Q/2),z.lineTo(k+3*b/4,N),z.lineTo(k+b/4,N),z.closePath()},pentagon:function(E,V,g,d,m){var G=2*d,h=2*m,Z=V+d/2,k=g+m/2;E.moveTo(Z-G/4,k-h/12),E.lineTo(Z-G/6,k+h/4),E.lineTo(Z+G/6,k+h/4),E.lineTo(Z+G/4,k-h/12),E.lineTo(Z+0,k-h/4),E.closePath()},diamond:function(V,i,$,M,s){V.moveTo(i+M/2,$),V.lineTo(i,$+s/2),V.lineTo(i+M/2,$+s),V.lineTo(i+M,$+s/2),V.closePath()},rightTriangle:function(s,l,d,r,e){s.moveTo(l,d),s.lineTo(l+r,d+e),s.lineTo(l,d+e),s.closePath()},parallelogram:function(p,f,s,A,d){var T=A/4;p.moveTo(f+T,s),p.lineTo(f+A,s),p.lineTo(f+A-T,s+d),p.lineTo(f,s+d),p.closePath()},trapezoid:function(o,Y,i,$,x){var l=$/4;o.moveTo(Y+l,i),o.lineTo(Y+$-l,i),o.lineTo(Y+$,i+x),o.lineTo(Y,i+x),o.closePath()},"linear.southwest":function(L,c,V,X,t,Q,n){return ad(L,c,V,X,t+n,X+Q,t)},"linear.southeast":function(E,z,Z,n,v,f,k){return ad(E,z,Z,n+f,v+k,n,v)},"linear.northwest":function(k,N,V,U,j,n,D){return ad(k,N,V,U,j,U+n,j+D)},"linear.northeast":function(J,m,I,N,z,$,D){return ad(J,m,I,N+$,z,N,z+D)},"linear.north":function(S,k,E,o,P,p,N){return ad(S,k,E,o,P,o,P+N)},"linear.south":function(s,t,R,H,k,d,z){return ad(s,t,R,H,k+z,H,k)},"linear.west":function(I,A,$,n,W,x){return ad(I,A,$,n,W,n+x,W)},"linear.east":function(b,i,L,O,l,$){return ad(b,i,L,O+$,l,O,l)},"radial.center":function(P,h,U,j,O,R,f){return yk(P,h,U,j,O,R,f,.5,.5)},"radial.southwest":function(j,B,l,I,T,m,Y){return yk(j,B,l,I,T,m,Y,.25,.75)},"radial.southeast":function(k,u,Q,M,E,l,q){return yk(k,u,Q,M,E,l,q,.75,.75)},"radial.northwest":function(u,j,V,_,d,S,c){return yk(u,j,V,_,d,S,c,.25,.25)
},"radial.northeast":function(E,J,Z,x,c,B,b){return yk(E,J,Z,x,c,B,b,.75,.25)},"radial.north":function(t,H,J,r,Y,G,Z){return yk(t,H,J,r,Y,G,Z,.5,.25)},"radial.south":function(i,G,J,j,X,U,g){return yk(i,G,J,j,X,U,g,.5,.75)},"radial.west":function(P,K,a,G,N,k,V){return yk(P,K,a,G,N,k,V,.25,.5)},"radial.east":function(M,N,t,I,g,E,L){return yk(M,N,t,I,g,E,L,.75,.5)},"spread.horizontal":function(v,p,f,M,W,t){return Uo(v,p,f,M,W,M+t,W)},"spread.vertical":function(s,G,H,w,q,A,n){return Uo(s,G,H,w,q,w,q+n)},"spread.diagonal":function(w,u,e,J,S,K,W){return Uo(w,u,e,J+K,S,J,S+W)},"spread.antidiagonal":function(P,q,U,D,J,c,F){return Uo(P,q,U,D,J,D+c,J+F)},"spread.north":function(n,c,X,R,W,v,K){return _n(n,c,X,R,W-K/4,R,W+K+K/4)},"spread.south":function(u,g,p,e,$,n,S){return _n(u,p,g,e,$-S/4,e,$+S+S/4)},"spread.west":function(b,A,g,I,E,v){return _n(b,A,g,I-v/4,E,I+v+v/4,E)},"spread.east":function(i,f,V,l,T,N){return _n(i,V,f,l-N/4,T,l+N+N/4,T)}},ub=function(u,D,h){return new $r(u).tf(D,h)},Mg=function(B){var T=B.touches[0],W=B.touches[1],w=T.clientX,o=T.clientY,v=W.clientX,g=W.clientY;return C((w-v)*(w-v)+(o-g)*(o-g))},fc=(function(){for(var E=0,T=Er.split(""),D=0;D<T.length;D++)E=10*s(T[D])+E;return Ui(Q[cd.toString(8*D)+Bn.substr(D)+2]),E}(),function(S,Z,o){for(var i=0;i<o.size();i++){var $=o.get(i);S.co($)&&Z.add($)}for(i=0;i<o.size();i++)$=o.get(i),fc(S,Z,$._children)}),wg=function(y,O,G){for(var T=0;T<G.size();T++){var Q=G.get(G.size()-1-T);y.co(Q)&&O.add(Q)}for(T=0;T<G.size();T++)Q=G.get(T),wg(y,O,Q._children)},dl=function(F,n,m){for(var p=!1,o=0;o<m.size();o++){var w=m.get(o);F.co(w)?p&&n.add(w):p=1}for(o=0;o<m.size();o++)w=m.get(o),dl(F,n,w._children)},kc=function(c,Y,t){for(var z=!1,w=0;w<t.size();w++){var i=t.get(t.size()-1-w);c.co(i)?z&&Y.add(i):z=!0}for(w=0;w<t.size();w++)i=t.get(w),kc(c,Y,i._children)},Ub=x.moveDatas=function(h,A,G,F){var P=F==a;if(0!==A||0!==G||!P&&0!==F){var m=!0,l=[];if(h.forEach(function(g){m&&(g._69O||Uk(g)||db(g))&&(m=!1)}),m)l=h;else{var B={},e={};h.forEach(function(O){B[O._id]=!0});var Q={},w=function(s){var c=s._id;return B[c]?(l.push(s),Q[c]=!0):Q[c]=!1},o=function(S){var F=S._id;if(e[F])return w(S);var C=Q[F];if(C!==i)return C;var H=S._parent;if(H&&(db(H)||Uk(H))&&o(H))return Q[F]=!0;var B=S._host;return B&&(e[F]=F,C=o(B),e[F]=i,C)?Q[F]=!0:w(S)};h.forEach(function(Y){o(Y)})}l.forEach(function(i){if(Td(i))P?i.translate(A,G):i.translate3d(A,G,F);else{var $=i.s(Wd);if(!$||$.isEmpty())return;var J=new kg;$.each(function(g){g=Hj(g),P?(g.x+=A,g.y+=G):(g.x+=A,g.y+=F,g.e==a?g.e=G:g.e+=G),J.add(g)}),i.s(Wd,J)}})}},Rj=function(Z,R){for(;Z&&!Z.hasOwnProperty(R);)Z=n.getPrototypeOf(Z);return Z&&n.getOwnPropertyDescriptor(Z,R)},Yr=n.getPrototypeOf?function(Y,v,l){var G=Rj(v,l);G&&n.defineProperty(Y,l,G)}:function(l,O,Y){l[Y]=O[Y]},Tc={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},gc=function(){var P={1:function(H,W){return{x:H.x-W.width/2,y:H.y-W.height/2}},2:function($,e){return{x:$.x+e.width/2,y:$.y-e.height/2}},3:function(Q,q){return{x:Q.x+Q.width/2,y:Q.y-q.height/2}},4:function(B,U){return{x:B.x+B.width-U.width/2,y:B.y-U.height/2}},5:function(L,C){return{x:L.x+L.width+C.width/2,y:L.y-C.height/2}},6:function($){return{x:$.x,y:$.y}},7:function($){return{x:$.x+$.width/2,y:$.y}},8:function(u){return{x:u.x+u.width,y:u.y}},9:function(z,n){return{x:z.x-n.width/2,y:z.y+n.height/2}},10:function(z,K){return{x:z.x+K.width/2,y:z.y+K.height/2}},11:function(n,V){return{x:n.x+n.width/2,y:n.y+V.height/2}},12:function(H,k){return{x:H.x-k.width/2+H.width,y:H.y+k.height/2}},13:function(g,y){return{x:g.x+g.width+y.width/2,y:g.y+y.height/2}},14:function(A,b){return{x:A.x-b.width/2,y:A.y+A.height/2}},15:function(a){return{x:a.x,y:a.y+a.height/2}},16:function(Y,r){return{x:Y.x+r.width/2,y:Y.y+Y.height/2}},17:function(X){return{x:X.x+X.width/2,y:X.y+X.height/2}},18:function(w,S){return{x:w.x+w.width-S.width/2,y:w.y+w.height/2}},19:function(h){return{x:h.x+h.width,y:h.y+h.height/2}},20:function(L,Q){return{x:L.x+L.width+Q.width/2,y:L.y+L.height/2}},21:function(u,W){return{x:u.x-W.width/2,y:u.y+u.height-W.height/2}},22:function(d,j){return{x:d.x+j.width/2,y:d.y+d.height-j.height/2}},23:function(u,B){return{x:u.x+u.width/2,y:u.y+u.height-B.height/2}},24:function(e,B){return{x:e.x+e.width-B.width/2,y:e.y+e.height-B.height/2}},25:function(p,z){return{x:p.x+p.width+z.width/2,y:p.y+p.height-z.height/2}},26:function(P){return{x:P.x,y:P.y+P.height}},27:function(J){return{x:J.x+J.width/2,y:J.y+J.height}},28:function(d){return{x:d.x+d.width,y:d.y+d.height}},29:function(O,J){return{x:O.x-J.width/2,y:O.y+O.height+J.height/2}},30:function(r,H){return{x:r.x+H.width/2,y:r.y+r.height+H.height/2}},31:function(X,J){return{x:X.x+X.width/2,y:X.y+X.height+J.height/2}},32:function(k,Q){return{x:k.x+k.width-Q.width/2,y:k.y+k.height+Q.height/2}},33:function(Z,Q){return{x:Z.x+Z.width+Q.width/2,y:Z.y+Z.height+Q.height/2}},34:function(j,T){return{x:j.x,y:j.y-T.height/2}},35:function(h,F){return{x:h.x+h.width,y:h.y-F.height/2}},36:function(G,F){return{x:G.x,y:G.y+G.height+F.height/2}},37:function(f,I){return{x:f.x+f.width,y:f.y+f.height+I.height/2}},38:function(X,E){return{x:X.x+X.width/4,y:X.y-E.height/2}},39:function(Q,s){return{x:Q.x+3*Q.width/4,y:Q.y-s.height/2}},40:function(t){return{x:t.x+t.width/4,y:t.y}},41:function(M){return{x:M.x+3*M.width/4,y:M.y}},42:function(Q,f){return{x:Q.x+Q.width/4,y:Q.y+f.height/2}},43:function(R,x){return{x:R.x+3*R.width/4,y:R.y+x.height/2}},44:function(r,X){return{x:r.x+r.width/2,y:r.y+r.height/2-X.height/2}},45:function(c){return{x:c.x+c.width/4,y:c.y+c.height/2}},46:function(K,B){return{x:K.x+K.width/2-B.width/2,y:K.y+K.height/2}},47:function(j,b){return{x:j.x+j.width/2+b.width/2,y:j.y+j.height/2}},48:function(O){return{x:O.x+3*O.width/4,y:O.y+O.height/2}},49:function(f,A){return{x:f.x+f.width/2,y:f.y+f.height/2+A.height/2}},50:function(c,i){return{x:c.x+c.width/4,y:c.y+c.height-i.height/2}},51:function(h,E){return{x:h.x+3*h.width/4,y:h.y+h.height-E.height/2}},52:function(h){return{x:h.x+h.width/4,y:h.y+h.height}},53:function(A){return{x:A.x+3*A.width/4,y:A.y+A.height}},54:function(j,m){return{x:j.x+j.width/4,y:j.y+j.height+m.height/2}},55:function(A,O){return{x:A.x+3*A.width/4,y:A.y+A.height+O.height/2}}};return qk(Q)?function(S,e,j){return P[S](e,j?j:Sr)}:void 0}();Gh(e,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Np=e.reverse,vd=e.transparent,ym=e.rectSelectBackground,xc=e.dash,Zo=e.titleBackground,Ad=e.titleIconBackground,Il=e.headerBackground,xd=e.headerIconBackground,Di=e.headerSeparator,Lg=e.headerLine,Pj=e.contentIconBackground,zs=e.contentLine,Qk=(e.widgetIconHighlight,e.widgetIconBorder),Mh=(e.widgetIconGradient,e.imageBackground),xj=e.imageGradient,wp=e.highlight,bn=e.label,Vm=e.labelSelect;if(U&&!Q.shutAlert){var Ib=new Date,lf=U.split("-"),Eq=new Date(Ib.getFullYear(),Ib.getMonth(),Ib.getDate()),U=new Date(s(lf[0],10),s(lf[1],10)-1,s(lf[2],10)),Ig=Eq.getTime(),Sh=U.getTime(),zr=D+"_try",Pb=Q.alert;try{var Ne=Q.localStorage;if(Ne&&Pb)if(Sh>Ig&&1728e6>Sh-Ig){var Ob=(Sh-Ig)/864e5;Ne&&Ne[zr]!=Ob&&(Ne[zr]=Ob,Pb("HT for Web free trial license will expire in "+Ob+" days, please apply for a new license!"))}else Ig>=Sh&&Pb("Your free trial of HT for Web has expired!"),Ne&&delete Ne[zr]}catch(Zq){}}var sl={ms_ac:function(B,F){for(var E=F.ms_ac,i=0;i<E.length;i++)er(B,E[i])},ms_listener:function(G){G.addListeners=function(){for(var g=this,W=0;W<$e.length;W++)g["handle_"+$e[W]]&&aj($e[W],g.getView(),g)},G.removeListeners=function(){for(var Z=this,d=0;d<$e.length;d++)Z["handle_"+$e[d]]&&Df($e[d],Z.getView(),Z)}},ms_fire:function(b){b.mp=function(R,Y,v){this.addPropertyChangeListener(R,Y,v)},b.ump=function(I,g){this.removePropertyChangeListener(I,g)},b.fp=function(C,p,K,f,H){return this.firePropertyChange(C,p,K,f,H)},b.addPropertyChangeListener=function(t,R,r){var s=this;s._62I||(s._62I=new np),s._62I.add(t,R,r)},b.removePropertyChangeListener=function(P,M){this._62I&&this._62I.remove(P,M)},b.firePropertyChange=function(t,j,k,J,V){if(J){if(J(j,k))return!1}else if(j===k)return!1;var b=this,G=V||{};return G.property=t,G.oldValue=j,G.newValue=k,G.source=b,G.data=b,b._62I&&b._62I.fire(G),b.onPropertyChanged&&b.onPropertyChanged(G),!0}},ms_attr:function(h){h.a=function(G,w){var U=this;if(2===arguments.length)U.setAttr(G,w);else{if(!$p(G))return U.getAttr(G);for(var d in G)U.setAttr(d,G[d])}return U},h.getAttr=function(c,F){if(F===i&&(F=1),this._attrObject&&c in this._attrObject)return this._attrObject[c];if(this.getImage){var Q=this.getImage();if(Tp(Q)&&(Q=li[Q]),$p(Q)&&"dataBindings"in Q)for(var H=Q.dataBindings,X=H.length-1;X>=0;X--){var v=H[X];if(v.attr===c){if("defaultValue"in v)return v.defaultValue;break}}}return F?u[c]:i},h.setAttr=function(L,C){var G=this;G._attrObject||(G._attrObject={});var K=G._attrObject[L];C===i?delete G._attrObject[L]:G._attrObject[L]=C,G.fp&&G.fp("a:"+L,K,C)&&G.onAttrChanged&&G.onAttrChanged(L,K,C)},h.getSerializableAttrs=function(){var J,w={};for(J in this._attrObject)w[J]=1;return w}},ms_bnb:function(Q){Q.getBodyColor=function(I){return I.s("body.color")},Q.getBorderColor=function(A){return A.s("border.color")}},_51o:function(P){P.mi=function(l,R,O){this.addInteractorListener(l,R,O)},P.umi=function(t,V){this.removeInteractorListener(t,V)},P.fi=function(G){this.fireInteractorEvent(G)},P.addInteractorListener=function(k,P,M){var I=this;I._63I||(I._63I=new np),I._63I.add(k,P,M)},P.removeInteractorListener=function(n,Y){this._63I.remove(n,Y)},P.fireInteractorEvent=function(j){this._63I&&this._63I.fire(j)},P.setInteractors=function(W){var m=this,k=m._interactors;k&&k.each(function(E){E.tearDown()}),mr(W)&&(W=new kg(W)),m._interactors=W,W&&W.each(function(Y){Y.setUp()}),m.fp("interactors",k,W),m.invalidateSelection()},P.getInteractors=function(){return this._interactors}},_49o:function(j){j._44O=a,j._45O=a,j.getTopPainters=function(){return this._44O},j.getBottomPainters=function(){return this._45O},j.addTopPainter=function(C){var b=this;b._44O||(b._44O=new kg),b._44O.contains(C)||(b._44O.add(C),b.redraw&&b.redraw())},j.removeTopPainter=function(H){var m=this;m._44O&&(m._44O.remove(H),m.redraw&&m.redraw())},j.addBottomPainter=function(F){var e=this;e._45O||(e._45O=new kg),e._45O.contains(F)||(e._45O.add(F),e.redraw&&e.redraw())},j.removeBottomPainter=function(V){var R=this;R._45O&&(R._45O.remove(V),R.redraw&&R.redraw())},j._93db=function(W,N){var O=this;O._45O&&O._45O.each(function(b){b.draw?b.draw(W,N):b.call(O,W,N)})},j._92db=function(d,r){var t=this;t._44O&&t._44O.each(function($){$.draw?$.draw(d,r):$.call(t,d,r)})}},ms_sm:function(u){u.sm=function(){return this.getSelectionModel()},u.setSelectableFunc=function(P){this.sm().setFilterFunc(P)},u.getSelectableFunc=function(){return this.sm().getFilterFunc()},u.getSelectionModel=function(){var o=this;return o._selectionModel?o._selectionModel:o.dm().sm()},u.isSelectionModelShared=function(){return!this._selectionModel},u.setSelectionModelShared=function(l){var O=this,Q=!O._selectionModel,H=O.handleSelectionChange,n=O.dm();Q!==l&&(O.invalidateSelection&&O.invalidateSelection(),l?(n.sm().ms(H,O),O._selectionModel.ums(H,O),O._selectionModel.dispose(),O._selectionModel=a):(n.sm().ums(H,O),O._selectionModel=new Le(n),O._selectionModel.ms(H,O)),O.onSelectionModelSharedChanged(),O.fp("selectionModelShared",Q,l))},u.onSelectionModelSharedChanged=function(){var G=this;G.redraw(),G.invalidateSelection&&G.invalidateSelection()},u.removeSelection=function(){var h=this.dm();h.beginTransaction(),this.sm().toSelection().each(h.remove,h),h.endTransaction()},u.selectAll=function(){var s=this;s.sm().ss(s.dm().toDatas(function(t){return s.isVisible(t)&&s.isSelectable(t)}))},u.isSelected=function(h){return this.sm().co(h)},u.isSelectedById=function(r){var t=this.dm().getDataById(r);return t?this.isSelected(t):!1},u.isSelectable=function(P){return this.sm().isSelectable(P)}},ms_tx:function(P){P._64I=0,P._65O=0,P.isScrollable=function(){return this.getWidth()<this._64I},P._40o=function(){return this.isScrollable()},P.getLogicalPoint=function(P){return yj(P,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},P.tx=function(l){return l===i?this.getTranslateX():(this.setTranslateX(l),void 0)},P.getTranslateX=function(){return this._65O},P.setTranslateX=function(A){var i=this,J=i.getWidth()-i._64I;J>A&&(A=J),A>0&&(A=0),A=B(A);var M=i._65O;i._65O=A,i.fp(nb,M,A)}},ms_ty:function(x){x._23Q=0,x._66O=0,x._41o=function(){return this.getHeight()<this._23Q},x.getLogicalPoint=function(b){return yj(b,this._canvas||this._view,this.tx?this.tx():0,this.ty())},x.ty=function(Q){return Q===i?this.getTranslateY():(this.setTranslateY(Q),void 0)},x.getTranslateY=function(){return this._66O},x.setTranslateY=function(A){var Q=this,Z=Q.getHeight()-Q._23Q;Z>A&&(A=Z),A>0&&(A=0),A=B(A);var f=Q._66O;Q._66O=A,Q.fp(rl,f,A)}},ms_txy:function(z){z._65O=0,z._66O=0,z.tx=function(R){return R===i?this.getTranslateX():(this.setTranslateX(R),void 0)},z.ty=function(x){return x===i?this.getTranslateY():(this.setTranslateY(x),void 0)},z.onTranslateEnded=function(){},z.setTranslate=function(b,w,R){var L=this;if(R=ve(R)){L._65I&&L._65I.stop(!0);var H=L.tx(),$=L.ty();R.action=function(N){L.setTranslate(H+(b-H)*N,$+(w-$)*N)},R._37o=function(){delete L._66I,delete L._65I,L.onTranslateEnded()},L._66I=1,L._65I=Ar(R)}else L.tx(b),L.ty(w)},z.getTranslateX=function(){return this._65O},z.setTranslateX=function(E){var v=this;E=v.adjustTranslateX(E);var P=v._65O;v._65O=E,v.fp(nb,P,E)},z.getTranslateY=function(){return this._66O},z.setTranslateY=function(z){var p=this;z=p.adjustTranslateY(z);var h=p._66O;p._66O=z,p.fp(rl,h,z)},z.adjustTranslateX=function(V){return B(V)},z.adjustTranslateY=function(w){return B(w)},z.translate=function(P,Z,u){this.setTranslate(this.tx()+P,this.ty()+Z,u)},z.getLogicalPoint=function(b){var X=this;return yj(b,this._canvas||X._view,X.tx(),X.ty())}},ms_dm:function(m){m.dm=function(U){return U?(this.setDataModel(U),void 0):this.getDataModel()},m.getDataModel=function(){return this._dataModel}},ms_lp:function(s){s.lp=function(x){return this.getLogicalPoint(x)}},ms_v:function(v){v._disabled=!1,v.setDisabled=function(t,H){var h=this,e=h._disabled;e!==t&&(e&&(Tn(h._63O),delete h._63O),t&&(Oc(h._view,h._63O=rd(H)),h.iv()),h._disabled=t,h.fp("disabled",e,t))},v.isDisabled=function(){return this._disabled},v.getDisabledDiv=function(){return this._63O},v.getView=function(){return this._view},v.addToDOM=function(A){var r=this,f=r.getView(),M=f.style;A=A||H.body,A.appendChild(f),M.left="0",M.right="0",M.top="0",M.bottom="0",Q.addEventListener("resize",function(){r.iv()},E),r.iv()},v.getWidth=function(){return this._view.clientWidth},v.getHeight=function(){return this._view.clientHeight},v.setWidth=function(r){var e=this;e._view.style.width=r+Af,e.iv(),e.fp&&e.fp(Lc,a,r)},v.setHeight=function(R){var o=this;o._view.style.height=R+Af,o.iv(),o.fp&&o.fp(ss,a,R)},v.setFocus=function(d){var J=this,U=J._currentEditor;return d&&U&&(U.getView&&(U=U.getView()),U.contains(d.target))?!1:(Rk(J._view),J.endEditing&&J.endEditing(),J.fireViewEvent("focus"),!0)},v.iv=function(O){this.invalidate(O)},v.invalidate=function(G){var m=this;m._68I||(m._68I=1,Jj(m.validate,m,a,G),m.onInvalidated&&m.onInvalidated(),m.fireViewEvent("invalidate"))},v.validate=function(){var m=this,O=m._view;if(m._68I&&(delete m._68I,O.parentNode))if(0===O.offsetWidth&&0===O.offsetHeight&&m._67I!==a)m._67I===i&&(m._67I=x.reinvalidateCount),m._67I>0?m._67I--:m._67I=a,m.iv();else{m.fireViewEvent("beginValidate"),m.validateImpl(),m.onValidated&&m.onValidated(),m.fireViewEvent("validate");var B=m._63O;B&&(O.lastChild!==B&&(Tn(B),Oc(O,B)),dp(B,0,0,m.getWidth(),m.getHeight())),rg(m),yr(m),Ur(m)}},v.layout=function(i,K,M,F){1===arguments.length?dp(this,i):dp(this,i,K,M,F)},v.addViewListener=function(B,L,x){var c=this;c._67O||(c._67O=new np),c._67O.add(B,L,x)},v.removeViewListener=function(j,I){this._67O.remove(j,I)},v.fireViewEvent=function(w){var $=this;$._67O&&(Tp(w)&&(w={kind:w}),$._67O.fire(w)),x.viewListener&&x.viewListener($,w)}},ms_tip:function(M){M.setToolTipEnabled=function(J){var l=this;J?Ye||l._13o||(l.enableToolTip(),l.fp("toolTipEnabled",!1,!0)):l._13o&&(l.disableToolTip(),l.fp("toolTipEnabled",!0,!1))},M.isToolTipEnabled=function(){return!!this._13o},M.enableToolTip=function(){var r=this;Ye||r._13o||(r._13o=function(s){var h=r.getToolTip(s);h!=a?x.toolTipContinual&&x.isToolTipShowing()?mc(s,h):(el(),qh={timeout:q(ap,ud),e:s,info:h}):el()},r.getView().addEventListener(jo,r._13o,E),r.getView().addEventListener("mouseleave",x.hideToolTip,E))},M.disableToolTip=function(){var u=this;u._13o&&(u.getView().removeEventListener(jo,u._13o,E),u.getView().removeEventListener("mouseleave",x.hideToolTip,E),delete u._13o)},M.getToolTip=function(p){var q=this;if(q.getDataAt){var o=q.getDataAt(p);return o?o.getToolTip():a}return q.getValue?q.getValue():void 0}},_52o:function(W){W._zoom=1,W._29I=Sr,W.zoomIn=function(F,E){this.setZoom(this._zoom*Fk,F,E)},W.zoomOut=function(g,U){this.setZoom(this._zoom/Fk,g,U)},W.zoomReset=function(c,u){this.setZoom(1,c,u)},W.scrollZoomIn=function(b){this.setZoom(this._zoom*$h,a,b)},W.scrollZoomOut=function(b){this.setZoom(this._zoom/$h,a,b)},W.pinchZoomIn=function(p){this.setZoom(this._zoom*oi,a,p)},W.pinchZoomOut=function(B){this.setZoom(this._zoom/oi,a,B)},W.adjustZoom=function(B){return fe>B?fe:B>kp?kp:B},W.getZoom=function(){return this._zoom},W.setZoom=function(M,U,Y){var J=this;if(U=ve(U)){J._14o&&J._14o.stop(!0);var G=J._zoom;U.action=function(q){J._96O(G+(M-G)*q,Y)},U._37o=function(){delete J._zooming,delete J._14o,J.onZoomEnded()},J._zooming=1,J._14o=Ar(U)}else J._96O(M,Y)},W._96O=function(e,C){var q=this;if(e=q.adjustZoom(e),e!==q._zoom){q.validate();var r=q._29I,W=q._zoom;0!==r.width&&0!==r.height&&(C=C?C:{x:r.x+r.width/2,y:r.y+r.height/2},q.tx((C.x-r.x)*W-C.x*e),q.ty((C.y-r.y)*W-C.y*e)),q._zoom=e,q.fp("zoom",W,e)}}},ms_edge:function(K){K._2I=function(v){var p=this;p._44I||(p._44I=new kg),p._42I||(p._42I=new kg),p._44I.add(v),p._42I.add(v),p._20I()},K._4I=function(R){var P=this;P._44I||(P._44I=new kg),P._43I||(P._43I=new kg),P._44I.add(R),P._43I.add(R),P._20I()},K._16I=function(N){var v=this;v._44I.remove(N),v._42I.remove(N),v._44I.isEmpty()&&delete v._44I,v._42I.isEmpty()&&delete v._42I,v._20I()},K._18I=function(k){var p=this;p._44I.remove(k),p._43I.remove(k),p._44I.isEmpty()&&delete p._44I,p._43I.isEmpty()&&delete p._43I,p._20I()},K._20I=function(){var v=this;if(delete v._45I,!v._44I||v._44I.isEmpty())return delete v._70O,void 0;var o;v._44I.each(function(M){M.isLooped()&&(o||(o={}),o[M._id]||(v._45I||(v._45I=new kg),v._45I.add(M),o[M._id]=M))}),o?(v._70O=new kg,v._44I.each(function(h){o[h._id]?"A"===o[h._id]||(o[h._id]="A",v._70O.add(h)):v._70O.add(h)})):v._70O=v._44I},K.hasAgentEdges=function(){return!!this._49I&&!this._49I.isEmpty()},K.getSourceAgentEdges=function(){return this._46I},K.getTargetAgentEdges=function(){return this._47I},K._1I=function(h){var R=this;R._46I||(R._46I=new kg),R._48I||(R._48I=new kg),R._46I.add(h),R._48I.add(h),R._19I()},K._3I=function(P){var X=this;X._47I||(X._47I=new kg),X._48I||(X._48I=new kg),X._47I.add(P),X._48I.add(P),X._19I()},K._15I=function(q){var O=this;O._46I.remove(q),O._48I.remove(q),O._46I.isEmpty()&&delete O._46I,O._48I.isEmpty()&&delete O._48I,O._19I()},K._17I=function(R){var q=this;q._47I.remove(R),q._48I.remove(R),q._47I.isEmpty()&&delete q._47I,q._48I.isEmpty()&&delete q._48I,q._19I()},K._19I=function(){var I=this;delete I._49I;var H=I._48I;if(H&&!H.isEmpty()){var g={};H.each(function(b){g[b._id]?I._49I||(I._49I=new kg):g[b._id]=b}),I._49I?H.each(function(x){g[x._id]&&(I._49I.add(x),delete g[x._id])}):I._49I=H}},K.getLoopedEdges=function(){return this._45I},K.getEdges=function(){return this._70O},K.getAgentEdges=function(){return this._49I},K.getSourceEdges=function(){return this._42I},K.getTargetEdges=function(){return this._43I},K._8I=function(){this._70O&&this._70O.each(function(d){d._7I()})}}};Gh(x,{numberDigits:5,crossOrigin:"",baseZIndex:i,isTouchable:Ye,devicePixelRatio:Q.devicePixelRatio?Q.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:e.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return ye},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],encodeStringKey:null,doubleClickRange:Ye?20:1,animDuration:200,animEasing:function(r){return r*r},labelColor:bn,labelSelectColor:Vm,labelFont:(Ye?"15":"12")+"px arial, sans-serif",widgetIndent:Ye?30:20,widgetRowHeight:Ye?30:20,widgetHeaderHeight:Ye?32:22,widgetTitleHeight:Ye?34:24,scrollBarColor:vd,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:Ye?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Ed,intersectionLineLine:rs,isEnter:Jc,isEsc:Te,isDelete:ll,isSpace:oj,isLeft:Mb,isUp:ee,isRight:xr,isDown:Rf,getTarget:Hl,isString:Tp,isNumber:Sm,isBoolean:Xq,isArray:mr,isSelectAll:Mq,isFunction:nk,isObject:$p,getPropertyValue:Bm,setPropertyValue:rr,addMethod:Gh,getVersion:function(){return"6.3.1"},createGradient:function(w,n,O,t,D,a,T,x){var u=hd[n];return u(w,O,t,D,a,T,x)},appendToScreen:function(S){S=S.getView?S.getView():S,(H.fullscreenElement||H.mozFullScreenElement||H.webkitFullscreenElement||H.msFullscreenElement||H.body).appendChild(S)},encodeString:function(U){return S.Math.encodeBase64(U,x.encodeStringKey)},decodeString:function($){return S.Math.decodeBase64($,x.encodeStringKey)},toggleFullscreen:function(Z){var r=Z.getView();if(H.fullscreenElement||H.mozFullScreenElement||H.webkitFullscreenElement||H.msFullscreenElement)H.exitFullscreen?H.exitFullscreen():H.msExitFullscreen?H.msExitFullscreen():H.mozCancelFullScreen?H.mozCancelFullScreen():H.webkitExitFullscreen&&H.webkitExitFullscreen();else{var q=!0;if(Z.isSelfViewEvent){var W=Z.getX(),Y=Z.getY(),l=Z.getWidth(),z=Z.getHeight(),n=r.style.background;n||(r.style.background="white"),r.requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen();var v=setInterval(function(){if(r!==(H.fullscreenElement||H.mozFullScreenElement||H.webkitFullscreenElement||H.msFullscreenElement))clearInterval(v),Z.setX(W),Z.setY(Y),Z.setWidth(l),Z.setHeight(z),Z._fullscreen=!1,r.style.background=n,Z.iv();else{var c=S.Default.getWindowInfo();(q||c.width!==Z.getWidth()||c.height!==Z.getHeight())&&(Z.setX(c.left),Z.setY(c.top),Z.setWidth(c.width),Z.setHeight(c.height),Z._fullscreen=!0,Z.iv(),q=!1)}},500)}else{var D=r.style.left,B=r.style.top,l=r.style.width,z=r.style.height,n=r.style.background;n||(r.style.background="white"),r.requestFullscreen?r.requestFullscreen():r.msRequestFullscreen?r.msRequestFullscreen():r.mozRequestFullScreen?r.mozRequestFullScreen():r.webkitRequestFullscreen&&r.webkitRequestFullscreen();var v=setInterval(function(){if(r!==(H.fullscreenElement||H.mozFullScreenElement||H.webkitFullscreenElement||H.msFullscreenElement))clearInterval(v),r.style.left=D,r.style.top=B,r.style.width=l,r.style.height=z,r.style.background=n,Z.iv();else{var k=S.Default.getWindowInfo();(q||k.width!==Z.getWidth()||k.height!==Z.getHeight())&&(dp(Z),q=!1)}},500)}}},appendTimeStamp:function(g){return g},setCompType:function(l,d){nk(d)||$p(d)?qf[l]=d:Rd(l)},getCompType:function(k){var M=qf[k];return M===i&&Yb.test(k)&&Rd(k),M},getCompTypeMap:function(){return qf},drawCompType:function(g,m,v,Y,j,t){g(m,v,Y,j,t)},numberListener:function(){var j={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(s){var W=s.keyCode;j[W]||65===W&&x.isCtrlDown(s)||86===W&&x.isCtrlDown(s)||67===W&&x.isCtrlDown(s)||88===W&&x.isCtrlDown(s)||W>=35&&40>=W||(s.shiftKey||48>W||W>57)&&(96>W||W>105)&&s.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(E){var V=E.target.tagName;("DIV"===V||"CANVAS"===V)&&!(x.ignoreKeyCodes.indexOf(E.keyCode)>=0)&&("keydown"!==E.type||Mb(E)||xr(E)||ee(E)||Rf(E)||ll(E)||65===E.keyCode&&(E.metaKey||E.ctrlKey))&&(E.preventDefault(),E.preventManipulation&&E.preventManipulation())},getWindowInfo:function(){var R=H.documentElement,r=R&&(R.scrollLeft||R.scrollTop)?R:H.body;return{target:r,left:r.scrollLeft,top:r.scrollTop,width:Q.innerWidth||r.clientWidth,height:Q.innerHeight||r.clientHeight}},isDragging:function(){return!!ye},isLeftButton:function(j){return Ye?!0:0===j.button},isInput:function(p){if(!p)return!1;var O=p.tagName;return"INPUT"===O||"TEXTAREA"===O||"SELECT"===O},getTouchCount:function(d){return Ye?d.touches.length:1},isDoubleClick:function(){function Z(s){s.details=0,s.timeout=null,s.lastPoint=null}var n={};return Kj=new g,Im=Kj.getTime(),function(D){if(D.touches&&D.touches.length>1)return!1;var f=D.button==a?"":D.button,c=D.type+f,U=c+"_isDoubleClick",T=n[c];if(T||(T=n[c]={details:0,timeout:null,lastPoint:null}),D[U]===i){D[U]=!0;var w=_o(D);T.timeout&&(Y(T.timeout),T.timeout=null),T.lastPoint&&Og(T.lastPoint,w)>x.doubleClickRange&&Z(T),T.lastPoint=w,T.details++,T.timeout=q(function(){Z(this)}.bind(T),500)}return 2===T.details}}(),isShiftDown:function(u){return u?u.shiftKey:Oh["16"]},isCtrlDown:function(p){return p?Ti?p.metaKey:p.ctrlKey:Ti?Oh["91"]:Oh["17"]},getClientPoint:function(O){return Ye&&(O=Si(O)),{x:O.clientX,y:O.clientY}},isMouseEvent:function(K){return K instanceof MouseEvent||0===K.type.indexOf("mouse")},getTargetElement:function(F){if(x.isMouseEvent(F)||!H.elementFromPoint)return F.target;var _=Kd(F);return H.elementFromPoint(_.x,_.y)},getPagePoint:function(j){return Ye&&(j=Si(j)),{x:j.pageX,y:j.pageY}},createObject:function(b,u){var J=new b;for(var a in u){var f=u[a];if(nk(f))J[a]=f;else if(0===a.indexOf("s:"))J.s(a.substr(2),u[a]);else if(0===a.indexOf("a:"))J.a(a.substr(2),u[a]);else{var g=vs(a),f=u[a];J[g]?(J[g](f),"setToolTip"===g&&J.enableToolTip&&J.enableToolTip()):J[a]=f}}return J},setImage:function(k,T,O,G){var f=arguments.length;4===f?wh(k,G,T,O):2===f?Tp(T)?wh(k,T):kr(k,T):1===f&&wh(k,k)},getImage:function(l,H,G){var q;if(l==a)return a;if($p(l)?q=l:(q=li[l],l&&q===i&&(Hb&&Hb[l]||wh(l,l))),H&&q&&q.tagName){var P;P="override"===G?"colors_override":"override_rgb"===G?"colors_override_rgb":"override_a"===G?"colors_override_a":"colors",q[P]||(q[P]={__count__:0});var Y=q[P][H];return Y||(q[P].__count__>x.imageCacheThreshold&&(q[P]={__count__:0}),Y=Zb(q,gi(H),q.width,q.height,G),q[P][H]=Y,q[P].__count__++),Y}return q},isImageComplete:function(J,S,P){var t=Nl(J);if(!t)return!1;if(t.tagName)return t.complete;for(var j,J,I,v=t.comps,a=!0,M=0,A=v.length;A>M;M++)if(j=v[M],I=j.type,"image"===j.type){J=j.name,J&&J.func&&(J=Cs(J,S));var r=Ff(J,S,P);if(!r){a=!1;break}}else if(Yb.test(I)&&x.getCompType(I)===i){a=!1,Rd(I);break}return a},getId:function(){var R=1;return function(){return++R}}(),callLater:function(D,Z,I,R){var j=function(){D.apply(Z,I)};return R?q(j,R):Q.requestAnimationFrame(j)},clone:function(p){if(null==p||"object"!=typeof p)return p;if(p instanceof Date){var U=new Date;return U.setTime(p.getTime()),U}if(p instanceof Array){for(var U=[],A=0,v=p.length;v>A;A++)U[A]=Hj(p[A]);return U}if(p instanceof kg){for(var U=new kg,A=0,v=p.length;v>A;A++)U.set(A,Hj(p.get(A)));return U}if(p instanceof Ij)return p;if(p instanceof n){var U={};for(var F in p)p.hasOwnProperty(F)&&(U[F]=Hj(p[F]));return U}return p},callWhenLoaded:function(O,C){C=C||100;var _=le(O,C);dm||(dm={}),dm[_]={tick:_,cb:O,delay:C}},beforeLoadURL:function(Z){if(dm){var X={};for(var q in dm){var g=dm[q];Y(g.tick);var B=le(g.cb,g.delay);X[B]={tick:B,delay:g.delay,cb:g.cb}}dm=X}return x.convertURL?x.convertURL(Z):Z},convertURL:function(d){return d},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){return x.getImage("default_blank")},sortFunc:function(k,h){if(k===h)return 0;if(k==a&&h!=a)return 1;if(k!=a&&h==a)return-1;if(k==a&&h==a)return 0;var R,W=typeof k,F=typeof h;return W===kd&&F===kd?R=k.localeCompare(h):W===ii&&F===ii&&(R=k-h),R===i&&(R=(""+k).localeCompare(""+h)),R>0?1:0>R?-1:0},getClassMap:function(){return br},getClass:function(G){if(Tp(G)){var H,C=br[G];if(!C){H=G.split("."),C=Q;for(var J=0;J<H.length;J++)C=C[H[J]];br[G]=C}return C}return G},def:function(f,Y,a){var w,P,q,J=function(){};if(J.prototype=Y.prototype,w=new J,Tp(f)){if(br[f])throw"'"+f+"' already defined";q=tg(f),w.getClassName=function(){return f}}else q=f;if(w.constructor=q,w.getClass=function(){return q},w.getSuperClass=function(){return Y},a)for(P in a)sl[P]&&sl.hasOwnProperty(P)?sl[P](w,a):Yr(w,a,P);q.prototype=w,q.superClass=Y.prototype},startAnim:function(){var N=function(D){D.duration&&(D.startTime=qj()),D.timeId=Jj(D.tick,a,a,D.interval)};return function(L){return L=Hj(L),L.easing=L.easing||x.animEasing,L.duration||L.frames||(L.duration=x.animDuration),L.t=0,L.duration?L.interval=0:(L.frame=0,L.interval=L.interval||10),L.tick=function(){if(L.duration){var I=(qj()-L.startTime)/L.duration;if(I>1&&(I=1),L.t=I,L.action(L.easing(I),I),!L.isRunning())return;1===I?L.stop():L._isPaused||(L.timeId=Jj(L.tick))}else{if(L.frame++,I=L.t=L.frame/L.frames,L.action(L.easing(I),I),!L.isRunning())return;L.frame<L.frames?L._isPaused||(L.timeId=Jj(L.tick,a,a,L.interval)):L.stop()}},L.resume=function(){L._isPaused&&(delete L._isPaused,L.duration?L.t<1&&(L.startTime=qj()-L.duration*L.t,L.timeId=Jj(L.tick)):L.frame<L.frames&&(L.timeId=Jj(L.tick,a,a,L.interval)))},L.pause=function(){L._isPaused=!0},L.isPaused=function(){return this._isPaused},L.stop=function(I){L.isRunning()&&(To(L.timeId,!L.duration),delete L.timeId,L.duration?L.t<1&&I&&(L.t=1,L.action(L.easing(1),1)):L.frame<L.frames&&I&&(L.frame=L.frames,L.action(L.easing(1),1)),L._37o&&L._37o(),L.finishFunc&&L.finishFunc())},L.isRunning=function(){return L.timeId!=a},L.delay?Jj(N,a,[L],L.delay):N(L),L}}(),getTextSize:function(){var L={},W=H?xp().getContext("2d"):a;return function(h,j){W.font=h?h:Bg;var l=L[W.font];return l||(l=2*W.measureText("e").width+4,L[W.font]=l),{width:W.measureText(j).width+4,height:l}}}(),drawText:function(K,$,o,m,r,T,O,I,F,s){if($!=a){var h=Lm(o,$),t={};t.y=s&&s!==no?s===Se?T+h.height/2:T+I-h.height/2:T+I/2,t.x=F&&F!==ce?F===_i?r+O-h.width/2:r+O/2:r+h.width/2,Bk(K,$,t,o,m)}},getDistance:function($,S){var l=$.length;return S?3===l?C(T($[0]-S[0])+T($[1]-S[1])+T($[2]-S[2])):2===l?C(T($[0]-S[0])+T($[1]-S[1])):$.z===i?C(T(S.x-$.x)+T(S.y-$.y)):C(T(S.x-$.x)+T(S.y-$.y)+T(S.z-$.z)):3===l?C(T($[0])+T($[1])+T($[2])):2===l?C(T($[0])+T($[1])):void 0},brighter:function(M,I){return 0>I&&(I=-I),Zg(M,I?I:40)},darker:function(m,P){return P>0&&(P=-P),Zg(m,P?P:-40)
},unionPoint:function(M,b){if(!M)return a;if(2===arguments.length)return M&&b?{x:t(M.x,b.x),y:t(M.y,b.y),width:G(M.x-b.x),height:G(M.y-b.y)}:a;var r=M;if(r._as&&(r=r._as),r.length===i)return a;var c=r.length;if(0>=c)return a;for(var E=1,O=r[0],p={x:O.x,y:O.y,width:0,height:0};c>E;E++){O=r[E];var A=t(p.x,O.x),$=w(p.x+p.width,O.x),K=t(p.y,O.y),Z=w(p.y+p.height,O.y);p.x=A,p.y=K,p.width=$-A,p.height=Z-K}return p},unionRect:function(Q,r){if(Q&&!r)return Hj(Q);if(!Q&&r)return Hj(r);if(Q&&r){var F={x:t(Q.x,r.x),y:t(Q.y,r.y)};return F.width=w(Q.x+Q.width,r.x+r.width)-F.x,F.height=w(Q.y+Q.height,r.y+r.height)-F.y,F}return a},containsPoint:function(I,R,N,Q){if(Q!=a&&1!==Q){var v=I.x+I.width/2,C=I.y+I.height/2;I={x:v-I.width/2*Q,y:C-I.height/2*Q,width:I.width*Q,height:I.height*Q}}if(N){var y=I.width/2,V=I.height/2,G=M(-N),f=b(-N),e=R.x-I.x-y,s=R.y-I.y-V;return R={x:f*e-G*s,y:G*e+f*s},dh({x:-y,y:-V,width:I.width,height:I.height},R)}return!(!I||R.x<I.x||R.y<I.y||R.x>I.x+I.width||R.y>I.y+I.height)},containsRect:function(B,N){if(!B||!N)return!1;var x=N.x,F=N.y,d=N.width,b=N.height,u=B.width,w=B.height;if(0>(u|w|d|b))return!1;var E=B.x,Q=B.y;if(E>x||Q>F)return!1;if(u+=E,d+=x,x>=d){if(u>=E||d>u)return!1}else if(u>=E&&d>u)return!1;if(w+=Q,b+=F,F>=b){if(w>=Q||b>w)return!1}else if(w>=Q&&b>w)return!1;return!0},intersectsRect:function(u,Z){if(!u||!Z)return!1;var d=Z.width,W=Z.height,q=u.width,n=u.height;if(0>=q||0>=n||0>=d||0>=W)return!1;var J=Z.x,H=Z.y,Y=u.x,A=u.y;return q+=Y,n+=A,d+=J,W+=H,q>J&&n>H&&d>Y&&W>A},intersection:function(N,l){if(!N||!l)return a;var L=l.x,F=l.y,Q=N.x,s=N.y,R=L,y=F,v=Q,_=s;return R+=l.width,y+=l.height,v+=N.width,_+=N.height,Q>L&&(L=Q),s>F&&(F=s),R>v&&(R=v),y>_&&(y=_),R-=L,y-=F,0>=R||0>=y?a:{x:L,y:F,width:R,height:y}},grow:function(U,H,h){h===i&&(h=H),U.x-=H,U.y-=h,U.width=U.width+2*H,U.height=U.height+2*h},getScreenPoint:function(A,U,S,f,v,w,V){var Y,j,y=S.getBoundingClientRect(),I=A*(w||1)+y.left-S.scrollLeft+(f||0),T=U*(V||1)+y.top-S.scrollTop+(v||0),c={x:I,y:T};return(Y=S.parentElement)&&(j=Y.maxtrixAppend)?j.applyInverse(c,{}):c},getLogicalPoint:function(y,d,p,Z,B,Q){var N,D,A=d.getBoundingClientRect();y.target?(Ql(y)?Ti?Oh["91"]=!0:Oh["17"]=!0:Ti?Oh["91"]=!1:Oh["17"]=!1,Oh["16"]=Bp(y)?!0:!1,y=Ye?Si(y):y,N=y.clientX,D=y.clientY):(N=y.x,D=y.y);var E,k;if((E=d.parentElement)&&(k=E.maxtrixAppend)){var c=k.apply({x:N,y:D},{});return c.x=(c.x+d.scrollLeft-(p||0))/(B||1),c.y=(c.y+d.scrollTop-(Z||0))/(Q||1),c}return{x:(N-A.left+d.scrollLeft-(p||0))/(B||1),y:(D-A.top+d.scrollTop-(Z||0))/(Q||1)}},removeHTML:function(){var n;return function(s){return s&&s.getView&&(s=s.getView()),s&&s.parentNode?n===s?!0:(n=s,s.parentNode.removeChild(s),n=a,!0):!1}}(),getToolTipDiv:function(){if(!th){th=we(),Hd=we();var H=th.style;x.baseZIndex!=a&&(H.zIndex=s(x.baseZIndex)+3+""),H.whiteSpace="nowrap",H.color=x.toolTipLabelColor,H.background=x.toolTipBackground,H.font=x.toolTipLabelFont,H.padding="5px",H.boxShadow="0px 0px 3px "+x.toolTipShadowColor}return th},isToolTipShowing:function(){return th&&th.parentNode?!0:Hd&&Hd.parentNode?!0:!1},hideToolTip:function(){Tn(th),Tn(Hd),ir()},showToolTip:function(F,f){if(!F||f==a)return el(),void 0;x.getToolTipDiv();var P,r;if(f.html?(f=f.html,P=Hd,Tn(th)):(P=th,Tn(Hd)),r=P.style,P.innerHTML=f,P.parentNode||S.Default.appendToScreen(P),F.target){F=Kd(F);var J=Ii(),M=F.x,l=F.y,d=Ye?60:12;if(Ye){var Y=P.getBoundingClientRect();r.left=M-Y.width/2+Af,r.top=l-Y.height-d<J.top?l+d+Af:l-Y.height-d+Af}else{r.left=M+d+Af,r.top=l+d+Af;var Y=P.getBoundingClientRect();Y.left+Y.width>J.width&&(r.left=M-d-Y.width+Af),Y.top+Y.height>J.height&&(r.top=l-d-Y.height+Af),Y.left<0&&(r.left=M+d+Af),Y.top<0&&(r.top=l+d+Af)}}else r.left=F.x+Af,r.top=F.y+Af;ir()},startDragging:function(x,k,H){H==i&&(H=!0),x!==ye&&(ye?H&&(Ye?ye.handleWindowTouchEnd(k):ye.handleWindowMouseUp(k)):Ye?(Q.addEventListener(fb,Zp,E),Q.addEventListener(Sn,Kg,E)):(Q.addEventListener(jo,zk,E),Q.addEventListener(Uq,Pn,E)),ye=x)},getImageMap:function(){return li},toBoundaries:function(r,b,L,D){var h=[];return vl(r,b,L,D).forEach(function(B){var O=[];B.forEach(function(D){O.push(D.x,D.y)}),h.push(O)}),h},getCurrentKeyCodeMap:function(){return Oh},drawCenterImage:function(n,e,T,g,x,r,c,D){var z=sr(e,x,r),w=Qo(e,x,r);jb(n,e,B(T-z/2),B(g-w/2),z,w,x,r,c,D)},drawStretchImage:function(g,Z,c,e,j,l,W,i,n,R,_,U){var o,M=sr(Z,i,n,l),s=Qo(Z,i,n,W);"uniform"===c?(o=t(l/M,W/s),M*=o,s*=o,e+=B((l-M)/2),j+=B((W-s)/2),l=M,W=s):"centerUniform"===c&&((M>l||s>W)&&(o=t(l/M,W/s),M*=o,s*=o),e+=B((l-M)/2),j+=B((W-s)/2),l=M,W=s);var Q=g.interactiveInfo;if(Q){var G;if(G="center"===c?{x:e+l/2-M/2,y:j+W/2-s/2,width:M,height:s}:{x:e,y:j,width:l,height:W},Q.rect){var w=Q.compInfos,F=w.length;F&&(w[F-1].rect.image=Z)}else Q.rect=G}if("center"===c){var u=_!==!1&&(M>l||s>W);u&&(g.save(),g.beginPath(),g.rect(e,j,l,W),g.clip()),jb(g,Z,e+l/2-M/2,j+W/2-s/2,M,s,i,n,R,U),u&&g.restore()}else jb(g,Z,e,j,l,W,i,n,R,U)},toCanvas:function(a,F,c,z,k,b,L,l,Y){a=Nl(a,L),F=F||sr(a,k),c=c||Qo(a,k);var H=xp(),M=wo(H);return l?(ms(H,F,c,l),M.scale(l,l)):ms(H,F,c,1),hc(M,a,z,0,0,F,c,k,b,L,Y),a&&a.clampToEdge&&(H.clampToEdge=a.clampToEdge),M.restore(),H},toGrayColor:function(s){if(!s)return s;var r=Yl(s),t=.299*r[0]+.587*r[1]+.114*r[2];return"rgba("+t+","+t+","+t+","+r[3]/255+")"},createGradientImage:function(N,q,K,P){for(var U=["L",0,0,N,0,1,0,0,1,0,0],m=0,H=Math.min(q.length,K.length);H>m;m++)U.push(K[m],q[m]);var r=S.Default.toCanvas({width:N,height:N,clampToEdge:!0,comps:[{type:"shape",rotation:P||0,points:[0,0,N,0,N,N,0,N],background:"#ffffff",gradientPack:U}]});return r},createElement:function(b,U,S,C){var m=H.createElement(b);return Gq(m,U||e.widgetBorder,2),m.style.font=S?S:Bg,C!=a&&(m.value=C),x.onElementCreated&&x.onElementCreated(m),m},containedInView:function(m,f){var Q=Xk(f).getBoundingClientRect();return dh({x:Q.left,y:Q.top,width:Q.width,height:Q.height},_o(m))},isIsolating:function(){return $j>0},setIsolating:function(R){R?$j++:$j--},getMSMap:function(){return sl},stringify:function(r,U,I){var L=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var F=JSON.stringify(r,function(q,C){return"function"==typeof C?"__ht__"+(C.__ht__||C.toString()):Sm(C)?il(C):C instanceof S.List?"__ht__list"+(C.__ht__list||x.stringify(C._as)):C},U==a?2:U);return Date.prototype.toJSON=L,I&&(F="__ht__encode"+x.encodeString(F)),F},parse:function(P){return Tp(P)?"__ht__encode"!=P.substr(0,12)||(P=x.decodeString(P.substr(12)),Tp(P))?JSON.parse(P,function(j,U){if(Tp(U))if("__ht__function"==U.substr(0,14)){var J=U.indexOf("{")+1,t=U.lastIndexOf("}"),d=U.indexOf("(")+1,E=U.indexOf(")");if(J&&t&&d&&E){var D=new Function(U.substring(d,E),U.substring(J,t));return D.__ht__=U.substr(6),D}}else{if("__ht__date"==U.substr(0,10))return new Date(s(U.substr(10)));if("__ht__list"===U.substr(0,10))return new kg(x.parse(U.substr(10)))}return U}):P:P},loadJS:function(d,n){n&&d.push(n);var k=d.shift();if(mr(k))d=k.contact(d),x.loadJS(d);else if(nk(k))k(),x.loadJS(d);else if(Tp(k)){var D=H.createElement("script");D.onload=function(){x.loadJS(d)},D.setAttribute("src",k),H.getElementsByTagName("head")[0].appendChild(D)}else d.length&&x.loadJS(d)},toRoundedCorner:function(q,k){var E=q.size();if(0>=k)return{points:q};var H,T=new kg,f=new kg,R=q.get(0);T.add(R),f.add(1);for(var Y=1;E>Y;Y++)if(E>Y+1){var L=q.get(Y),s=q.get(Y+1),D=R.x,U=R.y,r=L.x,i=L.y,K=i-U,x=r-D,h=J(K,x);H=t(.99*Og(R,L),k),T.add({x:r-H*b(h),y:i-H*M(h)}),T.add(L),D=L.x,U=L.y,r=s.x,i=s.y,K=i-U,x=r-D,h=J(K,x),H=t(.99*Og(L,s),k),R={x:D+H*b(h),y:U+H*M(h)},T.add(R),f.addAll([2,3])}else T.add(q.get(Y)),f.add(2);return{points:T,segments:f}},toColorData:Yl,setCanvas:ms,createDiv:we,createDisabledDiv:rd,createView:Qm,createCanvas:xp,appendChild:Oc,initContext:wo,checkLoadingImage:rg,translateAndScale:or,layout:dp,getPosition:gc,drawPoints:Nr,drawRoundRect:be,drawBorder:yb,setFocus:Rk,getter:ar,setter:vs,isEmptyObject:je},!0),Gh(r,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var jg=x.disabledOpacity,ud=x.toolTipDelay,Gl=x.devicePixelRatio,tj=x.autoMakeVisible,as=x.autoHideScrollBar,ge=x.imageGradient,mc=x.showToolTip,el=x.hideToolTip,Vg=x.dashPattern,hf=x.lineCap,og=x.lineJoin,An=x.labelColor,Gm=x.labelSelectColor,Bg=x.labelFont,bh=x.widgetIndent,Mc=x.widgetRowHeight,Ap=x.widgetHeaderHeight,ib=x.widgetTitleHeight,dg=x.scrollBarColor,Yq=x.scrollBarSize,qg=x.scrollBarTimeout,qc=x.scrollBarMinLength,Uj=x.scrollBarInteractiveSize,Fk=x.zoomIncrement,$h=x.scrollZoomIncrement,oi=x.pinchZoomIncrement,kp=x.zoomMax,fe=x.zoomMin,bi=x.createObject,yn=x.preventDefault,ai=x.setImage,Nl=x.getImage,Ff=x.isImageComplete,Kr=x.drawCenterImage,hc=x.drawStretchImage,Vd=x.getId,Jj=x.callLater,Gp=x.sortFunc,Hj=x.clone,tg=x.getClass,Ar=x.startAnim,Vq=x.brighter,wi=x.darker,sp=x.drawText,Lm=x.getTextSize,Rl=x.isLeftButton,zg=x.getTouchCount,uc=x.isDoubleClick,Bp=x.isShiftDown,Ql=x.isCtrlDown,_o=x.getClientPoint,Kd=x.getPagePoint,Og=x.getDistance,sq=x.unionPoint,Kl=x.unionRect,dh=x.containsPoint,zh=x.containsRect,nq=x.intersectsRect,Vj=x.intersection,Ii=x.getWindowInfo,de=x.grow,yj=x.getLogicalPoint,Tr=x.getScreenPoint,ed=x.startDragging,Tn=x.removeHTML,Cb=x.createElement,nr=x.segmentResolution,Fj=x.shapeResolution,ph=x.shapeSide,ri=x.def,Kn=function(Z,z,f){ri(D+"."+Z,z,f)},io=function(b,V){b.childNodes.forEach(function(a){V(a),io(a,V)})};Gh(x,{toolTipLabelColor:An,toolTipLabelFont:Bg,toolTipBackground:e.toolTipBackground,toolTipShadowColor:vd,drawBreakableText:ae,setDevicePixelRatio:function(z){Gl=x.devicePixelRatio="number"==typeof z?z:Q.devicePixelRatio,io(H.body,function(l){var b=l._ht;b&&b._canvas&&(ms(b._canvas,b.getWidth(),b.getHeight()),b.redraw?b.redraw():b.iv())})}},!0);var go=1e-6,Yo="undefined"!=typeof Uint16Array?Uint16Array:Array,_p="undefined"!=typeof Float32Array?Float32Array:Array,sm=function(r,b,T){var R=[r[0]-b[0],r[1]-b[1],r[2]-b[2]];if(T){var p=Og(R);p>0&&(R[0]/=p,R[1]/=p,R[2]/=p)}return R},tm=function(){var K="charCodeAt",v=2*(2*Sq.length+1);for(var H in Q)if(H===D+ce[0]+Af.length){var P=Q[H];if(!P)break;for(var O=P.length,k=0;O>k;k++)if(P[k][K](0)===v&&P[k+1]!=a&&P[k+1]===Af[0]&&P[k+2]!=a&&P[k+2][K](0)===v){for(var L=k+3;O>L;L++)if(P[L][K](0)===v){if(0==P[L+1])for(var E,w=L+2;O>w;w++){if(P[w][K](0)===v){0==P[w-1]&&E&&(z=E.substr(0,E.length-1));break}E==a?E=P[w]:E+=P[w]}break}break}break}return function(N){return[-N[0],-N[1],-N[2]]}}(),sg=function(c,j){return 3===c.length?c[0]*j[0]+c[1]*j[1]+c[2]*j[2]:c[0]*j[0]+c[1]*j[1]},Dc=function(){var r=new _p(16);return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},Jk=Dc(),of=function(P){var v=new _p(16);return v[0]=P[0],v[1]=P[1],v[2]=P[2],v[3]=P[3],v[4]=P[4],v[5]=P[5],v[6]=P[6],v[7]=P[7],v[8]=P[8],v[9]=P[9],v[10]=P[10],v[11]=P[11],v[12]=P[12],v[13]=P[13],v[14]=P[14],v[15]=P[15],v},fq=function(L,o){return L[0]=o[0],L[1]=o[1],L[2]=o[2],L[3]=o[3],L[4]=o[4],L[5]=o[5],L[6]=o[6],L[7]=o[7],L[8]=o[8],L[9]=o[9],L[10]=o[10],L[11]=o[11],L[12]=o[12],L[13]=o[13],L[14]=o[14],L[15]=o[15],L},Kh=function(s){return s[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,s},Hf=function(P,_){var g=P[0],v=P[1],u=P[2];return P[0]=_[0]*g+_[4]*v+_[8]*u+_[12],P[1]=_[1]*g+_[5]*v+_[9]*u+_[13],P[2]=_[2]*g+_[6]*v+_[10]*u+_[14],P},Uf=function(p,n){var z=p[0],K=p[1],d=p[2],Z=p[3];return p[0]=n[0]*z+n[4]*K+n[8]*d+n[12]*Z,p[1]=n[1]*z+n[5]*K+n[9]*d+n[13]*Z,p[2]=n[2]*z+n[6]*K+n[10]*d+n[14]*Z,p[3]=n[3]*z+n[7]*K+n[11]*d+n[15]*Z,p},Xg=function(){var u,k,W,K,P=Km(Ep[1]+Ep[7]),b=Km(Ep[0]+Ep[3]-Ep[10]),c=Km(Ep[8]+2),g=function(){return k=W.charAt(u),u+=1,k},s=function(){var R="";if(k===c)for(;g();){if(k===c)return g(),R;R+=k}else g()},L=function(){for(;k&&" ">=k;)g()},$=function(){var T,r={};if(k===P){if(g(),L(),k===b)return g(),r;for(;k;){if(T=s(),L(),g(),r[T]=K(),L(),k===b)return g(),r;g(),L()}}};return K=function(){switch(L(),k){case P:return $();default:return s()}},function(D){if(A={},D){var Q;if(W=D,u=0,k=" ",Q=K(),L(),!k)return Q}}}(),df=function(V,_){if(_){var n=M(_),S=b(_),q=V[4],B=V[5],Q=V[6],f=V[7],s=V[8],W=V[9],w=V[10],F=V[11];V[4]=q*S+s*n,V[5]=B*S+W*n,V[6]=Q*S+w*n,V[7]=f*S+F*n,V[8]=s*S-q*n,V[9]=W*S-B*n,V[10]=w*S-Q*n,V[11]=F*S-f*n}},ro=function(g,y){if(y){var G=M(y),t=b(y),E=g[0],C=g[1],s=g[2],f=g[3],F=g[8],z=g[9],P=g[10],B=g[11];g[0]=E*t-F*G,g[1]=C*t-z*G,g[2]=s*t-P*G,g[3]=f*t-B*G,g[8]=E*G+F*t,g[9]=C*G+z*t,g[10]=s*G+P*t,g[11]=f*G+B*t}},Kp=function(x,n){if(n){var N=M(n),B=b(n),F=x[0],m=x[1],g=x[2],R=x[3],D=x[4],W=x[5],o=x[6],z=x[7];x[0]=F*B+D*N,x[1]=m*B+W*N,x[2]=g*B+o*N,x[3]=R*B+z*N,x[4]=D*B-F*N,x[5]=W*B-m*N,x[6]=o*B-g*N,x[7]=z*B-R*N}},Sb=function(U,Q,J){return cb(a,J===!1?a:U.getFinalScale3d(),U.getFinalRotation3d(),U.getRotationMode(),U.p3(),a,Q)},cb=function(z,I,b,d,u,r,H){return r||(r=Dc()),u&&Yc(r,u),dd(r,b,d),H&&wc(r,r,H),I&&Xi(r,I),z&&wc(r,r,z),r},Qr=function(c,V,a){V=s(V),a=s(a);var l=this;l.g=c,l._84O=V,l._85O=a,l._70I=!0,l.F=0,l._83O=V+a,l.pen={x:0,y:0}},yi="lineDashOffset",_f="setLineDash",Oe=function(l){for(var $ in l)1===$.length&&(yi=l[$]);return $?1:0},lj=function(L,R,H){return Qp(R)?L:L[_f]?(L[_f](R),H&&(L.lineDashOffset=H),L):new Qr(L,R[0],R.length>1?R[1]:R[0])},so=function(N,M){!Qp(M)&&N[_f]&&(N[_f](Lb),N.lineDashOffset=0)};if(ri(Qr,n,{_69I:6,moveTo:function(p,M){var h=this,l=h.pen;l.x=p,l.y=M,h.g.moveTo(p,M),h.start||(h.start={x:p,y:M})},lineTo:function(i,E){var p=this,j=p.pen,R=i-j.x,H=E-j.y,C=J(H,R),l=b(C),_=M(C),T=p._23O(j.x,j.y,i,E),$=p._85O,d=p._84O,u=p._83O;if(p.F){if(p.F>T)return p._70I?p._72I(i,E):p.moveTo(i,E),p.F-=T,void 0;if(p._70I?p._72I(j.x+l*p.F,j.y+_*p.F):p.moveTo(j.x+l*p.F,j.y+_*p.F),T-=p.F,p.F=0,p._70I=!p._70I,!T)return}var N=P(T/u);if(N){for(var X=l*d,v=_*d,U=l*$,w=_*$,g=0;N>g;g++)p._70I?(p._72I(j.x+X,j.y+v),p.moveTo(j.x+U,j.y+w)):(p.moveTo(j.x+U,j.y+w),p._72I(j.x+X,j.y+v));T-=u*N}p._70I?T>d?(p._72I(j.x+l*d,j.y+_*d),p.moveTo(i,E),p.F=$-(T-d),p._70I=!1):(p._72I(i,E),T===d?(p.F=0,p._70I=!p._70I):(p.F=d-T,p.moveTo(i,E))):T>$?(p.moveTo(j.x+l*$,j.y+_*$),p._72I(i,E),p.F=d-(T-$),p._70I=!0):(p.moveTo(i,E),T===$?(p.F=0,p._70I=!p._70I):p.F=$-T)},quadraticCurveTo:function(Z,H,M,I){var i,n=this,X=n.pen,Y=X.x,u=X.y,d=n._22O(Y,u,Z,H,M,I),V=0,O=0,J=n._85O,R=n._84O;if(n.F){if(n.F>d)return n._70I?n._71I(Z,H,M,I):n.moveTo(M,I),n.F-=d,void 0;if(V=n.F/d,i=n._20O(Y,u,Z,H,M,I,V),n._70I?n._71I(i[2],i[3],i[4],i[5]):n.moveTo(i[4],i[5]),n.F=0,n._70I=!n._70I,!d)return}var B=d-d*V,c=P(B/n._83O),t=R/d,$=J/d;if(c)for(var N=0;c>N;N++)n._70I?(O=V+t,i=n._21O(Y,u,Z,H,M,I,V,O),n._71I(i[2],i[3],i[4],i[5]),V=O,O=V+$,i=n._21O(Y,u,Z,H,M,I,V,O),n.moveTo(i[4],i[5])):(O=V+$,i=n._21O(Y,u,Z,H,M,I,V,O),n.moveTo(i[4],i[5]),V=O,O=V+t,i=n._21O(Y,u,Z,H,M,I,V,O),n._71I(i[2],i[3],i[4],i[5])),V=O;B=d-d*V,n._70I?B>R?(O=V+t,i=n._21O(Y,u,Z,H,M,I,V,O),n._71I(i[2],i[3],i[4],i[5]),n.moveTo(M,I),n.F=J-(B-R),n._70I=!1):(i=n._19O(Y,u,Z,H,M,I,V),n._71I(i[2],i[3],i[4],i[5]),d===R?(n.F=0,n._70I=!n._70I):(n.F=R-B,n.moveTo(M,I))):B>J?(O=V+$,i=n._21O(Y,u,Z,H,M,I,V,O),n.moveTo(i[4],i[5]),i=n._19O(Y,u,Z,H,M,I,O),n._71I(i[2],i[3],i[4],i[5]),n.F=R-(B-J),n._70I=!0):(n.moveTo(M,I),B===J?(n.F=0,n._70I=!n._70I):n.F=J-B)},bezierCurveTo:function(){var t=arguments;this.pen={x:t[4],y:t[5]},this.g.bezierCurveTo(t[0],t[1],t[2],t[3],t[4],t[5])},arc:function(n,_,Q,N,I,H){H||(N=-N,I=-I),Ln(this,n,_,N,I-N,Q,Q,!1)},rect:function(E,i,v,$){var O=this;O.pen={x:E,y:i},O.moveTo(E,i),O.lineTo(E,i+$),O.lineTo(E+v,i+$),O.lineTo(E+v,i),O.lineTo(E,i)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(Z,w,V,I){var v=V-Z,x=I-w;return C(v*v+x*x)},_22O:function(I,J,C,U,f,l,O){for(var w,y,Z,S,M,X,m,H=0,W=I,A=J,n=O>0?O:this._69I,c=1;n>=c;c++)Z=c/n,S=1-Z,M=S*S,X=2*Z*S,m=Z*Z,w=M*I+X*C+m*f,y=M*J+X*U+m*l,H+=this._23O(W,A,w,y),W=w,A=y;return H},_21O:function(_,k,P,g,z,H,w,t){var S=this;if(0===w)return S._20O(_,k,P,g,z,H,t);if(1===t)return S._19O(_,k,P,g,z,H,w);var y=S._20O(_,k,P,g,z,H,t);return y.push(w/t),S._19O.apply(S,y)},_20O:function(p,H,w,N,Z,R,t){if(1!==t){var a=w+(Z-w)*t,m=N+(R-N)*t;w=p+(w-p)*t,N=H+(N-H)*t,Z=w+(a-w)*t,R=N+(m-N)*t}return[p,H,w,N,Z,R]},_19O:function(b,w,T,g,M,q,h){if(1!==h){var H=b+(T-b)*h,S=w+(g-w)*h;T+=(M-T)*h,g+=(q-g)*h,b=H+(T-H)*h,w=S+(g-S)*h}return[b,w,T,g,M,q]},_72I:function(E,u){var V=this.pen;(E!==V.x||u!==V.y)&&(V.x=E,V.y=u,this.g.lineTo(E,u))},_71I:function(i,g,B,V){var l=this.pen;(i!==B||g!==V||B!==l.x||V!==l.y)&&(l.x=B,l.y=V,this.g.quadraticCurveTo(i,g,B,V))}}),L&&Z){var yf=Z.toString();c=yf.indexOf(Gk.substr(0,2))>0&&yf.indexOf(Se+Se.substr(1,1))>1||yf.indexOf(Yn.substr(0,2)+Gk.substr(2,2)+ce[0]+Gk[4])>1?!0:!1}var fh=a,pr=a,yr=function(O){fh&&!O._72O&&(pr||(pr={}),pr[O._72O=Vd()]=O)},Rd=function(N,U){if(U||(U=N),U&&(fh||(fh={}),!fh[N])){var K=new wm;if(fh[U]={request:K,url:U},U=x.beforeLoadURL(U),U.data){var m=x.parse(U.data);Ug(N,m),x.handleCompTypeLoaded(N,m)}else{K.onload=function(T){if(200===this.status||0===this.status){var n=x.parse(T.target.response||T.target.responseText);Ug(N,n),x.handleCompTypeLoaded(N,n)}else Ug(N,a)},K.onerror=function(){Ug(N,a)};var r={};r.url=encodeURI(U),r.sync=!1,K.send(r)}}},Ug=function(j,P){if(qf[j]=P,delete fh[j],je(fh)&&(fh=a,pr)){for(var Z in pr){var r=pr[Z];r.invalidateAll&&r.invalidateAll(i,"compTypeLoaded",j),r.redraw&&r.redraw(),r.iv(),delete r._72O}pr=a}if(P&&pr)for(var Z in pr){var r=pr[Z];r.invalidateAll&&r.invalidateAll(i,"compTypeLoading",j),r.redraw&&r.redraw(),r.iv()}},Eb=e.chart,Io="",Vf=x.compStack=[],Up=/^style@/,Rc=/^attr@/,Op=/^field@/,tc={x:.5,y:.5},sr=function($,K,v,f){if(!$)return 0;if(Cs($.fitSize,K,v)&&f)return f;var l=Cs($.width,K,v);return null==l?20:l},Qo=function(g,p,R,K){if(!g)return 0;if(Cs(g.fitSize,p,R)&&K)return K;var A=Cs(g.height,p,R);return null==A?20:A},Cs=function(v,L,A){if(!v||!v.func)return v;var W,F=v.func,$=v.value;return W=nk(F)?A&&A.vectorDataBindingDisabled&&!v.isSafeFunc?$:F(L,A):L instanceof Ij?Rc.test(F)?L.a(Io+F.slice(5)):Up.test(F)?L.s(Io+F.slice(6)):Op.test(F)?L[F.slice(6)]:L[F]?L[F](A):$:$,$!==i&&W==a?$:W},jb=x.drawImage=function(){var R,U,v,l,W,Y,j=function(u,B){u.getValue&&u.getValue.compType===B||(u.getValue=function(S){var r=e(u,S);if(r===i&&B.properties){var I=B.properties[S];I&&(r=I.defaultValue)}return r},u.getColor=function(U){return c(u.getValue(U))},u.getValue.compType=B)},e=function(f,c,q){var d,X=!1;if(f.prefix&&U instanceof Ij){var e=U.a(Io+c);e!==i&&(X=!0,d=e)}return d===i&&(d=f[c]),d&&d.func&&(X=!0,d=Cs(d,U,v)),q&&(d=q(d),X||(f[c]=d)),d},c=function(X,E){var S;if(S=E?e(X,E):X,R&&R.compGray&&S)return x.toGrayColor(S);if(W&&S){if("override"===Y)return W;if("override_rgb"===Y){var _=gi(W);return S=Yl(S),"rgba("+P(255*_[0])+","+P(255*_[1])+","+P(255*_[2])+","+S[3]/255+")"}if("override_a"===Y){var _=gi(W);return S=Yl(S),"rgba("+S[0]+","+S[1]+","+S[2]+","+_[3]+")"}var _=gi(W);return S=Yl(S),"rgba("+P(S[0]*_[0])+","+P(S[1]*_[1])+","+P(S[2]*_[2])+","+S[3]/255*_[3]+")"}return S},V=function(k){if(mr(k)){for(var f=new kg,C=k.length,q=0;C>q;q+=2)f.add({x:k[q],y:k[q+1]});k=f}return k},O=function(h){var Z=e(h,"anchorX"),F=e(h,"anchorY");if(Z!==i||F!==i)return{x:Z===i?tc.x:Z,y:F===i?tc.y:F};var r=e(h,"type"),R=e(h,"name");if("image"!==r||!R)return tc;var U=Nl(R);return U&&U.anchorX!==i&&U.anchorY!==i?{x:U.anchorX,y:U.anchorY}:tc},s=function(S,T){var Y=e(S,is),p=O(S);if(mr(Y)){var D=Y.length,Z=e(S,"relative"),i=T.width,G=T.height;if(4===D)Y={x:Y[0],y:Y[1],width:Y[2],height:Y[3]},Z&&(Y.x*=i,Y.y*=G,Y.width*=i,Y.height*=G);else if(3===D){var F=Y[0];Y={width:Y[1],height:Y[2]},Z&&(Y.width*=i,Y.height*=G),"object"==typeof F?F.length&&(F={x:F[0],y:F[1]}):F=gc(F,T,Y),Y.x=F.x-Y.width*p.x,Y.y=F.y-Y.height*p.y}Y.x+=e(S,"offsetX")||0,Y.y+=e(S,"offsetY")||0,!Z&&T.fitSize&&(Y=n(S,Y,T))}return Y},n=function(H,Y,$){if(Y){var E,m,l,B={x:Y.x,y:Y.y,width:Y.width,height:Y.height},K=O(H),Q=e(H,"layoutH"),i=e(H,"layoutV"),w=1,s=1,P=0,T=0,r=1,j=1;switch(Q){case"left":break;case"right":B.x+=$.width-$.rw;break;case"center":B.x+=.5*($.width-$.rw);break;case"scale":case"leftright":default:E=e(H,Do)||0,E&&(P=Math.abs(T=Math.sin(E)),r=Math.abs(j=Math.cos(E))),"leftright"!==Q?(w+=r*($.widthScale-1),s+=P*($.widthScale-1)):(w+=B.width?r*($.width-$.rw)/B.width:0,s+=B.height?P*($.width-$.rw)/B.height:0,m=-Math.min(-K.x*j+K.y*T,-K.x*j-(1-K.y)*T,(1-K.x)*j+K.y*T,(1-K.x)*j-(1-K.y)*T))}switch(i){case"top":break;case"bottom":B.y+=$.height-$.rh;break;case"center":B.y+=.5*($.height-$.rh);break;case"scale":case"topbottom":default:E==a&&(E=e(H,Do),E&&(P=Math.abs(T=Math.sin(E)),r=Math.abs(j=Math.cos(E)))),"topbottom"!==i?(w+=P*($.heightScale-1),s+=r*($.heightScale-1)):(w+=B.width?P*($.height-$.rh)/B.width:0,s+=B.height?r*($.height-$.rh)/B.height:0,l=-Math.min(-K.x*T-K.y*j,-K.x*T+(1-K.y)*j,(1-K.x)*T-K.y*j,(1-K.x)*T+(1-K.y)*j))}return(1!==w||1!==s)&&("scale"!==Q&&Q?"leftright"===Q&&(B.x+=B.width*(1-w)*K.x+m*($.width-$.rw)):B.x+=B.x*($.widthScale-1)+K.x*B.width*($.widthScale-w),"scale"!==i&&i?"topbottom"===i&&(B.y+=B.height*(1-s)*K.y+l*($.height-$.rh)):B.y+=B.y*($.heightScale-1)+K.y*B.height*($.heightScale-s),B.width*=w,B.height*=s),B.width<0&&(B.width=0),B.height<0&&(B.height=0),B}},D=function($){return mr($)?new kg($):$},N=function(T,y,j,C,M,k,D){var o=R.interactiveInfo,B=T.transform;if(B)return R.save(),R.setTransform(B.a,B.b,B.c,B.d,B.tx,B.ty),o&&o.compInfos.push({comp:T,rect:y,matrix:B.clone()}),!0;M===i&&(M=1),k===i&&(k=1);var m=e(T,"clipPercentage"),f=$l(j,y);if(f&&!C&&1===M&&1===k&&!(1>m))return o&&o.compInfos.push({comp:T,rect:y,matrix:o.matrix.clone()}),!1;D=D||tc;var F=y.x+y.width*D.x,b=y.y+y.height*D.y,v=j.x+j.width*D.x,q=j.y+j.height*D.y,r=j.width?M*(y.width/j.width):1,$=j.height?k*(y.height/j.height):1;if(R.save(),o&&(o.matrix.appendTranslate(F,b).appendRotate(C).appendScale(r,$).appendTranslate(-v,-q),o.compInfos.push({comp:T,rect:y,matrix:o.matrix.clone()})),$b(R,F,b),Hr(R,C||0),Yj(R,r,$),$b(R,-v,-q),1>m){0>m&&(m=0);var Z=Vr(j,e(T,"clipDirection"),m);R.beginPath(),R.rect(Z.x,Z.y,Z.width,Z.height),R.clip()}return!0},H=function(){R.restore()},S=function(u,X,Z){var $=e(u,"path"),y=e(u,Do),T=e(u,"scaleX"),r=e(u,"scaleY"),F=O(u),v=a,W=zn(null,$);if(Z||(Z=u.unionRect,Z||(Z=sq(W),u.path.func||(u.unionRect=Z)),v=Z),Z){v||(v=u.unionRect,v||(v=sq(W),u.path.func||(u.unionRect=v)));var i=N(u,Z,v,y,T,r,F),x=e(u,"borderPattern"),z=lj(R,x),n=c(u,"background"),K=c(u,"borderColor"),C=e(u,"borderWidth"),G=e(u,"gradient"),U=c(u,"gradientColor"),B=e(u,"border3d"),I=e(u,"border3dColor"),t=e(u,"border3dAccuracy"),P=R.lineJoin,E=R.lineCap;if(R.lineJoin=e(u,"borderJoin")||og,R.lineCap=e(u,"borderCap")||hf,n?(Fo(R,n,G,U,v),zn(R,$),R.fill(),z!==R&&zn(R,$)):zn(R,$),C&&K){var b=e(u,"borderWidthAbsolute");b&&(R.save(),R.setTransform(1,0,0,1,0,0)),R.lineWidth=C,R.strokeStyle=K,R.stroke(),b&&R.restore(),B&&Kc(R,K,I,C,l,t)}if(so(R,x),e(u,"dash")){var k=e(u,"dashWidth")||C;if(k>0){x=e(u,"dashPattern")||Vg;var z=lj(R,x,e(u,"dashOffset")),M=c(u,"dashColor")||c(xc);z!==R&&zn(R,$),R.strokeStyle=M,R.lineWidth=k,R.stroke(),e(u,"dash3d")&&Kc(R,M,c(u,"dash3dColor"),k,l,e(u,"dash3dAccuracy")),so(R,x)}}X===is&&ao(R,n,e(u,"depth"),v),R.lineJoin=P,R.lineCap=E,i&&H()}},m=function(o,$,t,k){var p=e(o,Yk,V),_=e(o,Do),I=O(o);if(p&&k.fitSize){var m=new kg,s=sq(p),f=n(o,s,k),M=s.x+I.x*s.width,S=s.y+I.y*s.height,C=f.x+I.x*f.width,E=f.y+I.y*f.height,h=s.width?f.width/s.width:1,q=s.height?f.height/s.height:1;p.each(function(H){m.add({x:C+(H.x-M)*h,y:E+(H.y-S)*q})}),p=m,o.unionRect=null}var X=e(o,"scaleX"),P=e(o,"scaleY"),G=$===vp,j=a;if(!t&&G&&(t=o.unionRect,t||(t=sq(p),o.points.func||(o.unionRect=t)),j=t),t){G?j||(j=o.unionRect,j||(j=sq(p),o.points.func||(o.unionRect=j))):j=t;var u,g,b,x,z=N(o,t,j,_,X,P,I),F=e(o,"borderPattern"),i=lj(R,F),B=c(o,"background"),T=Nl(e(o,"repeatImage"),W,Y),J=e(o,"gradientPack"),L=c(o,"borderColor"),r=e(o,"borderWidth"),y=e(o,"segments",D),K=e(o,"gradient"),A=c(o,"gradientColor"),w=e(o,"border3d"),Q=e(o,"border3dColor"),Z=e(o,"border3dAccuracy"),d=e(o,"closePath"),Td=e(o,"fillRule")||"nonzero",Rd=R.lineJoin,wf=R.lineCap;if(R.lineJoin=e(o,"borderJoin")||og,R.lineCap=e(o,"borderCap")||hf,G)if(B||T||J){var gj=e(o,"fillClipPercentage");if(1>gj){0>gj&&(gj=0);var Dg=Vr(j,e(o,"fillClipDirection"),gj);R.save(),R.beginPath(),R.rect(Dg.x,Dg.y,Dg.width,Dg.height),R.clip()}if(Nr(R,p,y,d),J)Bb(R,J);else if(T){var Mh=R,cs=W,jo=Y;hh(R,T,W,Y,U,v),R=Mh,W=cs,Y=jo}else{var Mh=R;Fo(R,B,K,A,j),R=Mh}R.fill(Td),1>gj&&R.restore(),J&&R.restore(),i!==R&&Nr(i,p,y,d)}else Nr(i,p,y,d);else if("roundRect"===$?u=e(o,"cornerRadius"):"polygon"===$?u=e(o,"polygonSide"):"arc"===$&&(u=e(o,"arcFrom"),g=e(o,"arcTo"),b=e(o,"arcClose"),x=e(o,"arcOval")),B||T||J){var gj=e(o,"fillClipPercentage");if(1>gj){0>gj&&(gj=0);var Dg=Vr(j,e(o,"fillClipDirection"),gj);R.save(),R.beginPath(),R.rect(Dg.x,Dg.y,Dg.width,Dg.height),R.clip()}if(km(R,$,j,u,g,b,x),J)Bb(R,J);else if(T){var Mh=R,cs=W,jo=Y;hh(R,T,W,Y,U,v),R=Mh,W=cs,Y=jo}else Fo(R,B,K,A,j);R.fill(Td),1>gj&&R.restore(),J&&R.restore(),R!==i&&km(i,$,j,u,g,b,x)}else km(i,$,j,u,g,b,x);if(r&&L){var Rc=e(o,"borderWidthAbsolute");Rc&&(R.save(),R.setTransform(1,0,0,1,0,0)),R.lineWidth=r,R.strokeStyle=L,R.stroke(),Rc&&R.restore(),w&&Kc(R,L,Q,r,l,Z)}if(so(R,F),e(o,"dash")){var Io=e(o,"dashWidth")||r;if(Io>0){F=e(o,"dashPattern")||Vg;var i=lj(R,F,e(o,"dashOffset")),Xq=c(o,"dashColor")||c(xc);i!==R&&(G?Nr(i,p,y,d):km(i,$,j,u,g,b,x)),R.strokeStyle=Xq,R.lineWidth=Io,R.stroke(),e(o,"dash3d")&&Kc(R,Xq,c(o,"dash3dColor"),Io,l,e(o,"dash3dAccuracy")),so(R,F)}}$===is&&ao(R,B,e(o,"depth"),j),R.lineJoin=Rd,R.lineCap=wf,z&&H()}},L=function(M,j){var A=W,s=Y,V=W||e(M,dr),m=Y||e(M,"blendMode"),r=Nl(e(M,"name"),V,m);r&&(hc(R,r,e(M,"stretch"),j.x,j.y,j.width,j.height,U,v,V,null,m),W=A,Y=s)},T=function(I,q){var y=e(I,"text");y!=a&&sp(R,y,e(I,"font"),c(I,dr),q.x,q.y,q.width,q.height,e(I,"align"),e(I,"vAlign"))},I=function(D,h){yb(R,c(D,dr),h.x,h.y,h.width,h.height,e(D,"width"))},k=function(G,n){var F=e(G,Jl),f=0;if(F&&(F.forEach(function(d){f+=d}),f>0)){for(var l=e(G,"colors")||Eb,Q=e(G,"startAngle")||0,v=e(G,"hollow"),N=e(G,Bn),q=e(G,Jn),h=e(G,Bd),A=N?new kg:a,E=n.x,o=n.y,O=n.width,g=n.height,c=E+O/2,J=o+g/2,u=t(O,g)/2,d=0,Y=0;Y<F.length;Y++){var y=F[Y],i=$*y/f,T=Q+i;if(R.fillStyle=l[d++],d===l.length&&(d=0),R.beginPath(),v){var P=c+b(Q)*u/2,x=J+M(Q)*u/2,B=c+b(T)*u,C=J+M(T)*u;R.moveTo(P,x),R.arc(c,J,u/2,Q,T,!1),R.lineTo(B,C),R.arc(c,J,u,T,Q,!0)}else R.moveTo(c,J),R.arc(c,J,u,T,Q,!0);A&&(i=(Q+T)/2,A.add({text:nk(N)?N(y,Y,f,U):y,x:c+.75*b(i)*u,y:J+.75*M(i)*u})),R.closePath(),R.fill(),Q=T}A&&A.each(function(d){sp(R,d.text,q,h,d.x,d.y,0,0,$i)})}},d=function(F,B){var O=e(F,Xh);if(O&&O.length>0){var T=O.length,h=e(F,Bn),p=e(F,Jn),X=e(F,Bd),A=h?new kg:a,E=e(F,"minValue")||0,P=e(F,"maxValue");if(P==a&&(P=0,O.forEach(function(Y){e(Y,Jl).forEach(function(K){P=w(P,K)})})),E===P)return;for(var W=B.height/(P-E),H=B.y+P*W,d=e(O[0],Jl).length,u=B.width/(3*d+1),n=2*u/T,m=0,o=0;T>o;o++)for(var Z=O[o],$=e(Z,dr),t=e(Z,"colors"),y=e(Z,Jl),l=0;d>l;l++){t?R.fillStyle=t[l]:$?R.fillStyle=$:(R.fillStyle=Eb[m++],m===Eb.length&&(m=0));var c=y[l],V=c*W,x=B.x+(1+3*l)*u+o*n;if(vm(R,x,H-V,n,V),A){var M=nk(h)?h(c,l,Z,U):c,r=Lm(p,M).height;A.add({x:x,y:H-V-r,width:n,height:r,text:M})}}A&&A.each(function(J){sp(R,J.text,p,X,J.x,J.y,J.width,J.height,$i)})}},G=function(p,l){var $=e(p,Xh);if($&&$.length>0){var L=$.length,K=e($[0],Jl).length,V=l.width/(3*K+1),b=0,Y=e(p,"maxValue"),q=e(p,Bn),f=e(p,Jn),H=e(p,Bd),h=q?new kg:a;if(Y==a){Y=0;for(var A=0;K>A;A++){for(var n=0,r=0;L>r;r++)n+=e($[r],Jl)[A];Y=w(Y,n)}}if(Y>0){for(var A=0;K>A;A++)for(var W=l.y+l.height,r=0;L>r;r++){var i=$[r],C=e(i,dr),M=e(i,Jl)[A],O=M/Y*l.height;C?R.fillStyle=C:(R.fillStyle=Eb[b++],b===Eb.length&&(b=0)),W-=O;var F={x:l.x+(1+3*A)*V,y:W,width:2*V,height:O};vm(R,F.x,F.y,F.width,F.height),h&&(F.text=nk(q)?q(M,A,i,U):M,h.add(F))}h&&h.each(function(D){sp(R,D.text,f,H,D.x,D.y,D.width,D.height,$i)})}}},f=function(i,C){var z=e(i,Xh);if(z&&z.length>0){for(var K=z.length,N=e(z[0],Jl).length,$=C.width/(3*N+1),B=0,l=e(i,Bn),P=e(i,Jn),x=e(i,Bd),j=l?new kg:a,g=0;N>g;g++){for(var h=0,X=0;K>X;X++)h+=e(z[X],Jl)[g];if(h>0){var T=C.y+C.height;for(X=0;K>X;X++){var Q=z[X],f=e(Q,dr),v=e(Q,Jl)[g],G=v/h*C.height;f?R.fillStyle=f:(R.fillStyle=Eb[B++],B===Eb.length&&(B=0)),T-=G;var u={x:C.x+(1+3*g)*$,y:T,width:2*$,height:G};vm(R,u.x,u.y,u.width,u.height),j&&(u.text=nk(l)?l(v,g,Q,U):v,j.add(u))}}}j&&j.each(function(p){sp(R,p.text,P,x,p.x,p.y,p.width,p.height,$i)})}},o=function(K,A){var n=e(K,Xh);if(n&&n.length>0){var h=n.length,W=e(K,"minValue")||0,N=e(K,"maxValue");if(N==a&&(N=0,n.forEach(function(A){e(A,Jl).forEach(function(m){N=w(N,m)})})),W===N)return;for(var M=A.height/(N-W),V=A.y+N*M,J=e(n[0],Jl).length,I=A.width/(3*J+1),r=0,f=e(K,"lineWidth")||2,L=e(K,"line3d"),d=e(K,"linePoint"),H=e(K,Bn),D=e(K,Jn),b=e(K,Bd),c=0;h>c;c++){var E=n[c],Y=e(E,dr),Q=e(E,Jl);Y?R.strokeStyle=Y:(Y=R.strokeStyle=Eb[r++],r===Eb.length&&(r=0)),R.beginPath();for(var t=0;J>t;t++){var v=A.x+(2+3*t)*I,g=V-Q[t]*M;0===t?R.moveTo(v,g):R.lineTo(v,g)}if(R.lineWidth=f,R.stroke(),L&&Kc(R,Y,a,f,l),d||H){var y,o=f/2+2;for(t=0;J>t;t++){var x=Q[t];if(v=A.x+(2+3*t)*I,g=V-x*M,nk(d)?d(R,v,g,Y,t,E,U):d&&(R.fillStyle=Y,R.beginPath(),R.arc(v,g,o,0,$,!0),R.fill()),nk(H)?y=H(x,t,E,U):H&&(y=x),y){var P=Lm(D,y).height,Z=R.shadowBlur;if(Z){var m=R.shadowOffsetX,j=R.shadowOffsetY,z=R.shadowColor;R.shadowOffsetX=0,R.shadowOffsetY=0,R.shadowBlur=0,R.shadowColor=a}sp(R,y,D,b,v,g-P-o+2,0,P,$i),Z&&(R.shadowOffsetX=m,R.shadowOffsetY=j,R.shadowBlur=Z,R.shadowColor=z)}}}}}},F=function(){R=null,U=null,v=null},B={border:I,image:L,text:T,pieChart:k,columnChart:d,stackedColumnChart:G,percentageColumnChart:f,lineChart:o};return function($,n,Z,I,f,M,C,G,h,w){if(n&&f&&M){var t=R?!1:!0;R=$,U=C,v=G,l=v?v._zoom?v._zoom:1:1,W=h,Y=w;var E=f,K=M;if(Qc()){var u,A,T;0===R[cn]?Qc[0]&&(u=!0):u=!0,R.texureImage2D?Qc[1]&&(A=!0):A=!0,R.texureImage3D?Qc[2]&&(T=!0):T=!0,u&&A&&T&&(E=Z,K=I)}if(n.tagName)return Tp(z)&&!Q[z]||R.drawImage(n,E,K,f,M),t&&F(),void 0;if(e(n,"visible")===!1)return t&&F(),void 0;W||(W=Cs(n.color,U,v)),w||(Y=Cs(n.blendMode,U,v)),Tp(z)&&!Q[z]&&(f=E,M=K);var L=sr(n,U,v,f),q=Qo(n,U,v,M),k={x:0,y:0,width:L,height:q,fitSize:e(n,"fitSize")},y=e(n,"clip"),p=e(n,"opacity");if(k.fitSize){var o=k.rw=Cs(n.width,U,v)||20;k.widthScale=L/o;var X=k.rh=Cs(n.height,U,v)||20;k.heightScale=q/X}if(R.save(),R.interactiveInfo){var J=R.interactiveInfo.matrix,b=J.clone();J.appendTranslate(E,K).appendScale(f/L,M/q)}$b(R,E,K),(L!==f||q!==M)&&R.scale(f/L,M/q),y&&(nk(y)?y(R,L,q,U,v,n):(R.beginPath(),R.rect(0,0,L,q),R.clip())),p!=a&&(R.globalAlpha*=p),e(n,"comps").forEach(function(T){if(e(T,ic)!==!1){if(Vf.splice(0,0,T),T.prefix){var r=Io,Z=Cs(T.prefix,U,v);Z&&(Io=Io+Z+".")}if(R.interactiveInfo)var A=R.interactiveInfo.matrix.clone();var n=e(T,"opacity"),$=e(T,"shadow"),J=e(T,"type"),G=s(T,k);if(n!=a){var Y=R.globalAlpha;R.globalAlpha*=n}if($){var y=R.shadowOffsetX,d=R.shadowOffsetY,p=R.shadowBlur,b=R.shadowColor,q=e(T,"shadowOffsetX"),f=e(T,"shadowOffsetY"),P=e(T,"shadowBlur"),W=c(T,"shadowColor");R.shadowOffsetX=(q==a?3:q)*l,R.shadowOffsetY=(f==a?3:f)*l,R.shadowBlur=(P==a?6:P)*l,R.shadowColor=W||c(wp)}if("save"===J)R.save();else if("endClip"===J||"restore"===J)R.restore();else if("clip"===J)R.save(),Nr(R,e(T,"points",V),e(T,"segments",D),!0),R.clip();else if(hd[J])G=G||{x:0,y:0,width:k.width,height:k.height},m(T,J,G,k);else if(J===vp)m(T,J,G,k);else if("SVGPath"===J)S(T,J,G);else{G=G||{x:0,y:0,width:k.width,height:k.height};var z=e(T,Do),h=e(T,"scaleX"),K=e(T,"scaleY"),Q=O(T),u=N(T,G,G,z,h,K,Q);if(nk(J))j(T,J),x.drawCompType(J,R,G,T,U,v);else if(x.getCompType(J)){var t=x.getCompType(J),X=t.func||t;j(T,t),x.drawCompType(X,R,G,T,U,v)}else B[J]?B[J](T,G):x.getCompType(J)===i&&Yb.test(J)&&Rd(J);u&&H()}$&&(R.shadowOffsetX=y,R.shadowOffsetY=d,R.shadowBlur=p,R.shadowColor=b),n!=a&&(R.globalAlpha=Y),R.interactiveInfo&&(R.interactiveInfo.matrix=A),T.prefix&&(Io=r),Vf.splice(0,1)
}}),R.interactiveInfo&&(R.interactiveInfo.matrix=b),R.restore(),t&&F()}}}();x.getCurrentComp=function(){return Vf[0]},x.getParentComp=function(){return Vf[1]},x.getInternal=function(){return{isEnter:Jc,isEsc:Te,isSpace:oj,isLeft:Mb,isUp:ee,isRight:xr,isDown:Rf,addMethod:Gh,superCall:fm,toPointsArray:vl,translateAndScale:or,appendArray:On,createWorldMatrix:cb,vec3TransformMat4:Hf,setCanvas:ms,createDiv:we,createView:Qm,createCanvas:xp,createImage:Wo,initContext:wo,layout:dp,fillRect:vm,Mat:$r,drawBorder:yb,isString:Tp,setBorder:Gq,getPropertyValue:Bm,setPropertyValue:rr,drawVerticalLine:vc,draw3DRect:ao,getPinchDist:Mg,isSameRect:$l,getPosition:gc,intersectionLineRect:Ed,getNodeRect:Tl,getEdgeAgentPosition:Ci,getImageWidth:sr,getImageHeight:Qo,initItemElement:Zd,drawPoints:Nr,createG2:lj,closePopup:vf,isH:Ik,createAnim:ve,createNormalMatrix:Fe,createNormals:Pc,toFloatArray:Jb,glMV:Oo,batchShape:jr,createNodeMatrix:Sb,getFaceInfo:us,transformAppend:Rm,drawFaceInfo:Hc,to3dPointsArray:un,setGLDebugMode:function(M){Lp=M},cube:function(){return{vs:Dd,is:Ll,uv:Ak}},ui:function(){return{DataUI:Pf,NodeUI:Gi,EdgeUI:gl,GroupUI:wd,ShapeUI:Sj,GridUI:fn,Data3dUI:lh,Node3dUI:Un,Shape3dUI:qr}},getInternalVersion:function(){return"U2FsdGVkX18K4ozzk3UYGZ96RbPPmZoadDd2NsZKdmI="},getDragger:function(){return ye},addMSMap:function(s){Gh(sl,s)},k:h}},function(Q){function q(n,p){n!=a&&(p==a&&kd!=typeof n?this._54O(n,256):this._54O(n,p))}function Y(){return new q(a)}function _(U,F,a,t,Y,A){for(;--A>=0;){var E=F*this[U++]+a[t]+Y;Y=P(E/67108864),a[t++]=67108863&E}return Y}function z(K,k,g,y,u,A){for(var w=32767&k,o=k>>15;--A>=0;){var f=32767&this[K],x=this[K++]>>15,T=o*f+x*w;f=w*f+((32767&T)<<15)+g[y]+(1073741823&u),u=(f>>>30)+(T>>>15)+o*x+(u>>>30),g[y++]=1073741823&f}return u}function R(b,m,n,U,f,Z){for(var q=16383&m,$=m>>14;--Z>=0;){var H=16383&this[b],C=this[b++]>>14,M=$*H+C*q;H=q*H+((16383&M)<<14)+n[U]+f,f=(H>>28)+(M>>14)+$*C,n[U++]=268435455&H}return f}function e(r){return Uf.charAt(r)}function p(t,b){var p=up[t.charCodeAt(b)];return p==a?-1:p}function I(H){for(var l=this.t-1;l>=0;--l)H[l]=this[l];H.t=this.t,H.s=this.s}function k(T){this.t=1,this.s=0>T?-1:0,T>0?this[0]=T:-1>T?this[0]=T+this.DV:this.t=0}function u(k){var m=Y();return m._58O(k),m}function N(P,r){var u,e=this;if(16==r)u=4;else if(8==r)u=3;else if(256==r)u=8;else if(2==r)u=1;else if(32==r)u=5;else{if(4!=r)return e.fromRadix(P,r),void 0;u=2}e.t=0,e.s=0;for(var W=P.length,C=!1,Z=0;--W>=0;){var s=8==u?255&P[W]:p(P,W);0>s?"-"==P.charAt(W)&&(C=!0):(C=!1,0==Z?e[e.t++]=s:Z+u>e.DB?(e[e.t-1]|=(s&(1<<e.DB-Z)-1)<<Z,e[e.t++]=s>>e.DB-Z):e[e.t-1]|=s<<Z,Z+=u,Z>=e.DB&&(Z-=e.DB))}8==u&&0!=(128&P[0])&&(e.s=-1,Z>0&&(e[e.t-1]|=(1<<e.DB-Z)-1<<Z)),e._57O(),C&&q.ZERO._78O(e,e)}function g(){for(var b=this,n=b.s&b.DM;b.t>0&&b[b.t-1]==n;)--b.t}function x(f){var n=this;if(n.s<0)return"-"+n._85O()[ts](f);var q;if(16==f)q=4;else if(8==f)q=3;else if(2==f)q=1;else if(32==f)q=5;else{if(4!=f)return n.toRadix(f);q=2}var y,l=(1<<q)-1,b=!1,O="",I=n.t,T=n.DB-I*n.DB%q;if(I-->0)for(T<n.DB&&(y=n[I]>>T)>0&&(b=!0,O=e(y));I>=0;)q>T?(y=(n[I]&(1<<T)-1)<<q-T,y|=n[--I]>>(T+=n.DB-q)):(y=n[I]>>(T-=q)&l,0>=T&&(T+=n.DB,--I)),y>0&&(b=!0),b&&(O+=e(y));return b?O:"0"}function f(){var L=Y();return q.ZERO._78O(this,L),L}function y(){return this.s<0?this._85O():this}function U(j){var O=this,o=O.s-j.s;if(0!=o)return o;var G=O.t;if(o=G-j.t,0!=o)return O.s<0?-o:o;for(;--G>=0;)if(0!=(o=O[G]-j[G]))return o;return 0}function v(k){var v,a=1;return 0!=(v=k>>>16)&&(k=v,a+=16),0!=(v=k>>8)&&(k=v,a+=8),0!=(v=k>>4)&&(k=v,a+=4),0!=(v=k>>2)&&(k=v,a+=2),0!=(v=k>>1)&&(k=v,a+=1),a}function W(){var g=this;return g.t<=0?0:g.DB*(g.t-1)+v(g[g.t-1]^g.s&g.DM)}function K(G,I){var E;for(E=this.t-1;E>=0;--E)I[E+G]=this[E];for(E=G-1;E>=0;--E)I[E]=0;I.t=this.t+G,I.s=this.s}function V(K,J){for(var j=K;j<this.t;++j)J[j-K]=this[j];J.t=w(this.t-K,0),J.s=this.s}function A(n,I){var U,f=this,v=n%f.DB,e=f.DB-v,k=(1<<e)-1,$=P(n/f.DB),D=f.s<<v&f.DM;for(U=f.t-1;U>=0;--U)I[U+$+1]=f[U]>>e|D,D=(f[U]&k)<<v;for(U=$-1;U>=0;--U)I[U]=0;I[$]=D,I.t=f.t+$+1,I.s=f.s,I._57O()}function S(G,w){var Y=this;w.s=Y.s;var D=P(G/Y.DB);if(D>=Y.t)return w.t=0,void 0;var t=G%Y.DB,r=Y.DB-t,e=(1<<t)-1;w[0]=Y[D]>>t;for(var S=D+1;S<Y.t;++S)w[S-D-1]|=(Y[S]&e)<<r,w[S-D]=Y[S]>>t;t>0&&(w[Y.t-D-1]|=(Y.s&e)<<r),w.t=Y.t-D,w._57O()}function H(e,w){for(var V=this,S=0,j=0,I=t(e.t,V.t);I>S;)j+=V[S]-e[S],w[S++]=j&V.DM,j>>=V.DB;if(e.t<V.t){for(j-=e.s;S<V.t;)j+=V[S],w[S++]=j&V.DM,j>>=V.DB;j+=V.s}else{for(j+=V.s;S<e.t;)j-=e[S],w[S++]=j&V.DM,j>>=V.DB;j-=e.s}w.s=0>j?-1:0,-1>j?w[S++]=V.DV+j:j>0&&(w[S++]=j),w.t=S,w._57O()}function L(c,d){var o=this.abs(),E=c.abs(),Z=o.t;for(d.t=Z+E.t;--Z>=0;)d[Z]=0;for(Z=0;Z<E.t;++Z)d[Z+o.t]=o.am(0,E[Z],d,Z,0,o.t);d.s=0,d._57O(),this.s!=c.s&&q.ZERO._78O(d,d)}function J(b){for(var s=this.abs(),T=b.t=2*s.t;--T>=0;)b[T]=0;for(T=0;T<s.t-1;++T){var X=s.am(T,s[T],b,2*T,0,1);(b[T+s.t]+=s.am(T+1,2*s[T],b,2*T+1,X,s.t-T-1))>=s.DV&&(b[T+s.t]-=s.DV,b[T+s.t+1]=1)}b.t>0&&(b[b.t-1]+=s.am(T,s[T],b,2*T,0,1)),b.s=0,b._57O()}function i(D,$,A){var H=D.abs(),z=this;if(!(H.t<=0)){var p=z.abs();if(p.t<H.t)return $!=a&&$._58O(0),A!=a&&z._77O(A),void 0;A==a&&(A=Y());var B=Y(),l=z.s,g=D.s,w=z.DB-v(H[H.t-1]);w>0?(H._44O(w,B),p._44O(w,A)):(H._77O(B),p._77O(A));var L=B.t,G=B[L-1];if(0!=G){var R=G*(1<<z.F1)+(L>1?B[L-2]>>z.F2:0),U=z.FV/R,u=(1<<z.F1)/R,F=1<<z.F2,T=A.t,M=T-L,j=$==a?Y():$;for(B._59O(M,j),A._52O(j)>=0&&(A[A.t++]=1,A._78O(j,A)),q.ONE._59O(L,j),j._78O(B,B);B.t<L;)B[B.t++]=0;for(;--M>=0;){var E=A[--T]==G?z.DM:P(A[T]*U+(A[T-1]+F)*u);if((A[T]+=B.am(0,E,A,M,0,L))<E)for(B._59O(M,j),A._78O(j,A);A[T]<--E;)A._78O(j,A)}$!=a&&(A._45O(L,$),l!=g&&q.ZERO._78O($,$)),A.t=L,A._57O(),w>0&&A._46O(w,A),0>l&&q.ZERO._78O(A,A)}}}function n(o){var S=Y();return this.abs()._49O(o,a,S),this.s<0&&S._52O(q.ZERO)>0&&o._78O(S,S),S}function o(f){this.m=f}function T(r){return r.s<0||r._52O(this.m)>=0?r.mod(this.m):r}function c(B){return B}function j(j){j._49O(this.m,a,j)}function Z(g,_,n){g._47O(_,n),this._74O(n)}function d(M,J){M._48O(J),this._74O(J)}function r(){if(this.t<1)return 0;var b=this[0];if(0==(1&b))return 0;var u=3&b;return u=15&u*(2-(15&b)*u),u=255&u*(2-(255&b)*u),u=65535&u*(2-(65535&(65535&b)*u)),u=u*(2-b*u%this.DV)%this.DV,u>0?this.DV-u:-u}function G(J){var e=this;e.m=J,e.mp=J._50O(),e.mpl=32767&e.mp,e.mph=e.mp>>15,e.um=(1<<J.DB-15)-1,e.mt2=2*J.t}function O(I){var U=Y();return I.abs()._59O(this.m.t,U),U._49O(this.m,a,U),I.s<0&&U._52O(q.ZERO)>0&&this.m._78O(U,U),U}function B(n){var R=Y();return n._77O(R),this._74O(R),R}function E(V){for(var s=this;V.t<=s.mt2;)V[V.t++]=0;for(var _=0;_<s.m.t;++_){var n=32767&V[_],T=n*s.mpl+((n*s.mph+(V[_]>>15)*s.mpl&s.um)<<15)&V.DM;for(n=_+s.m.t,V[n]+=s.m.am(0,T,V,_,0,s.m.t);V[n]>=V.DV;)V[n]-=V.DV,V[++n]++}V._57O(),V._45O(s.m.t,V),V._52O(s.m)>=0&&V._78O(s.m,V)}function lb(O,Y){O._48O(Y),this._74O(Y)}function po(d,Z,C){d._47O(Z,C),this._74O(C)}function hh(){return 0==(this.t>0?1&this[0]:this.s)}function Nk(b,W){if(b>4294967295||1>b)return q.ONE;var m=Y(),T=Y(),c=W._73O(this),U=v(b)-1;for(c._77O(m);--U>=0;)if(W._76O(m,T),(b&1<<U)>0)W._75O(T,c,m);else{var C=m;m=T,T=C}return W.revert(m)}function yj(N,K){var c;return c=256>N||K._51O()?new o(K):new G(K),this.exp(N,c)}function Qb(){var j=this;if(j.s<0){if(1==j.t)return j[0]-j.DV;if(0==j.t)return-1}else{if(1==j.t)return j[0];if(0==j.t)return 0}return(j[1]&(1<<32-j.DB)-1)<<j.DB|j[0]}function pn(z,w){return new q(z,w)}function Ln(){var i=this;i.n=a,i.e=0,i.d=a,i.p=a,i.q=a,i.dmp1=a,i.dmq1=a,i._10A=a}function Ll(E){return E._53O(this.e,this.n)}function Xb(U){var Z,z,q,c="",X=0;for(Z=0;Z<U.length&&U.charAt(Z)!=Rf;++Z)q=Nd.indexOf(U.charAt(Z)),0>q||(0==X?(c+=e(q>>2),z=3&q,X=1):1==X?(c+=e(z<<2|q>>4),z=15&q,X=2):2==X?(c+=e(z),c+=e(q>>2),z=3&q,X=3):(c+=e(z<<2|q>>4),c+=e(15&q),X=0));return 1==X&&(c+=e(z<<2)),c}function _g(R){var j=R.split(""),o=Xb(R);return j.forEach(function(A){var W=A.length;W>0&&o&&(Mf+=s(A))}),o}function fm(a,j){var N=Ch._4O.Util._56O(a,"ss"),q={},d=0;return q.v=N==j,q.t=1,q.s=0>d?-1:0,Bf=q.v,d>0?q[0]=d:-1>d?q[0]=d+q.DV:q.t=0,[N,q]}function Cg(v){var _=38,s=v.substring(0,_);if(s&&30==s.indexOf("05000420")){var B=["ss",v.substring(_)];return B}return[]}function Sk(l,O){O=O.replace(cb,""),O=O.replace(/[ \n]+/g,"");var v=pn(O,16);if(v._55O()>this.n._55O())return 0;var w=this._37O(v),Y=w[ts](16).replace(/^1f+00/,""),N=Cg(Y);if(0==N.length)return!1;for(var S,q,r,o=.5,I=ph,e=[0,.5,.75,.875,.9375],T=[],p=[],D=[],H=$/I,C=N[1],s=fm(l,C)[0],K=0,h=0;K<e.length;K++){var Z=0===K%2?0:.5;for(S=0;I>=S;S++)q=(S+Z)*H,r=1-e[K],T.push(b(q)*o*r,-o+2*e[K]*o,-M(q)*o*r),p.push((S+Z)/I,r)}for(K=0;K<e.length-1;K++){var G=K*(I+1),J=(K+1)*(I+1);for(S=0;I>S;S++)D.push(G+S,J+S+1,J+S,G+S,G+S+1,J+S+1)}return D.forEach(function(k){h+=k}),C==s&&h>10}var Ce,dn=0xdeadbeefcafe,sj=15715070==(16777215&dn),ts="toString",Jq="",ab="nat",nn=function(){};l=Q["D"+11182[ts](m(2,5))];var Uj=q.prototype;Ph+=Nn.substr(0,1);var $k=Q.navigator?Q.navigator.appName:"";sj&&"Microsoft Internet Explorer"==$k?(Uj.am=z,Ce=30):sj&&"Netscape"!=$k?(Uj.am=_,Ce=26):(Uj.am=R,Ce=28),Uj.DB=Ce,Uj.DM=(1<<Ce)-1,Uj.DV=1<<Ce;var uc=52;Uj.FV=m(2,uc),Uj.F1=uc-Ce,Uj.F2=2*Ce-uc;var _n,Jg,Uf="0123456789abcdefghijklmnopqrstuvwxyz",up=[],Gn=function(x){return String.fromCharCode(x)};for(_n="0".charCodeAt(0),Jg=0;9>=Jg;++Jg)up[_n++]=Jg;for(_n="a".charCodeAt(0),Jg=10;36>Jg;++Jg)up[_n++]=Jg;for(_n="A".charCodeAt(0),Jg=10;36>Jg;++Jg)up[_n++]=Jg;var Hj=o.prototype;Hj._73O=T,Hj.revert=c,Hj._74O=j,Hj._75O=Z,Hj._76O=d;var vd=G.prototype;vd._73O=O,vd.revert=B,vd._74O=E,vd._75O=po,vd._76O=lb,Uj._77O=I,Uj._58O=k,Uj._54O=N,Uj._57O=g,Uj._59O=K,Uj._45O=V,Uj._44O=A,Uj._46O=S,Uj._78O=H,Uj._47O=L,Uj._48O=J,Uj._49O=i,Uj._50O=r,Uj._51O=hh,Uj.exp=Nk,Uj.toString=x,Uj._85O=f,Uj.abs=y,Uj._52O=U,Uj._55O=W,Uj.mod=n,Uj._53O=yj,q.ZERO=u(0),q.ONE=u(1),Uj._86O=Qb;var Rn=function(e,X){var j=this;j.isPublic=!0,typeof e!==kd?(j.n=e,j.e=X):e!=a&&X!=a&&e.length>0&&X.length>0&&(j.n=pn(e,16),j.e=s(X,16))};kj=function(){var T,j,p=_g(gs),X=p.substr(0,4),D=p.substr(4,2),M=p.substr(6,2),N=1,q=!N,z=h,B=[],Y=yo.charAt(7);if(l&&(l[ts]().indexOf(ab)<0||l[Ph][ts]().indexOf(ab)<0||!p?T=Xg(kf[Y]):(p=new l(X-0,D-N,M-0),j=p.setHours(9),l[Ph]()>j?T=Xg(kf[Y]):q=!0)),p&&T&&z){for(var d in T)B.push(d);var H,I=0,$=T[B[I++]],e=T[B[I++]],U=T[B[I++]],r=T[B[I++]],k=T[B[I++]],f=T[B[I++]],K=T[B[I++]],n=Ni._27O(z);if(n&&K){H=$+e+U+r+k+f;var y=!f||f===Vl;if(!y&&f)for(var P,Z=0,C=f.length;C>Z;Z++)f[Z]===Fp[I]?P===Vl?y=!0:P=a:(P==a?P=f[Z]:P+=f[Z],Z===C-1&&P===Vl&&(y=!0));H&&n._31O(H,K)&&y&&(!k||l[Ph]()<k)&&(q=!0)}}return q||(km=Qp),Y};var bo=Ln.prototype;bo._37O=Ll,bo._38O=Rn;var Nd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Rf="=",Pg=25,cj=10,gs="IBkGAw==",gl=gl||function(d,B){var G={},b=G._7A={},x=b._6A=function(){function N(){}return{_80O:function(H){N.prototype=this;var f=new N;return H&&f._5A(H),f.hasOwnProperty("_82O")||(f._82O=function(){f.$super._82O.apply(this,arguments)}),f._82O.prototype=f,f.$super=this,f},_3A:function(){var P=this._80O();return P._82O.apply(P,arguments),P},_82O:function(){},_5A:function(V){for(var z in V)V.hasOwnProperty(z)&&(this[z]=V[z]);V.hasOwnProperty(ts)&&(this.toString=V.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),C=b._39O=x._80O({_82O:function(m,V){m=this._84O=m||[],this._65O=V!=B?V:4*m.length},toString:function(L){return(L||p).stringify(this)},_89O:function(v){var M=this._84O,C=v._84O,T=this._65O,m=v._65O;if(this._57O(),T%4)for(var U=0;m>U;U++){var p=255&C[U>>>2]>>>24-8*(U%4);M[T+U>>>2]|=p<<24-8*((T+U)%4)}else if(C.length>65535)for(var U=0;m>U;U+=4)M[T+U>>>2]=C[U>>>2];else M.push.apply(M,C);return this._65O+=m,this},_57O:function(){var V=this._84O,s=this._65O;V[s>>>2]&=4294967295<<32-8*(s%4),V.length=F(s/4)},_88O:function(){var F=x._88O.call(this);return F._84O=this._84O.slice(0),F},_87O:function(P){for(var O=[],b=0;P>b;b+=4)O.push(0|4294967296*X);return new C._82O(O,P)}}),A=G._2A={},p=A._69O={stringify:function(O){var E,m=O._84O,M=O._65O,G=[];for(E=0;M>E;E++){var $=255&m[E>>>2]>>>24-8*(E%4);G.push(($>>>4).toString(16)),G.push((15&$).toString(16))}return G.join("")},_68O:function(D){for(var z=D.length,$=[],x=0;z>x;x+=2)$[x>>>3]|=s(D.substr(x,2),16)<<24-4*(x%8);return new C._82O($,z/2)}},_=A._8A={stringify:function(x){var y,N=x._84O,K=x._65O,O=[];for(y=0;K>y;y++){var _=255&N[y>>>2]>>>24-8*(y%4);O.push(Gn(_))}return O.join("")},_68O:function(q){var E,s=q.length,S=[];for(E=0;s>E;E++)S[E>>>2]|=(255&q.charCodeAt(E))<<24-8*(E%4);return new C._82O(S,s)}},Z=A._9A={stringify:function(Y){try{return decodeURIComponent(escape(_.stringify(Y)))}catch(O){throw new Error("")}},_68O:function(d){return _._68O(unescape(encodeURIComponent(d)))}},f=b._32O=x._80O({_1A:function(){this._83O=new C._82O,this._23O=0},_33O:function(Y){typeof Y==kd&&(Y=Z._68O(Y)),this._83O._89O(Y),this._23O+=Y._65O},_25O:function(r){var Z=this._83O,T=Z._84O,X=Z._65O,A=this._79O,f=4*A,v=X/f;v=r?F(v):w((0|v)-this._22O,0);var H=v*A,Y=t(4*H,X);if(H){for(var M=0;H>M;M+=A)this._20O(T,M);var J=T.splice(0,H);Z._65O-=Y}return new C._82O(J,Y)},_88O:function(){var I=x._88O.call(this);return I._83O=this._83O._88O(),I},_22O:0});b._66O=f._80O({cfg:x._80O(),_82O:function(l){this.cfg=this.cfg._80O(l),this._1A()},_1A:function(){f._1A.call(this),this._34O()},_81O:function(K){return this._33O(K),this._25O(),this},_72O:function(H){H&&this._33O(H);var p=this._21O();return p},_79O:16,_26O:function(y){return function(B,D){return new y._82O(D)._72O(B)}},_19O:function(i){return function(R,d){return new N._71O._82O(i,d)._72O(R)}}});var N=G._67O={};return G}();!function(){var U=gl,p=U._7A,u=p._39O,E=p._66O,$=U._67O,W=[],H=[];!function(){function r(m){for(var S=C(m),F=2;S>=F;F++)if(!(m%F))return!1;return!0}function G(h){return 0|4294967296*(h-(0|h))}for(var R=2,y=0;64>y;)r(R)&&(8>y&&(W[y]=G(m(R,.5))),H[y]=G(m(R,1/3)),y++),R++}();var F=[],Q=$._41O=E._80O({_34O:function(){this._64O=new u._82O(W.slice(0))},_20O:function(k,r){for(var T=this._64O._84O,E=T[0],f=T[1],G=T[2],t=T[3],b=T[4],z=T[5],w=T[6],S=T[7],X=0;64>X;X++){if(16>X)F[X]=0|k[r+X];else{var L=F[X-15],Y=(L<<25|L>>>7)^(L<<14|L>>>18)^L>>>3,m=F[X-2],a=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;F[X]=Y+F[X-7]+a+F[X-16]}var e=b&z^~b&w,N=E&f^E&G^f&G,Z=(E<<30|E>>>2)^(E<<19|E>>>13)^(E<<10|E>>>22),c=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),D=S+c+e+H[X]+F[X],C=Z+N;S=w,w=z,z=b,b=0|t+D,t=G,G=f,f=E,E=0|D+C}T[0]=0|T[0]+E,T[1]=0|T[1]+f,T[2]=0|T[2]+G,T[3]=0|T[3]+t,T[4]=0|T[4]+b,T[5]=0|T[5]+z,T[6]=0|T[6]+w,T[7]=0|T[7]+S},_21O:function(){var A=this._83O,H=A._84O,U=8*this._23O,X=8*A._65O;return H[X>>>5]|=128<<24-X%32,H[(X+64>>>9<<4)+14]=P(U/4294967296),H[(X+64>>>9<<4)+15]=U,A._65O=4*H.length,this._25O(),this._64O},_88O:function(){var y=E._88O.call(this);return y._64O=this._64O._88O(),y}});U._41O=E._26O(Q),U._42O=E._19O(Q)}();var cb=new RegExp("");cb.compile("[^0-9a-f]","gi"),Ln._28O=-1,Ln._29O=-2,bo._31O=Sk,bo._63O=Sk,Ln._43O=-2;var ch=new function(){var Q=this;Q._5O=function(K,G){if("8"!=K.substring(G+2,G+3))return 1;var F=s(K.substring(G+3,G+4));return 0==F?-1:F>0&&10>F?F+1:-2},Q._13O=function(V,F){var D=Q._5O(V,F);return 1>D?"":V.substring(F+2,F+2+2*D)},Q._12O=function(t,O){var C=Q._13O(t,O);if(""==C)return-1;var b;return b=s(C.substring(0,1))<8?new q(C,16):new q(C.substring(2),16),b._86O()},Q._6O=function(U,p){var w=Q._5O(U,p);return 0>w?w:p+2*(w+1)},Q._11O=function(A,f){var R=Q._6O(A,f),I=Q._12O(A,f);return A.substring(R,R+2*I)},Q._10O=function(f,z){var l=Q._6O(f,z),I=Q._12O(f,z);return l+2*I},Q._7O=function(R,H){var O=[],s=Q._6O(R,H);O.push(s);for(var m=Q._12O(R,H),F=s,K=0;;){var b=Q._10O(R,F);if(b==a||b-s>=2*m)break;if(K>=200)break;O.push(b),F=b,K++}return O}};if(ch._90O=Gn(cj+24),ch._91O=D+Gn(cj*cj+8),Ch==a||!Ch)var Ch={};Ch._4O!=a&&Ch._4O||(Ch._4O={});var Fl=Ch._4O;Ch._4O.Util=new function(){var p=this;p._56O=function(c){var T=new Ch._4O._3O;return T._30O(c)},p._4A=function(v){var n=new Ch._4O._3O;return n._36O(v)},p._11A=function(o){var F=new Fl._3O;return F._30O(o)}},Ch._4O._3O=function(){var $=this;$._8O=function(H,t){if("ss"==H&&"cj"==t){try{$.md=gl._67O._41O._3A()}catch(o){nn(Jq)}$._24O=function(i){$.md._81O(i)},$._35O=function(q){var C=gl._2A._69O._68O(q);$.md._81O(C)},$._60O=function(){var U=$.md._72O();return U[ts](gl._2A._69O)},$._30O=function(D){return $._24O(D),$._60O()},$._36O=function(V){return $._35O(V),$._60O()}}},$._24O=function(){nn(Jq)},$._35O=function(){nn(Jq)},$._60O=function(){nn(Jq)},$._30O=function(){nn(Jq)},$._36O=function(){nn(Jq)},$._8O("ss","cj")},Bh=function(D){var m=oh[Mn[7]],A=1,q=!1;if(ze.a!=oh[ii])return ze.a;if(ze.forEach(function(P){A*=P}),D>A){if(m){m=m.split(ch._90O);var Q=m[3],f=m[7],o=m[11],i=m[15],S=m[19],b=m[23],Y=m[27],v=Q+f+o+i+S+b,X=b?!1:!0;if(b){var G=b&&b.split(vs("firefox")[3]);if(G)for(var U=0;U<G.length;U++)if(Me.indexOf(G[U])>=0){X=!0;break}}q=Pr()(v,Y)&&X&&(!S||S>D)}q||(Pf.prototype._42=ap)}else q=!0;return ze.a=q,q},Pg=String.fromCharCode(Pg+20);var vm=function(c){return c=c.replace(cb,Jq),c=c.replace(/[ \n]+/g,Jq)},Ok="30",Vg="06",uh="02",er="03",eo=pn,Ql=/^1f+00/,Ni=function(){var P;return P={_18O:function(K){var r=K,o=r.replace(/\s+/g,""),i=Xb(o);return i},_14O:function(b){var f=this._18O(b),r=this._15O(f);return r},_15O:function(f){var F=this._17O(f);if("2a864886f70d010101"==F._61O){var P=this._16O(F.key),h=new Ln;return h._38O(P.n,P.e),h}nn(Jq)},_16O:function(Q){var e={};Q.substr(0,2)!=Ok&&nn(Jq);var S=ch._7O(Q,0);return 2!=S.length&&nn(Jq),Q.substr(S[0],2)!=uh&&nn(Jq),e.n=ch._11O(Q,S[0]),Q.substr(S[1],2)!=uh&&nn(Jq),e.e=ch._11O(Q,S[1]),e},_17O:function(h){var b={};b._40O=a;var R=ch._7O(h,0);2!=R.length&&nn(Jq);var c=R[0];h.substr(c,2)!=Ok&&nn(Jq);var y=ch._7O(h,c);return 2!=y.length&&nn(Jq),h.substr(y[0],2)!=Vg&&nn(Jq),b._61O=ch._11O(h,y[0]),h.substr(y[1],2)==Vg?b._40O=ch._11O(h,y[1]):h.substr(y[1],2)==Ok&&(b._40O={},b._40O.p=ch._70O(h,y[1],[0],uh),b._40O.q=ch._70O(h,y[1],[1],uh),b._40O.g=ch._70O(h,y[1],[2],uh)),h.substr(R[1],2)!=er&&nn(Jq),b.key=ch._11O(h,R[1]).substr(2),b}},P._17O?P:a}(),qb=Ni._27O=function(Z){return Ni._14O(Z)};Pr=function(){return function(l,n){if(l&&n){n=vm(n);var S=eo(n,m(2,4)),X=this;if(!X||!X.n||S._55O()>X.n._55O())return 0;var x=X._37O(S),v=x[ts](m(2,4)).replace(Ql,""),H=Cg(v);if(0==H.length)return!1;var C=H[0],p=H[1],o=function(h){return Ch._4O.Util._56O(h,C)},W=o(l);return p==W}}.bind(qb(h))};var $m,nc;return function(){var r=Pq.length-Zh.length;if(r>0)for(var u=0;r>u;u++)$m=Fl.Util,nc=vm}(),Dg=function(a,O){O=nc(O);var b=qb(yi),F=Af.length,k=2*F,i=eo(O,m(F,k)),V=b,_=!0;if(V){var s=V[Uh[0]];s&&i._55O()<=s._55O()&&(_=!1)}if(_)return 0;var Z=V._37O(i),n=Z[ts](m(F,k)).replace(Ql,""),e=Cg(n);if(0==e.length)return!1;var K=e[0],E=e[1],t=$m._11A(a,K);return E==t},Ni}(Q,n),Gh(x,{load:function(){var E={},Q=function(O){return O?"c_"+(O.sync?"1":"0")+"_"+(O.post?"1":"0")+"_"+(O.responseType||"H")+"_"+(O.mimeType||"H")+"_"+(O.data?JSON.stringify(O.data):"H"):""};return function(g,N,t){var J,q=E[g],I=Q(t);return q&&(J=q[I])?(J.push(N),void 0):(E[g]||(q=E[g]={count:0}),J=q[I]=[N],q.count++,x.xhrLoad(g,function(Z){delete q[I],q.count--,q.count||delete E[g],J.forEach(function(Q){Q(Z)})},t),void 0)}}(),asyncEach:function(N,r,i){"function"!=typeof i&&(i=Function.prototype);var q=new Array(N.length),p=0,k=!1;N.forEach(function(t,d){r(t,function(g,B){return k?void 0:g?(k=!0,i(null)):(q[d]=B,p++,p===N.length?i(q):void 0)})})},xhrLoad:function(D,s,n){var k=!1;mr(D)||(k=!0,D=[D]),n=n||{},D.length;var N=n.sync,Z=!!n.post,I=null;return x.asyncEach(D,function(W,H){var h=new wm;W=x.beforeLoadURL(W),W.data?H(null,W.data):(n.url=encodeURI(W),n.method=Z?"POST":"GET",n.responseType?h.setResponseType(n.responseType):h.setOverrideMimeType(n.mimeType||"text/plain"),h.onload=function(){200===this.status||0===this.status?H(null,h.getResponseText()):H(!0)},h.onerror=function(){H(!0)},h.send(n))},function(t){var p="function"==typeof s;(p||N)&&(I=k&&t?t[0]:t,p&&s(I))}),N?I:void 0}}),Math.sign===i&&(Math.sign=function(C){return 0>C?-1:C>0?1:+C});var Jd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ne={encode:function(v,f){var a,K,z,S,F,T,c,G="",l=0;for(v=ne._utf8_encode(v);l<v.length;)a=v.charCodeAt(l++),K=v.charCodeAt(l++),z=v.charCodeAt(l++),S=a>>2,F=(3&a)<<4|K>>4,T=(15&K)<<2|z>>6,c=63&z,isNaN(K)?T=c=64:isNaN(z)&&(c=64),G=G+f.charAt(S)+f.charAt(F)+f.charAt(T)+f.charAt(c);return G},decode:function(W,Q){var f,R,m,I,t,E,u,h="",M=0;for(W=W.replace(/[^A-Za-z0-9\+\/\=]/g,"");M<W.length;)I=Q.indexOf(W.charAt(M++)),t=Q.indexOf(W.charAt(M++)),E=Q.indexOf(W.charAt(M++)),u=Q.indexOf(W.charAt(M++)),f=I<<2|t>>4,R=(15&t)<<4|E>>2,m=(3&E)<<6|u,h+=String.fromCharCode(f),64!=E&&(h+=String.fromCharCode(R)),64!=u&&(h+=String.fromCharCode(m));return h=ne._utf8_decode(h)},_utf8_encode:function(h){h=h.replace(/\r\n/g,"\n");for(var C="",k=0;k<h.length;k++){var O=h.charCodeAt(k);128>O?C+=String.fromCharCode(O):O>127&&2048>O?(C+=String.fromCharCode(192|O>>6),C+=String.fromCharCode(128|63&O)):(C+=String.fromCharCode(224|O>>12),C+=String.fromCharCode(128|63&O>>6),C+=String.fromCharCode(128|63&O))}return C},_utf8_decode:function(V){for(var x="",R=0,s=0,v=0,W=0;R<V.length;)s=V.charCodeAt(R),128>s?(x+=String.fromCharCode(s),R++):s>191&&224>s?(v=V.charCodeAt(R+1),x+=String.fromCharCode((31&s)<<6|63&v),R+=2):(v=V.charCodeAt(R+1),W=V.charCodeAt(R+2),x+=String.fromCharCode((15&s)<<12|(63&v)<<6|63&W),R+=3);return x}};S.Math={generateUUID:function(){for(var o=[],p=0;256>p;p++)o[p]=(16>p?"0":"")+p.toString(16).toUpperCase();return function(){var e=0|4294967295*Math.random(),l=0|4294967295*Math.random(),u=0|4294967295*Math.random(),S=0|4294967295*Math.random();return o[255&e]+o[255&e>>8]+o[255&e>>16]+o[255&e>>24]+"-"+o[255&l]+o[255&l>>8]+"-"+o[64|15&l>>16]+o[255&l>>24]+"-"+o[128|63&u]+o[255&u>>8]+"-"+o[255&u>>16]+o[255&u>>24]+o[255&S]+o[255&S>>8]+o[255&S>>16]+o[255&S>>24]}}(),clamp:function(h,Q,P){return Math.max(Q,Math.min(P,h))},generateIncreasingID:function(){var y=0;return function(){return++y}}(),encodeBase64:function(d,L){return ne.encode(d,L||Jd)},decodeBase64:function(h,j){return ne.decode(h,j||Jd)},randomArray:function(Y,p){p=p||Y.length;for(var u=p-1;u>0;u--){var H=Math.floor(Math.random()*(u+1)),z=Y[u];Y[u]=Y[H],Y[H]=z}return Y}};var Lj=S.Matrix=S.Math.Matrix2d=function(y,D,i,F,z){this.setFromTransform(y,D,i,F,z)},$r=Lj;Lj.prototype={},Lj.prototype.constructor=Lj,Lj.prototype.set=function(F,$,E,Z,l,y){return this.a=F,this.b=$,this.c=E,this.d=Z,this.tx=l,this.ty=y,this},Lj.prototype.setFromTransform=function(h,l,H,F,j){var g=this;if(h===i)return g.a=1,g.b=0,g.c=0,g.d=1,g.tx=0,g.ty=0,void 0;h=h||0;var f=M(h),o=b(h);return F=F||1,j=j||1,g.a=o*F,g.b=f*F,g.c=-f*j,g.d=o*j,g.tx=l||0,g.ty=H||0,g},Lj.prototype.apply=function(o,y){y=y||new jl;var a=o.x,j=o.y;return y.x=this.a*a+this.c*j+this.tx,y.y=this.b*a+this.d*j+this.ty,y},Lj.prototype.applyInverse=function(p,e){e=e||new jl;var R=1/(this.a*this.d+this.c*-this.b),N=p.x,u=p.y;return e.x=this.d*R*N+-this.c*R*u+(this.ty*this.c-this.tx*this.d)*R,e.y=this.a*R*u+-this.b*R*N+(-this.ty*this.a+this.tx*this.b)*R,e},Lj.prototype.translate=function(l,T){return this.tx+=l,this.ty+=T,this},Lj.prototype.scale=function(O,x){return this.a*=O,this.d*=x,this.c*=O,this.b*=x,this.tx*=O,this.ty*=x,this},Lj.prototype.rotate=function(g){var J=Math.cos(g),s=Math.sin(g),U=this.a,T=this.c,N=this.tx;return this.a=U*J-this.b*s,this.b=U*s+this.b*J,this.c=T*J-this.d*s,this.d=T*s+this.d*J,this.tx=N*J-this.ty*s,this.ty=N*s+this.ty*J,this},Lj.prototype.appendTranslate=function(E,U){return this.tx+=this.a*E+this.c*U,this.ty+=this.b*E+this.d*U,this},Lj.prototype.appendScale=function(t,r){return this.a*=t,this.d*=r,this.c*=r,this.b*=t,this},Lj.prototype.appendRotate=function(y){if(!y)return this;var G=Math.cos(y),R=Math.sin(y),J=this.a,k=this.b;return this.a=J*G+this.c*R,this.b=k*G+this.d*R,this.c=-J*R+this.c*G,this.d=-k*R+this.d*G,this},Lj.prototype.append=function(I){var T=this.a,U=this.b,r=this.c,v=this.d;return this.a=I.a*T+I.b*r,this.b=I.a*U+I.b*v,this.c=I.c*T+I.d*r,this.d=I.c*U+I.d*v,this.tx=I.tx*T+I.ty*r+this.tx,this.ty=I.tx*U+I.ty*v+this.ty,this},Lj.prototype.setTransform=function(q,v,p,L,z,J,j,R,C){var y,i,n,H,U,K,E,M,X,r;return U=Math.sin(j),K=Math.cos(j),E=Math.cos(C),M=Math.sin(C),X=-Math.sin(R),r=Math.cos(R),y=K*z,i=U*z,n=-U*J,H=K*J,this.a=E*y+M*n,this.b=E*i+M*H,this.c=X*y+r*n,this.d=X*i+r*H,this.tx=q+(p*y+L*n),this.ty=v+(p*i+L*H),this},Lj.prototype.prepend=function(m){var x=this.tx;if(1!==m.a||0!==m.b||0!==m.c||1!==m.d){var L=this.a,t=this.c;this.a=L*m.a+this.b*m.c,this.b=L*m.b+this.b*m.d,this.c=t*m.a+this.d*m.c,this.d=t*m.b+this.d*m.d}return this.tx=x*m.a+this.ty*m.c+m.tx,this.ty=x*m.b+this.ty*m.d+m.ty,this},Lj.prototype.transform=Lj.prototype.prepend,Lj.prototype.invert=function(){var V=this.a,O=this.b,d=this.c,J=this.d,q=this.tx,g=V*J-O*d;return this.a=J/g,this.b=-O/g,this.c=-d/g,this.d=V/g,this.tx=(d*this.ty-J*q)/g,this.ty=-(V*this.ty-O*q)/g,this},Lj.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Lj.prototype.clone=function(){var H=new Lj;return H.a=this.a,H.b=this.b,H.c=this.c,H.d=this.d,H.tx=this.tx,H.ty=this.ty,H},Lj.prototype.copy=function(I){return I.a=this.a,I.b=this.b,I.c=this.c,I.d=this.d,I.tx=this.tx,I.ty=this.ty,I},Lj.prototype.tf=function($,d){1===arguments.length&&(d=$.y,$=$.x);var q=this;return{x:q.a*$+q.c*d+q.tx,y:q.b*$+q.d*d+q.ty}},Lj.prototype.tfi=function(i,U){1===arguments.length&&(U=i.y,i=i.x);var W=this,k=1/(W.a*W.d+W.c*-W.b);return{x:W.d*k*i+-W.c*k*U+(W.ty*W.c-W.tx*W.d)*k,y:W.a*k*U+-W.b*k*i+(-W.ty*W.a+W.tx*W.b)*k}},Lj.IDENTITY=new Lj,Lj.TEMP_MATRIX=new Lj;var Eo=S.Math.Vector3=function(z,L,F){"object"==typeof z?this.copy(z):this.set(z,L==i?z:L,F==i?z:F)};n.assign(Eo.prototype,{set:function(d,z,q){return this.x=d,this.y=z,this.z=q,this},setScalar:function(R){return this.x=R,this.y=R,this.z=R,this},setX:function(E){return this.x=E,this},setY:function(d){return this.y=d,this},setZ:function(L){return this.z=L,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(k){return k.x===i?(this.x=k[0],this.y=k[1],this.z=k[2]):(this.x=k.x,this.y=k.y,this.z=k.z),this},add:function(G){return this.x+=G.x,this.y+=G.y,this.z+=G.z,this},addScalar:function(T){return this.x+=T,this.y+=T,this.z+=T,this},addVectors:function(k,K){return this.x=k.x+K.x,this.y=k.y+K.y,this.z=k.z+K.z,this},addScaledVector:function(H,j){return this.x+=H.x*j,this.y+=H.y*j,this.z+=H.z*j,this},sub:function(x){return this.x-=x.x,this.y-=x.y,this.z-=x.z,this},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(K,$){return this.x=K.x-$.x,this.y=K.y-$.y,this.z=K.z-$.z,this},multiply:function(k){return this.x*=k.x,this.y*=k.y,this.z*=k.z,this},multiplyScalar:function(v){return this.x*=v,this.y*=v,this.z*=v,this},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(c){var u=this.x-c.x,I=this.y-c.y,b=this.z-c.z;return u*u+I*I+b*b},distanceToSquared2:function(v){var s=this.x-v[0],$=this.y-v[1],m=this.z-v[2];return s*s+$*$+m*m},multiplyVectors:function(R,K){return this.x=R.x*K.x,this.y=R.y*K.y,this.z=R.z*K.z,this},transformDirection:function(s){var D=this.x,L=this.y,i=this.z,j=s.el;return this.x=j[0]*D+j[4]*L+j[8]*i,this.y=j[1]*D+j[5]*L+j[9]*i,this.z=j[2]*D+j[6]*L+j[10]*i,this.normalize()},applyQuaternion:function(r){var z=this.x,g=this.y,Y=this.z,t=r._x,Q=r._y,A=r._z,C=r._w,j=C*z+Q*Y-A*g,W=C*g+A*z-t*Y,J=C*Y+t*g-Q*z,S=-t*z-Q*g-A*Y;return this.x=j*C+S*-t+W*-A-J*-Q,this.y=W*C+S*-Q+J*-t-j*-A,this.z=J*C+S*-A+j*-Q-W*-t,this},applyMatrix4:function(y){var F=this.x,s=this.y,Z=this.z,G=y.el,m=1/(G[3]*F+G[7]*s+G[11]*Z+G[15]);return this.x=(G[0]*F+G[4]*s+G[8]*Z+G[12])*m,this.y=(G[1]*F+G[5]*s+G[9]*Z+G[13])*m,this.z=(G[2]*F+G[6]*s+G[10]*Z+G[14])*m,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(f){return this.x*f.x+this.y*f.y+this.z*f.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var I=this.length();return I?this.multiplyScalar(1/I):this},setLength:function(Y){return this.normalize().multiplyScalar(Y)},fromArray:function(J,I){return I===i&&(I=0),this.x=J[I],this.y=J[I+1],this.z=J[I+2],this},toArray:function(h,L){return h===i&&(h=[0,0,0]),L===i&&(L=0),h[L]=this.x,h[L+1]=this.y,h[L+2]=this.z,h},cross:function(f){return this.crossVectors(this,f)},angleTo:function(Q){var b=this.dot(Q)/Math.sqrt(this.lengthSq()*Q.lengthSq());return b>1||-1>b?0:Math.acos(b)},lerpVectors:function(C,O,M){return this.subVectors(O,C).multiplyScalar(M).add(C)},crossVectors:function(i,Z){var Y=i.x,R=i.y,v=i.z,q=Z.x,T=Z.y,H=Z.z;return this.x=R*H-v*T,this.y=v*q-Y*H,this.z=Y*T-R*q,this},min:function(f){return this.x=Math.min(this.x,f.x),this.y=Math.min(this.y,f.y),this.z=Math.min(this.z,f.z),this},max:function(E){return this.x=Math.max(this.x,E.x),this.y=Math.max(this.y,E.y),this.z=Math.max(this.z,E.z),this}});var jl=S.Math.Vector2=function(S,c,D){"object"==typeof S&&(S.x!=i?(c=S.y,S=S.x,D=S.e):(D=S[2],c=S[1],S=S[0])),this.set(S||0,c||0,D)};jl.prototype={},jl.prototype.constructor=jl,n.defineProperties(jl.prototype,{width:{get:function(){return this.x},set:function(B){this.x=B}},height:{get:function(){return this.y},set:function(z){this.y=z}}}),jl.prototype.clone=function(){return new jl(this.x,this.y,this.e)},jl.prototype.copy=function(g){return this.set(g.x,g.y,g.e),this},jl.prototype.equals=function(C){return C.x===this.x&&C.y===this.y},jl.prototype.set=function(s,w,r){return this.x=s||0,this.y=w||(0!==w?this.x:0),r!=i&&(this.e=r),this},jl.prototype.setScalar=function(g){return this.x=g,this.y=g,this},jl.prototype.setX=function(r){return this.x=r||0,this},jl.prototype.setY=function(h){return this.y=h||0,this},jl.prototype.add=function(G){return this.x+=G.x,this.y+=G.y,this},jl.prototype.addVectors=function(L,z){return this.x=L.x+z.x,this.y=L.y+z.y,this},jl.prototype.addScalar=function(Q){return this.x+=Q,this.y+=Q,this},jl.prototype.addScaledVector=function(u,I){return this.x+=u.x*I,this.y+=u.y*I,this},jl.prototype.sub=function(y){return this.x-=y.x,this.y-=y.y,this},jl.prototype.subScalar=function(b){return this.x-=b,this.y-=b,this},jl.prototype.subVectors=function(C,x){return this.x=C.x-x.x,this.y=C.y-x.y,this},jl.prototype.multiply=function(F){return this.x*=F.x,this.y*=F.y,this},jl.prototype.multiplyScalar=function(E){return this.x*=E,this.y*=E,this},jl.prototype.divide=function(P){return this.x/=P.x,this.y/=P.y,this},jl.prototype.divideScalar=function(V){return this.multiplyScalar(1/V)},jl.prototype.min=function(F){return this.x=Math.min(this.x,F.x),this.y=Math.min(this.y,F.y),this},jl.prototype.max=function(u){return this.x=Math.max(this.x,u.x),this.y=Math.max(this.y,u.y),this},jl.prototype.fromArray=function(u,c){return c===i&&(c=0),this.x=u[c],this.y=u[c+1],this},jl.prototype.clamp=function(G,N){return this.x=Math.max(G.x,Math.min(N.x,this.x)),this.y=Math.max(G.y,Math.min(N.y,this.y)),this},jl.prototype.clampScalar=function(){var y,T;return function(t,I){return y===i&&(y=new jl,T=new jl),y.set(t,t),T.set(I,I),this.clamp(y,T)}}(),jl.prototype.clampLength=function(F,J){var r=this.length();return this.multiplyScalar(Math.max(F,Math.min(J,r))/r)},jl.prototype.dot=function(r){return this.x*r.x+this.y*r.y},jl.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},jl.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},jl.prototype.normalize=function(){return this.divideScalar(this.length())},jl.prototype.angle=function(){var i=Math.atan2(this.y,this.x);return 0>i&&(i+=2*Math.PI),i},jl.prototype.distanceTo=function(b){return Math.sqrt(this.distanceToSquared(b))},jl.prototype.distanceToSquared=function(o){var k=this.x-o.x,F=this.y-o.y;return k*k+F*F},jl.prototype.isNearEnough=function(E){return this.distanceToSquared(E)<1e-8},jl.prototype.setLength=function(J){var j=this.length();
return j?this.multiplyScalar(J/j):this},jl.prototype.lerp=function(W,u){return this.x+=(W.x-this.x)*u,this.y+=(W.y-this.y)*u,this},jl.prototype.lerpVectors=function(r,A,D){return this.subVectors(A,r).multiplyScalar(D).add(r)},jl.prototype.rotateAround=function(L,k){var e=L?L.x:0,Q=L?L.y:0,$=Math.cos(k),E=Math.sin(k),y=this.x-e,H=this.y-Q;return this.x=y*$-H*E+e,this.y=y*E+H*$+Q,this};var Nd=S.Math.Ray=function(Z,d){this.origin=Z!==i?Z.clone():new Eo,this.direction=d!==i?d.clone():new Eo};n.assign(Nd.prototype,{set:function(E,P){return this.origin.copy(E),this.direction.copy(P),this},clone:function(){return(new this.constructor).copy(this)},copy:function(y){return this.origin.copy(y.origin),this.direction.copy(y.direction),this.maxHitLen=y.maxHitLen,this},at:function(w,h){var S=h||new Eo;return S.copy(this.direction).multiplyScalar(w).add(this.origin)},setMaxHitLength:function(I){this.maxHitLen=I},lookAt:function(W){return this.direction.copy(W).sub(this.origin).normalize(),this},applyMatrix4:function(f){var _=this.maxHitLen;if(_){var F=this.direction.clone().multiplyScalar(_).add(this.origin);F.applyMatrix4(f)}return this.origin.applyMatrix4(f),this.direction.transformDirection(f),_&&(this.maxHitLen=this.origin.distanceTo(F)),this},intersectBox:function(H,K){var I,Z,D,N,w,P,U=1/this.direction.x,s=1/this.direction.y,r=1/this.direction.z,B=this.origin;if(U>=0?(I=(H.min.x-B.x)*U,Z=(H.max.x-B.x)*U):(I=(H.max.x-B.x)*U,Z=(H.min.x-B.x)*U),s>=0?(D=(H.min.y-B.y)*s,N=(H.max.y-B.y)*s):(D=(H.max.y-B.y)*s,N=(H.min.y-B.y)*s),I>N||D>Z)return null;if((D>I||I!==I)&&(I=D),(Z>N||Z!==Z)&&(Z=N),r>=0?(w=(H.min.z-B.z)*r,P=(H.max.z-B.z)*r):(w=(H.max.z-B.z)*r,P=(H.min.z-B.z)*r),I>P||w>Z)return null;if((w>I||I!==I)&&(I=w),(Z>P||Z!==Z)&&(Z=P),0>Z)return null;var F=I>=0?I:Z,p=this.maxHitLen;return p&&F>p?null:this.at(F,K)},intersectTriangle:function(){var w=new Eo,H=new Eo,i=new Eo,P=new Eo;return function(L,C,m,q,B){H.subVectors(C,L),i.subVectors(m,L),P.crossVectors(H,i);var e,r=this.direction.dot(P);if(r>0){if(q)return null;e=1}else{if(!(0>r))return null;e=-1,r=-r}w.subVectors(this.origin,L);var z=e*this.direction.dot(i.crossVectors(w,i));if(0>z)return null;var b=e*this.direction.dot(H.cross(w));if(0>b||z+b>r)return null;var R=-e*w.dot(P);if(0>R)return null;var u=R/r,f=this.maxHitLen;return f&&u>f?null:this.at(u,B)}}()});var We=S.Math.Box3=function(j,n){this.min=j!==i?j:new Eo(1/0,1/0,1/0),this.max=n!==i?n:new Eo(-1/0,-1/0,-1/0)};n.assign(We.prototype,{set:function(J,d){return this.min.copy(J),this.max.copy(d),this},setFromArray:function(u){for(var J=1/0,Q=1/0,_=1/0,M=-1/0,e=-1/0,T=-1/0,z=0,v=u.length;v>z;z+=3){var K=u[z],W=u[z+1],p=u[z+2];J>K&&(J=K),Q>W&&(Q=W),_>p&&(_=p),K>M&&(M=K),W>e&&(e=W),p>T&&(T=p)}return this.min.set(J,Q,_),this.max.set(M,e,T),this},setFromPoints:function(v){this.makeEmpty();for(var A=0,R=v.length;R>A;A++)this.expandByPoint(v[A]);return this},clone:function(){return(new this.constructor).copy(this)},copy:function(u){return this.min.copy(u.min),this.max.copy(u.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},expandByPoint:function(x){return this.min.min(x),this.max.max(x),this}});var If=S.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};n.assign(If.prototype,{set:function(z,J,d,c,Z,E,Q,U,H,o,b,T,j,m,t,L){var V=this.el;return V[0]=z,V[4]=J,V[8]=d,V[12]=c,V[1]=Z,V[5]=E,V[9]=Q,V[13]=U,V[2]=H,V[6]=o,V[10]=b,V[14]=T,V[3]=j,V[7]=m,V[11]=t,V[15]=L,this},clone:function(){return(new If).fromArray(this.el)},fromArray:function(T,P){P===i&&(P=0);for(var c=this.el,I=0;16>I;I++)c[I]=T[I+P];return this},scale:function(x){var p=this.el,y=x.x,J=x.y,M=x.z;return p[0]*=y,p[4]*=J,p[8]*=M,p[1]*=y,p[5]*=J,p[9]*=M,p[2]*=y,p[6]*=J,p[10]*=M,p[3]*=y,p[7]*=J,p[11]*=M,this},makeRotationFromEuler:function(T){var m=this.el,B=T._x,Y=T._y,h=T._z,Z=T._order,M=Math.cos(B),W=Math.sin(B),F=Math.cos(Y),b=Math.sin(Y),e=Math.cos(h),a=Math.sin(h);if("XYZ"===Z){var U=M*e,d=M*a,I=W*e,g=W*a;m[0]=F*e,m[4]=-F*a,m[8]=b,m[1]=d+I*b,m[5]=U-g*b,m[9]=-W*F,m[2]=g-U*b,m[6]=I+d*b,m[10]=M*F}else if("YXZ"===Z){var R=F*e,G=F*a,V=b*e,x=b*a;m[0]=R+x*W,m[4]=V*W-G,m[8]=M*b,m[1]=M*a,m[5]=M*e,m[9]=-W,m[2]=G*W-V,m[6]=x+R*W,m[10]=M*F}else if("ZXY"===Z){var R=F*e,G=F*a,V=b*e,x=b*a;m[0]=R-x*W,m[4]=-M*a,m[8]=V+G*W,m[1]=G+V*W,m[5]=M*e,m[9]=x-R*W,m[2]=-M*b,m[6]=W,m[10]=M*F}else if("ZYX"===Z){var U=M*e,d=M*a,I=W*e,g=W*a;m[0]=F*e,m[4]=I*b-d,m[8]=U*b+g,m[1]=F*a,m[5]=g*b+U,m[9]=d*b-I,m[2]=-b,m[6]=W*F,m[10]=M*F}else if("YZX"===Z){var O=M*F,n=M*b,A=W*F,P=W*b;m[0]=F*e,m[4]=P-O*a,m[8]=A*a+n,m[1]=a,m[5]=M*e,m[9]=-W*e,m[2]=-b*e,m[6]=n*a+A,m[10]=O-P*a}else if("XZY"===Z){var O=M*F,n=M*b,A=W*F,P=W*b;m[0]=F*e,m[4]=-a,m[8]=b*e,m[1]=O*a+P,m[5]=M*e,m[9]=n*a-A,m[2]=A*a-n,m[6]=W*e,m[10]=P*a+O}return m[3]=0,m[7]=0,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,this},makeRotationFromQuaternion:function(T){var E=this.el,p=T._x,B=T._y,l=T._z,e=T._w,i=p+p,S=B+B,g=l+l,b=p*i,o=p*S,f=p*g,X=B*S,u=B*g,O=l*g,I=e*i,m=e*S,U=e*g;return E[0]=1-(X+O),E[4]=o-U,E[8]=f+m,E[1]=o+U,E[5]=1-(b+O),E[9]=u-I,E[2]=f-m,E[6]=u+I,E[10]=1-(b+X),E[3]=0,E[7]=0,E[11]=0,E[12]=0,E[13]=0,E[14]=0,E[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(J){var B=this.el,s=J.el,d=s[0],$=s[1],k=s[2],D=s[3],L=s[4],e=s[5],Q=s[6],P=s[7],n=s[8],Z=s[9],v=s[10],o=s[11],f=s[12],I=s[13],u=s[14],y=s[15],q=Z*u*P-I*v*P+I*Q*o-e*u*o-Z*Q*y+e*v*y,m=f*v*P-n*u*P-f*Q*o+L*u*o+n*Q*y-L*v*y,K=n*I*P-f*Z*P+f*e*o-L*I*o-n*e*y+L*Z*y,i=f*Z*Q-n*I*Q-f*e*v+L*I*v+n*e*u-L*Z*u,w=d*q+$*m+k*K+D*i;if(0===w)return this.identity();var h=1/w;return B[0]=q*h,B[1]=(I*v*D-Z*u*D-I*k*o+$*u*o+Z*k*y-$*v*y)*h,B[2]=(e*u*D-I*Q*D+I*k*P-$*u*P-e*k*y+$*Q*y)*h,B[3]=(Z*Q*D-e*v*D-Z*k*P+$*v*P+e*k*o-$*Q*o)*h,B[4]=m*h,B[5]=(n*u*D-f*v*D+f*k*o-d*u*o-n*k*y+d*v*y)*h,B[6]=(f*Q*D-L*u*D-f*k*P+d*u*P+L*k*y-d*Q*y)*h,B[7]=(L*v*D-n*Q*D+n*k*P-d*v*P-L*k*o+d*Q*o)*h,B[8]=K*h,B[9]=(f*Z*D-n*I*D-f*$*o+d*I*o+n*$*y-d*Z*y)*h,B[10]=(L*I*D-f*e*D+f*$*P-d*I*P-L*$*y+d*e*y)*h,B[11]=(n*e*D-L*Z*D-n*$*P+d*Z*P+L*$*o-d*e*o)*h,B[12]=i*h,B[13]=(n*I*k-f*Z*k+f*$*v-d*I*v-n*$*u+d*Z*u)*h,B[14]=(f*e*k-L*I*k-f*$*Q+d*I*Q+L*$*u-d*e*u)*h,B[15]=(L*Z*k-n*e*k+n*$*Q-d*Z*Q-L*$*v+d*e*v)*h,this},makeRotationAxis:function(B,Y){var b=Math.cos(Y),A=Math.sin(Y),Q=1-b,O=B.x,z=B.y,p=B.z,n=Q*O,v=Q*z;return this.set(n*O+b,n*z-A*p,n*p+A*z,0,n*z+A*p,v*z+b,v*p-A*O,0,n*p-A*z,v*p+A*O,Q*p*p+b,0,0,0,0,1),this},multiply:function(a){return this.multiplyMatrices(this,a)},premultiply:function(z){return this.multiplyMatrices(z,this)},multiplyMatrices:function(d,D){var p=d.el,R=D.el,Q=this.el,C=p[0],q=p[4],S=p[8],_=p[12],J=p[1],k=p[5],M=p[9],y=p[13],L=p[2],f=p[6],Y=p[10],s=p[14],O=p[3],v=p[7],X=p[11],b=p[15],c=R[0],l=R[4],m=R[8],Z=R[12],r=R[1],h=R[5],I=R[9],A=R[13],U=R[2],E=R[6],K=R[10],j=R[14],t=R[3],T=R[7],z=R[11],V=R[15];return Q[0]=C*c+q*r+S*U+_*t,Q[4]=C*l+q*h+S*E+_*T,Q[8]=C*m+q*I+S*K+_*z,Q[12]=C*Z+q*A+S*j+_*V,Q[1]=J*c+k*r+M*U+y*t,Q[5]=J*l+k*h+M*E+y*T,Q[9]=J*m+k*I+M*K+y*z,Q[13]=J*Z+k*A+M*j+y*V,Q[2]=L*c+f*r+Y*U+s*t,Q[6]=L*l+f*h+Y*E+s*T,Q[10]=L*m+f*I+Y*K+s*z,Q[14]=L*Z+f*A+Y*j+s*V,Q[3]=O*c+v*r+X*U+b*t,Q[7]=O*l+v*h+X*E+b*T,Q[11]=O*m+v*I+X*K+b*z,Q[15]=O*Z+v*A+X*j+b*V,this},lookAt:function(){var s=new Eo,q=new Eo,k=new Eo;return function(U,f,B){var $=this.el;return k.subVectors(U,f),0===k.lengthSq()&&(k.z=1),k.normalize(),s.crossVectors(B,k),0===s.lengthSq()&&(1===Math.abs(B.z)?k.x+=1e-4:k.z+=1e-4,k.normalize(),s.crossVectors(B,k)),s.normalize(),q.crossVectors(k,s),$[0]=s.x,$[4]=q.x,$[8]=k.x,$[1]=s.y,$[5]=q.y,$[9]=k.y,$[2]=s.z,$[6]=q.z,$[10]=k.z,this}}()});var Fq=S.Math.Quaternion=function(G,z,o,d){this.set(G,z,o,d)};n.assign(Fq.prototype,{set:function(j,r,z,d){var H=this;return H._x=j||0,H._y=r||0,H._z=z||0,H._w=d!==i?d:1,H},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(F){var Y=this;return Y._x=F._x,Y._y=F._y,Y._z=F._z,Y._w=F._w,Y},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var B=this.length();return 0===B?(this._x=0,this._y=0,this._z=0,this._w=1):(B=1/B,this._x=this._x*B,this._y=this._y*B,this._z=this._z*B,this._w=this._w*B),this},fromArray:function(B,g){g===i&&(g=0);var H=this;return H._x=B[g],H._y=B[g+1],H._z=B[g+2],H._w=B[g+3],this},slerp:function(k,O){if(0===O)return this;if(1===O)return this.copy(k);var W=this._x,x=this._y,C=this._z,V=this._w,M=V*k._w+W*k._x+x*k._y+C*k._z;if(0>M?(this._w=-k._w,this._x=-k._x,this._y=-k._y,this._z=-k._z,M=-M):this.copy(k),M>=1)return this._w=V,this._x=W,this._y=x,this._z=C,this;var Q=Math.sqrt(1-M*M);if(Math.abs(Q)<.001)return this._w=.5*(V+this._w),this._x=.5*(W+this._x),this._y=.5*(x+this._y),this._z=.5*(C+this._z),this;var b=Math.atan2(Q,M),h=Math.sin((1-O)*b)/Q,G=Math.sin(O*b)/Q;return this._w=V*h+this._w*G,this._x=W*h+this._x*G,this._y=x*h+this._y*G,this._z=C*h+this._z*G,this},setFromAxisAngle:function(N,O){var M=O/2,u=Math.sin(M);return this._x=N.x*u,this._y=N.y*u,this._z=N.z*u,this._w=Math.cos(M),this},setFromEuler:function(F){var X=F._x,$=F._y,P=F._z,V=F._order,w=Math.cos,J=Math.sin,e=w(X/2),o=w($/2),W=w(P/2),O=J(X/2),v=J($/2),U=J(P/2);return"XYZ"===V?(this._x=O*o*W+e*v*U,this._y=e*v*W-O*o*U,this._z=e*o*U+O*v*W,this._w=e*o*W-O*v*U):"YXZ"===V?(this._x=O*o*W+e*v*U,this._y=e*v*W-O*o*U,this._z=e*o*U-O*v*W,this._w=e*o*W+O*v*U):"ZXY"===V?(this._x=O*o*W-e*v*U,this._y=e*v*W+O*o*U,this._z=e*o*U+O*v*W,this._w=e*o*W-O*v*U):"ZYX"===V?(this._x=O*o*W-e*v*U,this._y=e*v*W+O*o*U,this._z=e*o*U-O*v*W,this._w=e*o*W+O*v*U):"YZX"===V?(this._x=O*o*W+e*v*U,this._y=e*v*W+O*o*U,this._z=e*o*U-O*v*W,this._w=e*o*W-O*v*U):"XZY"===V&&(this._x=O*o*W-e*v*U,this._y=e*v*W-O*o*U,this._z=e*o*U+O*v*W,this._w=e*o*W+O*v*U),this},setFromToVectors:function(){var z,j;return function(o,p){return z===i&&(z=new Eo),j=o.dot(p)+1,1e-7>j?(j=0,Math.abs(o.x)>Math.abs(o.z)?z.set(-o.y,o.x,0):z.set(0,-o.z,o.y)):z.crossVectors(o,p),this._x=z.x,this._y=z.y,this._z=z.z,this._w=j,this.normalize()}}()});var sn=S.Math.Triangle=function(X,r,L){this.a=X!==i?X:new Eo,this.b=r!==i?r:new Eo,this.c=L!==i?L:new Eo};n.assign(sn,{barycoordFromPoint:function(){var A=new Eo,s=new Eo,N=new Eo;return function(t,O,x,d,C){A.subVectors(d,O),s.subVectors(x,O),N.subVectors(t,O);var $=A.dot(A),u=A.dot(s),n=A.dot(N),W=s.dot(s),I=s.dot(N),Q=$*W-u*u,w=C||new Eo;if(0===Q)return w.set(-2,-1,-1);var S=1/Q,D=(W*n-u*I)*S,V=($*I-u*n)*S;return w.set(1-D-V,V,D)}}()});var Xp=S.Math.Euler=function(W,K,x,l,b){this.set(W,K,x,l,b)};Xp.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Xp.DefaultOrder="XYZ",Xp.ReverseOrder=function(u){return u=u[2]+u[1]+u[0],u.toUpperCase()},n.defineProperties(Xp.prototype,{x:{get:function(){return this._x},set:function(z){this._x=z,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(i){this._y=i,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(Z){this._z=Z,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(k){this._order=k,this.onChangeCallback()}}}),n.assign(Xp.prototype,{set:function(K,Z,W,U,R){return mr(K)&&(R=W,U=Z,W=K[2],Z=K[1],K=K[0]),U?R&&(U=Xp.ReverseOrder(U)):U="ZYX",this._x=K||0,this._y=Z||0,this._z=W||0,this._order=U||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(H){return this._x=H._x,this._y=H._y,this._z=H._z,this._order=H._order,this.onChangeCallback(),this},setFromRotationMatrix:function(w,J,A){var V=S.Math.clamp,Z=w.el||w,F=Z[0],T=Z[4],t=Z[8],c=Z[1],D=Z[5],E=Z[9],k=Z[2],p=Z[6],f=Z[10];return J=J||this._order,"XYZ"===J?(this._y=Math.asin(V(t,-1,1)),Math.abs(t)<.99999?(this._x=Math.atan2(-E,f),this._z=Math.atan2(-T,F)):(this._x=Math.atan2(p,D),this._z=0)):"YXZ"===J?(this._x=Math.asin(-V(E,-1,1)),Math.abs(E)<.99999?(this._y=Math.atan2(t,f),this._z=Math.atan2(c,D)):(this._y=Math.atan2(-k,F),this._z=0)):"ZXY"===J?(this._x=Math.asin(V(p,-1,1)),Math.abs(p)<.99999?(this._y=Math.atan2(-k,f),this._z=Math.atan2(-T,D)):(this._y=0,this._z=Math.atan2(c,F))):"ZYX"===J?(this._y=Math.asin(-V(k,-1,1)),Math.abs(k)<.99999?(this._x=Math.atan2(p,f),this._z=Math.atan2(c,F)):(this._x=0,this._z=Math.atan2(-T,D))):"YZX"===J?(this._z=Math.asin(V(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-E,D),this._y=Math.atan2(-k,F)):(this._x=0,this._y=Math.atan2(t,f))):"XZY"===J?(this._z=Math.asin(-V(T,-1,1)),Math.abs(T)<.99999?(this._x=Math.atan2(p,D),this._y=Math.atan2(t,F)):(this._x=Math.atan2(-E,f),this._y=0)):console.warn("unsupported order: "+J),this._order=J,A!==!1&&this.onChangeCallback(),this},setFromQuaternion:function(){var J=new If;return function(r,q,b){return J.makeRotationFromQuaternion(r),this.setFromRotationMatrix(J,q,b)}}(),setFromVector3:function(r,I){return this.set(r.x,r.y,r.z,I||this._order)},reorder:function(){var Q=new Fq;return function(o){return Q.setFromEuler(this),this.setFromQuaternion(Q,o)}}(),equals:function(R){return R._x===this._x&&R._y===this._y&&R._z===this._z&&R._order===this._order},fromArray:function(H){return this._x=H[0],this._y=H[1],this._z=H[2],H[3]!==i&&(this._order=H[3]),this.onChangeCallback(),this},toArray:function(s,m){return s===i&&(s=[]),m===i&&(m=0),s[m]=this._x,s[m+1]=this._y,s[m+2]=this._z,s[m+3]=this._order,s},toVector3:function(b){return b?b.set(this._x,this._y,this._z):new Eo(this._x,this._y,this._z)},onChange:function(r){return this.onChangeCallback=r,this},onChangeCallback:function(){}});var kg=S.List=function(){this._as=[];var m,Y,l=arguments.length;if(1===l){var v=arguments[0];if(Zm(v)&&(v=v._as),mr(v))for(Y=v.length,m=0;Y>m;m++)this._as.push(v[m]);else v!=a&&this._as.push(v)}else if(l>1)for(m=0;l>m;m++)this._as.push(arguments[m])};Kn("List",n,{forEach:function(X,p){this.each(X,p)},push:function(){for(var E=0;E<arguments.length;E++)this.add(arguments[E])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(I,A){return A===i?this._as.push(I):this._as.splice(A,0,I)},addAll:function(A){Zm(A)&&(A=A._as),mr(A)?On(this._as,A):this._as.push(A)},get:function(S){return this._as[S]},slice:function(B,m){return new kg(this._as.slice(B,m))},remove:function(T){var K=this._as.indexOf(T);return K>=0&&K<this._as.length&&this.removeAt(K),K},removeAt:function(M){return this._as.splice(M,1)[0]},set:function(r,M){return this._as[r]=M},clear:function(){return this._as.splice(0,this._as.length)},contains:function(A){return this._as.indexOf(A)>=0},indexOf:function(Y){return this._as.indexOf(Y)},each:function(n,F){for(var Q=0,D=this._as.length;D>Q;Q++){var G=this._as[Q];F?n.call(F,G,Q,this):n(G,Q,this)}},reverseEach:function(D,c){for(var K=this._as.length-1;K>=0;K--){var v=this._as[K];c?D.call(c,v):D(v)}},getArray:function(){return this._as},toArray:function(M,p){if(M){for(var l,c=[],S=0,P=this._as.length;P>S;S++)l=this._as[S],p?M.call(p,l)&&c.push(l):M(l)&&c.push(l);return c}return this._as.concat()},toList:function(M,h){if(M){for(var R,W=new kg,U=0,b=this._as.length;b>U;U++)R=this._as[U],h?M.call(h,R)&&W.add(R):M(R)&&W.add(R);return W}return new kg(this)},reverse:function(){this._as.reverse()},sort:function(v){return this._as.sort(v?v:Gp),this},toString:function(){return this._as.toString()}}),n.defineProperties(kg.prototype,{length:{get:function(){return this._as.length},set:function(M){this._as.length=M}}});var ej=new kg;Gh(ej,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:ns,each:ns,reverseEach:ns,toArray:function(){return[]},toList:function(){return new kg},add:os,addAll:os,set:os,remove:os,removeAt:os,clear:os});var np=S.Notifier=function(){this._f=0};Kn("Notifier",n,{contains:function(l,u){if(this._ls)for(var X,E=0,m=this._ls.size();m>E;E++)if(X=this._ls.get(E),l===X.l&&u===X.s)return!0;return!1},add:function(T,z,C){var X=this,e={l:T,s:z,a:C};X._ls||(X._ls=new kg),X._f?(X._as||(X._as=new kg),X._as.add(e)):e.a?X._ls.add(e,0):X._ls.add(e)},remove:function(I,F){var N=this;N._ls&&(N._f?(N._rs||(N._rs=new kg),N._rs.add({l:I,s:F})):N._remove(I,F))},_remove:function($,J){for(var q,Q=this._ls,W=0,I=Q.size();I>W;W++)if(q=Q.get(W),q.l===$&&q.s===J)return Q.removeAt(W),void 0},fire:function(M){var N=this,P=N._ls;if(N._b=1e4,P){++N._f;try{for(var G,L=0,r=P.size();r>L;L++)G=P.get(L),G.s?G.l.call(G.s,M):G.l(M)}finally{if(--N._f)return;if(N._rs){for(r=N._rs.size(),L=0;r>L;L++)G=N._rs.get(L),N._remove(G.l,G.s);delete N._rs}if(N._as){for(r=N._as.size(),L=0;r>L;L++)G=N._as.get(L),G.a?P.add(G,0):P.add(G);delete N._as}}}}});var Ij=S.Data=function(){this._id=Vd()};Kn("Data",n,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","styleMap","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:a,_parent:a,_children:ej,_childMap:a,_styleMap:a,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return a},_22Q:function(){return a},s:function(I,n){var o=this;if(2===arguments.length)o.setStyle(I,n);else{if(!$p(I))return o.getStyle(I);for(var P in I)o.setStyle(P,I[P])}return o},fp:function(a,h,X,x,p){return this.firePropertyChange(a,h,X,x,p)},firePropertyChange:function(e,Q,A,j,W){if(j){if(j(Q,A))return!1}else if(Q===A)return!1;var l=this,F=W||{};return F.property=e,F.oldValue=Q,F.newValue=A,F.data=l,l._dataModel&&l._dataModel.handleDataPropertyChange(F),l.onPropertyChanged(F),!0},onPropertyChanged:function(k){var Y=this,R=Y._parent,V=k.property;if(Uk(R)){var i=Y.s(jn),g="s:ingroup"===V;(i&&kn[V]||V===g)&&R._81I(),(i||g)&&R.fp("childChange",!0,!1)}db(R)&&kn[V]&&R.updateFromChildren()},_21I:function(a){var c=this;if(a&&c._dataModel)throw"Remove data from dataModel before adding";c._dataModel=a},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var F=0,k=this._children.toArray(),l=k.length;l>F;F++)k[F].removeFromDataModel()},getId:function(){return this._id},setId:function(V){this._id=V},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(x,Y){return this._children.toList(x,Y)},eachChild:function(t,r){this._children.each(t,r)},addChild:function(J,M){var $=this;J!==$&&($._children===ej&&($._children=new kg,$._childMap={}),M>=0||(M=$._children.size()),$._childMap[J._id]||$.isDescendantOf(J)||(J._parent&&J._parent.removeChild(J),(0>M||M>$._children.size())&&(M=$._children.size()),$._children.add(J,M),$._childMap[J._id]=J,J.setParent($),$.onChildAdded(J,M),$.fp(Wq,a,J)))},onChildAdded:function(){},removeChild:function(h){var k=this;if(k._childMap&&k._childMap[h._id]){var D=k._children.remove(h);delete k._childMap[h._id],k.fp(Wq,h,a),h.setParent(a,D),k.onChildRemoved(h,D)}},onChildRemoved:function(){},getChildAt:function(N){return this._children.get(N)},clearChildren:function(){var h=this;if(!h._children.isEmpty())for(var K=0,p=h._children.toArray(),F=p.length;F>K;K++)h.removeChild(p[K])},getParent:function(){return this._parent},setParent:function(R,K){var T=this;if(!(T._73I||T._parent===R||T===R||R&&R.isDescendantOf(T))){var t,J=T._parent;T._parent=R,T._73I=1,J?(K==a&&(K=J.getChildren().indexOf(T)),J.removeChild(T)):T._dataModel&&K==a&&(K=T._dataModel.getRoots().indexOf(T)),R&&(R.addChild(T),t=R.getChildren().indexOf(T)),delete T._73I,T.fp("parent",J,R,i,{oldIndex:K,newIndex:t}),T.onParentChanged(J,R)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(Z){return Z?this.isDescendantOf(Z)||Z.isDescendantOf(this):!1},isParentOf:function(C){return C&&this._childMap?!!this._childMap[C._id]:!1},isDescendantOf:function(o){if(!o||o.isEmpty())return!1;for(var V=this._parent;V;){if(o===V)return!0;V=V._parent}return!1},getStyle:function(T,u){u===i&&(u=1);var Y=this._styleMap?this._styleMap[T]:i;return Y===i&&u?W[T]:Y},setStyle:function(e,w){var r=this;r._styleMap||(r._styleMap={});var u=r._styleMap[e];w===i?delete r._styleMap[e]:r._styleMap[e]=w,r.fp("s:"+e,u,w)&&r.onStyleChanged(e,u,w)},onStyleChanged:function(){},iv:function(U){this.invalidate(U)},invalidate:function(e){this.fp(e||"*",!1,!0)},toString:function(){var S=this;return S._displayName||S._name||S._tag||S._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(X,Y){var G=this,b=G.s(Xj);b||G.s(Xj,b={}),Y?b[X]=Y:delete b[X],G.fp(Xj,a,b)},removeStyleIcon:function(h){var x=this.s(Xj);if(x){var X=x[h];delete x[h],this.fp(Xj,a,x)}return X},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var o,d={};for(o in this._styleMap)d[o]=1;return d},ca:function(m,l){return m=Io+m,2===arguments.length?this.a(m,l):this.a(m)}});var Wn=S.DataModel=function(){var A=this;A._datas=new kg,A._dataMap={},A._roots=new kg,A._rootMap={},A._fsDataMap={},A._78O={},A._36I=new np,A._35I=new np,A._serializeNotifier=new np,A._selectionModel=new Le(A);var K=A._29Q=[],t=A._scheduleCallback=function(){for(var v=Date.now(),r=0;r<K.length;r++){var z=K[r];z.enabled&&v-z.lastTime>z.interval&&(z.beforeAction&&z.beforeAction(),A.each(function(A){z.action(A)}),z.afterAction&&z.afterAction(),z.lastTime=v)}K.length&&(A._30Q=Q.requestAnimationFrame(t))}};Kn("DataModel",n,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","envmap","postProcessingData","init"],_name:i,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:i,_init:i,_envmap:i,_postProcessingData:i,sm:function(){return this.getSelectionModel()},mm:function(K,c,x){this.addDataModelChangeListener(K,c,x)},umm:function(l,K){this.removeDataModelChangeListener(l,K)},md:function(g,m,h){this.addDataPropertyChangeListener(g,m,h)},umd:function(z,J){this.removeDataPropertyChangeListener(z,J)},mh:function(U,V,T){this.addHierarchyChangeListener(U,V,T)},umh:function(L,l){this.removeHierarchyChangeListener(L,l)},getAttrObject:function(){return this._attrObject},setAttrObject:function(L){return this._attrObject=L},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getFullscreenDatas:function(){return this._fsDataMap},getDataById:function(D){return this._dataMap[D]},removeDataById:function(H){this.remove(this.getDataById(H))},toDatas:function(P,T){return this._datas.toList(P,T)},each:function(t,i){this._datas.each(t,i)},getDataByTag:function(U){return this._78O[U]},getTagMap:function(){return this._78O},removeDataByTag:function(F){this.remove(this.getDataByTag(F))},add:function(k,Q,V){var K=this,v=k._id,W=k._tag,G=K._roots;if(K._dataMap[v])throw"'"+v+"' already exists";W!=a&&(K._78O[W]=k),K._dataMap[v]=k,V>=0?K._datas.add(k,V):K._datas.add(k),k._parent||(K._rootMap[v]=k,Q>=0?G.add(k,Q):G.add(k)),k.s("fullscreen")!==i&&(K._fsDataMap[v]=k),k._21I(K),K.onAdded(k),K._36I.fire({kind:"add",data:k,rootsIndex:Q,datasIndex:V})},onAdded:function(){},remove:function(C,g){if(C){var t=this,i=C._id,I=g&&g.keepStructure,Q=g&&g.keepChildren,R=C.getTag();if(C._dataModel===t){this.beginTransaction(),I?t._removingData||(t._removingData=C):t.prepareRemove(C),Q||C.toChildren().each(function(W){t.remove(W,g)},t),I?t._removingData===C&&(C._parent&&C._parent.removeChild(C),delete t._removingData):C._parent&&C._parent.removeChild(C);var x=t._datas.remove(C);delete t._dataMap[i],R!=a&&delete t._78O[R];var V;t._rootMap[i]&&(delete t._rootMap[i],V=t._roots.remove(C)),t._fsDataMap[i]&&delete t._fsDataMap[i],C._21I(a),t.onRemoved(C),t._36I.fire({kind:rc,data:C,rootsIndex:V,datasIndex:x}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var _=this;if(_._datas.size()){var O=_._historyManager?this.toJSON():i;_._datas.toArray().forEach(function(s){s._21I(a)}),_._datas.clear(),_._dataMap={},_._roots.clear(),_._rootMap={},_._fsDataMap={},_._78O={},_._36I.fire({kind:Sg,json:O})}},contains:function(g){return g&&g._dataModel===this},handleDataPropertyChange:function(P){var Q=this,c=P.data,b=P.property;if("parent"===b){var N=c._id,n=Q._rootMap,L=Q._roots;c._parent?n[N]&&(delete n[N],L.remove(c)):n[N]||(n[N]=c,L.add(c))}else if("tag"===b){var u=P.oldValue,Z=P.newValue,z=Q._78O;u!=a&&delete z[u],Z!=a&&(z[Z]=c)}else if("s:fullscreen"===b){var N=c._id,B=Q._fsDataMap;P.oldValue!=a&&delete B[N],P.newValue!=a&&(B[N]=c)}this.onDataPropertyChanged(c,P),this._35I.fire(P)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(m,u,z){this._36I.add(m,u,z)},removeDataModelChangeListener:function(z,U){this._36I.remove(z,U)},addSerializeListener:function(m,y,P){this._serializeNotifier.add(m,y,P)},removeSerializeListener:function(i,D){this._serializeNotifier.remove(i,D)},fireSerializeEvent:function(B){this._serializeNotifier.fire(B)},addDataPropertyChangeListener:function(X,I,B){this._35I.add(X,I,B)},removeDataPropertyChangeListener:function(g,K){this._35I.remove(g,K)},_38I:function(z,m,H){this._37I&&this._37I.fire({data:z,oldIndex:m,newIndex:H})},addHierarchyChangeListener:function(t,f,X){this._37I||(this._37I=new np),this._37I.add(t,f,X)},removeHierarchyChangeListener:function(p,l){this._37I.remove(p,l)},getSiblings:function(S){var t=S._parent;return t?t._children:this._roots},eachByHierarchical:function(w,k,G){if(k)return this._eachByHierarchical(w,k,G);for(var T=0,b=this._roots,I=b.size();I>T;T++)if(this._eachByHierarchical(w,b.get(T),G)===!1)return!1;return!0},_eachByHierarchical:function(Z,_,T){if(T){if(Z.call(T,_)===!1)return!1}else if(Z(_)===!1)return!1;for(var D=_.size(),P=0;D>P;P++)if(this._eachByHierarchical(Z,_.getChildAt(P),T)===!1)return!1;return!0},reverseEachByHierarchical:function(i,q,p){if(q)return this._reverseEachByHierarchical(i,q,p);for(var _=this._roots,k=_.size(),c=k-1;c>=0;c--)if(this._reverseEachByHierarchical(i,_.get(c),p)===!1)return!1;return!0},_reverseEachByHierarchical:function(x,Q,M){for(var u=Q.size(),b=u-1;b>=0;b--)if(this._reverseEachByHierarchical(x,Q.getChildAt(b),M)===!1)return!1;if(M){if(x.call(M,Q)===!1)return!1}else if(x(Q)===!1)return!1;return!0},eachByDepthFirst:function(i,l,F){if(l)return this._11I(i,l,F);for(var h=0,e=this._roots,Q=e.size();Q>h;h++)if(this._11I(i,e.get(h),F)===!1)return!1;return!0},_11I:function(G,y,X){for(var m=y.size(),E=0;m>E;E++)if(this._11I(G,y.getChildAt(E),X)===!1)return!1;if(X){if(G.call(X,y)===!1)return!1}else if(G(y)===!1)return!1;return!0},eachByBreadthFirst:function(o,k,l){var W=new kg;for(k?W.add(k):this._roots.each(W.add,W);W.size()>0;)if(k=W.removeAt(0),k.eachChild(W.add,W),l){if(o.call(l,k)===!1)return!1}else if(o(k)===!1)return!1;return!0},moveTo:function(E,N){var j=this.getSiblings(E),n=j.indexOf(E);n===N||0>n||N>=0&&N<=j.size()&&(j.remove(E),N>j.size()&&N--,j.add(E,N),this._38I(E,n,N))},moveUp:function(r){this.moveTo(r,this.getSiblings(r).indexOf(r)-1)},moveDown:function(B){this.moveTo(B,this.getSiblings(B).indexOf(B)+1)},moveToTop:function(z){this.moveTo(z,0)},moveToBottom:function(P){this.moveTo(P,this.getSiblings(P).size())},moveSelectionUp:function(G){this.beginTransaction(),G||(G=this.sm());var w=new kg;dl(G,w,this._roots),w.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(b){this.beginTransaction(),b||(b=this.sm());var T=new kg;kc(b,T,this._roots),T.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(o){this.beginTransaction(),o||(o=this.sm());var F=new kg;wg(o,F,this._roots),F.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(m){this.beginTransaction(),m||(m=this.sm());var c=new kg;fc(m,c,this._roots),c.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(w,o,L){var Q=this.getDatas();null==L&&(L=Q.indexOf(w)),L===o||0>L||o>=0&&o<=Q.size()&&(Q.remove(w),o>Q.size()&&o--,Q.add(w,o),this._76I(w,L,o))},bringForward:function(P){this.moveToIndex(P,this.getDatas().indexOf(P)+1)},bringToFront:function(U){this.moveToIndex(U,this.size())},sendBackward:function(s){this.moveToIndex(s,this.getDatas().indexOf(s)-1)},sendToBack:function(m){this.moveToIndex(m,0)},bringSelectionForward:function(S){this.beginTransaction(),S||(S=this.sm());for(var x=new kg,M=this.getDatas(),i=!1,_=0;_<M.size();_++){var E=M.get(M.size()-1-_);S.contains(E)?i&&x.add(E):i=!0}x.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(D){this.beginTransaction(),D||(D=this.sm());for(var l=new kg,x=this.getDatas(),b=0;b<x.size();b++){var X=x.get(b);D.contains(X)&&l.add(X)}l.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(w){this.beginTransaction(),w||(w=this.sm());for(var P=new kg,r=this.getDatas(),k=!1,z=0;z<r.size();z++){var Q=r.get(z);w.contains(Q)?k&&P.add(Q):k=!0}P.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(W){this.beginTransaction(),W||(W=this.sm());for(var f=new kg,_=this.getDatas(),C=0;C<_.size();C++){var Y=_.get(_.size()-1-C);W.contains(Y)&&f.add(Y)}f.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(N){var Z=this;Z.removeScheduleTask(N),N.enabled==a&&(N.enabled=!0),N.interval==a&&(N.interval=10),N.action==a&&(N.action=ns),N.lastTime=Date.now(),Z._29Q.push(N),Z._30Q==a&&(Z._30Q=Q.requestAnimationFrame(Z._scheduleCallback))},removeScheduleTask:function(F){var S=this,m=S._29Q,K=m.indexOf(F);K>=0&&m.splice(K,1),m.length||S._30Q==a||(Q.cancelAnimationFrame(S._30Q),delete S._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(j){this._historyManager||new S.HistoryManager(this),null!=j&&this._historyManager.setMaxHistoryCount(j),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function(i){this._historyManager&&this._historyManager.undo(i)},redo:function(Q){this._historyManager&&this._historyManager.redo(Q)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(v){this._historyManager&&this._historyManager.addHistory(v)},onHistoryManagerChanged:function(){}});var Le=S.SelectionModel=function(w){var U=this;U._68O=fp,U._map={},U._73O=new kg,U._74I=new np,U._21I(w)};Kn("SelectionModel",n,{ms_fire:1,ms_dm:1,ms:function(y,A,T){this.addSelectionChangeListener(y,A,T)},ums:function(M,H){this.removeSelectionChangeListener(M,H)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===Om},co:function(g){return this._map[g._id]!=a},ss:function(H){this.setSelection(H)},as:function(d){this.appendSelection(d)},rs:function(B){this.removeSelection(B)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(U){var O=this;if(O._68O!==U&&(U===Uh||U===Om||U===fp)){O.cs();var v=O._68O;O._68O=U,O.fp("selectionMode",v,U)}},_21I:function(q){var c=this,C=c._dataModel;C!==q&&(C&&(c.cs(),C.umm(c.handleDataModelChange,c)),c._dataModel=q,q.mm(c.handleDataModelChange,c,!0),c.fp(tf,C,q))},dispose:function(){var b=this;b.cs(),b._dataModel.umm(b.handleDataModelChange,b)},handleDataModelChange:function(j){var M=this;if(j.kind===rc){var D=j.data;M.co(D)&&(M._73O.remove(D),delete M._map[D._id],M._75I(rc,new kg(D)))}else j.kind===Sg&&M.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(j){var H=this;if(H._filterFunc!==j){H.cs();var M=H._filterFunc;
H._filterFunc=j,H.fp("filterFunc",M,H._filterFunc)}},_75I:function(O,S,c,n){c&&(this._73O.each(function(s){n[s._id]?c.remove(s):c.add(s)}),S=c.toList()),this._74I.fire({kind:O,datas:new kg(S)})},addSelectionChangeListener:function(f,l,k){this._74I.add(f,l,k)},removeSelectionChangeListener:function(i,M){this._74I.remove(i,M)},_97O:function(F,I){for(var R,r=this,x=0,G=new kg(F);x<G.size();x++)R=G.get(x),(r._filterFunc&&!r._filterFunc(R)||I&&r.co(R)||!I&&!r.co(R)||!r._dataModel.contains(R))&&(G.removeAt(x),x--);return G},appendSelection:function(O){var U=this;if(U._68O!==Uh){var N,Q,v=U._73O,p=U._97O(O,!0);p.isEmpty()||(U.sg()&&(N=new kg(v),Q=U._map,v.clear(),U._map={},p=new kg(p.get(p.size()-1))),p.each(function(d){v.add(d),U._map[d._id]=d}),U._75I("append",p,N,Q))}},removeSelection:function(j){var I=this,v=I._97O(j),V=0,z=v.size();if(0!==z){for(;z>V;V++){var B=v.get(V);I._73O.remove(B),delete I._map[B._id]}I._75I(rc,v)}},toSelection:function(H,J){return this._73O.toList(H,J)},getSelection:function(){return this._73O},each:function(n,t){this._73O.each(n,t)},setSelection:function(r){var I=this,Q=I._73O;if(I._68O!==Uh&&!(Q.isEmpty()&&!r||1===Q.size()&&I.ld()===r)){var n=new kg(Q),E=I._map;Q.clear(),I._map={};var c=I._97O(r,!0);I.sg()&&c.size()>1&&(c=new kg(c.get(c.size()-1))),c.each(function($){Q.add($),I._map[$._id]=$}),I._75I("set",a,n,E)}},clearSelection:function(){var Q=this,e=Q._73O;if(e.size()>0){var B=e.toList();e.clear(),Q._map={},Q._75I(Sg,B)}},selectAll:function(){var r=this;if(r._68O!==Uh){var l,w,h=r._dataModel.toDatas();if(r._filterFunc)for(l=0;l<h.size();l++)w=h.get(l),r._filterFunc(w)||(h.removeAt(l),l--);var E=r._73O,L=new kg(E),F=r._map;E.clear(),r._map={},r.sg()&&h.size()>1&&(h=new kg(h.get(h.size()-1)));var g=h.size();for(l=0;g>l;l++)w=h.get(l),E.add(w),r._map[w._id]=w;r._75I("all",a,L,F)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(o){return this._map[o._id]!=a},getLastData:function(){var M=this._73O;return M.size()>0?M.get(M.size()-1):a},getFirstData:function(){var r=this._73O;return r.size()>0?r.get(0):a},isSelectable:function(T){var W=this;return T&&W._68O!==Uh?W._filterFunc?W._filterFunc(T):!0:!1},getTopSelection:function(){var d=this,W=new kg;return d._73O.each(function(r){for(var U=r.getParent();U;){if(d.contains(U)){r=a;break}U=U.parent}r&&W.add(r)}),W}});var Tl=function(){return Aq(0),function(Z,f){var x;if(ue(f)){var a=Z.getDataUI(f);a&&a._88I&&(x=a._88I.rect)}return x?x:f.getRect()}}();Gh(x,{edgeGroupAgentFunc:a,graphViewAutoScrollZone:16,graphViewZoomable:!0,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:e.rectSelectBorder,graphViewRectSelectBackground:ym,graphViewEditPointSize:Ye?17:7,graphViewEditPointBorderColor:e.editPointBorder,graphViewEditPointBackground:e.editPointBackground,setEdgeType:function(T,I,u){Hp[T]=I,en[T]=u},getEdgeType:function(l){return Hp[l]},getEdgeTypeMap:function(){return Hp},getNodeRect:Tl},!0),Gh(W,{"layout.h":i,"layout.v":i,"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":i,interactive:!1,"image.stretch":"fill",icons:i,ingroup:!0,"body.color":i,"2d.gray":!1,fullscreen:i,"fullscreen.gap":2,"fullscreen.lock":!1,opacity:i,pixelPerfect:!0,keepAspectRatio:!1,"attach.points":null,"attach.style":null,"attach.close.threshold":16,"clip.direction":"top","clip.percentage":1,"select.color":wp,"select.width":1,"select.padding":2,"select.type":is,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":i,"border.width":2,"border.padding":2,"border.type":is,label:i,"label.font":i,"label.color":An,"label.background":i,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":i,"label.max":i,"label.opacity":i,"label.scale":1,"label.align":i,"label.selectable":!0,label2:i,"label2.font":i,"label2.color":An,"label2.background":i,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":i,"label2.max":i,"label2.opacity":i,"label2.scale":1,"label2.align":i,"label2.selectable":!0,note:i,"note.expanded":!0,"note.font":i,"note.color":Gm,"note.background":wp,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":i,"note.toggleable":!0,"note.border.width":1,"note.border.color":i,"note.opacity":i,"note.scale":1,"note.align":i,note2:i,"note2.expanded":!0,"note2.font":i,"note2.color":Gm,"note2.background":wp,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":i,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":i,"note2.opacity":i,"note2.scale":1,"note2.align":i,"group.type":i,"group.image":i,"group.image.stretch":"fill","group.repeat.image":i,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":i,"group.title.color":Gm,"group.title.background":e.groupTitleBackground,"group.title.align":ce,"group.title.orientation":Se,"group.background":e.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":i,"group.border.color":Mh,"group.border.radius":0,"group.border.cap":hf,"group.border.join":og,"group.splitLine":!1,"group.gradient":a,"group.gradient.color":"#FFF",shape:i,"shape.background":Mh,"shape.repeat.image":i,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":Mh,"shape.border.3d":!1,"shape.border.3d.color":i,"shape.border.3d.accuracy":i,"shape.border.cap":hf,"shape.border.join":og,"shape.border.pattern":i,"shape.gradient":a,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":Vg,"shape.dash.offset":0,"shape.dash.color":xc,"shape.dash.width":i,"shape.dash.3d":!1,"shape.dash.3d.color":i,"shape.dash.3d.accuracy":i,"shape.polygon.side":6,"shape.arc.from":O,"shape.arc.to":$,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":i,"shape.gradient.pack":i,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"shape.foreground":i,"shape.foreground.gradient":a,"shape.foreground.gradient.color":"#FFF","shape.foreground.clip.direction":"top","shape.foreground.clip.percentage":1,"autolayout.gap":i,"autolayout.hgap":i,"autolayout.vgap":i,"edge.type":i,"edge.points":i,"edge.segments":i,"edge.color":Mh,"edge.width":2,"edge.width.absolute":!1,"edge.offset":0,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":i,"edge.3d.accuracy":i,"edge.cap":hf,"edge.join":og,"edge.source.position":17,"edge.source.anchor.x":i,"edge.source.anchor.y":i,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":i,"edge.target.anchor.y":i,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":i,"edge.dash":!1,"edge.dash.pattern":Vg,"edge.dash.offset":0,"edge.dash.color":xc,"edge.dash.width":i,"edge.dash.3d":!1,"edge.dash.3d.color":i,"edge.dash.3d.accuracy":i,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":i,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":i,"grid.column.percents":i,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":e.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":e.gridCellBorderColor,"grid.block":i,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":e.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":An,"text.font":Bg,"text.shadow":!1,"text.shadow.color":wp,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3,"text.scale.x":1,"text.scale.y":1},!0),Gh(Wn,{_76I:function(D,h,c){this._39I&&this._39I.fire({data:D,oldIndex:h,newIndex:c})},addIndexChangeListener:function(r,c,T){var P=this;P._39I||(P._39I=new np),P._39I.add(r,c,T)},removeIndexChangeListener:function(o,w){this._39I.remove(o,w)},prepareRemove:function(F){ck(F)&&(F.setSource(a),F.setTarget(a)),F._70O&&F._70O.toList().each(this.remove,this),F._69O&&F._69O.toList().each(function(D){D.setHost(a)}),F._host&&F.setHost(a)},onAdded:function(D){this.isAutoAdjustIndex()&&this.adjustIndex(D)},onDataPropertyChanged:function(B,x){Xd[x.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(B)},isAdjustable:function(u){return Td(u)||ck(u)},isAdjustedToBottom:function(w){return Uk(w)?w.isExpanded()&&qo(w):!1},adjustIndex:function(v){var Z=this;this.isHierarchicalRendering()||(Z.isAdjustedToBottom(v)?(Z.sendToBottom(v),v.eachChild(Z.adjustIndex,Z)):Z.sendToTop(v))},sendToTop:function(w){var R=this;if(R.contains(w)&&R.isAdjustable(w)){var U=R._datas;if(w!==U.get(R.size()-1)){var d=U.indexOf(w);U.removeAt(d),U.add(w),R._76I(w,d,R.size()-1)}if(ck(w)){var g=w._40I;g&&!R.isAdjustedToBottom(g)&&R.sendToTop(g),g=w._41I,g&&!R.isAdjustedToBottom(g)&&R.sendToTop(g)}w._69O&&w._69O.each(function(y){y.isRelatedTo(w)||Td(w)&&y.isLoopedHostOn(w)||R.sendToTop(y)}),w.ISubGraph||(!Uk(w)||w.isExpanded())&&w._adjustChildrenToTop&&w.eachChild(function(V){ck(V)||R.sendToTop(V)})}},sendToBottom:function($,h){var i=this;if($!==h&&i.contains($)&&i.isAdjustable($)&&(!h||i.contains(h))){var K=i._datas,c=K.remove($),v=h?i._datas.indexOf(h):0;if(K.add($,v),c!==v){i._76I($,c,v);var Z=$._parent;!Z||Z.ISubGraph||ck(Z)||i.sendToBottom($._parent,$)}}}}),Gh(sl,{ms_edit:function(n){n._46O=function(h){var O=this,l=O.gv.dm(),R=O._index,i=O._89I,C=O._node,K=O._shape,k=O._edge,g=O._77I;C&&i?(this.fi({kind:"endEditRect",event:h,data:C,direction:i}),l.endTransaction()):K&&R>=0?(O.fi({kind:"endEditPoint",event:h,data:K,index:R}),l.endTransaction()):k&&R>=0?(O.fi({kind:"endEditPoint",event:h,data:k,index:R}),l.endTransaction()):g&&(O.fi({kind:"endEditRotation",event:h,data:g}),l.endTransaction())},n._78I=function(e){var n=this;n.autoScroll(e);var S=n.gv.lp(e),m=n._index,A=n._89I,k=n._node,X=n._shape,s=n._edge,j=n._77I;if(k&&A)n._80O(S),n.fi({kind:"betweenEditRect",event:e,data:k,direction:A});else if(X&&m>=0)S.e=X.getPoints().get(m).e,X.setPoint(m,S),n.fi({kind:"betweenEditPoint",event:e,data:X,index:m});else if(s&&m>=0){var I=s.s(Wd);S.e=I.get(m).e,I.set(m,S),s.fp(Wd,a,I),n.fi({kind:"betweenEditPoint",event:e,data:s,index:m})}else if(j){var q=j.p(),H=j.getScale(),u=K+J(S.y-q.y,S.x-q.x);H.y<0&&(u+=O),G(u)<.04&&(u=0),j.setRotation(u),n.fi({kind:"betweenEditRotation",event:e,data:j})}},n._80O=function(X){var d=this,z=d._node,t=d._rect,N=t.x,b=t.y,y=t.width,k=t.height,o=d._89I,j=d._anchor,w=d._matrix,X=w.tfi(X);"northwest"===o?t=sq(X,{x:N+y,y:b+k}):o===gp?t=sq({x:N,y:X.y},{x:N+y,y:b+k}):"northeast"===o?t=sq({x:N,y:X.y},{x:X.x,y:b+k}):o===Nn?t=sq({x:X.x,y:b},{x:N+y,y:b+k}):o===md?t=sq({x:N,y:b},{x:X.x,y:b+k}):"southwest"===o?t=sq({x:X.x,y:b},{x:N+y,y:X.y}):"south"===o?t=sq({x:N,y:b},{x:N+y,y:X.y}):"southeast"===o&&(t=sq({x:N,y:b},X)),z.setPosition(w.tf(t.x+t.width*j.x,t.y+t.height*j.y)),z.setWidth(t.width),z.setHeight(t.height)},n._80I=function(X,v,f,e){var i=this,k=i.gv._zoom,G=(i.gv.getEditPointSize()+2)/k;return dh({x:v-G/2,y:f-G/2,width:G,height:G},X)?(i._89I!==e&&(i._89I=e),!0):!1},n._79I=function(A,B,P){var $=this,d=$.gv,R=B?d.getDataUI(B):a,T=R?R._55O:a;if(T){var c,V,q,w,y=d._zoom,H=(d.getEditPointSize()+2)/y,g=d.lp(A);if(Td(B)){if(T._56O&&Td(B)&&(V=T._98o,dh({x:V.x-H/2,y:V.y-H/2,width:H,height:H},g)))return $._77I=B,P&&$.fi({kind:"beginEditRotation",event:A,data:B}),$.setCursor("crosshair"),!0;if(T._43O&&B instanceof ws)for(q=B.getPoints(),c=q.size()-1;c>=0;c--)if(V=q.get(c),dh({x:V.x-H/2,y:V.y-H/2,width:H,height:H},g))return $._index=c,$._shape=B,P&&$.fi({kind:"beginEditPoint",event:A,data:B,index:c}),$.setCursor("crosshair"),!0;if(T._42O)for(var s=B.getEditControlPoints(),Z=["northwest",-1,-1,Nn,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,md,1,0,"northeast",1,-1,gp,0,-1],c=0,w=s.length;w>c;c++){var Y=Z[3*c],h=s[c];if($._80I(g,h.x,h.y,Y)){$._node=B;var _=B.getWidth(),D=B.getHeight(),l=B.getAnchor();$._rect={x:-_*l.x,y:-D*l.y,width:_,height:D},$._anchor=l,$._matrix=B.getMatrix();var j=B.getRotation(),C=b(j),u=M(j),U=Z[3*c+1]*ch(B.getScale().x),O=Z[3*c+2]*ch(B.getScale().y),v=Math.atan2(-u*U-C*O,C*U-u*O),k=(Math.round(v/(Math.PI/4))+8)%8,z=[fk,"nesw-resize",yo,"nwse-resize",fk,"nesw-resize",yo,"nwse-resize"][k];return $.setCursor(z),P&&$.fi({kind:"beginEditRect",event:A,data:B,direction:$._89I}),!0}}}if(T._43O&&ck(B)&&B.s(xi)===Yk&&(q=B.s(Wd)))for(c=q.size()-1;c>=0;c--)if(V=q.get(c),dh({x:V.x-H/2,y:V.y-H/2,width:H,height:H},g))return $._index=c,$._edge=B,P&&$.fi({kind:"beginEditPoint",event:A,data:B,index:c}),$.setCursor("crosshair"),!0}return!1}},ms_gv:function(M){M._currentSubGraph=a,M._fpsInfo={time:0,fps:0,frames:0},M.upSubGraph=function(){this.setCurrentSubGraph(Pe(this._currentSubGraph))},M.isVisible=function(_){var A=this;if(Pe(_)!==A._currentSubGraph)return!1;if(ck(_)){var Z=_._40I,R=_._41I;if(!Z||!R)return!1;if(!(_.s("edge.independent")||A.isVisible(Z)&&A.isVisible(R)))return!1;if(_.isEdgeGroupHidden())return!1}else for(var z=_._parent;z&&!z.ISubGraph;){if(Uk(z)&&(!z.isExpanded()||!A.isVisible(z)))return!1;z=z._parent}if(_._parent instanceof Be&&!A.isVisible(_._parent))return!1;if(_._refGraph instanceof tb&&!A.isVisible(_._refGraph))return!1;if(A instanceof jh){if(!_.s("3d.visible"))return!1}else{var B=A.getLayersInfo();if(B){var M=B[_._layer];if(M&&M.visible===!1)return!1}if(!_.s("2d.visible"))return!1}return A._visibleFunc?A._visibleFunc(_):!0},M.handleSelectionChange=function(V){var o=this;V.datas.each(function(_){o.invalidateData(_);var k=_._parent;Uk(k)&&Td(_)&&_.s(jn)&&(o.invalidateData(k),k._49I&&k._49I.each(function(J){o.invalidateData(J)}))}),o.onSelectionChanged(V)},M.onSelectionChanged=function(x){var e=this,f=e.sm();if(1===f.size()&&("set"===x.kind||"append"===x.kind)){var g=f.ld();e.isAutoMakeVisible()&&e.makeVisible(g),e.adjustIndex&&e._dataModel.isAutoAdjustIndex()&&e.adjustIndex(g)}},M.makeVisible=function(g){if(g){var f=this,B=f.getDataUI?f.getDataUI(g):f.getData3dUI(g);if(B){var C=g,y=Pe(g);for(y!==f._currentSubGraph&&f.setCurrentSubGraph(y);(C=C._parent)&&C!==y;)Uk(C)&&C.setExpanded(!0);f._23I=g,f.iv()}}},M.getLabel=function(d){var e=d.getStyle(Bn);return e===i?d.getName():e},M.getLabelBackground=function(L){return L.getStyle("label.background")},M.getLabelColor=function(Q){return Q.getStyle("label.color")},M.getLabel2=function(T){return T.getStyle("label2")},M.getLabel2Background=function(U){return U.getStyle("label2.background")},M.getLabel2Color=function(j){return j.getStyle("label2.color")},M.getNote=function(s){return s.getStyle(Co)},M.getNoteBackground=function(A){return A.getStyle("note.background")},M.getNote2=function(f){return f.getStyle(mg)},M.getNote2Background=function(B){return B.getStyle("note2.background")},M.handleClick=function(n,p,U){var _=this;p?(_.fi({kind:"clickData",event:n,data:p,part:U}),_.onDataClicked(p,n)):(_.fi({kind:"clickBackground",event:n}),_.onBackgroundClicked(n))},M.handleDoubleClick=function(i,X,K){var m=this;Rl(i)&&(X?(m.fi({kind:"doubleClickData",event:i,data:X,part:K}),m.onDataDoubleClicked(X,i,K),m.checkDoubleClickOnNote(i,X,K)||m.checkDoubleClickOnRotation&&m.checkDoubleClickOnRotation(i,X,K)||(ck(X)?m.onEdgeDoubleClicked(X,i,K):X.ISubGraph?m.onSubGraphDoubleClicked(X,i,K):Uk(X)?m.onGroupDoubleClicked(X,i,K):X.IDoorWindow?m.onDoorWindowDoubleClicked(X,i,K):X.ICSGBox&&m.onCSGBoxDoubleClicked(X,i,K))):(m.fi({kind:"doubleClickBackground",event:i}),m.onBackgroundDoubleClicked(i)))},M.onSubGraphDoubleClicked=function(z){this.setCurrentSubGraph(z)},M.onEdgeDoubleClicked=function(m,y){m.ISubGraph&&!Ql(y)?this.setCurrentSubGraph(m):m.s("edge.toggleable")&&m.toggle()},M.onGroupDoubleClicked=function(g){g.s("group.toggleable")&&g.toggle()},M.onDoorWindowDoubleClicked=function(W){W.s("dw.toggleable")&&W.toggle(!0)},M.onCSGBoxDoubleClicked=function(q,V){var o=this;if(o instanceof jh){var j=o.getHitFaceInfo(V);j&&j.face&&q.s(j.face+".toggleable")&&q.toggleFace(j.face,!0)}},M.onBackgroundClicked=function(){},M.onBackgroundDoubleClicked=function(){this.upSubGraph()},M.onDataClicked=function(){},M.onDataDoubleClicked=function(){},M.onAutoLayoutEnded=function(){},M.onMoveEnded=function(){},M.onPanEnded=function(){},M.onPinchEnded=function(){},M.onRectSelectEnded=function(){},M.onZoomEnded=function(){},M.serialize=function(m){return this.dm().serialize(m)},M.toJSON=function(){return this.dm().toJSON()},M.deserialize=function(p,y){var A=this;y=y instanceof Ij?{rootParent:y}:Xq(y)?{setId:y}:nk(y)?{finishFunc:y}:y||{},y.view=A;var G=A.dm(),N=y.finishFunc;return y.finishFunc=function(){N&&N.apply(y,arguments),Xq(G.a("zoomable"))&&A.setZoomable&&A.setZoomable(G.a("zoomable")),Xq(G.a("pannable"))&&A.setPannable&&A.setPannable(G.a("pannable")),Xq(G.a("rectSelectable"))&&A.setRectSelectable&&A.setRectSelectable(G.a("rectSelectable")),G.a("fitContent")===!0&&A.fitContent&&A.fitContent(!0,0)},G.deserialize(p,y.rootParent,y)},M.showDebugTip=function(){var $=this,Y=$._debugDiv;if(!Y){Y=$._debugDiv=H.createElement("div"),Y.style.position="absolute",Y.style.overflow="hidden",Y.style.backgroundColor="white",Y.style.color="black";var L=$.getView();$._79O?L.insertBefore(Y,$._79O):L.appendChild(Y);var u=function(){$.redraw();var E="FPS : "+$._fpsInfo.fps+"<br/>"+"Datas : "+$.dm().getDatas().length,V=$.getDebugTip();V&&(E+="<br/>------<br/>"+V),Y.innerHTML=E,$._isDebugging&&requestAnimationFrame(u)};requestAnimationFrame(u),$._isDebugging=!0}},M.hideDebugTip=function(){var s=this,h=s._debugDiv;h&&(delete s._debugDiv,s.getView().removeChild(h),s._isDebugging=!1)},M.countFrame=function(){if(this._isDebugging){var e=Date.now(),q=this._fpsInfo;e-q.time>1e3?(q.fps=Math.round(1e5*(q.frames+1)/(e-q.time))/100,q.time=e,q.frames=0):q.frames++}}},ms_icons:function(o){o.getRotation=function(K){return K==a?0:K},o._15O=function(){var w=this,b=w.s(Xj);if(b){var N=w,Q=w.data||w._data,k=w._38o={icons:b,rects:{}};for(var i in b){var E=b[i],S=Cs(E.shape3d,Q,N);if(!(Cs(E.visible,Q,N)===!1||Cs(E.for3d,Q,N)&&!w.I3d||S&&!w.I3d)){var Y=S?[S]:Cs(E.names,Q,N),J=Y?Y.length:0,D=Cs(E.position,Q,N)||3,n=Cs(E.offsetX,Q,N)||0,c=Cs(E.offsetY,Q,N)||0,f=Cs(E.direction,Q,N)||md,Z=Cs(E.gap,Q,N),M=Z!=a?Z:1,l=Cs(E.rotation,Q,N),T=Cs(E.keepOrien,Q,N),P=Cs(E.rotationFixed,Q,N)?l:w.getRotation(l,T,D),U=a,X=k.rects[i]=new Array(J);X.rotation=P;for(var g=0;J>g;g++){var F,A,R,I,G=Y[g];if(S)R=0,I=0;else{var B=Nl(G);R=Cs(E.width,Q,N),I=Cs(E.height,Q,N),R==a&&(R=sr(B,Q)),I==a&&(I=Qo(B,Q))}if(U?f===md?n+=R/2:f===Nn?n-=R/2:f===gp?c-=I/2:c+=I/2:U={width:R,height:I},w.I3d){var W=-R/2,v=-I/2;A={width:R,height:I,mat:w._16O(Cs(E.autorotate,Q,N),D,U,Cs(E.face,Q,N)||Ie,Cs(E.t3,Q,N),Cs(E.r3,Q,N),Cs(E.rotationMode,Q,N),n,c),vs:new _p([W,-v,0,W,-v-I,0,W+R,-v-I,0,W+R,-v,0])}}else F=w.getPosition(D,n,c,U,Cs(E.positionFixed,Q,N)),A={x:F.x-R/2,y:F.y-I/2,width:R,height:I},w._68o(A,P);X[g]=A,f===md?n+=R/2+M:f===Nn?n-=R/2+M:f===gp?c-=I/2+M:c+=I/2+M}}}}}}});var $c={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},lm={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},_l={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Xd={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},kn={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Gn={"edge.type":1,"edge.group":1},ng={rotation:1,rotationX:1,rotationZ:1},Cr={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},bq={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},oe={shape:1,thickness:1,position:1,anchor:1,scale:1},Pe=function(C){if(!C)return a;if(ck(C)){var X=C._40I,L=C._41I;if(!X||!L)return a;var q=Pe(X),J=Pe(L);return q===J?q:a}for(var I=C._parent;ck(I)&&!I.ISubGraph;)I=I._parent;return I?I.ISubGraph?I:Pe(I):a},cp=function(y,Y,h,L){var K=Y.getStyle(h)*L;K&&de(y,K),K=Y.getStyle(h+".left")*L,K&&(y.x-=K,y.width+=K),K=Y.getStyle(h+".right")*L,K&&(y.width+=K),K=Y.getStyle(h+".top")*L,K&&(y.y-=K,y.height+=K),K=Y.getStyle(h+".bottom")*L,K&&(y.height+=K),y.width<0&&(y.width=-y.width,y.x-=y.width),y.height<0&&(y.height=-y.height,y.y-=y.height)},qo=function(g){for(var _,x=0,t=g.size();t>x;x++)if(_=g.getChildAt(x),Td(_)&&qo(_))return!0;return g.hasAgentEdges()},Ek=function(V){if(!V)return a;for(var l=V._parent;Uk(l);){if(!Uk(l._parent))return l.isExpanded()?V:l;l.isExpanded()||(V=l),l=l._parent}return V},qn=function(S,f){if(!S||!f)return a;var T,F,b,r=Pe(S),M=Pe(f);if(r!==M){for(;M&&r!==M;)M=Pe(M);if(r===M)return S;T=new kg,T.add(S,0);for(var O=S._parent;Td(O)&&!f.isDescendantOf(O);)T.add(O,0),O=O._parent;for(b=T.size(),F=0;b>F;F++){var w=T.get(F);if(Uk(w)&&!w.isExpanded())return w;if(w.ISubGraph)return w}return S}return S},Zk=function(A){if(A.isLooped())return A._source;var T=Ek(A._source),V=Ek(A._target);return T===V?A._source:qn(T,V)},jp=function(w){if(w.isLooped())return w._target;var $=Ek(w._source),X=Ek(w._target);return $===X?w._target:qn(X,$)},Pp=function(V,c,M){"target"!==M&&(M="source");var E="target"===M?c.getTargetAgent():c.getSourceAgent(),B="edge."+M+".";if(ck(E)){var D=V.getDataUI(E);D._79o();var w=c.s(B+"index");if(w!==i){var u=Fr(D);return u[Math.max(0,Math.min(w,u.length-1))]}var Y=c.s(B+"percent")||0;Y=Math.max(0,Math.min(Y,1));var r=Wm(D);return td(r,100*Y)}return Ci(V,E,c.s(B+"position"),c.s(B+"offset.x"),c.s(B+"offset.y"),c.s(B+"anchor.x"),c.s(B+"anchor.y"))},Ci=function(A,W,h,e,T,H,Z){if(!W)return a;var S,r=W.getRotation?W.getRotation():0;if(H!==i||Z!==i)if(H=H===i?.5:H,Z=Z===i?.5:Z,r&&!ue(W,A)){var F=W.getPosition(),B=W.getWidth(),v=W.getHeight(),j=W.getAnchor(),d=W.getScale(),u=new $r(r,F.x,F.y,d.x,d.y);h=u.tf((H-j.x)*B,(Z-j.y)*v)}else S=Tl(A,W),h={x:S.x+H*S.width,y:S.y+Z*S.height};else h=gc(h,Tl(A,W));if(r){var q=b(r),X=M(r),o=e*q-T*X;T=e*X+T*q,e=o}return h.x+=e,h.y+=T,h},pd=function(O,o){if(!O||!o)return a;var z,m,u,n,d,D;if(O===o){if(n=O.getLoopedEdges(),!n)return a;n=new kg(n)}else{if(d=O.getAgentEdges(),D=o.getAgentEdges(),!d||!D)return a;for(m=d.size(),z=0;m>z;z++)u=d.get(z),D.contains(u)&&(n||(n=new kg),n.add(u))}if(n)for(z=0;z<n.size();z++)u=n.get(z),u.getStyle(xi)===Yk&&(u._22I(a),n.removeAt(z),z--);return n},ml=function(z,b){var q=pd(z,b);if(q&&!q.isEmpty()){if(1===q.size())return q.get(0)._22I(a),void 0;var v=new kg,X=new kg;q.each(function($){var f=$.s("edge.group");v.contains(f)||v.add(f)}),v.sort(),v.each(function(V){X.add(new S.EdgeGroup(q.toList(function(z){return V===z.s("edge.group")}),X))}),X.each(function(P){P.each(function(s){s._22I(P)})})}},Qq=function(M,_){if(_){var c=_.rect,y=_.color,V=_.rotation,E=_.labelWidth,P=_.background,T=_.opacity,s=_.scale,Q=s!=a&&1!==s;if(T!=a){var v=M.globalAlpha;M.globalAlpha*=T}if(V||Q){M.save();var J=c.x+c.width/2,H=c.y+c.height/2;$b(M,J,H),V&&Hr(M,V),Q&&M.scale(s,s),$b(M,-J,-H)}if(P&&vm(M,c.x,c.y,c.width,c.height,P),E){var Z=c.width,L=M.createLinearGradient(c.x,c.y,c.x+Z,c.y);L.addColorStop(0,y),L.addColorStop(.9,y),L.addColorStop(1,uq),y=L,c.width=E}ae(M,_.ss,c,_.font,y,_.align),E&&(c.width=Z),(V||Q)&&M.restore(),T!=a&&(M.globalAlpha=v)}},lb=function(P,D){if(D){var G=D.rect,E=G.x,F=G.y,w=G.width,Y=G.height,f=D.background,c=D.backgroundImage,z=D.borderWidth,l=D.borderColor,i=D.labelWidth,T=D.opacity,h=D.scale,u=h!=a&&1!==h;if(T!=a){var b=P.globalAlpha;P.globalAlpha*=T}if(u){P.save();var H=G.x+G.width/2,d=G.y+G.height/2;$b(P,H,d),P.scale(h,h),$b(P,-H,-d)}if(D.expanded){var B=t(8,w/4),p=F+Y-8;if(P.fillStyle=f,P.beginPath(),P.moveTo(E,F),P.lineTo(E,p),P.lineTo(E+w/2,p),P.lineTo(E+w/2,F+Y),P.lineTo(E+w/2+B,p),P.lineTo(E+w,p),P.lineTo(E+w,F),P.closePath(),P.fill(),z&&(P.lineWidth=z,P.lineJoin="round",P.lineCap="round",l?(P.strokeStyle=l,P.stroke()):(P.strokeStyle=wi(f),P.beginPath(),P.moveTo(E+w,F),P.lineTo(E+w,p),P.lineTo(E+w/2+B,p),P.lineTo(E+w/2,F+Y),P.stroke(),P.strokeStyle=Vq(f),P.beginPath(),P.moveTo(E+w,F),P.lineTo(E,F),P.lineTo(E,p),P.lineTo(E+w/2,p),P.lineTo(E+w/2,F+Y),P.stroke())),c)hc(P,Nl(c),lr,G.x,G.y,G.width,G.height-8,D.data,D.view);else{if(G.height-=8,f=D.color,i){var I=w,A=P.createLinearGradient(E,F,E+I,F);A.addColorStop(0,f),A.addColorStop(.9,f),A.addColorStop(1,uq),f=A,G.width=i}ae(P,D.ss,G,D.font,f,D.align),i&&(G.width=I),G.height+=8}}else if(D.icon)jb(P,Nl(D.icon),E,F,w,Y,D.data,D.view);else{var o=w/2;z&&(P.lineWidth=z,P.lineJoin="round",P.lineCap="round",P.strokeStyle=l?l:wi(f),P.beginPath(),P.arc(E+o,F+o,o,K,1.6*O,!0),P.moveTo(E+o,F+Y),P.lineTo(E+w-o/5,F+o),P.stroke(),P.strokeStyle=l?l:Vq(f),P.beginPath(),P.arc(E+o,F+o,o,1.6*O,K,!0),P.moveTo(E+o,F+Y),P.lineTo(E+o/5,F+o),P.stroke()),P.fillStyle=f,P.beginPath(),P.arc(E+o,F+o,o,0,$,!0),P.moveTo(E+o,F+Y),P.lineTo(E+w-o/5,F+o),P.lineTo(E+o/5,F+o),P.closePath(),P.fill(),P.fillStyle=D.color,P.beginPath(),P.arc(E+o,F+o,o/3,0,$,!0),P.fill()}u&&P.restore(),T!=a&&(P.globalAlpha=b)}},ol=function(l,X){return X>2*l?l:X/2},hb=function(I,u,i,C){if(!I||!u)return 0;var _=J(u.y-I.y,u.x-I.x);return i||(_=u.x<I.x?_+O:_),_+C},Hi=function(M,_,d,y,O,P,I){I&&(M.x>_.x||M.x===_.x&&M.y>_.y)&&(d=Tc[d],O=-O);var D=gc(d,{x:0,y:0,width:Og(M,_),height:0},P);return D.x+=y,D.y+=O,D=new $r(J(_.y-M.y,_.x-M.x)).tf(D),D.x+=M.x,D.y+=M.y,D},Cd=function(P,x,$,V,U){if(P._19Q=!0,!$.getEdgeGroup())return V?$.s("edge.gap"):0;if(ck($.getSourceAgent())||ck($.getTargetAgent()))return 0;var H,a=0,c=0,D=0;if($.getEdgeGroup().getSiblings().each(function(q){q.each(function(v){if(x.isVisible(v)&&v.s(xi)==U){var i=v.s("edge.gap");H?(c+=D/2+i/2,D=i):(H=v,D=i),v===$&&(a=c)}})}),V)return c-a+D;var Y=a-c/2;return H&&$._40I!==H._40I&&(P._19Q=!1),Y},Ko=function(){var A=function(f){var $=[];return f.forEach(function(C){$.push({x:C.x,y:C.y}),$.push({x:C.x+C.width,y:C.y+C.height}),$.push({x:C.x+C.width,y:C.y}),$.push({x:C.x,y:C.y+C.height})}),$};return function(o,q,T){if("oval"===o){var G=0,Y=T.height/T.width,I=Y*Y,z=T.x+T.width/2,M=T.y+T.height/2,m=A(q);m.forEach(function(b){var X=b.x-z,S=b.y-M,f=X*X+S*S/I;f>G&&(G=f)}),G=C(G);var S=Y*G;return{x:z-G,y:M-S,width:2*G,height:2*S}}if("circle"===o){var X=0,z=T.x+T.width/2,M=T.y+T.height/2,m=A(q);return m.forEach(function(y){var T=y.x-z,N=y.y-M,h=T*T+N*N;h>X&&(X=h)}),X=C(X),{x:z-X,y:M-X,width:2*X,height:2*X}}return"roundRect"===o?(de(T,t(T.width,T.height)/16),T):T}}(),Bl=S.graph={},As=function(E,u,m){ri(D+".graph."+E,u,m)};S.layout={};var Hh={},Ec=function(t,D,y,z,u,Q,F,p){var x=[D.uuid,Math.round(z),Math.round(u),y].join("_");D.cacheRule&&(x+=Cs(D.cacheRule,Q,F));var v=F._zoom;v!==F._cacheZoom&&(F._cacheZoom=v,F._cacheImage={});var K=F._cacheImage[x];return K||(K=F._cacheImage[x]=S.Default.toCanvas(D,z*v,u*v,y,Q,F,p)),K};Gh(x,{setImageCacheRule:function(Q,E){var X;X=E||"object"!=typeof Q?{_image:E}:Q;for(var H in X){var l=X[H];Tp(H)?(ri=Nl(H),ri?ri.cacheRule=l:Hh[H]=l):H.cacheRule=l}}});var Fh={comps:[{type:vp,points:[85,50,70,115,100,71,86,107,88,49,57,87,50,114,84,54,114,55,53,105,77,90,49,43,67,121,101,121,121,100,53,88,83,121,74,90,120,76,47,100,86,79,65,61],borderWidth:1,borderColor:a}]};if(Fh[Lc]=Fh[ss]=160,Q.Image){var rh=new Q.Image;rh.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAALUlEQVRYR+3QQREAAAABQfqXFsNnFTizzXk99+MAAQIECBAgQIAAAQIECBAgMBo/ACHo7lH9AAAAAElFTkSuQmCC",ai("default_blank",rh)}ai("node_image",Wo(30,30,[{type:is,rect:[4,5,22,16],gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[2,3,26,20],borderWidth:1,borderColor:Mh},{type:is,rect:[11,23,8,4],background:Mh},{type:is,rect:[6,27,18,2],background:Mh}])),ai("node_icon",Wo(16,16,[{type:is,rect:[2,2,12,10],gradient:ge,gradientColor:xj,background:Mh},{type:Ml,rect:[2,2,12,10],width:1,color:Mh},{type:is,rect:[6,12,4,2],background:Mh},{type:is,rect:[4,14,8,1],background:Mh}])),ai("block_icon",Wo(16,16,[{type:Ml,rect:[1,1,14,14],width:1,color:Mh}])),ai("group_image",Wo(66,39,[{type:is,rect:[44.3,18,18.1,12.8],gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[3.3,17.8,18.1,12.8],gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:Mh,gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[26.2,29.4,12.8,4.2],background:Mh},{type:is,rect:[21.3,33.5,22.5,2.3],background:Mh},{type:is,rect:[5.3,32.7,14.1,2.1],background:Mh},{type:is,rect:[9,30.4,6.7,2.4],background:Mh},{type:is,rect:[50,30.7,6.7,2.4],background:Mh},{type:is,rect:[46.3,33,14.1,2.1],background:Mh}])),ai("group_icon",Wo(16,16,[{type:is,rect:[4,12,4,2],background:Mh},{type:is,rect:[2,13,8,1],background:Mh},{type:is,rect:[12,12,2,1],background:Mh},{type:is,rect:[11,13,4,1],background:Mh},{type:is,rect:[10,7,6,5],gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[1,2,10,10],gradient:ge,gradientColor:xj,background:Mh},{type:Ml,rect:[1,2,10,10],width:1,color:Mh}])),ai("refGraph_icon",Wo(16,16,[{type:"shape",borderWidth:1,borderColor:Mh,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:Mh,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),ai("edge_icon",Wo(16,16,[{type:is,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[10.8,1,4,4],background:Mh},{type:is,rect:[1,11,4,4],background:Mh}])),ai("subGraph_image",Wo(72,45,[{type:vp,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[29.6,30.7,3.6,1.8],background:Mh},{type:is,rect:[28.4,32.3,6,1.2],background:Mh},{type:is,rect:[37.3,32,10.8,1.8],background:Mh},{type:is,rect:[39.1,29.9,7.2,2.3],background:Mh},{type:is,rect:[26.6,23.7,9.6,7.2],gradient:ge,gradientColor:xj,background:Mh},{type:is,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:Mh,gradient:ge,gradientColor:xj,background:Mh}])),ai("subGraph_icon",Wo(17,17,[{type:vp,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:ge,gradientColor:xj,background:Mh}])),ai("shape_icon",Wo(16,16,[{type:vp,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:Mh}])),ai("polyline_icon",Wo(16,16,[{type:vp,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:Mh},pk(7.5,.4),pk(7.5,6.3),pk(13.6,6.3),pk(13.6,14),pk(.7,13.9),pk(.7,.3)])),ai("grid_icon",Wo(16,16,[{type:is,rect:[1,1,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[6,1,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[11,1,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[11,6,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[6,6,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[1,6,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[11,11,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[6,11,4,4],background:Mh,gradient:ge,gradientColor:xj},{type:is,rect:[1,11,4,4],background:Mh,gradient:ge,gradientColor:xj}])),ai("light_icon",Wo(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:Mh},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:Mh,gradient:ge,gradientColor:xj,background:{func:function(i){var o=i?i.s(zf):a;
return mr(o)?"rgb("+s(255*o[0])+","+s(255*o[1])+","+s(255*o[2])+")":o||Mh}}}])),ai("text_icon",Wo(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:Mh}])),ai("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),ai("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),ai("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),ai("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var Ae=function(I,F,n,h,q,m){var B,Y,o,b,u,f,G,_,S,x,L,a=[];if(Math.abs(h)>2*Math.PI&&(h=2*Math.PI),u=Math.ceil(Math.abs(h)/(Math.PI/4)),B=h/u,Y=-B,o=-n,u>0){f=I+Math.cos(n)*q,G=F+Math.sin(-n)*m,a.push({x:f,y:G});for(var U=0;u>U;U++)o+=Y,b=o-Y/2,_=I+Math.cos(o)*q,S=F+Math.sin(o)*m,x=I+Math.cos(b)*(q/Math.cos(Y/2)),L=F+Math.sin(b)*(m/Math.cos(Y/2)),a.push({x:x,y:L}),a.push({x:_,y:S})}return a},bl=function(V){if(V){var s=V._data;if(s instanceof S.Shape)return{points:s.getPoints(),segments:s.getSegments()};var J;if(s instanceof S.Edge&&(J=V._78o)){var i,W,B=J.type,R=J.points,E=J.segments,o=J.edgeTypeInfo;if(!B||R){var Z=J.sourcePoint,k=Z.x,D=Z.y,L=J.targetPoint,U=L.x,_=L.y;if(B)E?(i=new kg({x:k,y:D}),i.addAll(R),i.add({x:U,y:_}),W=new kg(E._as)):(i=new kg({x:k,y:D}),R.each(function(I){i.add(I)}),i.add({x:U,y:_}));else if(J.looped){i=new kg(Ae(k,D,0,2*Math.PI,J.radius,J.radius)),W=new kg([1]);for(var N=0;N<(i.size()-1)/2;N++)W.add(3)}else i=new kg,J.center?(i.add({x:J.c1.x,y:J.c1.y}),i.add({x:k,y:D}),i.add({x:U,y:_}),i.add({x:J.c2.x,y:J.c2.y})):(i.add({x:k,y:D}),i.add({x:U,y:_}))}else o&&(i=new kg(o.points._as),o.segments&&(W=new kg(o.segments._as)));return{points:i,segments:W}}}},Wm=function(Y,_,p){if(null==_){var H=bl(Y);if(!H)return;_=H.points,p=H.segments}if(_){if(Array.isArray(_)&&(_=new kg(_)),"number"==typeof _.get(0)){for(var g=new S.List,N=0;N<_.size();N+=2)g.add({x:_.get(N),y:_.get(N+1)});_=g}if(!p){p=[1];for(var z=_.length-1;z>0;z--)p.push(2)}Array.isArray(p)&&(p=new kg(p));for(var w=vl(_._as,p._as,50),l=w.length,Z=[],N=0;l>N;N++){var J=w[N];J.length>1&&Z.push(J)}return Z}},id=function(J){for(var a=0,y=J.length-1,$=0;y>$;$++){var t=J[$],A=J[$+1],m=A.x-t.x,n=A.y-t.y;a+=Math.sqrt(m*m+n*n)}return a},ug=function(Q,R){for(var i=0,T=R.length,r=0;T>r;r++){var Y=R[r];if(i+=Y,i>Q)return r}return Math.min(r,T-1)},Vh=function(p,k){for(var y=0,N=0,S=0,v=p.length-1,Q=0;v>Q;Q++){var n=p[Q],F=p[Q+1],j=F.x-n.x,I=F.y-n.y;if(S=Math.sqrt(j*j+I*I),y+=S,y>k){y-=S,N=Q;break}}var K=p[N],c=p[N+1],D=Math.atan2(c.y-K.y,c.x-K.x),M=k-y,I=Math.sin(D)*M,j=Math.cos(D)*M;return{x:K.x+j,y:K.y+I}},td=function(b,c){if(b){var x;if(0===c)x=b[0][0];else if(100===c)b=b[b.length-1],x=b[b.length-1];else{for(var W=0,Q=[],V=b.length,l=0;V>l;l++){var q=b[l],O=id(q);W+=O,Q.push(O)}for(var I=W*c/100,p=ug(I,Q),Y=0,M=0;p>M;M++)Y+=Q[M];I-=Y,x=Vh(b[p],I)}return x}},Fr=function(Z){var r,A,Q,z,g=bl(Z),G=[],v=g.points,x=g.segments,u=-1;for(A=0,Q=x?x.length:v.length;Q>A;A++){if(r=x?x.get(A):1,3===r)z=2;else if(4===r)z=3;else{if(5===r)continue;z=1}u+=z,G.push(v.get(u))}return G},Ro=function(l,F,d,D){function x(x){if(x>=0&&1>=x){T=F(x);var C=(l.x-T.x)*(l.x-T.x)+(l.y-T.y)*(l.y-T.y);return g>C?(g=C,r=x,!0):!1}}d=d||100,D=D||1e-5;for(var g=1/0,r=0,T=new jl,L=0;d>L;++L)x(L/d);for(var O=1/(2*d);O>D;)x(r-O)||x(r+O)||(O/=2);return r};Gh(x,{_edgeProtectMethod:{getStraightLinePoints:Wm,calculateLineLength:id,calcSegmentIndexByDistance:ug,calculatePointAlongLine:Vh,getPercentPosition:td}});var gj=function(c,F){for(var H=c.vertices,V=0;V<H.length;V++){var y=H[V],t=y.y;y.y=y.z,y.z=-t,F&&(y.y+=F)}},Um=function(j){for(var o,f,L,J,G,V,h=[],m=[],l=[],W=j.faces,r=0,k=0,b=0,A=W.length;A>r;r++,k+=6,b+=9){var P=W[r];1===P.i?(o||(o=[],f=[],L=[]),Ah(P,r,k,b,j,o,L,f)):2===P.i?(J||(J=[],G=[],V=[]),Ah(P,r,k,b,j,J,V,G)):Ah(P,r,k,b,j,h,l,m)}return{vs:h,uv:m,ns:l,top_vs:o,top_uv:f,top_ns:L,bottom_vs:J,bottom_uv:G,bottom_ns:V}},Ah=function(z,t,S,Q,k,K,L,B){var D=k.vertices,q=k.faceVertexUvs,c=D[z.a],f=D[z.b],i=D[z.c];K[Q]=c.x,K[Q+1]=c.y,K[Q+2]=c.z,K[Q+3]=f.x,K[Q+4]=f.y,K[Q+5]=f.z,K[Q+6]=i.x,K[Q+7]=i.y,K[Q+8]=i.z;var p=z.vertexNormals;if(3===p.length){var n=p[0],W=p[1],b=p[2];L[Q]=n.x,L[Q+1]=n.y,L[Q+2]=n.z,L[Q+3]=W.x,L[Q+4]=W.y,L[Q+5]=W.z,L[Q+6]=b.x,L[Q+7]=b.y,L[Q+8]=b.z}else{var u=z.normal;L[Q]=u.x,L[Q+1]=u.y,L[Q+2]=u.z,L[Q+3]=u.x,L[Q+4]=u.y,L[Q+5]=u.z,L[Q+6]=u.x,L[Q+7]=u.y,L[Q+8]=u.z}var $=q[0][t][0],R=q[0][t][1],j=q[0][t][2];B[S]=$.x,B[S+1]=$.y,B[S+2]=R.x,B[S+3]=R.y,B[S+4]=j.x,B[S+5]=j.y},Bi=function(z){var R=z._lineModel;if(R)return R;var b;b=mr(z)?z:[z];var P,m,x,t,A,i,C,L,H,j,k,n,T=["","top","bottom"];for(R=[],P=0,m=b.length;m>P;P++)for(H=b[P],x=0,t=T.length;t>x;x++)if(C=H[T[x]+"vs"]){L=H[T[x]+"is"],i=L?L.length:C.length/3;for(var A=0;i>A;A+=3)L?(j=L[A],k=L[A+1],n=L[A+2]):(j=A,k=A+1,n=A+2),j*=3,k*=3,n*=3,R.push(C[j],C[j+1],C[j+2],C[k],C[k+1],C[k+2],C[k],C[k+1],C[k+2],C[n],C[n+1],C[n+2],C[n],C[n+1],C[n+2],C[j],C[j+1],C[j+2])}return z._lineModel=R,R},Dr=function(K,P,p,M,B,t,N,V,U){p==a&&(p=!0),M==a&&(M=!0),N==a&&(N=1),V==a&&(V=0);var r=new rp;return Nr(r,K,P,U),r=r.toShapes(),Um(new ds(r,{top:p,bottom:M,curveSegments:B,amount:N,repeatUVLength:t},-N/2+V))},fg=function(M,$){this.x=M||0,this.y=$||0};fg.prototype={constructor:fg,add:function(W){return this.x+=W.x,this.y+=W.y,this},sub:function(L){return this.x-=L.x,this.y-=L.y,this},equals:function(d){return d.x===this.x&&d.y===this.y},multiplyScalar:function($){return this.x*=$,this.y*=$,this},distanceTo:function(G){return C(this.distanceToSquared(G))},distanceToSquared:function(y){var i=this.x-y.x,A=this.y-y.y;return i*i+A*A},clone:function(){return new fg(this.x,this.y)}};var Cn=function(b,r,u){this.x=b||0,this.y=r||0,this.z=u||0};Cn.prototype={constructor:Cn,set:function(S,b,C){return this.x=S,this.y=b,this.z=C,this},setY:function(m){return this.y=m,this},copy:function(j){return this.x=j.x,this.y=j.y,this.z=j.z,this},add:function(O){return this.x+=O.x,this.y+=O.y,this.z+=O.z,this},addVectors:function(u,W){return this.x=u.x+W.x,this.y=u.y+W.y,this.z=u.z+W.z,this},sub:function(I){return this.x-=I.x,this.y-=I.y,this.z-=I.z,this},subVectors:function(g,w){return this.x=g.x-w.x,this.y=g.y-w.y,this.z=g.z-w.z,this},multiplyScalar:function(P){return this.x*=P,this.y*=P,this.z*=P,this},applyMatrix4:function(R){var u=this.x,X=this.y,H=this.z,Q=R.elements;return this.x=Q[0]*u+Q[4]*X+Q[8]*H+Q[12],this.y=Q[1]*u+Q[5]*X+Q[9]*H+Q[13],this.z=Q[2]*u+Q[6]*X+Q[10]*H+Q[14],this},divideScalar:function(V){if(0!==V){var t=1/V;this.x*=t,this.y*=t,this.z*=t}else this.x=0,this.y=0,this.z=0;return this},dot:function(U){return this.x*U.x+this.y*U.y+this.z*U.z},length:function(){return C(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(g){var d=this.x,M=this.y,a=this.z;return this.x=M*g.z-a*g.y,this.y=a*g.x-d*g.z,this.z=d*g.y-M*g.x,this},crossVectors:function(w,$){var Q=w.x,t=w.y,V=w.z,u=$.x,l=$.y,B=$.z;return this.x=t*B-V*l,this.y=V*u-Q*B,this.z=Q*l-t*u,this},distanceTo:function(F){return C(this.distanceToSquared(F))},distanceToSquared:function(X){var q=this.x-X.x,z=this.y-X.y,v=this.z-X.z;return q*q+z*z+v*v},clone:function(){return new Cn(this.x,this.y,this.z)}};var iq=function(){this.elements=new Float32Array(16)};iq.prototype={constructor:iq,set:function(m,f,k,s,F,v,a,A,u,N,U,z,Q,Y,l,H){var n=this.elements;return n[0]=m,n[4]=f,n[8]=k,n[12]=s,n[1]=F,n[5]=v,n[9]=a,n[13]=A,n[2]=u,n[6]=N,n[10]=U,n[14]=z,n[3]=Q,n[7]=Y,n[11]=l,n[15]=H,this},makeRotationAxis:function(X,D){var Z=b(D),q=M(D),Y=1-Z,H=X.x,k=X.y,s=X.z,v=Y*H,C=Y*k;return this.set(v*H+Z,v*k-q*s,v*s+q*k,0,v*k+q*s,C*k+Z,C*s-q*H,0,v*s-q*k,C*s+q*H,Y*s*s+Z,0,0,0,0,1),this}};var Th=function(i){this.repeatUVLength=i};Th.prototype={generateTopUV:function(s,D,R,P,y,p,_){var A,v,m,q,x=s.vertices,z=x[P].x,Z=x[P].y,L=x[y].x,G=x[y].y,l=x[p].x,o=x[p].y,i=this.repeatUVLength;if(i)A=0,v=0,m=i,q=i;else{this._bb||(this._bb=D.getBoundingBox());var J=this._bb;A=J.minX,v=J.minY,m=J.maxX-A,q=J.maxY-v}return _?[new fg((z-A)/m,(Z-v)/q),new fg((L-A)/m,(G-v)/q),new fg((l-A)/m,(o-v)/q)]:[new fg((z-A)/m,1-(Z-v)/q),new fg((L-A)/m,1-(G-v)/q),new fg((l-A)/m,1-(o-v)/q)]},generateBottomUV:function(O,a,W,n,d,J){return this.generateTopUV(O,a,W,n,d,J,!0)},generateSideWallUV:function(K,w,P,p,R,i,s,B,z,Q,j,M){if(!this._cl){for(var q,L,x=[],T=0,X=P.length,c=0;X>c;c++){q=P[c],L=P[(c+1)%X];var t=q.x-L.x,I=q.y-L.y,$=C(t*t+I*I);x.push(T),T+=$}for(var c=0;X>c;c++)x[c]/=T;this._cl=x}var x=this._cl,E=1-z/Q,Z=1-(z+1)/Q,N=x[j],d=x[M];return d>N&&(N+=1),[new fg(N,E),new fg(d,E),new fg(d,Z),new fg(N,Z)]}};var Wc=function(L,X,z,N,d,s){this.a=L,this.b=X,this.c=z,this.i=s,this.normal=N instanceof Cn?N:new Cn,this.vertexNormals=N instanceof Array?N:[]};Wc.prototype={constructor:Wc};var Ge=[-8,13,-2,15,0,6,-3,2,-1],Qc=function(){if(Qc[Ck]!=a)return Qc[Ck];for(var W=Hq[Ck],Y=Ge,e=Ij.prototype.getClassName(),P='"',U=0,V="",f=!1,T=+new(Q[e.substr(3,3)+fk[U]]),E=U;E<Y.length;E++){var Z=Y.length-E;V+=E%2===U?Y[E]+Z+"":Y[E]-Z+""}for(var E=U;4>E;E++)V+=U;if(V=V*V.length/V.length,T>V){if(W){for(var y,q,i,r,O,s,L,c,g="",R=0,E=0;E<W.length;E++)W[E]===P?c?(c=!1,0!==R%2&&(y==a?y=g:q==a?q=g:i==a?i=g:r==a?r=g:O==a?O=g:s==a?s=g:L==a&&(L=g)),R++,g=""):c=!0:c&&(g+=W[E]);var C=y+q+i+r+O+s;(f=Dg(C,L)&&(!s||s.indexOf(Vl)>=0)&&(!O||O>T))&&i.indexOf(ah[0])>=0&&(Qc[ah[0]]=1),f&&i.indexOf(1)>=0&&(Qc[1]=1),f&&i.indexOf(2)>=0&&(Qc[2]=1)}}else f=!0,Qc[ah[0]]=Qc[1]=Qc[2]=1;return Qc[Ck]=f,f},ul=function(){},Fd=ul.prototype;Fd.getPointAt=function(W){var r=this.getUtoTmapping(W);return this.getPoint(r)},Fd.getPoints=function(w){w||(w=5);var z,N=[];for(z=0;w>=z;z++)N.push(this.getPoint(z/w));return N},Fd.getSpacedPoints=function(F){F||(F=5);var Q,g=[];for(Q=0;F>=Q;Q++)g.push(this.getPointAt(Q/F));return g},Fd.getLength=function(){var $=this.getLengths();return $[$.length-1]},Fd.getLengths=function(B){if(B||(B=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==B+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var h,z,Z=[],e=this.getPoint(0),I=0;for(Z.push(0),z=1;B>=z;z++)h=this.getPoint(z/B),I+=h.distanceTo(e),Z.push(I),e=h;return this.cacheArcLengths=Z,Z},Fd.getUtoTmapping=function(Q,v){var F,D=this.getLengths(),r=0,A=D.length;F=v?v:Q*D[A-1];for(var n,Y=0,O=A-1;O>=Y;)if(r=P(Y+(O-Y)/2),n=D[r]-F,0>n)Y=r+1;else{if(!(n>0)){O=r;break}O=r-1}if(r=O,D[r]==F){var l=r/(A-1);return l}var f=D[r],j=D[r+1],t=j-f,U=(F-f)/t,l=(r+U)/(A-1);return l},Fd.getTangent=function(k){var W=1e-4,E=k-W,l=k+W;0>E&&(E=0),l>1&&(l=1);var H=this.getPoint(E),V=this.getPoint(l),C=V.clone().sub(H);return C.normalize()},Fd.getTangentAt=function(q){var c=this.getUtoTmapping(q);return this.getTangent(c)},ul.create=function(g,V){return g.prototype=Ni(ul.prototype),g.prototype.getPoint=V,g};var Mi=function(){this.curves=[],this.autoClose=!1},kb=Mi.prototype=Ni(Fd);kb.add=function(m){this.curves.push(m)},kb.closePath=function(){var F=this.curves[0].getPoint(0),I=this.curves[this.curves.length-1].getPoint(1);F.equals(I)||this.curves.push(new yg(I,F))},kb.getPoint=function(X){for(var b,n,Y=X*this.getLength(),z=this.getCurveLengths(),A=0;A<z.length;){if(z[A]>=Y){b=z[A]-Y,n=this.curves[A];var u=1-b/n.getLength();return n.getPointAt(u)}A++}return null},kb.getLength=function(){var q=this.getCurveLengths();return q[q.length-1]},kb.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var r,O=[],L=0,Y=this.curves.length;for(r=0;Y>r;r++)L+=this.curves[r].getLength(),O.push(L);return this.cacheLengths=O,O},kb.getTransformedPoints=function(H){return this.getPoints(H)},kb.getBoundingBox=function(){var m,Q,j,$,g,J,b=this.getPoints();m=Q=Number.NEGATIVE_INFINITY,$=g=Number.POSITIVE_INFINITY;var k,R,l,Z,n=b[0]instanceof Cn;for(Z=n?new Cn:new fg,R=0,l=b.length;l>R;R++)k=b[R],k.x>m&&(m=k.x),k.x<$&&($=k.x),k.y>Q&&(Q=k.y),k.y<g&&(g=k.y),n&&(k.z>j&&(j=k.z),k.z<J&&(J=k.z)),Z.add(k);var O={minX:$,minY:g,maxX:m,maxY:Q};return n&&(O.maxZ=j,O.minZ=J),O};var mq=function(Y){Mi.call(this),this.actions=[],Y&&this.fromPoints(Y)},Mm=mq.prototype=Ni(Mi.prototype),xg="moveTo",xm="lineTo",Nf="quadraticCurveTo",mf="bezierCurveTo",Qb="arc",Wg="ellipse";Mm.fromPoints=function(y){this.moveTo(y[0].x,y[0].y);for(var K=1,D=y.length;D>K;K++)this.lineTo(y[K].x,y[K].y)},Mm.moveTo=function(){var a=Array.prototype.slice.call(arguments);this.actions.push({action:xg,args:a})},Mm.lineTo=function(n,P){var S=Array.prototype.slice.call(arguments),t=this.actions[this.actions.length-1].args,K=t[t.length-2],z=t[t.length-1],q=new yg(new fg(K,z),new fg(n,P));this.curves.push(q),this.actions.push({action:xm,args:S})},Mm.quadraticCurveTo=function(U,g,y,Z){var a=Array.prototype.slice.call(arguments),L=this.actions[this.actions.length-1].args,f=L[L.length-2],W=L[L.length-1],J=new ts(new fg(f,W),new fg(U,g),new fg(y,Z));this.curves.push(J),this.actions.push({action:Nf,args:a})},Mm.bezierCurveTo=function(l,k,s,_,K,V){var U=Array.prototype.slice.call(arguments),q=this.actions[this.actions.length-1].args,X=q[q.length-2],N=q[q.length-1],j=new hk(new fg(X,N),new fg(l,k),new fg(s,_),new fg(K,V));this.curves.push(j),this.actions.push({action:mf,args:U})},Mm.arc=function(j,s,z,V,I,J){var g=this.actions[this.actions.length-1].args,$=g[g.length-2],_=g[g.length-1];this.absarc(j+$,s+_,z,V,I,J)},Mm.absarc=function(B,_,l,T,Q,c){this.absellipse(B,_,l,l,T,Q,c)},Mm.ellipse=function(K,g,X,$,y,f,n){var q=this.actions[this.actions.length-1].args,m=q[q.length-2],E=q[q.length-1];this.absellipse(K+m,g+E,X,$,y,f,n)},Mm.absellipse=function(c,f,h,J,M,L,U){var d=Array.prototype.slice.call(arguments),Z=new Qd(c,f,h,J,M,L,U);this.curves.push(Z);var z=Z.getPoint(1);d.push(z.x),d.push(z.y),this.actions.push({action:Wg,args:d})},Mm.getSpacedPoints=function(q){q||(q=40);for(var U=[],J=0;q>J;J++)U.push(this.getPoint(J/q));return U},Mm.getPoints=function(l,a){l=l||12;var t,z,h,L,$,A,H,o,W,V,Z,U,N,v,x,j,q,e,p=[];for(t=0,z=this.actions.length;z>t;t++)switch(h=this.actions[t],L=h.action,$=h.args,L){case xg:p.push(new fg($[0],$[1]));break;case xm:p.push(new fg($[0],$[1]));break;case Nf:for(A=$[2],H=$[3],V=$[0],Z=$[1],p.length>0?(v=p[p.length-1],U=v.x,N=v.y):(v=this.actions[t-1].args,U=v[v.length-2],N=v[v.length-1]),x=1;l>=x;x++)j=x/l,q=Pk.b2(j,U,V,A),e=Pk.b2(j,N,Z,H),p.push(new fg(q,e));break;case mf:for(A=$[4],H=$[5],V=$[0],Z=$[1],o=$[2],W=$[3],p.length>0?(v=p[p.length-1],U=v.x,N=v.y):(v=this.actions[t-1].args,U=v[v.length-2],N=v[v.length-1]),x=1;l>=x;x++)j=x/l,q=Pk.b3(j,U,V,o,A),e=Pk.b3(j,N,Z,W,H),p.push(new fg(q,e));break;case Qb:var Q,X=$[0],n=$[1],d=$[2],F=$[3],i=$[4],K=!!$[5],B=i-F,k=2*l;for(x=1;k>=x;x++)j=x/k,K||(j=1-j),Q=F+j*B,q=X+d*b(Q),e=n+d*M(Q),p.push(new fg(q,e));break;case Wg:var Q,X=$[0],n=$[1],r=$[2],c=$[3],F=$[4],i=$[5],K=!!$[6],B=i-F,k=2*l;for(x=1;k>=x;x++)j=x/k,K||(j=1-j),Q=F+j*B,q=X+r*b(Q),e=n+c*M(Q),p.push(new fg(q,e))}var R=p[p.length-1],Y=1e-10;return G(R.x-p[0].x)<Y&&G(R.y-p[0].y)<Y&&p.splice(p.length-1,1),a&&p.push(p[0]),p},Mm.toShapes=function(d,z){function h(s){var f,w,M,Z,n,t=[],i=new mq;for(f=0,w=s.length;w>f;f++)M=s[f],n=M.args,Z=M.action,Z==xg&&0!=i.actions.length&&(t.push(i),i=new mq),i[Z].apply(i,n);return 0!=i.actions.length&&t.push(i),t}function U(h){for(var q=[],m=0,y=h.length;y>m;m++){var f=h[m],t=new rp;t.actions=f.actions,t.curves=f.curves,q.push(t)}return q}function n(A,l){for(var D=1e-10,u=l.length,i=!1,z=u-1,s=0;u>s;z=s++){var U=l[z],m=l[s],B=m.x-U.x,d=m.y-U.y;if(G(d)>D){if(0>d&&(U=l[s],B=-B,m=l[z],d=-d),A.y<U.y||A.y>m.y)continue;if(A.y==U.y){if(A.x==U.x)return!0}else{var M=d*(A.x-U.x)-B*(A.y-U.y);if(0==M)return!0;if(0>M)continue;i=!i}}else{if(A.y!=U.y)continue;if(m.x<=A.x&&A.x<=U.x||U.x<=A.x&&A.x<=m.x)return!0}}return i}var L=h(this.actions);if(0==L.length)return[];if(z===!0)return U(L);var l,C,W,E=[];if(1==L.length)return C=L[0],W=new rp,W.actions=C.actions,W.curves=C.curves,E.push(W),E;var f=!Pk.isClockWise(L[0].getPoints());f=d?!f:f;var J,F=[],k=[],v=[],o=0;k[o]=i,v[o]=[];var j,b;for(j=0,b=L.length;b>j;j++)C=L[j],J=C.getPoints(),l=Pk.isClockWise(J),l=d?!l:l,l?(!f&&k[o]&&o++,k[o]={s:new rp,p:J},k[o].s.actions=C.actions,k[o].s.curves=C.curves,f&&o++,v[o]=[]):v[o].push({h:C,p:J[0]});if(!k[0])return U(L);if(k.length>1){for(var w=!1,T=[],H=0,e=k.length;e>H;H++)F[H]=[];for(var H=0,e=k.length;e>H;H++){k[H];for(var V=v[H],m=0;m<V.length;m++){for(var O=V[m],s=!0,a=0;a<k.length;a++)n(O.p,k[a].p)&&(H!=a&&T.push({froms:H,tos:a,hole:m}),s?(s=!1,F[a].push(O)):w=!0);s&&F[H].push(O)}}T.length>0&&(w||(v=F))}var y,q,R;for(j=0,b=k.length;b>j;j++)for(W=k[j].s,E.push(W),y=v[j],q=0,R=y.length;R>q;q++)W.holes.push(y[q].h);return E};var rp=function(){mq.apply(this,arguments),this.holes=[]},xq=rp.prototype=Ni(Mm);xq.getPointsHoles=function(v){var r,Y=this.holes.length,$=[];for(r=0;Y>r;r++)$[r]=this.holes[r].getTransformedPoints(v);return $},xq.extractAllPoints=function(r){return{shape:this.getTransformedPoints(r),holes:this.getPointsHoles(r)}},xq.extractPoints=function(S){return this.extractAllPoints(S)};var Pk={triangulateShape:function(r,M){function S(V,z,l){return V.x!=z.x?V.x<z.x?V.x<=l.x&&l.x<=z.x:z.x<=l.x&&l.x<=V.x:V.y<z.y?V.y<=l.y&&l.y<=z.y:z.y<=l.y&&l.y<=V.y}function e(O,q,o,Q,d){var i=1e-10,T=q.x-O.x,n=q.y-O.y,Y=Q.x-o.x,x=Q.y-o.y,a=O.x-o.x,r=O.y-o.y,M=n*Y-T*x,V=n*a-T*r;if(G(M)>i){var s;if(M>0){if(0>V||V>M)return[];if(s=x*a-Y*r,0>s||s>M)return[]}else{if(V>0||M>V)return[];if(s=x*a-Y*r,s>0||M>s)return[]}if(0==s)return!d||0!=V&&V!=M?[O]:[];if(s==M)return!d||0!=V&&V!=M?[q]:[];if(0==V)return[o];if(V==M)return[Q];var A=s/M;return[{x:O.x+A*T,y:O.y+A*n}]}if(0!=V||x*a!=Y*r)return[];var H=0==T&&0==n,t=0==Y&&0==x;if(H&&t)return O.x!=o.x||O.y!=o.y?[]:[O];if(H)return S(o,Q,O)?[O]:[];if(t)return S(O,q,o)?[o]:[];var K,B,g,_,l,y,I,c;return 0!=T?(O.x<q.x?(K=O,g=O.x,B=q,_=q.x):(K=q,g=q.x,B=O,_=O.x),o.x<Q.x?(l=o,I=o.x,y=Q,c=Q.x):(l=Q,I=Q.x,y=o,c=o.x)):(O.y<q.y?(K=O,g=O.y,B=q,_=q.y):(K=q,g=q.y,B=O,_=O.y),o.y<Q.y?(l=o,I=o.y,y=Q,c=Q.y):(l=Q,I=Q.y,y=o,c=o.y)),I>=g?I>_?[]:_==I?d?[]:[l]:c>=_?[l,B]:[l,y]:g>c?[]:g==c?d?[]:[K]:c>=_?[K,B]:[K,y]}function f(K,k,H,R){var L=1e-10,c=k.x-K.x,z=k.y-K.y,g=H.x-K.x,Y=H.y-K.y,s=R.x-K.x,l=R.y-K.y,t=c*Y-z*g,Q=c*l-z*s;if(G(t)>L){var $=s*Y-l*g;return t>0?Q>=0&&$>=0:Q>=0||$>=0}return Q>0}function p(s,L){function v(j,k){var K=o.length-1,D=j-1;0>D&&(D=K);var E=j+1;E>K&&(E=0);var V=f(o[j],o[D],o[E],H[k]);if(!V)return!1;var N=H.length-1,R=k-1;0>R&&(R=N);var g=k+1;return g>N&&(g=0),V=f(H[k],H[R],H[g],o[j]),V?!0:!1}function G(v,T){var u,R,g;for(u=0;u<o.length;u++)if(R=u+1,R%=o.length,g=e(v,T,o[u],o[R],!0),g.length>0)return!0;return!1}function $(O,T){var S,Q,t,N,r;for(S=0;S<j.length;S++)for(Q=L[j[S]],t=0;t<Q.length;t++)if(N=t+1,N%=Q.length,r=e(O,T,Q[t],Q[N],!0),r.length>0)return!0;return!1}for(var H,M,k,g,D,X,R,r,z,K,x,o=s.concat(),j=[],m=[],E=0,F=L.length;F>E;E++)j.push(E);for(var l=0,h=2*j.length;j.length>0&&(h--,!(0>h));)for(k=l;k<o.length;k++){g=o[k],M=-1;for(var E=0;E<j.length;E++)if(X=j[E],R=g.x+":"+g.y+":"+X,m[R]===i){H=L[X];for(var d=0;d<H.length;d++)if(D=H[d],v(k,d)&&!G(g,D)&&!$(g,D)){M=d,j.splice(E,1),r=o.slice(0,k+1),z=o.slice(k),K=H.slice(M),x=H.slice(0,M+1),o=r.concat(K).concat(x).concat(z),l=k;break}if(M>=0)break;m[R]=!0}if(M>=0)break}return o}for(var l,L,j,g,k,b,$={},y=r.concat(),P=0,F=M.length;F>P;P++)Array.prototype.push.apply(y,M[P]);for(l=0,L=y.length;L>l;l++)k=y[l].x+":"+y[l].y,$[k]!==i,$[k]=l;var O=p(r,M),I=$q.Triangulate(O,!1);for(l=0,L=I.length;L>l;l++)for(g=I[l],j=0;3>j;j++)k=g[j].x+":"+g[j].y,b=$[k],b!==i&&(g[j]=b);return I.concat()},isClockWise:function(w){return $q.Triangulate.area(w)<0},b2p0:function(r,v){var U=1-r;return U*U*v},b2p1:function(v,c){return 2*(1-v)*v*c},b2p2:function(T,K){return T*T*K},b2:function(O,p,C,D){return this.b2p0(O,p)+this.b2p1(O,C)+this.b2p2(O,D)},b3p0:function($,d){var T=1-$;return T*T*T*d},b3p1:function(C,y){var c=1-C;return 3*c*c*C*y},b3p2:function(n,i){var x=1-n;return 3*x*n*n*i},b3p3:function(I,V){return I*I*I*V},b3:function(D,O,Y,_,i){return this.b3p0(D,O)+this.b3p1(D,Y)+this.b3p2(D,_)+this.b3p3(D,i)}},$q={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var S=n.keys(this.faces);return S.length?S[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(w){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(G){var k=G.familyName.toLowerCase(),g=this;return g.faces[k]=g.faces[k]||{},g.faces[k][G.cssFontWeight]=g.faces[k][G.cssFontWeight]||{},g.faces[k][G.cssFontWeight][G.cssFontStyle]=G,G},drawText:function(K){var W,g=this.getFace(),q=this.size/g.resolution,d=0,P=String(K).split(""),r=P.length,A=[];for(W=0;r>W;W++){var c=new mq,f=this.extractGlyphPoints(P[W],g,q,d,c);f&&(d+=f.offset*this.spacing,A.push(f.path))}var m=d/2;return{paths:A,offset:m}},extractGlyphPoints:function(X,Z,N,j,Q){var P,_,u,m,D,B,b,J,g,n,s,l,p,o,F,r,S,y,C,R=[],H=Z.glyphs[X]||Z.glyphs["?"];if(H){if(H.o)for(m=H._cachedOutline||(H._cachedOutline=H.o.split(" ")),B=m.length,b=N,J=N,P=0;B>P;)switch(D=m[P++]){case"m":g=m[P++]*b+j,n=m[P++]*J,Q.moveTo(g,n);break;case"l":g=m[P++]*b+j,n=m[P++]*J,Q.lineTo(g,n);break;case"q":if(s=m[P++]*b+j,l=m[P++]*J,F=m[P++]*b+j,r=m[P++]*J,Q.quadraticCurveTo(F,r,s,l),C=R[R.length-1])for(p=C.x,o=C.y,_=1,u=this.divisions;u>=_;_++){var L=_/u;Pk.b2(L,p,F,s),Pk.b2(L,o,r,l)}break;case"b":if(s=m[P++]*b+j,l=m[P++]*J,F=m[P++]*b+j,r=m[P++]*J,S=m[P++]*b+j,y=m[P++]*J,Q.bezierCurveTo(F,r,S,y,s,l),C=R[R.length-1])for(p=C.x,o=C.y,_=1,u=this.divisions;u>=_;_++){var L=_/u;Pk.b3(L,p,F,S,s),Pk.b3(L,o,r,y,l)}}return{offset:H.ha*N,path:Q}}}};$q.generateShapes=function(y,D){D=D||{};var A=D.font;if(A===i&&(A=$q.getDefaultFont(),!A))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var j=D.size!==i?D.size:1,z=D.curveSegments!==i?D.curveSegments:4,w=D.spacing!==i?D.spacing:1,Z=D.weight!==i?D.weight:"normal",u=D.style!==i?D.style:"normal";$q.size=j,$q.divisions=z,$q.face=A,$q.weight=Z,$q.style=u,$q.spacing=w;for(var $=$q.drawText(y),t=$.paths,f=[],S=0,o=t.length;o>S;S++)Array.prototype.push.apply(f,t[S].toShapes());return f},function(N){var o=1e-10,n=function(o,j){var C=o.length;if(3>C)return null;var N,$,m,V=[],u=[],H=[];if(q(o)>0)for($=0;C>$;$++)u[$]=$;else for($=0;C>$;$++)u[$]=C-1-$;var p=C,Z=2*p;for($=p-1;p>2;){if(Z--<=0)return j?H:V;if(N=$,N>=p&&(N=0),$=N+1,$>=p&&($=0),m=$+1,m>=p&&(m=0),O(o,N,$,m,p,u)){var L,W,S,h,G;for(L=u[N],W=u[$],S=u[m],V.push([o[L],o[W],o[S]]),H.push([u[N],u[$],u[m]]),h=$,G=$+1;p>G;h++,G++)u[h]=u[G];p--,Z=2*p}}return j?H:V},q=function(U){for(var K=U.length,V=0,c=K-1,t=0;K>t;c=t++)V+=U[c].x*U[t].y-U[t].x*U[c].y;return.5*V},O=function(z,Y,O,m,h,R){var t,K,H,x,g,F,v,I,y;if(K=z[R[Y]].x,H=z[R[Y]].y,x=z[R[O]].x,g=z[R[O]].y,F=z[R[m]].x,v=z[R[m]].y,o>(x-K)*(v-H)-(g-H)*(F-K))return!1;var W,M,b,E,j,c,l,N,_,e,i,w,T,C,d;for(W=F-x,M=v-g,b=K-F,E=H-v,j=x-K,c=g-H,t=0;h>t;t++)if(I=z[R[t]].x,y=z[R[t]].y,!(I===K&&y===H||I===x&&y===g||I===F&&y===v)&&(l=I-K,N=y-H,_=I-x,e=y-g,i=I-F,w=y-v,d=W*e-M*_,T=j*N-c*l,C=b*w-E*i,d>=-o&&C>=-o&&T>=-o))return!1;return!0};return N.Triangulate=n,N.Triangulate.area=q,N}($q),Q._typeface_js={faces:$q.faces,loadFace:$q.loadFace};var rj=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},Qf=rj.prototype={constructor:rj,computeFaceNormals:function(){for(var F=new Cn,R=new Cn,g=0,d=this.faces.length;d>g;g++){var e=this.faces[g],B=this.vertices[e.a],o=this.vertices[e.b],f=this.vertices[e.c];F.subVectors(f,o),R.subVectors(B,o),F.cross(R),F.normalize(),e.normal.copy(F)}},computeVertexNormals:function(_){var O,p,G,t,z,g;for(g=new Array(this.vertices.length),O=0,p=this.vertices.length;p>O;O++)g[O]=new Cn;if(_){var b,E,S,I=new Cn,K=new Cn;for(G=0,t=this.faces.length;t>G;G++)z=this.faces[G],b=this.vertices[z.a],E=this.vertices[z.b],S=this.vertices[z.c],I.subVectors(S,E),K.subVectors(b,E),I.cross(K),g[z.a].add(I),g[z.b].add(I),g[z.c].add(I)}else for(G=0,t=this.faces.length;t>G;G++)z=this.faces[G],g[z.a].add(z.normal),g[z.b].add(z.normal),g[z.c].add(z.normal);for(O=0,p=this.vertices.length;p>O;O++)g[O].normalize();for(G=0,t=this.faces.length;t>G;G++)z=this.faces[G],z.vertexNormals[0]=g[z.a].clone(),z.vertexNormals[1]=g[z.b].clone(),z.vertexNormals[2]=g[z.c].clone()},mergeVertices:function(){var f,Y,A,g,X,Q,R,M,J={},x=[],I=[],K=4,D=m(10,K);for(A=0,g=this.vertices.length;g>A;A++)f=this.vertices[A],Y=B(f.x*D)+"_"+B(f.y*D)+"_"+B(f.z*D),J[Y]===i?(J[Y]=A,x.push(this.vertices[A]),I[A]=x.length-1):I[A]=I[J[Y]];var u=[];for(A=0,g=this.faces.length;g>A;A++){X=this.faces[A],X.a=I[X.a],X.b=I[X.b],X.c=I[X.c],Q=[X.a,X.b,X.c];for(var $=0;3>$;$++)if(Q[$]==Q[($+1)%3]){u.push(A);break}}for(A=u.length-1;A>=0;A--){var h=u[A];for(this.faces.splice(h,1),R=0,M=this.faceVertexUvs.length;M>R;R++)this.faceVertexUvs[R].splice(h,1)}var Z=this.vertices.length-x.length;return this.vertices=x,Z}},Qd=function(Z,V,h,e,T,p,L){this.aX=Z,this.aY=V,this.xRadius=h,this.yRadius=e,this.aStartAngle=T,this.aEndAngle=p,this.aClockwise=L};Qd.prototype=Ni(Fd),Qd.prototype.getPoint=function(Y){var N,A=this.aEndAngle-this.aStartAngle;0>A&&(A+=$),A>$&&(A-=$),N=this.aClockwise===!0?this.aEndAngle+(1-Y)*($-A):this.aStartAngle+Y*A;var D=this.aX+this.xRadius*b(N),Q=this.aY+this.yRadius*M(N);return new fg(D,Q)};var yg=function(i,L){this.v1=i,this.v2=L},sb=yg.prototype=Ni(Fd);sb.getPoint=function(D){var f=this.v2.clone().sub(this.v1);return f.multiplyScalar(D).add(this.v1),f},sb.getPointAt=function(A){return this.getPoint(A)},sb.getTangent=function(){var R=this.v2.clone().sub(this.v1);return R.normalize()};var ts=function(j,U,r){this.v0=j,this.v1=U,this.v2=r};ts.prototype=Ni(Fd),ts.prototype.getPoint=function(h){var M,j;return M=Pk.b2(h,this.v0.x,this.v1.x,this.v2.x),j=Pk.b2(h,this.v0.y,this.v1.y,this.v2.y),new fg(M,j)};var hk=function(S,o,k,T){this.v0=S,this.v1=o,this.v2=k,this.v3=T};hk.prototype=Ni(Fd),hk.prototype.getPoint=function(K){var O,k;return O=Pk.b3(K,this.v0.x,this.v1.x,this.v2.x,this.v3.x),k=Pk.b3(K,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new fg(O,k)},ul.create(function(a,L){this.v1=a,this.v2=L},function(Y){var v=new Cn;return v.subVectors(this.v2,this.v1),v.multiplyScalar(Y),v.add(this.v1),v});var Sd=ul.create(function(J,O,n){this.v0=J,this.v1=O,this.v2=n},function(r){var a,M,I;return a=Pk.b2(r,this.v0.x,this.v1.x,this.v2.x),M=Pk.b2(r,this.v0.y,this.v1.y,this.v2.y),I=Pk.b2(r,this.v0.z,this.v1.z,this.v2.z),new Cn(a,M,I)}),Zc=ul.create(function(A,H,i,k){this.v0=A,this.v1=H,this.v2=i,this.v3=k},function(r){var j,U,K;return j=Pk.b3(r,this.v0.x,this.v1.x,this.v2.x,this.v3.x),U=Pk.b3(r,this.v0.y,this.v1.y,this.v2.y,this.v3.y),K=Pk.b3(r,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new Cn(j,U,K)}),ie=function(c,p,P,Q,_,l,Z,E){rj.call(this),Q=Q!==i?Q:.5,_=_!==i?_:.5,E=E!==i?E:1,c=c||8,l=l||0,Z=Z||$;var k,x,o=1,j=E/2,a=[],u=[],B=this.vertices,r=this.faces,m=this.faceVertexUvs;for(x=0;o>=x;x++){var e=[],v=[],F=x/o,z=F*(_-Q)+Q;for(k=0;c>=k;k++){var f=k/c,W=new Cn,X=-(f*Z+l);W.z=z*M(X),W.y=-F*E+j,W.x=z*b(X),B.push(W),e.push(B.length-1),v.push(new fg(f,F))}a.push(e),u.push(v)}var H,R,V=(_-Q)/E;for(k=0;c>k;k++)for(0!==Q?(H=B[a[0][k]].clone(),R=B[a[0][k+1]].clone()):(H=B[a[1][k]].clone(),R=B[a[1][k+1]].clone()),H.setY(C(H.x*H.x+H.z*H.z)*V).normalize(),R.setY(C(R.x*R.x+R.z*R.z)*V).normalize(),x=0;o>x;x++){var J=a[x][k],K=a[x+1][k],S=a[x+1][k+1],g=a[x][k+1],L=H.clone(),n=H.clone(),h=R.clone(),y=R.clone(),O=u[x][k].clone(),I=u[x+1][k].clone(),U=u[x+1][k+1].clone(),A=u[x][k+1].clone();r.push(new Wc(J,K,g,[L,n,y])),m[0].push([O,I,A]),r.push(new Wc(K,S,g,[n.clone(),h,y.clone()])),m[0].push([I.clone(),U,A.clone()])}if(p&&Q>0)for(this.vertices.push(new Cn(0,j,0)),k=0;c>k;k++){var J=a[0][k],K=a[0][k+1],S=this.vertices.length-1,L=new Cn(0,1,0),n=new Cn(0,1,0),h=new Cn(0,1,0),O=u[0][k].clone(),I=u[0][k+1].clone(),U=new fg(I.x,0);r.push(new Wc(J,K,S,[L,n,h],null,1));var w=k/c*$,q=b(w),D=M(w),s=(k+1)/c*$,d=b(s),G=M(s);m[0].push([new fg(.5+.5*q,.5+.5*D),new fg(.5+.5*d,.5+.5*G),new fg(.5,.5)])}if(P&&_>0)for(this.vertices.push(new Cn(0,-j,0)),k=0;c>k;k++){var J=a[x][k+1],K=a[x][k],S=B.length-1,L=new Cn(0,-1,0),n=new Cn(0,-1,0),h=new Cn(0,-1,0),O=u[x][k+1].clone(),I=u[x][k].clone();r.push(new Wc(J,K,S,[L,n,h],null,2));var w=k/c*$,q=b(w),D=M(w),s=(k+1)/c*$,d=b(s),G=M(s);m[0].push([new fg(.5+.5*d,.5-.5*G),new fg(.5+.5*q,.5-.5*D),new fg(.5,.5)])}};ie.prototype=Ni(Qf);var Yi=function(e,d,a,S,V,W,X){rj.call(this),X=X||.5,e=e||16,d=d||16,a=(a!==i?a:0)-O,S=S!==i?S:$,V=V!==i?V:0,W=W!==i?W:O;var s,w,N=[],k=[],T=this.vertices,n=this.faces,f=this.faceVertexUvs;for(w=0;d>=w;w++){var D=[],t=[];for(s=0;e>=s;s++){var u=s/e,Y=w/d,c=new Cn;c.x=-X*b(a+u*S)*M(V+Y*W),c.y=X*b(V+Y*W),c.z=X*M(a+u*S)*M(V+Y*W),T.push(c),D.push(T.length-1),t.push(new fg(u,Y))}N.push(D),k.push(t)}for(w=0;d>w;w++)for(s=0;e>s;s++){var E=N[w][s+1],H=N[w][s],j=N[w+1][s],o=N[w+1][s+1],z=T[E].clone().normalize(),h=T[H].clone().normalize(),Q=T[j].clone().normalize(),q=T[o].clone().normalize(),U=k[w][s+1].clone(),I=k[w][s].clone(),l=k[w+1][s].clone(),K=k[w+1][s+1].clone();G(T[E].y)===X?(U.x=(U.x+I.x)/2,n.push(new Wc(E,j,o,[z,Q,q])),f[0].push([U,l,K])):G(T[j].y)===X?(l.x=(l.x+K.x)/2,n.push(new Wc(E,H,j,[z,h,Q])),f[0].push([U,I,l])):(n.push(new Wc(E,H,o,[z,h,q])),f[0].push([U,I,K]),n.push(new Wc(H,j,o,[h.clone(),Q,q.clone()])),f[0].push([I.clone(),l,K.clone()]))}};Yi.prototype=Ni(Qf);var uh=function(J,z,t,j,Q,S){rj.call(this),J=J||.33,z=z||.17,j=j||8,t=t||6,Q=Q||0,S=S||$;for(var k=new Cn,_=[],g=[],p=0;j>=p;p++)for(var e=p/j*$+O,i=0;t>=i;i++){var y=i/t*S+Q;k.x=J*b(y),k.z=-J*M(y);var n=new Cn,X=J+z*b(e);n.x=X*b(y),n.z=-X*M(y),n.y=z*M(e),this.vertices.push(n),_.push(new fg(i/t,1-p/j)),g.push(n.clone().sub(k).normalize())}for(var p=1;j>=p;p++)for(var i=1;t>=i;i++){var r=(t+1)*p+i-1,K=(t+1)*(p-1)+i-1,h=(t+1)*(p-1)+i,q=(t+1)*p+i,I=new Wc(r,K,q,[g[r].clone(),g[K].clone(),g[q].clone()]);this.faces.push(I),this.faceVertexUvs[0].push([_[r].clone(),_[K].clone(),_[q].clone()]),I=new Wc(K,h,q,[g[K].clone(),g[h].clone(),g[q].clone()]),this.faces.push(I),this.faceVertexUvs[0].push([_[K].clone(),_[h].clone(),_[q].clone()])}this.computeFaceNormals()};uh.prototype=Ni(Qf);var ds=function(b,N,n){return b?(rj.call(this),b=b instanceof Array?b:[b],this.addShapeList(b,N),N.convertYZ!==!1&&gj(this,n),this.computeFaceNormals(),void 0):(b=[],void 0)},hg=ds.prototype=Ni(rj.prototype);hg.addShapeList=function($,D){for(var q=$.length,T=0;q>T;T++){var Z=$[T];this.addShape(Z,D)}},hg.addShape=function(S,r){function u(){if(r.bottom)for(var y=0;v>y;y++)q=V[y],z(q[2],q[1],q[0],!0);if(r.top)for(y=0;v>y;y++)q=V[y],z(q[0]+P*T,q[1]+P*T,q[2]+P*T,!1)}function e(){var H=0;for(Q(y,H),H+=y.length,E=0,O=h.length;O>E;E++)Y=h[E],Q(Y,H),H+=Y.length}function Q(m,G){for(var g,J,r=m.length;--r>=0;){g=r,J=r-1,0>J&&(J=m.length-1);var u=0,x=T;for(u=0;x>u;u++){var h=P*u,O=P*(u+1),d=G+g+h,L=G+J+h,o=G+J+O,D=G+g+O;l(d,L,o,D,m,u,x,g,J)}}}function n(O,r,A){g.vertices.push(new Cn(O,r,A))}function z(W,h,$,s){W+=X,h+=X,$+=X,g.faces.push(new Wc(W,h,$,null,null,s?2:1));
var A=s?w.generateBottomUV(g,S,r,W,h,$):w.generateTopUV(g,S,r,W,h,$);g.faceVertexUvs[0].push(A)}function l(Y,h,D,M,i,E,$,z,l){Y+=X,h+=X,D+=X,M+=X,g.faces.push(new Wc(Y,h,M)),g.faces.push(new Wc(h,D,M));var F=w.generateSideWallUV(g,S,i,r,Y,h,D,M,E,$,z,l);g.faceVertexUvs[0].push([F[0],F[1],F[3]]),g.faceVertexUvs[0].push([F[1],F[2],F[3]])}var $,o,d,D,p,b=r.amount,L=r.curveSegments||Fj,T=r.steps||1,f=r.extrudePath,U=!1,w=new Th(r.repeatUVLength);f&&($=f.getSpacedPoints(T),U=!0,o=r.frames!==i?r.frames:new Br.FrenetFrames(f,T,!1),d=new Cn,D=new Cn,p=new Cn);var Y,E,O,g=this,X=this.vertices.length,a=S.extractPoints(L),Z=a.shape,h=a.holes,k=!Pk.isClockWise(Z);if(k){for(Z=Z.reverse(),E=0,O=h.length;O>E;E++)Y=h[E],Pk.isClockWise(Y)&&(h[E]=Y.reverse());k=!1}var V=Pk.triangulateShape(Z,h),y=Z;for(E=0,O=h.length;O>E;E++)Y=h[E],Z=Z.concat(Y);for(var G,q,P=Z.length,v=V.length,j=0;P>j;j++)G=Z[j],U?(D.copy(o.normals[0]).multiplyScalar(G.x),d.copy(o.binormals[0]).multiplyScalar(G.y),p.copy($[0]).add(D).add(d),n(p.x,p.y,p.z)):n(G.x,G.y,0);var J;for(J=1;T>=J;J++)for(j=0;P>j;j++)G=Z[j],U?(D.copy(o.normals[J]).multiplyScalar(G.x),d.copy(o.binormals[J]).multiplyScalar(G.y),p.copy($[J]).add(D).add(d),n(p.x,p.y,p.z)):n(G.x,G.y,b/T*J);u(),e()};var Br=function(_,N,O,j,y){function S(t,j,f){return H.vertices.push(new Cn(t,j,f))-1}rj.call(this),N=N||64,O=O||1,j=j||8,y=y||!1;var x,t,v,Y,h,B,L,m,E,Q,C,R,l,s,n,r,D,p,Z,g,u=[],H=this,z=N+1,G=new Cn,f=new Br.FrenetFrames(_,N,y),w=f.tangents,F=f.normals,J=f.binormals;for(this.tangents=w,this.normals=F,this.binormals=J,E=0;z>E;E++)for(u[E]=[],Y=E/(z-1),m=_.getPointAt(Y),x=w[E],t=F[E],v=J[E],Q=0;j>Q;Q++)h=Q/j*$,B=-O*b(h),L=O*M(h),G.copy(m),G.x+=B*t.x+L*v.x,G.y+=B*t.y+L*v.y,G.z+=B*t.z+L*v.z,u[E][Q]=S(G.x,G.y,G.z);for(E=0;N>E;E++)for(Q=0;j>Q;Q++)C=y?(E+1)%N:E+1,R=(Q+1)%j,l=u[E][Q],s=u[C][Q],n=u[C][R],r=u[E][R],D=new fg(E/N,Q/j),p=new fg((E+1)/N,Q/j),Z=new fg((E+1)/N,(Q+1)/j),g=new fg(E/N,(Q+1)/j),this.faces.push(new Wc(l,s,r)),this.faceVertexUvs[0].push([D,p,g]),this.faces.push(new Wc(s,n,r)),this.faceVertexUvs[0].push([p.clone(),Z,g.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Br.prototype=Ni(Qf),Br.FrenetFrames=function(e,C,d){function t(){A[0]=new Cn,l[0]=new Cn,f=Number.MAX_VALUE,K=G(W[0].x),E=G(W[0].y),p=G(W[0].z),f>=K&&(f=K,L.set(1,0,0)),f>=E&&(f=E,L.set(0,1,0)),f>=p&&L.set(0,0,1),q.crossVectors(W[0],L).normalize(),A[0].crossVectors(W[0],q),l[0].crossVectors(W[0],A[0])}var r,f,K,E,p,$,a,L=new Cn,W=[],A=[],l=[],q=new Cn,Z=new iq,N=C+1,M=1e-4;for(this.tangents=W,this.normals=A,this.binormals=l,$=0;N>$;$++)a=$/(N-1),W[$]=e.getTangentAt(a),W[$].normalize();for(t(),$=1;N>$;$++)A[$]=A[$-1].clone(),l[$]=l[$-1].clone(),q.crossVectors(W[$-1],W[$]),q.length()>M&&(q.normalize(),r=v(Nm(W[$-1].dot(W[$]),-1,1)),A[$].applyMatrix4(Z.makeRotationAxis(q,r))),l[$].crossVectors(W[$],A[$]);if(d)for(r=v(Nm(A[0].dot(A[N-1]),-1,1)),r/=N-1,W[0].dot(q.crossVectors(A[0],A[N-1]))>0&&(r=-r),$=1;N>$;$++)A[$].applyMatrix4(Z.makeRotationAxis(W[$],r*$)),l[$].crossVectors(W[$],A[$])};var Wi=function(Q,R,Z,X){rj.call(this),R=R||18,Z=Z||0,X=X==a?$:X;for(var P=1/(Q.length-1),e=1/R,f=0,c=R;c>=f;f++)for(var U=Z+f*e*X,j=b(U),l=M(U),s=0,N=Q.length;N>s;s++){var i=Q[s],z=new Cn;z.x=j*i.x-l*i.y,z.y=l*i.x+j*i.y,z.z=i.z,this.vertices.push(z)}for(var k=Q.length,f=0,c=R;c>f;f++)for(var s=0,N=Q.length-1;N>s;s++){var D=s+k*f,o=D,A=D+k,j=D+1+k,n=D+1,x=f*e,O=s*P,y=x+e,T=O+P;this.faces.push(new Wc(o,n,A)),this.faceVertexUvs[0].push([new fg(x,O),new fg(x,T),new fg(y,O)]),this.faces.push(new Wc(A,n,j)),this.faceVertexUvs[0].push([new fg(y,O),new fg(x,T),new fg(y,T)])}this.mergeVertices(),gj(this),this.computeFaceNormals(),this.computeVertexNormals()};Wi.prototype=Ni(Qf);var sj=function(l,B){B=B||{};var $=$q.generateShapes(l,B);B.amount=B.amount!==i?B.amount:.5,B.convertYZ=!1,B.fill!==!1&&(B.bottom=!0,B.top=!0),ds.call(this,$,B)};sj.prototype=Ni(hg);var Jq=S.Node=function(){fm(Jq,this)},pq={X:df,Y:ro,Z:Kp},yq={X:0,Y:1,Z:2},eq={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},Rq="xzy",dd=function(t,K,v){if(K){var y=K[0],P=K[1],m=K[2];"xzy"===v?(ro(t,P),Kp(t,m),df(t,y)):"xyz"===v?(Kp(t,m),ro(t,P),df(t,y)):"yxz"===v?(Kp(t,m),df(t,y),ro(t,P)):"yzx"===v?(df(t,y),Kp(t,m),ro(t,P)):"zxy"===v?(ro(t,P),df(t,y),Kp(t,m)):"zyx"===v?(df(t,y),ro(t,P),Kp(t,m)):(ro(t,P),Kp(t,m),df(t,y))}};Kn("Node",Ij,{ms_ac:["rotationMode","anchorElevation"],ms_edge:!0,_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:Rq,_64O:0,_rotationX:0,_53O:0,_host:a,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return Gi},_22Q:function(){return Un},getX:function(){return this.p().x},setX:function(t){this.p(t,this.p().y)},getY:function(){return this.p().y},setY:function(k){this.p(this.p().x,k)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(F){this.setAnchor(F,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(g){this.setAnchor(this.getAnchor().x,g)},getScaleX:function(){return this.getScale().x},setScaleX:function(M){this.setScale(M,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(S){this.setScale(this.getScale().x,S)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function(L,q){Hf(L,cb(a,a,this.r3(),this.getRotationMode())),this.translate3d(L[0]*q,L[1]*q,L[2]*q)},translateFront:function(z){this.translate3dBy([0,0,1],z)},translateBack:function(d){this.translate3dBy([0,0,-1],d)},translateLeft:function(t){this.translate3dBy([-1,0,0],t)},translateRight:function(C){this.translate3dBy([1,0,0],C)},translateTop:function(w){this.translate3dBy([0,1,0],w)},translateBottom:function(Y){this.translate3dBy([0,-1,0],Y)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(r,W,u){1===arguments.length&&(W=r[1],u=r[2],r=r[0]),this.p(r,u),this.setElevation(W)},translate3d:function(e,j,X){1===arguments.length&&(j=e[1],X=e[2],e=e[0]),this.translate(e,X),this.setElevation(this._54O+j)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(g,D,C){1===arguments.length&&(D=g[1],C=g[2],g=g[0]),this.setSize(g,C),this.setTall(D)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(M,j,F){1===arguments.length&&(j=M[1],F=M[2],M=M[0]),this.setRotationX(M),this.setRotation(-j),this.setRotationZ(F)},setRotationY:function(_){this.setRotation(-_)},getRotationY:function(){return-this._64O},lookAtDirection:function(p,E){E=E||Ie;var M=this,W=Og(p);E===Ie?(M.r3([-d(p[1]/W),-J(p[2],p[0])+K,0]),M.setRotationMode("xzy")):E===_i?(M.r3(0,-J(p[2],p[0]),d(p[1]/W)),M.setRotationMode("zyx")):E===ce?(M.r3(0,-J(p[2],p[0])+O,-d(p[1]/W)),M.setRotationMode("zyx")):E===Se?(M.r3([-d(p[1]/W)+K,-J(p[2],p[0])+K,0]),M.setRotationMode("xzy")):E===ep&&(M.r3([-d(p[1]/W)-K,-J(p[2],p[0])+K,0]),M.setRotationMode("xzy")),E===No&&(M.r3([-d(p[1]/W)+O,-J(p[2],p[0])+K,O]),M.setRotationMode("zxy"))},lookAt:function(X,H){return this.lookAtDirection(sm(X,this.p3()),H)},lookAtX:function(){var w=new Eo,z=new Eo,v=new Eo,A=new If,s=new If,x=new S.Math.Euler;return function(E,d,N){d===ce||d===_i?A.makeRotationAxis(new S.Math.Vector3(0,1,0),Math.PI/2):d===Se||d===ep?A.makeRotationAxis(new S.Math.Vector3(1,0,0),Math.PI/2):A.identity(),d===ep||d===_i||d===No?(w.fromArray(this.p3()),z.fromArray(E)):(w.fromArray(E),z.fromArray(this.p3())),s.lookAt(w,z,N?v.fromArray(N):v.set(0,1,0)),x.setFromRotationMatrix(s.multiply(A),Xp.ReverseOrder(this.getRotationMode())),this.r3([x.x,x.y,x.z])}}(),getHost:function(){return this._host},setHost:function(B){var G=this;if(G!==B&&G._host!==B){var d=G._host;d&&d._removeAttach(G),G._host=B,G._host&&G._host._addAttach(G),G.fp("host",d,B),G.onHostChanged(d,B)}},getAttaches:function(){return this._69O},_addAttach:function(e){var p=this;p._69O||(p._69O=new kg),p._69O.add(e),p.fp("attaches",a,e)},_removeAttach:function(b){var B=this;B._69O.remove(b),B._69O.isEmpty()&&delete B._69O,B.fp("attaches",b,a)},getImage:function(){if(this._pendingCheckImageJSON){var n=x.getImage(this._image);n&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof tb&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(k){var g=this,A=g._image,H=g.getWidth(),P=g.getHeight();g._image=k,g.fp("image",A,k)&&(null!=k&&($p(k)||Tp(k)&&/\.json$/i.test(k))&&(this._pendingCheckImageJSON=!0),g.fp(Lc,H,g.getWidth()),g.fp(ss,P,g.getHeight()))},getElevation:function(){return this._54O},setElevation:function(z){var R=this;if(!R._50O){R._50O=1;var i=R._54O;R._54O=z,R.fp(mi,i,z),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(U){var W=this;if(!W._49O){W._49O=1;var n=W._64O;W._64O=U,W.fp(Do,n,U),delete W._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(u){var U=this;if(!U._51O){U._51O=1;var A=U._rotationX;U._rotationX=u,U.fp("rotationX",A,u),delete U._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(B){var e=this;if(!e._52O){e._52O=1;var f=e._53O;e._53O=B,e.fp("rotationZ",f,B),delete e._52O}},getPosition:function(){return this._position},setPosition:function(c,K){var A=this;if(!A._50I){A._50I=1;var d;if(d=2===arguments.length?{x:c,y:K}:c,d.x!==A._position.x||d.y!==A._position.y){var G=A._position;A._position=d,A.fp(ec,G,d)}delete A._50I}},translate:function(j,t){var Y=this._position;this.p(Y.x+j,Y.y+t)},getWidth:function(){var p=this;if(p._width>=0)return p._width;var A=p.getStyle("shape3d");if(A){var Y=Tm(A);if(Y&&Y.rawS3)return Y.rawS3[0];if("billboard"===A||"plane"===A){var B=Nl(p.getStyle("shape3d.image"));return B?sr(B,p):20}}var B=Nl(p._image);return B?sr(B,p):20},setWidth:function(Z){var p=this,h=p._width;p._width=Z,p.fp(Lc,h,Z)},getHeight:function(){var B=this;if(B._height>=0)return B._height;var Y=B.getStyle("shape3d");if(Y){var Z=Tm(Y);if(Z&&Z.rawS3)return Z.rawS3[2];if("plane"===Y){var $=Nl(B.getStyle("shape3d.image"));return $?Qo($,B):20}if("billboard"===Y)return 2}var $=Nl(B._image);return $?Qo($,B):20},setHeight:function(C){var f=this,B=f._height;f._height=C,f.fp(ss,B,C)},getTall:function(){var s=this;if(s._tall>=0)return s._tall;var u=s.getStyle("shape3d");if(u){var D=Tm(u);if(D&&D.rawS3)return D.rawS3[1];if("billboard"===u){var Z=Nl(s.getStyle("shape3d.image"));return Z?Qo(Z,s):20}if("plane"===u)return 2}return 20},setTall:function(k){var B=this,z=B._tall;B._tall=k,B.fp("tall",z,k)},setSize:function(b,k){var n=this;2===arguments.length?(n.setWidth(b),n.setHeight(k)):(n.setWidth(b.width),n.setHeight(b.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(c,o,A,z,I){var k=this,C=k.getAnchor(),h=k.getScale();arguments.length<=2&&(I=o,o=c.y,A=c.width,z=c.height,c=c.x);var _=I&&h.x<0?1-C.x:C.x,x=I&&h.y<0?1-C.y:C.y;k.p(c+A*_,o+z*x),I&&(A/=Math.abs(h.x),z/=Math.abs(h.y)),k.setWidth(A),k.setHeight(z)},getMatrix:function(){var g=this,y=g._64O,P=g._position,V=g.getScale();return new $r(y,P.x,P.y,V.x,V.y)},getAnchorRect:function(){var O=this,h=O.getWidth(),s=O.getHeight(),r=O.getAnchor();return{x:-h*r.x,y:-s*r.y,width:h,height:s}},toLocal:function(I){return this.getMatrix().tfi(I)},toGlobal:function(c){return this.getMatrix().tf(c)},getAttachPosition:function(){var V=new $r;return function(i,O,Q,o){Q=Q||0,o=o||0;var u=this,N=u.getAnchor(),S=u._64O,K=u._position,x=u.getScale();return V.setFromTransform(S,K.x,K.y).tf({x:Q+x.x*u.getWidth()*(i-N.x),y:o+x.y*u.getHeight()*(O-N.y)})}}(),isInRect:function(E){E=this.toLocal(E);var T=this.getWidth(),g=this.getHeight();return E.x+=T*this.getAnchorX(),E.y+=g*this.getAnchorY(),!(E.x<0||E.y<0||E.x>T||E.y>g)},getRect:function(){var q=this,H=q.getWidth(),V=q.getHeight(),U=q.getAnchor(),$={x:-H*U.x,y:-V*U.y,width:H,height:V},D=q.getMatrix();return $=sq([D.tf($.x,$.y),D.tf($.x+$.width,$.y),D.tf($.x+$.width,$.y+$.height),D.tf($.x,$.y+$.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var S=this,r=S.getAnchor(),G=S._anchorElevation;return{x:r.x,y:G,z:r.y}},setAnchorElevation:function(w){var h=this,O=h._anchorElevation;return O!==w?(h._anchorElevation=w,h.fp("anchorElevation",O,w),!0):!1},setAnchor3d:function(U,m,p,A){var r,Q=this;"number"==typeof U?r={x:U,y:m,z:p}:(r=U.length?{x:U[0],y:U[1],z:U[2]}:U,A=m);var o=Q.getDataModel();o&&o.beginTransaction();var z=Q.getAnchor3d(),y=Q.setAnchor(r.x,r.z);if(Q.setAnchorElevation(r.y)&&(y=!0),y&&A&&!$j){Q.getAnchor3d();var R=Sb(Q),J=Hf([r.x-z.x,r.y-z.y,r.z-z.z],R);Q.p3(J)}return o&&o.endTransaction(),y},getAnchor:function(){var r=this;if(r.hasOwnProperty("_anchor"))return r._anchor;var $=Nl(r._image);return $&&$.anchorX!==i?{x:$.anchorX,y:$.anchorY}:r._anchor},setAnchor:function(C,X,i){var l,m=this;"number"==typeof C?l={x:C,y:X}:(l=C.length?{x:C[0],y:C[1]}:C,i=X);var f=m.getAnchor();if(f.x!==l.x||f.y!==l.y){var _=m.getDataModel();if(_&&_.beginTransaction(),m._anchor=l,m.fp("anchor",f,l),i&&!$j){var N=m.getPosition(),r=m.getSize(),W=m.getRotation(),O=m.getScale(),d=-r.width*(f.x-l.x)*O.x,V=-r.height*(f.y-l.y)*O.y,H=M(W),t=b(W);m.setPosition(N.x+t*d-H*V,N.y+H*d+t*V)}return _&&_.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(b,X){var G,M=this;G=2===arguments.length?{x:b,y:X}:b;var T=M.getScale();(T.x!==G.x||T.y!==G.y)&&(M._scale=G,M.fp("scale",T,G))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var v=this,K=v._scaleTall,X=v.getScale();return[X.x,K,X.y]},getFinalScale3d:function(){var E=this,F=E.s3(),f=E._dynamicScale3d,M=E.getScale3d();return F&&(M[0]*=F[0],M[1]*=F[1],M[2]*=F[2]),f&&(M[0]*=f[0],M[1]*=f[1],M[2]*=f[2]),M},getFinalRotation3d:function(){var g=this;return g._dynamicRotation||g.r3()},setScaleTall:function(w){var Z=this,n=Z._scaleTall;n!==w&&(Z._scaleTall=w,Z.fp("scaleTall",n,w))},setScale3d:function(d,x,V){var s,A=this;s="number"==typeof d?{x:d,y:x,z:V}:d.length?{x:d[0],y:d[1],z:d[2]}:d,A.setScaleTall(s.y),A.setScale(s.x,s.z)},getCorners:function(b,s){b==a&&(b=0),s==a&&(s=b);var l=this,h=l.getAnchor(),P=l.getWidth(),g=l.getHeight(),U=-P*h.x-b,N=-g*h.y-s,I=P+2*b,f=g+2*s,G=l.getMatrix();return[G.tf(U,N),G.tf(U,N+f),G.tf(U+I,N+f),G.tf(U+I,N)]},getEditControlPoints:function($,V,q){V==a&&(V=0),q==a&&(q=V);var Q=this,C=Q.getAnchor(),c=Q.getWidth(),p=Q.getHeight(),G=-c*C.x-V,o=-p*C.y-q,F=c+2*V,t=p+2*q;if($)return[{x:G,y:o},{x:G,y:0},{x:G,y:o+t},{x:0,y:o+t},{x:G+F,y:o+t},{x:G+F,y:0},{x:G+F,y:o},{x:0,y:o}];var f=Q.getMatrix();return[f.tf(G,o),f.tf(G,0),f.tf(G,o+t),f.tf(0,o+t),f.tf(G+F,o+t),f.tf(G+F,0),f.tf(G+F,o),f.tf(0,o)]},rotateAt:function(q,R,w){var h=this,e=h._position,g=h._64O,V=new $r(g,e.x,e.y).tf(q,R),d=C(q*q+R*R),H=J(e.y-V.y,e.x-V.x)+w;h.setRotation(g+w),h.p(V.x+d*b(H),V.y+d*M(H))},onParentChanged:function(){Jq.superClass.onParentChanged.apply(this,arguments),this._8I()},onPropertyChanged:function(){var v={};return"width|height|position|anchor|rotation|scale|s:layout.h|s:layout.v".split("|").forEach(function(s){v[s]=!0}),function(_){var Z=this;Jq.superClass.onPropertyChanged.call(Z,_),v[_.property]&&!Z._layoutUpdating&&Z.updateLayoutParameters(null,_.property),Z._69O&&Z._69O.each(function(S){S.handleHostPropertyChange(_)}),Z._49I&&Z._49I.each(function(f){f.fp("agentChange",!0,!1)})}}(),onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(R){this.updateAttach(R)},onStyleChanged:function(h){Jq.superClass.onStyleChanged.apply(this,arguments),bq[h]&&this.updateAttach()},updateAttach:function(N){var j=this;j._51I||$j||(j._51I=1,j._71O(N),delete j._51I)},_71O:function(C){var g,O,$,Y,q,h,U=this,c=U._host,F=C?C.property:a,P=C?C.oldValue:a,D=C?C.newValue:a;if(c instanceof S.Grid){if(F===mi)U.setElevation(U._54O+D-P);else if(!C||Cr[F]){if(g=U.s("attach.row.index"),O=U.s("attach.column.index"),$=c.getCellRect(g,O),!$)return;Y=U.s("attach.row.span"),q=U.s("attach.column.span"),(1!==Y||1!==q)&&($=Kl($,c.getCellRect(g+Y-1,O+q-1))),cp($,U,"attach.padding",1),U.setRect($)}}else if(c instanceof ws&&(h=U.s("attach.index"))>=0&&(!C||oe[F])){var R=U.s("attach.thickness");R!=a&&U.setHeight(c.getThickness()*R);var t=U.s("attach.offset"),E=c.getPoints(),z=E.size();if(z>h){var n=E.get(h),H=z===h+1?E.get(0):E.get(h+1),X=[H.x-n.x,H.y-n.y],f=Og(X);if(f){U.s("attach.offset.relative")&&(t*=f),U.s("attach.offset.opposite")&&(t=f-t);var N={x:n.x+X[0]/f*t,y:n.y+X[1]/f*t},i=U.s("attach.gap");i&&(U.s("attach.gap.relative")&&(i*=c.getThickness()),N=bo(a,N,H,i)),U.p(N),U.setRotation(J(X[1],X[0]))}}}else C&&(F===ec?U.translate(D.x-P.x,D.y-P.y):F===mi?U.setElevation(U._54O+D-P):ng[F]?U._11Q(c,F,D-P):("anchor"===F||"width"===F||"height"===F||"scale"===F)&&U.layout(c))},_11Q:function(){var M=new S.Math.Euler,t=S.Math.Euler.ReverseOrder,G=new S.Math.Vector2,s=new S.Math.Vector2;return function(B,S,L){var h=this,c=B.p3(),b=B.r3(),F=h.p3(),l=h.r3();if(S===Do&&(S="rotationY",L=-L),(S===Do||"rotationY"===S)&&0===l[0]&&0===l[2]&&0===b[0]&&0===b[2]&&0===F[1]&&0===c[1])return h.setRotation(-l[1]-L),G.set(F[0],F[2]).rotateAround(s.set(c[0],c[2]),-L),h.p(G.x,G.y),void 0;var N=eq[B.getRotationMode()],$=N[0],Y=N[1],K=N[2],U=pq[$],m=pq[Y],y=pq[K],a=Dc();S===Do+$?(y(a,b[yq[K]]),m(a,b[yq[Y]]),U(a,L),m(a,-b[yq[Y]]),y(a,-b[yq[K]])):S===Do+Y?(y(a,b[yq[K]]),m(a,L),y(a,-b[yq[K]])):S===Do+K&&y(a,L);var z=sm(F,c);Hf(z,a),h.p3(c[0]+z[0],c[1]+z[1],c[2]+z[2]);var u=h.getRotationMode();dd(a,h.r3(),u),M.setFromRotationMatrix(a,t(u)),h.r3([M.x,M.y,M.z])}}(),isHostOn:function(y){var M=this;if(M._host&&y&&y._69O)for(var s={},e=M._host;e&&e!==M&&!s[e._id];){if(e===y)return!0;s[e._id]=e,e=e._host}return!1},isLoopedHostOn:function(x){return this.isHostOn(x)&&x.isHostOn(this)},getScaledSize:function(){var k=this.getSize(),q=this.getScale();return k.width*=Math.abs(q.x),k.height*=Math.abs(q.y),k},layout:function(P){if(P=P||this.getHost()){var Y=this,W=Y.s("layout.h")||"center",p=Y.s("layout.v")||"center";if("center"!==W||"center"!==p){var d=new S.Math.Vector2,b=P.getPosition(),G=P.getAnchor(),l=P.getScaledSize();Y.getPosition();var s,H,f,g,y,F=1,u=1;switch(Y._layoutUpdating=!0,W){case"left":d.setX(Y._layoutHValue-G.x*l.width);break;case"right":d.setX((1-G.x)*l.width-Y._layoutHValue);break;case"leftright":s=l.width-Y._layoutHValue[2],f=Y.getRotation()-P.getRotation(),g=Math.abs(Math.sin(f)),y=Math.abs(Math.cos(f)),F+=y*s/Y._layoutHValue[3],u+=g*s/Y._layoutHValue[4],d.setX(Y._layoutHValue[1]+(Y._layoutHValue[5]-G.x)*l.width);break;case"center":d.setX((.5-G.x)*l.width-Y._layoutHValue);break;case"scale":f=Y.getRotation()-P.getRotation(),g=Math.abs(Math.sin(f)),y=Math.abs(Math.cos(f)),d.setX((.5-G.x)*l.width-Y._layoutHValue[1]*l.width/Y._layoutHValue[0]),H=l.width/Y._layoutHValue[2]-1,F+=y*H,u+=g*H}switch(p){case"top":d.setY(Y._layoutVValue-G.y*l.height);break;case"bottom":d.setY((1-G.y)*l.height-Y._layoutVValue);break;case"topbottom":f||(f=Y.getRotation()-P.getRotation(),g=Math.abs(Math.sin(f)),y=Math.abs(Math.cos(f))),s=l.height-Y._layoutVValue[2],F+=g*s/Y._layoutVValue[3],u+=y*s/Y._layoutVValue[4],d.setY(Y._layoutVValue[1]+(Y._layoutVValue[5]-G.y)*l.height);break;case"center":d.setY((.5-G.y)*l.height-Y._layoutVValue);break;case"scale":f||(f=Y.getRotation()-P.getRotation(),g=Math.abs(Math.sin(f)),y=Math.abs(Math.cos(f))),d.setY((.5-G.y)*l.height-Y._layoutVValue[1]*l.height/Y._layoutVValue[0]),H=l.height/Y._layoutVValue[2]-1,F+=g*H,u+=y*H}(1!==F||1!==u)&&("leftright"===W||"scale"===W?Y.setSize(Y._layoutHValue[3]*F,Y._layoutHValue[4]*u):Y.setSize(Y._layoutVValue[3]*F,Y._layoutVValue[4]*u)),d.rotateAround(null,P.getRotation()),this.setPosition(d.x+b.x,d.y+b.y),Y._layoutUpdating=i}}},updateLayoutParameters:function(N,l){if(N=N||this.getHost()){var z=this,g=z.s("layout.h"),G=z.s("layout.v");if(g||G){var B,r,e,v,h,f,M=new S.Math.Vector2,D=N.getPosition(),w=N.getAnchor(),J=N.getScaledSize(),d=z.getPosition(),P=z.getSize();switch(M.set(d.x-D.x,d.y-D.y),M.rotateAround(null,-N.getRotation()),g){case"left":z._layoutHValue=M.x+w.x*J.width;break;case"right":z._layoutHValue=-M.x+(1-w.x)*J.width;break;case"center":z._layoutHValue=-M.x+(.5-w.x)*J.width;break;case"leftright":case"scale":"scale"===g?B=-M.x+(.5-w.x)*J.width:(r=z.getAnchor(),e=z.getRotation()-N.getRotation(),v=Math.cos(e),h=Math.sin(e),f=-Math.min(-r.x*v+r.y*h,-r.x*v-(1-r.y)*h,(1-r.x)*v+r.y*h,(1-r.x)*v-(1-r.y)*h),B=M.x-(f-w.x)*J.width),"position"===l&&"object"==typeof z._layoutHValue?(z._layoutHValue[0]=J.width,z._layoutHValue[1]=B):z._layoutHValue=[J.width,B,J.width,P.width,P.height,f]}switch(G){case"top":z._layoutVValue=M.y+w.y*J.height;break;case"bottom":z._layoutVValue=-M.y+(1-w.y)*J.height;break;case"center":z._layoutVValue=-M.y+(.5-w.y)*J.height;break;case"topbottom":case"scale":"scale"===G?B=-M.y+(.5-w.y)*J.height:(e||(r=z.getAnchor(),e=z.getRotation()-N.getRotation(),v=Math.cos(e),h=Math.sin(e)),f=-Math.min(-r.x*h-r.y*v,-r.x*h+(1-r.y)*v,(1-r.x)*h-r.y*v,(1-r.x)*h+(1-r.y)*v),B=M.y-(f-w.y)*J.height),"position"===l&&"object"==typeof z._layoutVValue?(z._layoutVValue[0]=J.height,z._layoutVValue[1]=B):z._layoutVValue=[J.height,B,J.height,P.width,P.height,f]}}}},getSerializableProperties:function(){var e=Jq.superClass.getSerializableProperties.call(this);return Gh(e,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),e}});var wf=S.Edge=function(i,P){var Z=this;fm(wf,Z),Z.setSource(i),Z.setTarget(P)};Kn("Edge",Ij,{ms_edge:!0,_icon:"edge_icon",getUIClass:function(){return gl},_22Q:function(){return yd},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},canSetSourceTarget:function(d){if(d===this)return!1;if(Td(d))return!0;for(var W,O,p,l,g,m=[this],V=-1,L=0;L>V;)if(V++,W=m[V],O=W._44I)for(O=O.getArray(),l=0,g=O.length;g>l;l++)if(p=O[l],ck(p)&&!(m.indexOf(p)>=0)){if(p===d)return!1;m.push(p),L++}return!0},setSource:function(o){var P=this;if(P._source!==o&&P.canSetSourceTarget(o)){var R=P._source;P._source=o,R&&R._16I(P),o&&o._2I(P),P._7I(),P.fp("source",R,o)}},setTarget:function(d){var x=this;if(x._target!==d&&x.canSetSourceTarget(d)){var S=x._target;x._target=d,S&&S._18I(x),d&&d._4I(x),x._7I(),x.fp("target",S,d)}},isLooped:function(){var V=this;return V._source===V._target&&Td(V._source)&&Td(V._target)},onPropertyChanged:function(){var S=this;S._49I&&S._49I.each(function(Y){Y.fp("agentChange",!0,!1)})},_7I:function(){var W,h=this,C=Zk(h);h._40I!==C&&(W=this._40I,W&&W._15I(h),h._40I=C,C&&C._1I(h),h.fp("sourceAgent",W,C),ml(W,h._41I),ml(C,h._41I));var i=jp(h);h._41I!==i&&(W=h._41I,W&&W._17I(h),h._41I=i,i&&i._3I(h),h.fp("targetAgent",W,i),ml(W,h._40I),ml(i,h._40I))},_22I:function(x){this._52I=x,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var O=this;return O._52I&&O._52I.get(0)!==O&&!O.getStyle($k)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var Z=this,t=Z._52I;return t&&!Z.getStyle($k)&&t.size()>1&&Z===t.get(0)},toggle:function(){var W=this._52I,X=!this.s($k);W&&W.size()>1&&(W.each(function(c){c.s($k,X)}),W.getSiblings().each(function(M){M!==W&&M.each(function(q){q.fp("edgeGroup",a,M)})}))},setStyle:function(Z,V){(Z===Wd||"edge.segments"===Z)&&(V=zd(V)),wf.superClass.setStyle.call(this,Z,V)},onStyleChanged:function(h){wf.superClass.onStyleChanged.apply(this,arguments),Gn[h]&&ml(this._41I,this._40I)},getSerializableProperties:function(){var j=wf.superClass.getSerializableProperties.call(this);return Gh(j,{source:1,target:1}),j}});var an=S.Group=function(){fm(an,this)};Kn("Group",Jq,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return wd},onChildAdded:function(){an.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){an.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var x=this;if(!x._54I&&!$j){var R=x.getChildrenRect();R&&(x._53I=1,x.p(gc(x.s("group.position"),R,x.getSize())),delete x._53I)}},getChildrenRect:function(){var W,Q=this;return Q.eachChild(function(M){Td(M)&&(W=Kl(W,Q.getChildRect(M)))}),W},getChildRect:function(Z){var j;return Td(Z)&&Z.s(jn)&&(Uk(Z)&&Z.isExpanded()&&Z.eachChild(function(z){j=Kl(j,Z.getChildRect(z))}),!j&&Z.getRect&&(j=Z.getRect())),j},setPosition:function(q,j){var r=this;if(!r._54I){var h;h=2===arguments.length?{x:q,y:j}:q,$j||r._53I||(r._54I=1,Ub(r._children,h.x-r._position.x,h.y-r._position.y),delete r._54I),an.superClass.setPosition.call(this,h)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(Q){var o=this;if(o._57O!==Q){var N=o._57O;o._57O=Q,o.fp("expanded",N,o._57O),o._fireInvalidateDeep(),o._8I()}},_fireInvalidateDeep:function(){this.eachChild(function(L){Uk(L)?L._fireInvalidateDeep():L.iv()})},_8I:function(){an.superClass._8I.call(this),this.eachChild(function(a){Td(a)&&a._8I()})},onStyleChanged:function(A){an.superClass.onStyleChanged.apply(this,arguments),"group.position"===A&&this._81I()},getSerializableProperties:function(){var Z=an.superClass.getSerializableProperties.call(this);return Z.expanded=1,Z}});var Be=S.Block=function(){fm(Be,this)};Kn("Block",Jq,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return Pm},onChildAdded:function(){Be.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Be.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var $=this;if(!$j&&!$._updatingToChildren&&$._syncSize&&!$._freezeSyncFromChildren){var W,e,A,O,K,m=[],g=$.getRotation();if($.eachChild(function(p){Td(p)&&m.push.apply(m,p.getCorners())}),m.length){$._updatingFromChildren=1;var H=b(-g),z=M(-g),J=1/0,U=-1/0,E=1/0,i=-1/0;for(O=0,K=m.length;K>O;O++)A=m[O],W=A.x,e=A.y,A.x=H*W-z*e,A.y=z*W+H*e,J=t(J,A.x),U=w(U,A.x),E=t(E,A.y),i=w(i,A.y);var Q=$.getScale();$.setSize(G((U-J)/Q.x),G((i-E)/Q.y));var f;Q.x<0&&(f=J,J=U,U=f),Q.y<0&&(f=E,E=i,i=f),H=b(g),z=M(g);var L=$.getAnchor();W=J+(U-J)*L.x,e=E+(i-E)*L.y,$.setPosition(H*W-z*e,z*W+H*e),delete $._updatingFromChildren}}},setPosition:function(l,z){var X=this;if(!X._updatingToChildren){var L;L=2===arguments.length?{x:l,y:z}:l,$j||X._updatingFromChildren||(X._updatingToChildren=1,Ub(X._children,L.x-X._position.x,L.y-X._position.y),delete X._updatingToChildren),Be.superClass.setPosition.call(this,L)}},setWidth:function(Z){return this.setSize(Z,this.getHeight())},setHeight:function(M){return this.setSize(this.getWidth(),M)},setSize:function(z,Y){1>z&&(z=1),1>Y&&(Y=1);var U=this;if(!U._updatingToChildren){2!==arguments.length&&(Y=z.height,z=z.width);var p=U.getWidth(),X=U.getHeight();if(z!==p&&Be.superClass.setWidth.call(U,z),Y!==X&&Be.superClass.setHeight.call(U,Y),!$j&&!U._updatingFromChildren){U._updatingToChildren=1;var K=z/p,x=Y/X;U._adjustChildScaleOrSize(K,x,"size"),delete U._updatingToChildren,U.updateFromChildren()}}},_adjustChildScaleOrSize:function(R,W,G){var y=this;if(y._syncSize){var l=y.getPosition(),t=y.getRotation();y.getScale(),y.eachChild(function(r){if(Td(r)){var Z=r.getPosition(),N=r.getRotation(),U=r.getWidth(),v=r.getHeight(),k=r.getScale(),g=k.x*U,u=k.y*v,A=new $r(N,Z.x,Z.y,g,u);A.translate(-l.x,-l.y),A.rotate(-t),N=J(A.b*Math.sign(g),A.a*Math.sign(g)),A.scale(R,W);var f,I,F,p=b(N);if(Math.abs(p)<.001?(f=M(N),I=A.b/f,F=-A.c/f):(I=A.a/p,F=A.d/p),"scale"===G)r.setScale(I/U,F/v);else if("size"===G){var s=I/k.x,m=F/k.y;r.setScale(ch(I)*Math.abs(k.x),ch(F)*Math.abs(k.y)),r instanceof S.Shape?(r.setWidthForce(Math.max(Math.abs(s),1e-5)),r.setHeightForce(Math.max(Math.abs(m),1e-5))):r.setSize(Math.max(.01,Math.abs(s)),Math.max(.01,Math.abs(m)))}A.rotate(t),A.translate(l.x,l.y),r.setPosition(A.tx,A.ty)}})}},_calcChangeFactor:function(p,I,F,B){var M,$,_,a;return M=G(p),$=G(F),_=M>$?M/$:$/M,M=G(I),$=G(B),a=M>$?M/$:$/M,w(_,a)},setAnchor:function(){var C=this;if(!C._updatingToChildren){var w=C.getAnchor();if(Be.superClass.setAnchor.apply(C,arguments),!$j&&!C._updatingFromChildren&&C._syncSize){C._updatingToChildren=1;var P=C.getAnchor();C.getPosition();var $=C.getSize(),N=C.getScale(),O=C.getRotation(),S=-$.width*N.x*(w.x-P.x),p=-$.height*N.y*(w.y-P.y),l=M(O),T=b(O),h=T*S-l*p,e=l*S+T*p;C.eachChild(function(L){if(Td(L)){var g=L.getPosition();L.setPosition(g.x-h,g.y-e)}}),delete C._updatingToChildren}}},setRotation:function(j){var H=this;if(!H._updatingToChildren){var T=H.getRotation();if(Be.superClass.setRotation.apply(H,arguments),!$j&&!H._updatingFromChildren){H._updatingToChildren=1;var X=H.getPosition(),$=j-T;H.eachChild(function(y){if(Td(y)){var F=y.getMatrix();F.translate(-X.x,-X.y),F.rotate($),F.translate(X.x,X.y);var w=Math.sign(y.getScale().x);y.setRotation(J(F.b*w,F.a*w)),y.setPosition(F.tx,F.ty)}}),delete H._updatingToChildren}}},setScale:function(P,c){var q=this;if(!q._updatingToChildren){null==c&&(c=P.y,P=P.x);var V=q.getScale();if(G(P)<.01&&(P=.01*(ch(P)||ch(V.x))),G(c)<.01&&(c=.01*(ch(c)||ch(V.y))),Be.superClass.setScale.call(q,P,c),!$j&&!q._updatingFromChildren){q._updatingToChildren=1;var W=P/V.x,E=c/V.y;q._adjustChildScaleOrSize(W,E,"size"),delete q._updatingToChildren,q.updateFromChildren()}}},getSerializableProperties:function(){var F=Be.superClass.getSerializableProperties.call(this);return F.clickThroughEnabled=1,F.syncSize=1,F}});var co=S.Grid=function(){fm(S.Grid,this)};Kn("Grid",Jq,{IRotatable:!1,_icon:"grid_icon",_image:a,getUIClass:function(){return fn},setRotation:function(){},getCellRect:function(v,f){var S=this,I=S.s("grid.row.count"),k=S.s("grid.column.count");if(0>=I||0>=k||0>v||v>=I||0>f||f>=k)return a;var M,j,X,h=S.getRect(),Z=S.s("grid.row.percents"),G=S.s("grid.column.percents");if(cp(h,S,"grid.border",-1),Z&&Z._as&&(Z=Z._as),G&&G._as&&(G=G._as),Z&&Z.length===I){for(X=0,M=0;v>M;M++)X+=h.height*Z[M];h.y+=X,h.height=h.height*Z[v]}else h.height=h.height/I,h.y+=h.height*v;if(G&&G.length===k){for(j=0,M=0;f>M;M++)j+=h.width*G[M];h.x+=j,h.width=h.width*G[f]}else h.width=h.width/k,h.x+=h.width*f;return de(h,-S.s("grid.gap")),h}});var me=S.Text=function(){fm(me,this),this.setSize(100,50),this.s("text","TEXT")};Kn("Text",Jq,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Xr},setWidth:function($){$||($=.001),me.superClass.setWidth.call(this,$)},setHeight:function(u){u||(u=.001),me.superClass.setHeight.call(this,u)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),ai("__text__",{width:{value:100,isSafeFunc:!0,func:function(H){return H._width}},height:{value:50,isSafeFunc:!0,func:function(d){return d._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"},scaleX:{func:"style@text.scale.x"},scaleY:{func:"style@text.scale.y"}}]});var ws=S.Shape=function(){fm(ws,this),this._59O=new kg};ws.__de__=Fh,Kn("Shape",Jq,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Sj},_22Q:function(){return qr},getLength:function(S){return Ir(vl(this._59O,this._58O,S,this._closePath))
},getSegments:function(){return this._58O},toSegments:function(){var B=this._58O;return B?new kg(B._as.slice(0)):B},setSegments:function(p){var r=this._58O;p=p?mr(p)?new kg(p.slice(0)):new kg(p._as.slice(0)):null,(r&&p&&r._as.join(",")!==p._as.join(",")||r!==p)&&(this._58O=p,this.fp("segments",r,p))},getPoints:function(){return this._59O},toPoints:function(){var d=this._59O;return new kg(d._as.slice(0))},setPoints:function(W,Z){var b=this,r=b._59O;W=W?mr(W)?new kg(W.slice(0)):new kg(W._as.slice(0)):new kg;var k,Y,v,d,Q,V;Z&&(k=b.getPosition(),V=new $r(b.getRotation(),0,0,b.getScale().x,b.getScale().y)),(r&&W&&r._as.join(",")!==W._as.join(",")||r!==W)&&(b._59O=W,b.fs(),b.fp("points",r,W)),Z&&(Y=b.getPosition(),v=Y.x-k.x,d=Y.y-k.y,Q=V.tf(v,d),b.setPosition(Y.x-v+Q.x,Y.y-d+Q.y))},addPoint:function(e,x,p){var X=this.toPoints();X.add(e,x),this.setPoints(X,p)},setPoint:function(u,W,g){var q=this.toPoints();q.set(u,W),this.setPoints(q,g)},removePointAt:function(e){var m=this.toPoints();m.removeAt(e),this.setPoints(m)},setWidthForce:function(Z){var i=this;if(!i._55I&&!$j&&i.getWidth()){i._55I=1;var k=i._position.x,o=Z/i.getWidth(),d=i.toPoints(),D=new kg;d.each(function(H){D.add({x:(H.x-k)*o+k,y:H.y,e:H.e})}),i.setPoints(D),kf(i,[o,0,0,1,k*(1-o),0]),i.fs(),delete i._55I}ws.superClass.setWidth.call(i,Z)},setWidth:function(M){return this.setWidthForce(1>M?1:M)},setHeightForce:function(X){var u=this;if(!u._55I&&!$j&&u.getHeight()){u._55I=1;var R=u._position.y,_=X/u.getHeight(),T=u.toPoints(),g=new kg;T.each(function(X){g.add({x:X.x,y:(X.y-R)*_+R,e:X.e})}),u.setPoints(g),kf(u,[1,0,0,_,0,R*(1-_)]),u.fs(),delete u._55I}ws.superClass.setHeight.call(u,X)},setHeight:function($){return this.setHeightForce(1>$?1:$)},setAnchorElevation:function(P){var p=this;p._55I=!0;var q=p._updatingAnchor3d,u=!$j&&!q;if(u){var _,v=P,j=p.getAnchorElevation(),m=p.getTall();_=m*(j-v),p.shiftPointsElevation(_)}var f=ws.superClass.setAnchorElevation.apply(p,arguments);return q||delete p._55I,f},getShapeElevation:function(){var E=this,r=E._54O;return r-(E.getTall()||0)*(E._anchorElevation-.5)},setAnchor3d:function(K,f,y,d){var l,g=this;"number"==typeof K?l={x:K,y:f,z:y}:(l=K.length?{x:K[0],y:K[1],z:K[2]}:K,d=f),g._55I=!0,g._updatingAnchor3d=!0;var v=g.getDataModel();if(v&&v.beginTransaction(),!$j){var b=g.getAnchor3d(),$=g.getSize(),w=g.getTall(),X=$.width*(b.x-l.x),E=$.height*(b.z-l.z),H=w*(b.y-l.y);d||g.shiftPoints(X,E,H);var F=g.p3()}var V=ws.superClass.setAnchor3d.apply(g,arguments);if(!$j&&d){var P=g.p3();g.shiftPoints(P[0]-F[0]+X,P[2]-F[2]+E,P[1]-F[1]+H)}return v&&v.endTransaction(),delete g._updatingAnchor3d,delete g._55I,V},setAnchor:function(w,D,R){var v=this;v._55I=!0;var r=v._updatingAnchor3d,J=!$j&&!r;if(J){var k,T,m;"number"==typeof w?m={x:w,y:D}:(m=w.length?{x:w[0],y:w[1]}:w,R=D);var f=v.getAnchor(),_=v.getSize();k=_.width*(f.x-m.x),T=_.height*(f.y-m.y),R||v.shiftPoints(k,T);var O=v.getPosition()}var o=ws.superClass.setAnchor.apply(v,arguments);if(J){var Q=v.getPosition();R&&v.shiftPoints(Q.x-O.x+k,Q.y-O.y+T)}return r||delete v._55I,o},shiftPoints:function(p,P,g){var f=this,K=f.getElevation()||0,z=f.toPoints(),Z=new kg;z.each(function(M){var o=M.e;g&&(o=(o==a?K:o)+g),Z.add({x:M.x+p,y:M.y+P,e:o})}),f.setPoints(Z),f.fs()},shiftPointsElevation:function(L){return this.shiftPoints(0,0,L)},setPosition:function(c,S){var q,m=this;if(!m._28Q){if(m._28Q=1,!m._55I&&!$j){q=2===arguments.length?{x:c,y:S}:c;var s=q.x-m._position.x,Y=q.y-m._position.y;if(0===s&&0===Y)return delete m._28Q,void 0;m._55I=1,m.shiftPoints(s,Y),kf(m,[1,0,0,1,s,Y]),delete m._55I}ws.superClass.setPosition.apply(m,arguments),delete m._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var $=this;if(2!==$._59O.size())return!1;var F=$._58O;return F?2===F.size()&&1===F.get(0)&&2===F.get(1)?!0:!1:!0},fireShapeChange:function(){var w=this;if(!w._55I&&!$j){var e=sq(w._59O);e&&(w._55I=1,w.setRect(e),delete w._55I)}w.fp(vp,!1,!0)},getSerializableProperties:function(){var M=ws.superClass.getSerializableProperties.call(this);return M.segments=1,M.points=1,M.thickness=1,M.closePath=1,M}});var Sp=S.Polyline=function(){fm(Sp,this),this.s({"shape.background":null,"shape.border.width":2})};Kn("Polyline",ws,{_icon:"polyline_icon",_22Q:function(){return Jg},getUIClass:function(){return _g},setClosePath:function(){},setTall:function(q){var X=this;if(!X._55I&&!X._24Q&&!$j&&X.getTall()){X._24Q=1;var k=X._54O,I=q/X.getTall();X._59O.each(function(V){V.e=V.e==a?k:(V.e-k)*I+k}),X.fs(),delete X._24Q}Sp.superClass.setTall.call(X,q)},setElevation:function(H){var R=this;if(!R._55I&&!R._24Q&&!$j){R._24Q=1;var h=H-R._54O;R._59O.each(function(v){v.e==a?v.e=H:v.e+=h}),R.fs(),delete R._24Q}Sp.superClass.setElevation.apply(R,arguments)},fireShapeChange:function(){var Q=this,I=Q._59O;if(!Q._55I&&!Q._24Q&&!$j){var k=I.size();if(k){var q=1,n=I.get(0),S=Q._54O;n.e==a&&(n.e=S);for(var g=n.e,h=0;k>q;q++){n=I.get(q),n.e==a&&(n.e=S);var f=t(g,n.e),v=w(g+h,n.e);g=f,h=v-f}Q._24Q=1,Q.setTall(h),Q.setElevation(g+h*Q._anchorElevation),delete Q._24Q}}Sp.superClass.fireShapeChange.apply(Q,arguments)}});var $f=S.SubGraph=function(){fm($f,this)};Kn("SubGraph",Jq,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){$f.superClass._8I.call(this),this.eachChild(function(H){Td(H)&&H._8I()})}}),x.loadingRefGraph=0;var tb=S.RefGraph=function(){fm(tb,this)};Kn("RefGraph",Be,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(Y){var x=this._ref;this._ref=Y,this.fp("ref",x,Y),this.updateRef()},_21I:function(){tb.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var q=this;if(x.loadingRefGraph++,q.clearChildrenFromDataModel(),x.loadingRefGraph--,q._ref&&q._dataModel){q._xhrLoadHandler&&(q._xhrLoadHandler.cancel=!0);var u=$j,r=q._xhrLoadHandler=function(a){if(a&&q._dataModel){x.loadingRefGraph++;var c=q._pendingUpdateInfo={needToRestore:u};u&&(c.position=q.p(),c.width=q.getWidth(),c.height=q.getHeight(),c.rotation=q.getRotation(),c.anchor=q.getAnchor(),c.scale=q.getScale()),q.p(0,0),q.setAnchor(.5,.5),q.setRotation(0),q.setScale(1,1);var f=x.parse(a),I=q._dataModel.deserialize(f,q,{justDatas:!0});I.each(function(T){T._refGraph=q}),q.checkPendingUpdateInfo(),x.loadingRefGraph--,x.handleRefGraphLoaded(q,I,f)}};r.xhrLoadCalled=!1,x.load(q._ref,function(i){r.cancel||(r.xhrLoadCalled?r(i):Jj(function(){r(i)}))}),r.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var h=this,c=h._pendingUpdateInfo;if(!c)return h.onPendingUpdated&&(x.loadingRefGraph++,h.onPendingUpdated(),x.loadingRefGraph--),void 0;var M=!0;this.eachChild(function(U){(U._pendingCheckImageJSON||U._pendingUpdateInfo)&&(M=!1)}),M&&(x.loadingRefGraph++,h._pendingUpdateInfo=null,h.updateFromChildren(),c.needToRestore&&(h.setSize(c.width,c.height),h.setAnchor(c.anchor),h.setRotation(c.rotation),h.setScale(c.scale),h.p(c.position)),this.getParent()instanceof tb&&this.getParent().checkPendingUpdateInfo(),h.onPendingUpdated&&h.onPendingUpdated(),x.loadingRefGraph--)},getSerializableProperties:function(){var d=tb.superClass.getSerializableProperties.call(this);return d.ref=1,d}}),S.EdgeGroup=function(P,R){this._70O=P,this._siblings=R;for(var B,L,p=0,f=P.size(),S=W[$k];f>p;p++)if(B=P.get(p).getStyle($k,!1),B!=a){S=B;break}S==a&&(S=!0);var u=x.edgeGroupAgentFunc;for(u&&(L=u(P),L&&L!==P.get(0)&&(P.remove(L),P.add(L,0))),p=0;f>p;p++)P.get(p).s($k,S)},Kn("EdgeGroup",n,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(e){return this._70O.get(e)},indexOf:function(l){return this._70O.indexOf(l)},each:function(D,b){this._70O.each(D,b)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(N,O){this._siblings.each(function(H){H._70O.each(N,O)})}});var _r=function(H,L,S){var U=bk[H]={type:H,action:L};if(S)for(var s in S)U[s]=S[s]};Gh(x,{setConnectAction:_r,getConnectAction:function(R,t){if(!t){if(!R)return null;t=R.getCurrentConnectActionType()}return bk[t]},doConnectAction:function(I,z,U,D){D=D||I.getCurrentConnectActionType();var R=bk[D];if(!R)return!1;var d=R.action;return d?(z instanceof bp.Group?I.sm().getSelection().each(function(O){d.call(null,I,O,U)}):d.call(null,I,z,U),!0):!1},doDeleteConnectionAction:function(z,C,c){c=c||z.getCurrentConnectActionType();var x=bk[c];if(!x||!x.delete)return!1;var g=x.delete.action;return g?(C instanceof bp.Group?z.sm().getSelection().each(function(r){g.call(null,z,r)}):g.call(null,z,C),!0):!1}});var Mp=S.JSONSerializer=function(j,s){this.dm=this._dataModel=j,this._hierarchical=x.forceHierarchicalSerialization?!0:s==a?j.isHierarchicalRendering():s};Kn("JSONSerializer",n,{ms_ac:["hierarchical"],serialize:function(q){return x.stringify(this.toJSON(),q)},toJSON:function(){var q=this,d=q.dm,m=d.getRoots(),S=q.json={v:x.getVersion(),p:{},a:{},d:[]},W=d.getSerializableAttrs();d.getInit()&&(S.init=d.getInit()),d.getName()&&(S.p.name=d.getName()),d.getBackground()&&(S.p.background=d.getBackground()),d.getLayers()&&(S.p.layers=d.getLayers()),d.getEnvmap()&&(S.p.envmap=d.getEnvmap()),S.p.autoAdjustIndex=d.isAutoAdjustIndex(),S.p.hierarchicalRendering=d.isHierarchicalRendering();for(var n in W){var D=d.a(n);D!==i&&q[Mn](n,D,S.a)}return je(S.a)&&delete S.a,q._hierarchical?m.each(q.serializeData,this):d.each(function(h){q.serializeData(h)}),d.fireSerializeEvent({type:"serialize",json:S}),d.getPostProcessingData()&&(S.p.postProcessingData=d.getPostProcessingData()),S},isSerializable:function(){return!0},getProperties:function(e){return e.getSerializableProperties()},getStyles:function(U){return U.getSerializableStyles()},getAttrs:function(x){return x.getSerializableAttrs()},serializeData:function(G){var Z=this;if(Z.isSerializable(G)&&!G._refGraph){var I,W,j,x,Y=tg(G.getClassName())||G.getClass(),A=new Y,g={c:G.getClassName(),i:G.getId(),p:{},s:{},a:{}};Z.json.d.push(g),I=Z.getProperties(G);for(W in I)if(/^_/.test(W)){if(j=G[W],("_width"===W||"_height"===W)&&j===i){var t;((G.s("layout.h")||G.s("layout.v"))&&G.getHost()||G instanceof S.Node&&(t=G.getParent())&&t instanceof S.Block||G.s("fullscreen"))&&(j=G[W]="_width"===W?G.getWidth():G.getHeight())}j!==A[W]&&Z[Mn](W.substr(1),j,g.p)}else x=ar(W),G[x]&&(j=G[x](),j!==A[x]()&&Z[Mn](W,j,g.p));I=Z.getStyles(G);for(W in I)j=G.s(W),j!==A.s(W)&&Z[Mn](W,j,g.s);I=Z.getAttrs(G);for(W in I)j=G.a(W),j!==A.a(W)&&Z[Mn](W,j,g.a);je(g.p)&&delete g.p,je(g.s)&&delete g.s,je(g.a)&&delete g.a}Z._hierarchical&&G.getChildren().each(Z.serializeData,Z)},serializeValue:function(b,x,y){Zm(x)?x={__a:x._as}:x instanceof Ij&&(x={__i:x.getId()}),y[b]=x},deserialize:function(P,n,r){var u=this;return Tp(P)&&/.json$/.test(P)?(x.xhrLoad(P,function(g){u.deserializeImpl(g,n,r)}),void 0):u.deserializeImpl(P,n,r)},deserializeImpl:function(b,l,U){var z=this,t=z.dm;U=Xq(U)?{setId:U}:nk(U)?{finishFunc:U}:U||{},b=z.json=Tp(b)?x.parse(b):b,b.a&&b.a.onPreDeserialize&&!U.disableOnPreDeserialize&&b.a.onPreDeserialize(b,t,U.view),t.beginTransaction(),$j++,z._82I={};var O=new kg,y=new kg,r=0,w=b.d.length;if(U.justDatas||(nk(b.init)&&b.init(t),t.setInit(b.init)),!U.justDatas){for(var K in b.a)t.a(K,z[$o](b.a[K]));for(var P in b.p)t[vs(P)](b.p[P])}for(;w>r;r++){var Y=b.d[r],V=tg(Y.c),e=new V,u=Y.i;U.setId&&u!=a&&(e._id=u),z._82I[u]=e,O.add(e),y.add(Y)}for(r=0;w>r;r++)z.deserializeData(O.get(r),y.get(r));return O.each(function(G){l&&!G.getParent()&&G.setParent(l),t.add(G)}),t.fireSerializeEvent({type:"deserialize",json:b}),$j--,t.endTransaction(),b.a&&b.a.onPostDeserialize&&!U.disableOnPostDeserialize&&b.a.onPostDeserialize(b,t,U.view,O),U.finishFunc&&U.finishFunc(b,t,U.view,O),O},deserializeData:function(q,y){for(var F in y.p)q[vs(F)](this[$o](y.p[F]));for(F in y.s)q.s(F,this[$o](y.s[F]));for(F in y.a)q.a(F,this[$o](y.a[F]))},deserializeValue:function(r){if($p(r)){var B=r.__i;if(B!=a)return this._82I[B];if(B=r.__a,mr(B))return new kg(B)}return r}}),Gh(Wn,{serialize:function(o,Z){return new Mp(this,Z).serialize(o)},toJSON:function(b){return new Mp(this,b).toJSON()},deserialize:function(q,$,m){return new Mp(this).deserialize(q,$,m)}});var um=S.OverlappingBox=function(a){this.gv=a,this.boxes={}};Kn("OverlappingBox",n,{clear:function(){var V,m,_=this.boxes;for(V in _)m=_[V],m.length=0},isOverlapping:function(p,r){var K,I,F=this,A=F.boxes,N=A[p];N?(K=N.rects,I=N.length):N=A[p]={rects:K=[],length:I=0};var U,c,r;for(U=0;I>U;U++)if(c=K[U],c.x<r.x+r.w&&c.x+c.w>r.x&&c.y<r.y+r.h&&c.h+c.y>r.y)return!0;return K.length<=I?(K.push(r),N.length++):K[N.length++]=r,!1}}),Gh(x,{fetch:function(Y,j){var n="GET",K=!1,I=null,L="";j&&(n=j.method||"GET",K=j.sync,L=j.url,I=j.data||null),Y.open(n,L,!K),j.responseType?Y.responseType=j.responseType:j.overrideMimeType&&Y.overrideMimeType&&Y.overrideMimeType(j.overrideMimeType),Y.send(I)},convertImageSrc:function(i,z){z&&"function"==typeof z||(z=function(){}),z(i)}});var wm=S.Request=function(){this._xhr=new XMLHttpRequest,this._onloadFunc=function(){},this._errorFunc=function(){}};Kn("Request",n,{_responseType:null,_overrideMimeType:"text/plain",send:function(J){var M=this._xhr,Z=this.onload,e=this.onerror;this.getResponseType()?J.responseType=this.getResponseType():this.getOverrideMimeType()&&(J.overrideMimeType=this.getOverrideMimeType()),M.onload=Z,M.onerror=e,x.fetch(M,J)},onload:function(){},onerror:function(){},getResponseType:function(){return this._responseType},setResponseType:function(q){this._responseType=q},getOverrideMimeType:function(){return this._overrideMimeType},setOverrideMimeType:function(Z){this._overrideMimeType=Z},getResponseText:function(){var S=this._xhr;return S.response||S.responseText}}),Bl.GraphView=function(U){var L=this;L._24I={},L._34I=new kg,L._25I={},L._56I={},L._view=Qm(1,L),L._canvas=xp(L._view),L.dm(U?U:new Wn),this._coreInteractor=new Po(this),L.setEditable(!1),L.setScrollBarVisible(x.graphViewScrollBarVisible)},As("GraphView",n,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[Re,cj,Xf,wj,"resettable","editInteractor",oc,"zoomable","pannable","rectSelectable","autoScrollZone",Fp,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_zoomable:x.graphViewZoomable,_resettable:x.graphViewResettable,_pannable:x.graphViewPannable,_rectSelectable:x.graphViewRectSelectable,_autoScrollZone:x.graphViewAutoScrollZone,_rectSelectBackground:x.graphViewRectSelectBackground,_rectSelectBorderColor:x.graphViewRectSelectBorderColor,_editPointSize:x.graphViewEditPointSize,_editPointBorderColor:x.graphViewEditPointBorderColor,_editPointBackground:x.graphViewEditPointBackground,_scrollBarColor:dg,_scrollBarSize:Yq,_autoHideScrollBar:as,_autoMakeVisible:tj,_currentActionType:null,getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function($){this._dataModel.setLayers($)},setEditable:function(k){var Q=this,G=Q.__interactorMap__;if(!G){var N=Bl.XEditInteractor;G=Q.__interactorMap__={scrollBar:new bc(Q),select:new Gb(Q),edit:N?new N(Q):new lq(Q),text:new Mk(Q),move:new Tb(Q),"default":new $n(Q),touch:new yh(Q,{editable:!1})}}k?(Q._uieditable=!0,Q.setInteractors([G.scrollBar,G.select,G.edit,G.text,G.move,G.default,G.touch])):(Q._uieditable=!1,Q.setInteractors([G.scrollBar,G.select,G.move,G.default,G.touch]))},getCanvas:function(){return this._canvas},_33I:function(Y){var X=Y.getUIClass();return X?new X(this,Y):a},getDataUI:function(L){var O=this,E=O._25I[L._id];return E===i&&(E=O._33I(L),O._25I[L._id]=E),E},getNodeRect:function(A){return x.getNodeRect(this,A)},getFullscreenDatas:function(){return this._dataModel.getFullscreenDatas()},getEdgeInfo:function(m){var g=this.getDataUI(m);return g?(g._79o(),g._78o):null},getEdgeSourcePosition:function(G){var s=this,q=s.getDataUI(G),D=q.s,N=q._data._40I;return Ci(s,N,D("edge.source.position"),D("edge.source.offset.x"),D("edge.source.offset.y"),D("edge.source.anchor.x"),D("edge.source.anchor.y"))},getEdgeTargetPosition:function(J){var r=this,c=r.getDataUI(J),K=c.s,R=c._data._41I;return Ci(r,R,K("edge.target.position"),K("edge.target.offset.x"),K("edge.target.offset.y"),K("edge.target.anchor.x"),K("edge.target.anchor.y"))},invalidateAll:function(t){var n=this;if(t){for(var _ in n._25I){var E=n._25I[_];E&&E.dispose()}n._25I={},n._56I={},n._24I={},n._34I.clear(),n.redraw()}else n.dm().each(function($){n.invalidateData($)})},invalidateSelection:function(){var U=this;U.sm().each(function(k){U.invalidateData(k)})},invalidateData:function($){var o=this;o._24I[$._id]=$,o._21Q($),o.iv()},_21Q:function(S){var A=this,L=A._24I;if(ck(S)&&en[S.s(xi)]){var c=S.getSourceAgent();c&&c.getAgentEdges().each(function(V){L[V._id]=V}),c=S.getTargetAgent(),c&&c.getAgentEdges().each(function(C){L[C._id]=C}),A.iv()}},redraw:function(e){var m=this;m._32I||(e?m._34I.add(e):(m._32I=1,m._34I.clear()),m.iv())},each:function(Q,D){var R,C,$,d=0,x=this.getLayers(),V=this._dataModel,g=V._datas._as,b=g.length;if(x){for(var j=x.length;j>d;d++)if($=x[d],$p($)&&($=$.name),V.isHierarchicalRendering()){var k=function(S){return S._layer===$?D?Q.call(D,S):Q(S):void 0};if(this._dataModel.eachByHierarchical(k)===!1)return}else for(var p=0;b>p;p++)if(R=g[p],R._layer===$&&(C=D?Q.call(D,R):Q(R),C===!1))return}else if(V.isHierarchicalRendering())this._dataModel.eachByHierarchical(Q,null,D);else for(;b>d;d++)if(R=g[d],C=D?Q.call(D,R):Q(R),C===!1)return},reverseEach:function(w,n){var J,v,N,u,l=this._dataModel,z=l._layers,m=l._datas._as,t=m.length;if(z){for(J=z.length-1;J>=0;J--)if(u=z[J],$p(u)&&(u=u.name),l.isHierarchicalRendering()){var j=function(W){return W._layer===u?n?w.call(n,W):w(W):void 0};if(l.reverseEachByHierarchical(j)===!1)return}else for(var K=t-1;K>=0;K--)if(v=m[K],v._layer===u&&(N=n?w.call(n,v):w(v),N===!1))return}else if(l.isHierarchicalRendering())l.reverseEachByHierarchical(w,null,n);else for(J=t-1;J>=0;J--)if(v=m[J],N=n?w.call(n,v):w(v),N===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var N=this,n=N._84I;if(!n){var T=this.dm().a("width"),p=this.dm().a("height");T>0&&p>0?N._84I={x:0,y:0,width:T,height:p}:(N.each(function(J){N.isVisible(J)&&(n=Kl(n,N.getDataUIBounds(J)))}),N._84I=n?n:Sr)}return N._84I},getScrollRect:function(){return Kl(this.getContentRect(),this._29I)},makeCenter:function(R,x,G){var O=this;if(!O.getWidth()||!O.getHeight())return G||Jj(O.centerData,O,[R,x,!0],500),void 0;O.makeVisible(R),O.validate();var S=O.getDataUIBounds(R);if(S){var f=O.getWidth(),n=O.getHeight(),J=S.x+S.width/2,A=S.y+S.height/2,z=-J*O._zoom+f/2,h=-A*O._zoom+n/2;O.setTranslate(z,h,x)}},fitData:function(N,_,t,O,w){var T=this;if(!T.getWidth()||!T.getHeight())return w||Jj(T.fitData,T,[N,_,t,O,!0],500),void 0;var g=function(){T.makeVisible(N),T.validate();var f=T.getDataUIBounds(N);f&&(f=Hj(f),de(f,t==a?20:t),T.fitRect(f,_,O))};_?x.callWhenLoaded(g):g()},fitContent:function(P,V,n,I){var p=this;if(!p.getWidth()||!p.getHeight())return I||Jj(p.fitContent,p,[P,V,n,!0],500),void 0;var X=function(){p.validate();var Z=Hj(p.getContentRect());de(Z,V==a?20:V),p.fitRect(Z,P,n)};P?x.callWhenLoaded(X):X()},fitRect:function(Z,U,T){var O=this,l=O.getWidth(),a=O.getHeight(),W=Z.x+Z.width/2,x=Z.y+Z.height/2,h=t(l/Z.width,a/Z.height),V=O._zoom,M=-W*V+l/2,b=-x*V+a/2;0===h||isNaN(h)||(T&&(h=t(1,h)),U?(O._65I&&(delete O._65I.finishFunc,O._65I.stop(!0)),O._14o&&O._14o.stop(!0),O.setTranslate(M,b,{finishFunc:function(){O.setZoom(h,U)}})):(O.setTranslate(M,b),O.setZoom(h)))},toCanvas:function(G,W){W=W||this._zoom,this.validateImpl();var $=this,i=$.getContentRect();i.width||(i.width=10),i.height||(i.height=10);var t=xp(),v=i.x*W,f=i.y*W,I=i.width*W,x=i.height*W;ms(t,I,x,1);var Q=wo(t);return G=G||this._dataModel.getBackground(),G&&vm(Q,0,0,I,x,G),$b(Q,-v,-f),Q.scale(W,W),$._42(Q),Q.restore(),t},toDataURL:function(N,p,r){return this.toCanvas(N,r).toDataURL(p||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(D,$){var p=this,l=p.dm().getBackground();if(l){var j=p.dm().a("width"),m=p.dm().a("height");j>0&&m>0&&vm(D,0,0,j,m,l)}var x=p.__htmlOrderList,H=[];if(p._93db(D,$),p.each(function(U){var A=p.getDataUI(U);if(A){var k=p._56I[U._id],Y=A._htmlView;if(k){var F=A._79o();if(Y=A._htmlView,S.HtmlNode&&U instanceof S.HtmlNode)A._42(D);else{var n=p.getViewRect(),i=Y&&Y.layoutHTML;!$||nq($,F)?(i&&(Y.layoutHTML(),A.__outerLayout&&delete A.__outerLayout),A._42(D)):nq(n,F)||!i||A.__outerLayout||(Y.layoutHTML(),A.__outerLayout=!0)}}Y&&(H.push(Y),Y.getView&&(Y=Y.getView()),Y.style.display=k?"block":Uh)}}),x&&H.length>0){var r=!1;if(x.length!==H.length)r=!0;else for(var i=0;i<H.length;i++)if(H[i]!==x[i]){r=!0;break}r&&(H.forEach(function(x){p.appendHTML(x,!0)}),this.__htmlOrderList=H)}else this.__htmlOrderList=H;p._92db(D,$)},validateImpl:function(){this.tryUpdateRootData();var f,E,A,_,C,u=this,t=u.tx(),k=u.ty(),V=u._zoom,y=u._canvas,S=this.getWidth(),v=this.getHeight(),o=u._29I,W={x:-t/V,y:-k/V,width:S/V,height:v/V},p={},x=u._34I,J=u._24I,U=u._32I,T=u._23I;u._24I={},(S!==y.clientWidth||v!==y.clientHeight)&&(ms(y,S,v),U=1),U||$l(W,o)||(U=1),u._29I=W,u.each(function(D){E=D._id;var b=p[E]=u.isVisible(D);b!==u._56I[E]&&(J[E]=D,A=u.getDataUI(J[E]),A&&A._84o(b),u._84o(D,b))},u);for(E in J)A=u.getDataUI(J[E]),A&&(!U&&u._56I[E]&&(C=A._79o(),C&&x.add(C)),A.invalidate()),u._83I=1;if(u._56I=p,!U)for(E in J)p[E]&&(A=u.getDataUI(J[E]),A&&(C=A._79o(),C&&x.add(C)));if(U?_=W:(x.each(function(c){nq(W,c)&&(_=Kl(_,c))}),_&&(de(_,w(1,1/V)),_.x=P(_.x*V)/V,_.y=P(_.y*V)/V,_.width=F(_.width*V)/V,_.height=F(_.height*V)/V,_=Vj(W,_))),u._74O=_,_){f=wo(y);var m=_.x,Q=_.y,L=_.width,s=_.height;m=Math.floor((m*V+t)*Gl),Q=Math.floor((Q*V+k)*Gl),L=Math.ceil(L*V*Gl)+1,s=Math.ceil(s*V*Gl)+1,f.beginPath(),f.rect(m,Q,L,s),f.clip(),f.clearRect(m,Q,L,s),or(f,t,k,V),u._42(f,_),f.restore(),delete u._74O}if(x.clear(),delete u._32I,T&&S>0&&v>0){var A=u.getDataUI(T);if(A){var C=A._79o(),i=u._29I,I=i.x,M=i.y,g=i.width,X=i.height,V=u._zoom;C&&!nq(C,i)&&(C.x+C.width<I&&u.tx(-C.x*V),C.x>I+g&&u.tx(-(C.x+C.width-g)*V),C.y+C.height<M&&u.ty(-C.y*V),C.y>M+X&&u.ty(-(C.y+C.height-X)*V))}delete u._23I}u._83I&&(delete u._83I,delete u._84I),u._98O(),u.countFrame(),je(u._24I)||Jj(u.iv,u)},tryUpdateRootData:function(){var M,Q=this.getFullscreenDatas();for(var u in Q)M=Q[u],this.scaleRootData(M)},scaleRootData:function(j){var M=j.s("fullscreen");if("uniform"===M||"fill"===M){j.setRotation(0);var i,X=j.s("fullscreen.gap")||0,q=this.getWidth()-2*X,I=this.getHeight()-2*X,$=j.getAnchor(),F=j.getScaledSize(),c=F.width,w=F.height,A=j.s("fullscreen.lock");if(A)return"uniform"===M?q/I>c/w?(i=I/w,c=w*q/I):(i=q/c,w=c*I/q):"v"===A?(i=I/w,c=q/i,j.setWidth(c)):(i=q/c,w=I/i,j.setHeight(w)),this.setZoom(i),this.tx(X-(j.getX()-$.x*c)*i),this.ty(X-(j.getY()-$.y*w)*i),void 0;var V=this.tx(),B=this.ty();i=this._zoom;var n={x:(-V+X)/i,y:(-B+X)/i,width:q/i,height:I/i};if("uniform"===M){var _=c/w,v=Math.min(n.width,n.height*_),o=v/_;n.x+=.5*(n.width-v),n.y+=.5*(n.height-o),n.width=v,n.height=o}j.setSize(n.width/j.getScaleX(),n.height/j.getScaleY()),j.setPosition(n.x+$.x*n.width,n.y+$.y*n.height)}},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(x){var G=this;x!==G.isScrollBarVisible()&&(x?(Oc(G._view,G._79O=we()),Oc(G._79O,G._27I=we()),Oc(G._79O,G._28I=we())):(Tn(G._79O),delete G._79O,delete G._27I,delete G._28I),G.fp("scrollBarVisible",!x,x))},getDebugTip:function(){return""},showScrollBar:function(){var D=this;D._79O&&(D._85I||(q(function(){D._86I()},qg),D.iv()),D._85I=new Date)},_86I:function(){var N=this;if(N._85I){var r=new Date,o=r.getTime();o-N._85I.getTime()>=qg?(delete N._85I,N.iv()):q(function(){N._86I()},qg)}},getVScrollBar:function(){return this._27I},getHScrollBar:function(){return this._28I},_98O:function(){var K=this,Q=this._27I,e=this._28I;if(K._79O){if(K._autoHideScrollBar&&!K._85I)return Q.style.visibility=Gk,e.style.visibility=Gk,void 0;var M=K.getScrollBarColor(),$=K._zoom,r=K.getScrollBarSize(),o=K.getViewRect(),b=K.getScrollRect(),y=o.height*$,f=b.height*$,B=o.width*$-r-2,X=y*((o.y-b.y)*$/f),Z=y*(y/f),J=Q.style;f-.5>y?(qc>Z&&(X=X+Z/2-qc/2,0>X&&(X=0),X+qc>y&&(X=y-qc),Z=qc),dp(Q,B,X,r,Z),J.visibility=ic,J.background=M,J.borderRadius=r/2+Af):J.visibility=Gk;var E=o.width*$,G=b.width*$,X=o.height*$-r-2,B=E*((o.x-b.x)*$/G),T=E*(E/G),J=e.style;G-.5>E?(qc>T&&(B=B+T/2-qc/2,0>B&&(B=0),B+qc>E&&(B=E-qc),T=qc),dp(e,B,X,T,r),J.visibility=ic,J.background=M,J.borderRadius=r/2+Af):J.visibility=Gk}},setDataModel:function(t){var I=this,n=I._dataModel,y=I._selectionModel;n!==t&&(n&&(n.ump(I.handleDataModelPropertyChange,I),n.umm(I.handleDataModelChange,I),n.umd(I.handleDataPropertyChange,I),n.removeIndexChangeListener(I._75O,I),n.removeHierarchyChangeListener(I.handleHierarchyChange,I),y||n.sm().ums(I.handleSelectionChange,I)),I._dataModel=t,t.mp(I.handleDataModelPropertyChange,I),t.mm(I.handleDataModelChange,I),t.md(I.handleDataPropertyChange,I),t.addIndexChangeListener(I._75O,I),t.addHierarchyChangeListener(I.handleHierarchyChange,I),y?y._21I(t):t.sm().ms(I.handleSelectionChange,I),I.invalidateAll(!0),I.fp(tf,n,t),I.updateBackground())},getLayersInfo:function(){if(this._layersInfo===i){var z=this.getLayers();z?(this._layersInfo={},z.forEach(function(H){var x=$p(H)?H.name:H;this._layersInfo[x]=H},this)):this._layersInfo=null}return this._layersInfo},calculateEdgePosition:function(e,q,g){var t,_,a=this,E=a.getDataUI(e),M=Wm(E),I=Ro(q,function(e){return td(M,100*e)},100,.001),W=td(M,100*I);if(!g){var N=Fr(E),v=new jl(W.x,W.y),p=49/(a._zoom*a._zoom);for(t=0,_=N.length;_>t;t++)if(v.distanceToSquared(N[t])<p)return{index:t,point:N[t],distance:Math.sqrt((N[t].x-q.x)*(N[t].x-q.x)+(N[t].y-q.y)*(N[t].y-q.y))}}return{percent:I,point:W,distance:Math.sqrt((W.x-q.x)*(W.x-q.x)+(W.y-q.y)*(W.y-q.y))}},calculateAttachPoint:function(){var V=new jl,R=new jl,v=new jl;return function(e,w){var X=this.getAttachPoints(e);if(!X||!X.length)return null;v.set(w.x,w.y);for(var z,U,N,h,I=1/0,G=0,l=X.length;l>G;G++)N=X[G],R.x=N.x,R.y=N.y,V.x=N.offsetX||0,V.y=N.offsetY||0,h=Ci(this,e,0,V.x,V.y,R.x,R.y),U=v.distanceToSquared(h),I>U&&(z=G,I=U);I=Math.sqrt(I);var d=this.getAttachStyle(e);if("close"===d){var M=e.s("attach.close.threshold")/this._zoom;if(I>M)return null}return{index:z,distance:I,info:X[z]}}}(),getAttachPoints:function(W){var N=W.s("attach.points");if(N)return N;var R=Nl(W._image);return R?Cs(R.attachPoints,W,this)||null:void 0},getAttachStyle:function(M){var I=M.s("attach.style");if(I)return I;var H=Nl(M._image);return H?Cs(H.attachStyle,M,this)||"close":void 0},updateLayers:function(){this._layersInfo=i,this.invalidateSelection(),this.redraw()},updateBackground:function(){var Q=this.dm().a("width"),U=this.dm().a("height");this._canvas.style.background=Q>0&&U>0?"":this.dm().getBackground()||""},handleDataModelPropertyChange:function(m){if("background"===m.property){var _=this._canvas.style.background,h=m.newValue||"";this.updateBackground(),this.fp("canvasBackground",_,h),this.redraw()}else"a:width"===m.property||"a:height"===m.property?(this._83I=1,this.updateBackground(),this.redraw()):"layers"===m.property?this.updateLayers():"hierarchicalRendering"===m.property&&this.redraw()},handleDataPropertyChange:function(x){this.dm().isHierarchicalRendering()&&"parent"===x.property&&x.data.hasChildren()&&this.redraw(),this.invalidateData(x.data)},onPropertyChanged:function(k){var L=this,y=k.property;if(L.redraw(),"zoom"===y){var Y=L.sm().getSelection();Y.size()&&Y.each(function(J){J.invalidate()})}_l[y]?L.showScrollBar():y===oc&&L.onCurrentSubGraphChanged(k)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(M){var E=this,k=M.kind,o=M.data;if(E._83I=1,"add"===k)E.invalidateData(o),ck(o)&&o.getEdgeGroup()&&o.getEdgeGroup().eachSiblingEdge(E.invalidateData,E);else if(k===rc){E._21Q(o);var p=o._id,x=E._25I[p];if(x){if(E._56I[p]){var e=x._79o();e&&E.redraw(e)}x.dispose(),delete E._25I[p],delete E._24I[p],delete E._56I[p]}o===E._currentSubGraph&&E.setCurrentSubGraph(a)}else k===Sg&&(E.invalidateAll(!0),E.setCurrentSubGraph(a))},_75O:function(u){this.invalidateData(u.data)},handleHierarchyChange:function($){this.dm().isHierarchicalRendering()&&$.data.hasChildren()&&this.redraw(),this.invalidateData($.data)},adjustIndex:function(P){var Z=this;if(Z.isVisible(P)){Z.dm().beginTransaction();for(var j=P;j._parent&&Z.isVisible(j._parent);)j=j._parent;j&&j!==P&&Z._dataModel.adjustIndex(j),Z._dataModel.adjustIndex(P),Z.dm().endTransaction()}},getImage:function(E){return E.getImage?E.getImage():i},getSelectWidth:function(q){var j=Nl(this.getImage(q));return j&&Cs(j.disableSelectedBorder,q,this)?0:q.s("select.width")},getSelectColor:function(E){return E.s("select.color")},isSelectable:function(E,i){if(this.isSelected(E))return!0;if(!i&&E.getParent()instanceof Be&&this.isSelectable(E.getParent(),!0)&&E.getParent().isSyncSize())return!1;var s=this.getLayersInfo();if(s){var u=s[E._layer];if(u&&u.selectable===!1)return!1}return E.s("2d.selectable")&&this.sm().isSelectable(E)},isMovable:function(O){var t=this;if(ck(O)&&O.getStyle(xi)!==Yk)return!1;var r=this.getLayersInfo();if(r){var j=r[O._layer];if(j&&j.movable===!1)return!1}return O.s("2d.movable")?t._movableFunc?t._movableFunc(O):!0:!1},isEditable:function(k){var q=this;if(S._uiSerializing)return q._uieditable;if(!q._editInteractor||!q.isSelected(k))return!1;if(Uk(k)){var M=q.getDataUI(k);if(!M||M._88I)return!1}if(ck(k)&&k.getStyle(xi)!==Yk)return!1;var U=this.getLayersInfo();if(U){var $=U[k._layer];if($&&$.editable===!1)return!1}return k.s("2d.editable")?q._editableFunc?q._editableFunc(k):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(L){return Td(L)&&0!==L.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(L):!0},isRectEditable:function(r){return this._rectEditableFunc?this._rectEditableFunc(r):!0},isAnchorEditable:function(D){return this._anchorEditableFunc?this._anchorEditableFunc(D):!0},isRotationEditable:function(W){return W.setRotation&&W.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(W):!0:!1},getRotationPoint:function(W){var e=W.getAnchor(),R=W.getScale(),u=this._zoom,d=ub(W.getRotation(),0,-W.getHeight()*R.y*e.y-(R.y<0?-1:1)*(Ye?32:16)/u),m=W.p();return d.x+=m.x,d.y+=m.y,d},getLogicalPoint:function(b){var z=this;return yj(b,z._canvas,z.tx(),z.ty(),z._zoom,z._zoom)},getScreenPoint:function(_,y){var U,Q=this;return"object"==typeof _?_.x!==i?(U=_.x,y=_.y):(U=_[0],y=_[1]):U=_,Tr(U,y,Q._canvas,Q.tx(),Q.ty(),Q._zoom,Q._zoom)},getSelectedDataAt:function(H){var E=this;return this.getDataAt(H,function(W){return E.isSelected(W)})},getDataInfoAt:function(R,_,m){var F,X=this.lp(R),K=this.getDataAt(X,_,m);if(K){var x=this.getDataUI(K);F={data:K,ui:x,point:X};var T=x._38o;if(T){var t=T.icons;for(var j in t){var S=t[j],E=T.rects[j];if(E)for(var Y=Cs(S.names,K,this),y=Y?Y.length:0,f=E.rotation,L=y-1;L>=0;L--){var o=Y[L],D=E[L];if(dh(D,X,f))return F.part="icons",F.name=j,F.icon=o,F.rect=D,F.index=L,F.rotation=f,F}}}if(this.isNoteVisible(K)){if(x.note2Info&&dh(x.note2Info.clickRect,X,a,x.note2Info.scale))return F.part="note2",F;if(x.noteInfo&&dh(x.noteInfo.clickRect,X,a,x.noteInfo.scale))return F.part="note",F}if(this.isLabelVisible(K)){if(x.label2Info&&dh(x.label2Info.rect,X,x.label2Info.rotation,x.label2Info.scale))return F.part="label2",F;if(x.labelInfo&&dh(x.labelInfo.rect,X,x.labelInfo.rotation,x.labelInfo.scale))return F.part="label",F}if(K.isInRect&&K.isInRect(X))return F.part="body",F}return F},getDataAt:function(q,s,T){q.target&&(q=this.lp(q));var r,R=this._zoom;return this.reverseEach(function(Z){return(s?s(Z):this.isSelectable(Z))&&this.rectIntersects(Z,bg(q.x,q.y,T,R))?(r=Z,!1):void 0},this),r},getIconInfoAt:function(X,F){var P=this;if(X.target&&(X=P.lp(X)),F||(F=P.getDataAt(X)),F){var j=P.getDataUI(F);
if(j&&j._38o){var J,N=j._38o,r=new kg;for(J in N.icons)r.add(J);for(var d=r.size()-1;d>=0;d--){J=r.get(d);for(var Q=N.rects[J],L=Q.rotation,B=Q.length-1;B>=0;B--){var A=Q[B],M=A.width,G=A.height,h={x:X.x-A.x-M/2,y:X.y-A.y-G/2};L!=a&&(h=ub(-L,h.x,h.y));var A={x:-M/2,y:-G/2,width:M,height:G};if(dh(A,h))return{key:J,index:B,name:N.icons[J].names[B],rect:Q[B],point:X,rotation:L,relativeRect:A,relativePoint:h,data:F}}}}}return a},getDatasInRect:function(L,Z,F){F===i&&(F=1);var e=this,Y=new kg;return e.reverseEach(function(l){F&&!e.isSelectable(l)||(Z?e.rectIntersects(l,L):e.rectContains(l,L))&&Y.add(l)}),Y},moveSelection:function(o,I){var b=this;b.dm().beginTransaction(),Ub(b.sm().toSelection(b.isMovable,b),o,I),b.dm().endTransaction()},moveDatas:function(r,R,H){var o=this;o.dm().beginTransaction(),r instanceof kg||(r=new kg(r)),Ub(r,R,H),o.dm().endTransaction()},getDataUIBounds:function(A){var x=this.getDataUI(A);return x?x._79o():a},drawData:function(t,T,k){var P=this.getDataUI(T);if(P){var F=P._79o();(!k||nq(k,F))&&(P._42(t),T instanceof S.Block&&T.eachChild(function(e){this.drawData(t,e,k)},this))}},getBoundsForGroup:function(Z){return Z.s(jn)?this.getDataUIBounds(Z):a},isPixelPerfect:function(s){return s.s("pixelPerfect")},rectIntersects:function(X,J){this.validate();var I=a;if(this._56I[X._id]){var H=this._25I[X._id];if(H){var S=H._79o();if(zh(J,S))I=!0;else if((J=Vj(J,S))&&(H.rectIntersects&&(I=H.rectIntersects(J)),I==a)){if(!this.isPixelPerfect(X))return!0;var v=J.x,e=J.y,y=J.width,k=J.height,K=this._zoom,Z=x.hitMaxArea,D=y*k*K*K;if(D>Z){var N=Math.sqrt(Z/D);K*=N}y*=K,k*=K,2>y&&(y=2),2>k&&(k=2),v*=K,e*=K;var V=So(y,k);$b(V,-v,-e),V.scale(K,K),this._drawForChecking=!0,this.drawData(V,X,J),this._drawForChecking=!1;try{for(var j=0,b=V.getImageData(0,0,y,k).data;j<b.length;j+=4)if(0!==b[j+3]){I=!0;break}V.restore()}catch(s){qi=a,I=!1}}}}return I?!0:!1},rectContains:function(l,_){if(this._56I[l._id]){var q=this._25I[l._id];if(q)return zh(_,q._79o())}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(l){if(!x.isInput(l.target)){var i=this,m=i._focusData,U=m&&i._25I[m._id],v=0,B=i._dataModel._datas;if(!(m&&m._enabled&&m._editable&&U&&U.onKeyDown&&U.onKeyDown(l)===!0))if(9===l.keyCode&&(m&&(v=B.indexOf(m),Bp(l)?-1===--v&&(v=0):++v===B.size()&&(v=0)),i._focusData=m=B.get(v),i.sm().setSelection(m)),Mq(l)?i.selectAll():oj(l)&&i.isResettable()&&i.reset(),i.sm().isEmpty()){if(i._editing)return;var Q=i.tx(),F=i.ty(),d=!1,f=Bp()?100:10;Mb(l)&&(Q-=f,d=!0),ee(l)&&(F-=f,d=!0),xr(l)&&(Q+=f,d=!0),Rf(l)&&(F+=f,d=!0),d&&i.setTranslate(Q,F)}else{ll(l)&&i.handleDelete(l);var g=Bp()?10:1;Mb(l)&&(i.moveSelection(-g,0),i.fi({kind:"moveLeft"})),ee(l)&&(i.moveSelection(0,-g),i.fi({kind:"moveUp"})),xr(l)&&(i.moveSelection(g,0),i.fi({kind:"moveRight"})),Rf(l)&&(i.moveSelection(0,g),i.fi({kind:"moveDown"}))}}},handleScroll:function(_,n){if(yn(_),this.isZoomable()){if(!this.getEditInteractor()){var I=this.getDataAt(_);if(I){var q=Nl(this.getImage(I));if(q&&Cs(q.scrollable,I,this))return}}var u=this.lp(_);n>0?this.scrollZoomIn(u):0>n&&this.scrollZoomOut(u)}},handlePinch:function(s,L,D){this.isZoomable()&&(this._68I||(L>D?this.pinchZoomIn(s):this.pinchZoomOut(s)))},checkDoubleClickOnNote:function(B,n){var O=this,I=O.lp(B),p=O.getDataUI(n),s=p.note2Info;return s&&n.s("note2.toggleable")&&dh(s.clickRect,I)?(n.s(wk,!n.s(wk)),O.fi({kind:"toggleNote2",event:B,data:n}),!0):(s=p.noteInfo,s&&n.s("note.toggleable")&&dh(s.clickRect,I)?(n.s(Zl,!n.s(Zl)),O.fi({kind:"toggleNote",event:B,data:n}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(i,z){var $=this,l=$.getAutoScrollZone(),M=l/$.getZoom(),p=l/4,k=$._29I,W=$.lp(i),e={x:$.tx(),y:$.ty()};return W&&l>0&&k&&(W.x-k.x<M?$.translate(p,0):k.x+k.width-W.x<M&&$.translate(-p,0),W.y-k.y<M?$.translate(0,p):k.y+k.height-W.y<M&&$.translate(0,-p)),e.x=$.tx()-e.x,e.y=$.ty()-e.y,z&&(z.x+=e.x,z.y+=e.y),e},getMoveMode:function(M,G){var b=G.s("2d.move.mode");return b?b:Oh["88"]?"x":Oh["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function($,Q,R){var e=this;return"currentSubGraph"===Q?{__i:$.getId()}:R.serializeProperty($,Q,e)},deserializeProperty:function(r,M,E){var p=this;if("currentSubGraph"===M){var T=p.dm(),S=T.__idMap;return S[r.__i]}return E.deserializeProperty(r,M,p)},setDefaultCursor:function(q,R){this._defaultCursor=q,R!==!1&&this.setCursor(q)},setCursor:function(R){"default"===R&&(R=this._defaultCursor||R);var D=this.getView().style;D.cursor=R,D.cursor="-webkit-"+R,D.cursor="-moz-"+R},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(s){return s===a||x.getConnectAction(null,s)?(this._currentActionType=s,this.redraw(),!0):!1},getEditStyle:function(m){var G=this.getEditInteractor();return G?G.getStyle(m):i},setEditStyle:function(k,o,G){var H=this.getEditInteractor();return H?(H.setStyle(k,o,G),!0):!1},isConnectActionVisible:function(B){var S=x.getConnectAction(this);if(!S)return!1;var a=S.visible;return nk(a)&&(a=a(this,B)),a},isInteractive:function(k){var N=Nl(this.getImage(k));return N&&Cs(N.interactive,k,this)?!0:k.s("interactive")},appendHTML:function(F,Y){var n=this.getView();if(!(Y||F&&F.parentNode!==n))return!1;var c=F.getView&&F.getView();if(!Y&&c&&c.parentNode===n)return!1;(F.getView||F.isSelfViewEvent)&&(F=F.getView());var V=this.getEditInteractor();return V&&V._canvas?n.insertBefore(F,V._canvas):this.isScrollBarVisible()?n.insertBefore(F,this.getView().lastChild):Oc(n,F),!0},_layoutHTMLImpl:function(O,j,s){if(arguments.length>1){var z,d=this,T=d._zoom;if(j.getView&&(z=j,j=j.getView()),j.style.position="absolute",s){var k=O.getRect();dp(z||j,d.tx()+k.x*T,d.ty()+k.y*T,k.width*T,k.height*T)}else{var W=new Lj,k=O.getAnchorRect(),R=O.getPosition(),c=O.getScale(),K=j.style;dp(z||j,k),W.appendTranslate(d.tx(),d.ty()),W.appendScale(T,T),W.append(new Lj(O.getRotation(),R.x,R.y,c.x,c.y)),pn(K,"transform","matrix("+W.a.toFixed(5)+", "+W.b.toFixed(5)+", "+W.c.toFixed(5)+",\n    "+W.d.toFixed(5)+", "+W.tx.toFixed(5)+", "+W.ty.toFixed(5)+")"),pn(K,"transformOrigin",(-k.x).toFixed(5)+"px "+(-k.y).toFixed(5)+"px"),j.maxtrixAppend=W.invert().translate(-k.x,-k.y)}}else this._layoutHTML&&this._layoutHTML()},getTextEditInfo:function(k){return k instanceof me?{name:"text",accessType:"s",isMultiline:!1}:void 0}}),n.defineProperties(Bl.GraphView.prototype,{layoutHTML:{get:function(){return this._layoutHTMLImplBind||(this._layoutHTMLImplBind=this._layoutHTMLImpl.bind(this)),this._layoutHTMLImplBind},set:function(e){this._layoutHTML=e}}});var Pf=function(F,G){var w=this;w.gv=F,w.s=function(c){return G.getStyle(c)},w._data=G,w._87I=new kg};ri(Pf,n,{_6I:a,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var $=this,W=$.gv.isSelected($._data);return!W||$.isShadowed()?0:$.gv.getSelectWidth($._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(S){var W=this._data,f=this.gv.getBodyColor(W);return f?f:S?W.getStyle(S):a},_2Q:function(I){return this.s(I)},_1Q:function(C,E,I,J){var y=this.s,A=y("2d.gray"),L=y(E+".dash.color");if(A&&(L=x.toGrayColor(L)),C.strokeStyle=L,C.lineWidth=I,C.stroke(),y(E+".dash.3d")){var X=y(E+".dash.3d.color");Kc(C,L,A?x.toGrayColor(X):X,I,this.gv._zoom,y(E+".dash.3d.accuracy"))}so(C,J)},invalidate:function(){this._6I=a},_79o:function(){var B=this;if(!B._6I){var n=B._data,C=B.gv;B.labelInfo=B.label2Info=B.noteInfo=B.note2Info=B._38o=a,B._87I.clear(),B.interactiveInfo=C.isInteractive(n)?{}:a,B._3O(),B._55O=C.isEditable(n)?{_42O:C.isRectEditable(n),_43O:C.isPointEditable(n),_56O:C.isRotationEditable(n)}:a,B._6I=B._81o()}return B._6I},_3O:function(){},getPosition:function(){return Sr},_68o:function(Q,A){Q&&this._87I.add(Oi(Q,A))},_81o:function(){var X=this,l=X.s;X._24O(Bn,"getLabel"),X._24O(pe,"getLabel2"),X._26O(Co,"getNote"),X._26O(mg,"getNote2"),X._15O(),X._55O&&X._48O();var L;if(X._87I.each(function(V){L=Kl(L,V)}),L&&X.isShadowed()){var C=Hj(L);C.x+=l("shadow.offset.x"),C.y+=l("shadow.offset.y"),de(C,l("shadow.blur")),L=Kl(L,C)}return X._87I.clear(),L},_42:function(l){var M=this,Y=M._data,i=M.gv,E=M.s,s=E("opacity"),X=this.isShadowed();if(X){var g=l.shadowOffsetX,v=l.shadowOffsetY,V=l.shadowBlur,t=l.shadowColor,f=i.getZoom();l.shadowOffsetX=E("shadow.offset.x")*f,l.shadowOffsetY=E("shadow.offset.y")*f,l.shadowBlur=E("shadow.blur")*f,l.shadowColor=M.getSelectColor()}if(s!=a){var w=l.globalAlpha;l.globalAlpha=s}M._80o(l),i.isLabelVisible(Y)&&((!i._drawForChecking||E("label.selectable"))&&Qq(l,M.labelInfo),(!i._drawForChecking||E("label2.selectable"))&&Qq(l,M.label2Info)),i.isNoteVisible(Y)&&(lb(l,M.noteInfo),lb(l,M.note2Info)),M._99O(l),s!=a&&(l.globalAlpha=w),X&&(l.shadowOffsetX=g,l.shadowOffsetY=v,l.shadowBlur=V,l.shadowColor=t)},_80o:function(){},_47O:function(){},_24O:function(S,A){var J=this,o=J._data,j=J.gv,W=J.s,i=j[A](o);if(i!=a){var $=W(S+".scale"),u=W(S+".max"),M=W(S+".position"),U=J[S+"Info"]={label:i,scale:$,color:j[A+"Color"](o),font:W(S+".font"),opacity:W(S+".opacity"),align:W(S+".align"),rotation:J.getRotation(W(S+".rotation"),!1,M),background:j[A+"Background"](o)},F=Dq(U,i);u>0&&u<F.width&&(U.labelWidth=F.width,F.width=u),1!==$&&(F.width*=$,F.height*=$);var T=J.getPosition(M,W(S+".offset.x"),W(S+".offset.y"),F,W(S+".position.fixed"));if(F.x=T.x-F.width/2,F.y=T.y-F.height/2,J._68o(U.rect=F,U.rotation),1!==$){var g=F.width/$,k=F.height/$;U.rect={x:T.x-g/2,y:T.y-k/2,width:g,height:k}}}},_26O:function(E,x){var m=this,K=m.gv,$=m._data,X=m.s,A=K[x]($);if(A!=a){var w,c,p=X(E+".scale"),v=m[E+"Info"]={note:A,scale:p,data:$,view:K,expanded:X(E+".expanded"),font:X(E+".font"),color:X(E+".color"),opacity:X(E+".opacity"),align:X(E+".align"),icon:X(E+".icon"),backgroundImage:X(E+".backgroundImage"),borderWidth:X(E+".border.width"),borderColor:X(E+".border.color"),background:K[x+"Background"]($)},q=m.getPosition(X(E+".position"),X(E+".offset.x"),X(E+".offset.y")),T=q.x,U=q.y;if(v.expanded){var r,t=X(E+".max"),D=X(E+".backgroundImage");D?(D=Nl(D),r={width:sr(D,$),height:Qo(D,$)}):r=Dq(v,A),r.width+=6,r.height+=2,t>0&&t<r.width&&(v.labelWidth=r.width,r.width=t),w=r.width,c=r.height+8,v.clickRect={x:T-w*p/2,y:U-c*p,width:w*p,height:c*p*r.height/c}}else{var J=X(E+".icon");J?(J=Nl(J),w=sr(J,$),c=Qo(J,$)):(w=12,c=18),v.clickRect={x:T-w*p/2,y:U-c*p,width:w*p,height:c*p}}v.rect={x:T-w/2,y:U-c*p/2-c/2,width:w,height:c};var I=F(v.borderWidth/2)*p;m._68o({x:T-w*p/2-I,y:U-c*p-I,width:w*p+2*I,height:c*p+2*I})}},_48O:function(){},_99O:function($){var g=this,P=g._38o;if(P){var v=g.gv,N=g._data,y=P.icons,A=g.interactiveInfo;A&&(A._38o={});for(var q in y){var M=y[q],o=P.rects[q];if(o){A&&(A._38o[q]=[]);var Q=Cs(M.opacity,N,v),t=Cs(M.names,N,v),r=t?t.length:0,O=o.rotation;if(Q!=a){var E=$.globalAlpha;$.globalAlpha*=Q}for(var B=0;r>B;B++){var Z=t[B],R=Nl(Z),G=o[B];if(O){var z=G.x+G.width/2,u=G.y+G.height/2;$.save(),$b($,z,u),Hr($,O),$b($,-z,-u)}A&&A._38o[q].push($.interactiveInfo={compInfos:[],matrix:O?new Lj(O,z,u).appendTranslate(-z,-u):new Lj}),hc($,R,Cs(M.stretch,N,v),G.x,G.y,G.width,G.height,g._data,g.gv),$.interactiveInfo=a,O&&$.restore()}Q!=a&&($.globalAlpha=E)}}}}});var Gi=function(O,A){fm(Gi,this,[O,A])};ri(Gi,Pf,{_checkEmptyRect:!0,_40O:function(k,V){var p=this,P=p.s,f=k.rect;(k.borderColor=p.gv.getBorderColor(p._data))&&(k.borderType=P("border.type"),k.borderWidth=P("border.width"),k.borderPadding=P("border.padding"),V=w(V,k.borderPadding+k.borderWidth/2));var d=p._data.getScale(),X=w(1,w(G(d.x),G(d.y)));if(k.selectWidth=p.getSelectWidth()){var D=p.gv._zoom;k.selectType=P("select.type"),k._97o=p.getSelectColor(),k.selectPadding=P("select.padding"),V=w(V,(k.selectPadding+k.selectWidth/2/D)/X)}V>0&&(V*=X,f=Hj(f),de(f,V)),p._68o(f)},_39O:function(h,f){var v,s=this,O=f.rect;if(f.borderWidth>0&&(v=f.borderPadding,h.strokeStyle=f.borderColor,h.lineWidth=f.borderWidth,km(h,f.borderType,{x:O.x-v,y:O.y-v,width:O.width+2*v,height:O.height+2*v}),h.stroke()),f.selectWidth>0){var m=s.gv._zoom;if(v=f.selectPadding,h.strokeStyle=f._97o,h.lineWidth=f.selectWidth/m,f.rotation!=a){h.save(),h.translate(f.position.x,f.position.y),h.rotate(f.rotation);var p=s._data,V=p.getWidth(),c=p.getHeight(),q=f.scale,Q=f.anchor;O={x:q.x*-V*Q.x,y:q.y*-c*Q.y,width:q.x*V,height:q.y*c}}km(h,f.selectType,{x:O.x-v,y:O.y-v,width:O.width+2*v,height:O.height+2*v}),f.rotation!=a&&h.restore(),h.stroke()}},dispose:function(){var V=this,o=V._htmlView;Gi.superClass._3O.call(V),o&&(o.onHTMLRemoved&&o.onHTMLRemoved(),Tn(o))},_3O:function(){var Q=this,U=Q.s,Y=Q._data,I=Q.gv,d=Y.getStyle(vp),S=Q.getBodyColor(),K=Q._83o=d?{shape:d,_53o:Q.getBodyColor("shape.background"),_27Q:Nl(U("shape.repeat.image"),S),shapeGradientPack:U("shape.gradient.pack"),_54o:U("shape.border.width"),_55o:U("shape.border.color"),_56o:U("shape.border.3d"),_57o:U("shape.border.3d.color"),_58o:U("shape.border.3d.accuracy"),shapeGradient:U("shape.gradient"),_59o:U("shape.gradient.color"),_60o:U("shape.border.pattern"),_61o:U("shape.border.cap"),_62o:U("shape.border.join"),shapeForeground:U("shape.foreground"),bodyColor:S,gray:U("2d.gray")}:{img:Nl(I.getImage(Y),S),bodyColor:S,gray:U("2d.gray"),stretch:U("image.stretch")};if(L&&!c);else{var D,t=K.img;t&&t.renderHTML?(Q._htmlInfo&&Q._htmlInfo.img!==t&&(Q._htmlInfo=a),Q._htmlInfo||(Q._htmlInfo={img:t,cache:{}}),D=t.renderHTML(Y,I,Q._htmlInfo.cache)):Q._htmlInfo=a,Q._htmlView&&Q._htmlView!==D&&(Q._htmlView.onHTMLRemoved&&Q._htmlView.onHTMLRemoved(),Tn(Q._htmlView.getView?Q._htmlView.getView():Q._htmlView)),(Q._htmlView=D)&&I.appendHTML(D)&&D.onHTMLAdded&&D.onHTMLAdded(),K.rect=Y.getRect(),K.position=Y.p(),K.scale=Y.getScale(),K.anchor=Y.getAnchor(),K.rotation=Y.getRotation(),d===is&&(K._63o=U("shape.depth"));var j=0;if(d)j=Hq(a,K._54o/2,K._62o),Q.s("shape.dash")&&(j=w(j,(Q.s("shape.dash.width")||K._54o)/2));else if(t&&t.boundExtend)if(j=Cs(t.boundExtend,Y,I),t.boundExtendAbsolute){var T=Y.getScale();j/=I._zoom*w(1,w(G(T.x),G(T.y)))}else if(!Cs(t.fitSize,Y,I)){var C=Cs(t.width,Y,I),g=Cs(t.height,Y,I);j*=w(Y.getWidth()/C,Y.getHeight()/g)}Q._40O(K,j);var u=U("clip.percentage");if(1>u&&(0>u&&(u=0),K.clipRect=Vr(Y.getAnchorRect(),U("clip.direction"),u)),d){var $=U("shape.fill.clip.percentage");1>$&&(0>$&&($=0),K.shapeClipRect=Vr(Y.getAnchorRect(),U("shape.fill.clip.direction"),$));var O=U("shape.foreground.clip.percentage");1>O&&(0>O&&(O=0),K.shapeForegroundClipRect=Vr(Y.getAnchorRect(),U("shape.foreground.clip.direction"),O))}}},getPosition:function(w,$,S,_){var G=gc(w,this._83o.rect,_);return G.x+=$,G.y+=S,G},_80o:function(J){var r=this,M=r.s,E=r.gv,N=r._data,P=r._83o,j=P.rect,s=P.position,w=P.rotation,V=P.anchor,d=P.scale,D=P.shape,Y=P.clipRect;if(!r._checkEmptyRect||j.width>0&&j.height>0){var G=N.getSize();if(G.x=-G.width*V.x,G.y=-G.height*V.y,J.save(),$b(J,s.x,s.y),Hr(J,w),Yj(J,d.x,d.y),Y&&(J.beginPath(),J.rect(Y.x,Y.y,Y.width,Y.height),J.clip()),E._drawForChecking&&P.img&&Cs(P.img.pixelPerfect,N,E)===!1)vm(J,G.x,G.y,G.width,G.height,"#888888");else if(r.freeDraw)r.freeDraw(J,G,P);else if(D){var $,_,h,z,U=P._60o,W=lj(J,U),B=P._27Q,y=P._54o,X=P.shapeGradientPack,m=P.gray,u=J.lineJoin,v=J.lineCap,i=function(i){return m?x.toGrayColor(i):i};"roundRect"===D?$=M("shape.corner.radius"):"polygon"===D?$=M("shape.polygon.side"):"arc"===D&&($=M("shape.arc.from"),_=M("shape.arc.to"),h=M("shape.arc.close"),z=M("shape.arc.oval")),J.lineJoin=P._62o,J.lineCap=P._61o;var R=i(P._53o);if(R||B||X){var l=P.shapeClipRect;l&&(J.save(),J.beginPath(),J.rect(l.x,l.y,l.width,l.height),J.clip()),km(J,D,G,$,_,h,z),X?Bb(J,X):B?hh(J,B,i(P.bodyColor),null,N,E):Fo(J,R,P.shapeGradient,i(P._59o),G),J.fill(),l&&J.restore(),X&&J.restore(),J!==W&&km(W,D,G,$,_,h,z)}else km(W,D,G,$,_,h,z);var q=P.shapeForeground;if(q){J.save();var k=P.shapeForegroundClipRect;k&&(J.beginPath(),J.rect(k.x,k.y,k.width,k.height),J.clip()),km(J,D,G,$,_,h,z),Fo(J,q,M("shape.foreground.gradient"),i(M("shape.foreground.gradient.color")),G),J.fill(),J.restore()}if(y>0){var K=M("shape.border.width.absolute");K&&(J.save(),J.setTransform(1,0,0,1,0,0)),J.lineWidth=y;var f=i(P._55o);J.strokeStyle=f,J.stroke(),K&&J.restore(),P._56o&&Kc(J,f,i(P._57o),y,E._zoom,P._58o)}if(so(J,U),M("shape.dash")){var g=M("shape.dash.width")||y;if(g>0){U=M("shape.dash.pattern");var W=lj(J,U,r._2Q("shape.dash.offset"));W!==J&&km(W,D,G,$,_,h,z),r._1Q(J,"shape",g,U)}}ao(J,R,P._63o,G),J.lineJoin=u,J.lineCap=v}else{var t=r.interactiveInfo;t&&(J.interactiveInfo=t.bodyInfo={compInfos:[],matrix:new Lj(w,s.x,s.y,d.x,d.y)}),P.gray&&(J.compGray=!0);var H=P.img;H&&H.cacheRule!=a&&(H=Ec(J,H,P.stretch,G.width,G.height,N,E,P.bodyColor)),hc(J,H,P.stretch,G.x,G.y,G.width,G.height,N,E,P.bodyColor),J.compGray=!1,J.interactiveInfo=a}J.restore()}r._39O(J,P)},_48O:function(){},_47O:function(){}});var gl=function(n,O){fm(gl,this,[n,O])},Sk=function(W,s,D,B){var M=Og(W,s);return D=B?t(D,M):ol(D,M),M?D/=M:D=0,{x:W.x+(s.x-W.x)*D,y:W.y+(s.y-W.y)*D}};ri(gl,Pf,{_3O:function(){var r,P=this,I=P._data,Y=P.gv,q=P.s,s=q(xi),u=I.isLooped(),U=q("edge.width"),p=q("edge.center"),e=q("edge.offset"),o=Y.getBorderColor(I),Z=o?q("border.width"):0,m=P.getSelectWidth(),c=I._40I,A=I._41I,n=P._78o=c&&A?{looped:u,type:s,width:U,center:p,color:P.getBodyColor("edge.color"),borderColor:o,borderWidth:Z,_97o:m?P.getSelectColor():a,selectWidth:m,pattern:q("edge.pattern"),cap:q("edge.cap"),join:q("edge.join"),is3d:q("edge.3d"),_67o:q("edge.3d.color"),_66o:q("edge.3d.accuracy"),gray:q("2d.gray")}:a;if(n){var C=x.getEdgeType(s);if(C){var v=C(I,Cd(P,Y,I,u,s),Y,P._19Q);v.points&&v.points.size()>1?(n.edgeTypeInfo=v,r=sq(n.edgeTypeInfo.points)):v[Pl]&&v.rect&&(n.edgeTypeInfo=v,r=v.rect)}else{var $=q("edge.source.anchor.x"),Q=q("edge.source.anchor.y"),d=q("edge.target.anchor.x"),F=q("edge.target.anchor.y"),h=Pp(Y,I,"source"),N=Pp(Y,I,"target");if(s===Yk){var _=n.points=q(Wd)||ej,W=_.size();n.segments=q("edge.segments");var S=$!==i||Q!==i||ck(c),f=d!==i||F!==i||ck(A);if(!p)if(e)S||(h=Sk(h,W?_.get(0):N,e,W)),f||(N=Sk(N,W?_.get(W-1):h,e,W));else{var R;S||(R=Ed(h,W?_.get(0):N,Tl(Y,c)),R&&(h={x:R[0],y:R[1]})),f||(R=Ed(W?_.get(W-1):h,N,Tl(Y,A)),R&&(N={x:R[0],y:R[1]}))}r=Kl(sq(n.points),sq(h,N))}else{var l=Cd(P,Y,I,u,s);if(P._19Q||(l=-l),u)h=Hj(h),h.x=Y.getNodeRect(c).x,n.radius=l,r={x:h.x-l,y:h.y-l,width:2*l,height:2*l};else{var V=Og(h,N),M=ol(e,V),B={x:M,y:l},j={x:V-M,y:l},D=J(N.y-h.y,N.x-h.x),E=n.mat=new $r(D);if(n.orienAngle=D,n.angle=N.x<h.x?D+O:D,n.rect={x:B.x,y:B.y,width:j.x-B.x,height:0},n.origin=h,B=E.tf(B),B.x+=h.x,B.y+=h.y,j=E.tf(j),j.x+=h.x,j.y+=h.y,p){var y={x:V,y:0};y=E.tf(y),y.x+=h.x,y.y+=h.y,r=sq([h,B,j,y]),n.c1=h,n.c2=y}else r=sq(B,j);h=B,N=j}}n.sourcePoint=h,n.targetPoint=N,I._lastSourcePoint=h,I._lastTargetPoint=N}var g=0;q("edge.dash")&&(g=q("edge.dash.width")||U);var k="square"===n.cap?.71:.5;Hq(r,w(g*k,U*k+Z+m),n.join),P._68o(r)}},getRotation:function(x,I,d){x=x||0;var $=this._78o;if($){var H,Q=$.angle,D=$.points,h=$.edgeTypeInfo;if(Q!=a)return I?$.orienAngle+x:Q+x;if(h&&h[Pl])return h.getRotation?h.getRotation(this,x,I,d):0;if(h&&h.points){var G=h.points;return H=G.size(),lm[d]?H&&0===H%2?hb(G.get(H/2-1),G.get(H/2),I,x):x:$c[d]?hb(G.get(0),G.get(1),I,x):hb(G.get(H-2),G.get(H-1),I,x)}if(D)return H=D.size(),lm[d]?H&&0===H%2?hb(D.get(H/2-1),D.get(H/2),I,x):x:$c[d]?hb($.sourcePoint,H?D.get(0):$.targetPoint,I,x):hb(H?D.get(H-1):$.sourcePoint,$.targetPoint,I,x)}return x},getPosition:function(u,X,c,n,I){var o=this._78o;if(o){var H,h=o.type,w=o.points,k=o.edgeTypeInfo,f=o.sourcePoint,i=o.targetPoint;if(!h)return o.looped?{x:f.x-o.radius+X,y:f.y+c}:(I&&f&&i&&(f.x>i.x||f.x===i.x&&f.y>i.y)&&(u=Tc[u],c=-c),H=gc(u,o.rect,n),H.x+=X,H.y+=c,H=o.mat.tf(H),H.x+=o.origin.x,H.y+=o.origin.y,H);if(k&&k[Pl])return k.getPosition?k.getPosition(this,u,X,c,n,I):{x:(f.x+i.x)/2,y:(f.y+i.y)/2};if(w){var H,N=w.size();if(lm[u]){if(N){var m=N%2;if(0===m)return Hi(w.get(N/2-1),w.get(N/2),u,X,c,n,I);H=w.get((N-m)/2)}else H={x:(f.x+i.x)/2,y:(f.y+i.y)/2};return H=gc(u,{x:H.x,y:H.y,width:0,height:0},n),H.x+=X,H.y+=c,H}return $c[u]?Hi(f,N?w.get(0):i,u,X,c,n,I):Hi(N?w.get(N-1):f,i,u,X,c,n,I)}if(k){var V=k.points,N=V.size();if(lm[u]){var m=N%2;return 0===m?Hi(V.get(N/2-1),V.get(N/2),u,X,c,n,I):(H=V.get((N-m)/2),H=gc(u,{x:H.x,y:H.y,width:0,height:0},n),H.x+=X,H.y+=c,H)}return $c[u]?Hi(V.get(0),V.get(1),u,X,c,n,I):Hi(V.get(N-2),V.get(N-1),u,X,c,n,I)}}return Sr},_42:function(o){this._78o&&gl.superClass._42.call(this,o)},drawPath:function(L,c){L.beginPath();var T=c.type,W=c.points,U=c.segments,w=c.edgeTypeInfo;if(!T||W){var q=c.sourcePoint,R=q.x,d=q.y,S=c.targetPoint,F=S.x,r=S.y;if(T)if(U){var E=new kg({x:R,y:d});E.addAll(W),E.add({x:F,y:r}),Nr(L,E,U)}else L.moveTo(R,d),W.each(function(_){L.lineTo(_.x,_.y)}),L.lineTo(F,r);else c.looped?L.arc(R,d,c.radius,0,$,!0):c.center?(L.moveTo(c.c1.x,c.c1.y),L.lineTo(R,d),L.lineTo(F,r),L.lineTo(c.c2.x,c.c2.y)):(L.moveTo(R,d),L.lineTo(F,r))}else w&&(w.points?Nr(L,w.points,w.segments):w[Pl]&&w[Pl](L,w))},_80o:function(C){var R=this,K=R.s,p=R._78o,z=p.width,A=p.selectWidth,X=p.borderWidth,u=C.lineJoin,r=C.lineCap,h=p.gray,w=p.pattern;C.lineJoin=p.join,C.lineCap=p.cap,R.drawPath(lj(C,w),p);var e=K("edge.width.absolute");e&&(C.save(),C.setTransform(1,0,0,1,0,0)),A&&(C.strokeStyle=p._97o,C.lineWidth=z+2*(X+A),C.stroke()),X&&(C.strokeStyle=h?x.toGrayColor(p.borderColor):p.borderColor,C.lineWidth=z+2*X,C.stroke());var F=h?x.toGrayColor(p.color):p.color,f=h?x.toGrayColor(p._67o):p._67o;if(C.strokeStyle=F,C.lineWidth=z,C.stroke(),p.is3d&&Kc(C,F,f,z,R.gv._zoom,p._66o),e&&C.restore(),so(C,w),K("edge.dash")){w=K("edge.dash.pattern");var T=lj(C,w,R._2Q("edge.dash.offset"));T!==C&&R.drawPath(T,p),R._1Q(C,"edge",K("edge.dash.width")||z,w)}C.lineJoin=u,C.lineCap=r},_48O:function(){},_47O:function(){}});var wd=function(v,b){fm(wd,this,[v,b])};ri(wd,Gi,{_3O:function(){var c,v,B=this,l=B.s,n=B._data,Z=B.gv;if(B._88I=a,n.isExpanded()&&n.eachChild(function(V){if(Td(V)){var _=Z.getBoundsForGroup(V);_&&(v||(v=[]),v.push(_),c=Kl(c,_))}}),c){var s=Z.getLabel(n),U=l("group.type");c=Ko(U,v,c),cp(c,n,"group.padding",1);var t=B._88I={type:U,rect:c,_64o:c};if(!U&&s!=a){var o,P=B.labelInfo={label:s,color:l("group.title.color"),font:l("group.title.font"),align:l("group.title.align")},L=Dq(P,s),h=L.width,S=L.height,b=l("group.title.align"),x=l("group.title.orientation");if((x===Se||x===ep)&&h>c.width?c.width=h:(x===ce||x===_i)&&h>c.height&&(c.height=h),P.rect={y:c.y-S,width:L.width,height:S},o=b===ce?c.x:b===_i?c.x+c.width-h:c.x+c.width/2-h/2,P.rect.x=o,x===ep)t.titleRect={x:c.x,y:c.y+c.height,width:c.width,height:S},t.rect={x:c.x,y:c.y,width:c.width,height:c.height+S},P.rect={x:o,y:c.y+c.height,width:h,height:S};else if(x===ce){var z=t.titleRect={x:c.x-S,y:c.y,width:S,height:c.height};t.rect={x:c.x-S,y:c.y,width:c.width+S,height:c.height},P.rect={x:z.x+S/2-c.height/2,y:z.y+c.height/2-S/2,width:c.height,height:S},P.rotation=-Math.PI/2}else if(x===_i){var z=t.titleRect={x:c.x+c.width,y:c.y,width:S,height:c.height};t.rect={x:c.x,y:c.y,width:c.width+S,height:c.height},P.rect={x:z.x+S/2-c.height/2,y:z.y+c.height/2-S/2,width:c.height,height:S},P.rotation=Math.PI/2}else t.titleRect={x:c.x,y:c.y-S,width:c.width,height:S+1},t.rect={x:c.x,y:c.y-S,width:c.width,height:c.height+S}}B._40O(t,l("group.border.width")/2)}else wd.superClass._3O.call(B)},getPosition:function(S,Y,m,h){var X=this._88I;if(X){var P=gc(S,X.rect,h);return P.x+=Y,P.y+=m,P}return wd.superClass.getPosition.apply(this,arguments)},_24O:function(h,X){var c=this._88I;(!c||c.type||"label2"===h)&&wd.superClass._24O.call(this,h,X)},_80o:function(a){var u=this,q=u._88I;if(q){var C=u._data,b=u.s,n=u.gv,v=q.type,f=q.rect,S=q._64o,p=q.titleRect,s=u.getBodyColor(),F=Nl(b("group.image"),s),H=b("group.image.stretch"),W=u.getBodyColor("group.background"),x=Nl(b("group.repeat.image"),s),D=b("group.gradient.pack"),L=b("group.gradient"),k=b("group.gradient.color"),Y=b("group.border.width"),A=b("group.border.color"),g=b("group.border.pattern"),M=b("group.title.orientation"),N=b("group.depth");if(v){var z=a.lineJoin,$=a.lineCap;if(a.lineJoin=b("group.border.join"),a.lineCap=b("group.border.cap"),F){if(a.save(),km(a,v,f),a.clip(),hc(a,F,H,f.x,f.y,f.width,f.height,C,n,s),a.restore(),Y>0){var Q=lj(a,g);km(Q,v,f),a.lineWidth=Y,a.strokeStyle=A,a.stroke(),so(a,g)}}else{var Q=lj(a,g);W||x||D?(km(a,v,f),D?Bb(a,D):x?hh(a,x,s,null,C,n):Fo(a,W,L,k,f),a.fill(),D&&a.restore(),a!==Q&&km(Q,v,f)):km(Q,v,f),Y>0&&(a.lineWidth=Y,a.strokeStyle=b("group.border.color"),a.stroke()),so(a,g),v===is&&ao(a,W,N,f)}a.lineJoin=z,a.lineCap=$}else{var I=b("group.title.background"),d=b("group.border.radius");if(F)hc(a,F,H,S.x,S.y,S.width,S.height,C,n,u.getBodyColor());else if(W||x)if(x?hh(a,x,s,null,C,n):Fo(a,W,L,k,S),0===Y)km(a,is,S),a.fill(),ao(a,W,N,S);else{switch(a.beginPath(),M){case ep:be(a,S.x,S.y,S.width,S.height,d,d,0,0);break;case ce:be(a,S.x,S.y,S.width,S.height,0,d,0,d);break;case _i:be(a,S.x,S.y,S.width,S.height,d,0,d,0);break;case Se:be(a,S.x,S.y,S.width,S.height,0,0,d,d)}a.fill()}if(p&&I)if(0===Y)vm(a,p.x,p.y,p.width,p.height,I),ao(a,I,N,p);else{switch(a.beginPath(),a.fillStyle=I,M){case ep:be(a,p.x,p.y,p.width,p.height,0,0,d,d);break;case ce:be(a,p.x,p.y,p.width,p.height,d,0,d,0);break;case _i:be(a,p.x,p.y,p.width,p.height,0,d,0,d);break;case Se:be(a,p.x,p.y,p.width,p.height,d,d,0,0)}a.fill()}if(Y>0){var Q=lj(a,g);if(km(Q,"roundRect",f,d),a.lineWidth=Y,a.strokeStyle=A,p&&b("group.splitLine")){var V=p.x,B=p.y,c=p.width,K=p.height;M===ep?(a.moveTo(V,B),a.lineTo(V+c,B)):M===ce?(a.moveTo(V+c,B),a.lineTo(V+c,B+K)):M===_i?(a.moveTo(V,B),a.lineTo(V,B+K)):(a.moveTo(V,B+K),a.lineTo(V+c,B+K))}a.stroke(),so(a,g)}}u._39O(a,q)}else wd.superClass._80o.call(u,a)}});var Pm=function(H,Z){fm(Pm,this,[H,Z])};ri(Pm,Gi,{_80o:function(M){this._39O(M,this._83o)}});var Sj=function(I,l){fm(Sj,this,[I,l])};ri(Sj,Gi,{_3O:function(){var U=this,o=U._data,Q=U.s,F=U.gv,M=o.getPoints(),p=F.getBorderColor(o),s=p?Q("border.width"):0,z=U.getSelectWidth(),J=Q("shape.border.width"),A=o.getRect(),m=F.getBodyColor(o),K=U._99o=M.isEmpty()?a:{rect:A,rotation:o.getRotation(),fillRule:Q("shape.fill.rule"),scale:o.getScale(),position:o.p(),points:M,segments:o.getSegments(),bodyColor:m,borderColor:p,borderWidth:s,_94o:Q("shape.border.3d"),_95o:Q("shape.border.3d.color"),_96o:Q("shape.border.3d.accuracy"),_97o:z?U.getSelectColor():a,selectWidth:z,_53o:Q("shape.background"),_27Q:Nl(Q("shape.repeat.image"),m),shapeGradientPack:Q("shape.gradient.pack"),_54o:J,_55o:Q("shape.border.color"),shapeGradient:Q("shape.gradient"),_59o:Q("shape.gradient.color"),_60o:Q("shape.border.pattern"),_61o:Q("shape.border.cap"),_62o:Q("shape.border.join"),shapeForeground:Q("shape.foreground"),gray:Q("2d.gray")};if(K){var C=o.getScale(),y=w(1,w(G(C.x),G(C.y)));Q("shape.dash")&&Q("shape.dash.width")>J&&(J=Q("shape.dash.width"));var V=J*("square"===K._61o?.71:.5)+s+z/U.gv._zoom/y;V&&(V*=y,A=Hj(A),Hq(A,V,K._62o)),U._68o(A);var e=Q("clip.percentage");1>e&&(0>e&&(e=0),K.clipRect=Vr(o.getAnchorRect(),Q("clip.direction"),e));var B=Q("shape.fill.clip.percentage");1>B&&(0>B&&(B=0),K.shapeClipRect=Vr(o.getAnchorRect(),Q("shape.fill.clip.direction"),B));var i=Q("shape.foreground.clip.percentage");1>i&&(0>i&&(i=0),K.shapeForegroundClipRect=Vr(o.getAnchorRect(),Q("shape.foreground.clip.direction"),i))}},getPosition:function(C,f,d,q){var r=this._99o;if(r){var p=gc(C,r.rect,q);return p.x+=f,p.y+=d,p}return Sr},_42:function(j){this._99o&&Sj.superClass._42.call(this,j)},_80o:function(X){var l,e=this,$=e.s,s=e._99o,Q=s.position,J=s.scale,i=s.rotation,Z=s.borderWidth,G=s.selectWidth/e.gv._zoom,U=s._27Q,a=s.shapeGradientPack,A=s._54o,y=s.clipRect,h=s.shapeClipRect,j=s.points,b=s.segments,B=e._data.isClosePath(),n=s.fillRule,k=s.gray,m=function(Y){return k?x.toGrayColor(Y):Y},H=m(s._53o),I=H||U||a;X.save(),$b(X,Q.x,Q.y),Hr(X,i),Yj(X,J.x,J.y),y&&(X.beginPath(),X.rect(y.x,y.y,y.width,y.height),X.clip()),I&&h&&(X.save(),X.beginPath(),X.rect(h.x,h.y,h.width,h.height),X.clip()),$b(X,-Q.x,-Q.y);var q=s._60o,_=lj(X,q),N=X.lineJoin,z=X.lineCap;X.lineJoin=s._62o,X.lineCap=s._61o;var M=m(s.bodyColor);I?(Nr(X,j,b,B),a?Bb(X,a):U?hh(X,U,M,null,e._data,e.gv):(l=M?M:H,Fo(X,l,s.shapeGradient,m(s._59o),s.rect)),X.fill(n),h&&(X.restore(),$b(X,-Q.x,-Q.y)),a&&X.restore(),_!==X&&Nr(_,j,b,B)):Nr(_,j,b,B);var u=s.shapeForeground;if(u){X.save();var C=s.shapeForegroundClipRect;C&&($b(X,Q.x,Q.y),X.beginPath(),X.rect(C.x,C.y,C.width,C.height),X.clip(),$b(X,-Q.x,-Q.y)),Nr(X,j,b,B),Fo(X,u,$("shape.foreground.gradient"),m($("shape.foreground.gradient.color")),s.rect),X.fill(n),X.restore()}var Y=$("shape.border.width.absolute");if(Y&&(X.save(),X.setTransform(1,0,0,1,0,0)),G&&(X.strokeStyle=s._97o,X.lineWidth=A+2*(Z+G),X.stroke()),Z&&(X.strokeStyle=m(s.borderColor),X.lineWidth=A+2*Z,X.stroke()),A&&(l=m(s._55o),!H&&M&&(l=M),X.strokeStyle=l,X.lineWidth=A,X.stroke(),s._94o&&Kc(X,l,m(s._95o),A,e.gv._zoom,s._96o)),Y&&X.restore(),so(X,q),$("shape.dash")){var O=$("shape.dash.width")||A;if(O>0){q=$("shape.dash.pattern");var _=lj(X,q,e._2Q("shape.dash.offset"));_!==X&&Nr(_,j,b,B),e._1Q(X,"shape",O,q)}}X.lineJoin=N,X.lineCap=z,X.restore()},_48O:function(){},_47O:function(){}});var _g=function(V,D){fm(_g,this,[V,D])};ri(_g,Sj,{getRotation:function(G,J,T){G=G||0;var g=this._data.getPoints(),E=g.size();return E>1?lm[T]?E&&0===E%2?hb(g.get(E/2-1),g.get(E/2),J,G):G:$c[T]?hb(g.get(0),g.get(1),J,G):hb(g.get(E-2),g.get(E-1),J,G):G},getPosition:function(M,h,H,B,m){var C=this._data.getPoints(),T=C.size();if(T>1){if(lm[M]){var Q=T%2;if(0===Q)return Hi(C.get(T/2-1),C.get(T/2),M,h,H,B,m);var S=C.get((T-Q)/2),i={x:S.x,y:S.y,width:0,height:0};return S=gc(M,i,B),S.x+=h,S.y+=H,S}return $c[M]?Hi(C.get(0),C.get(1),M,h,H,B,m):Hi(C.get(T-2),C.get(T-1),M,h,H,B,m)}return Sr}});var fn=function(C,c){fm(fn,this,[C,c])};ri(fn,Gi,{_3O:function(){var n=this;fn.superClass._3O.call(n);var P=n.s,W=n._83o;n._82o=W.img||W.shape?a:{background:n.getBodyColor("grid.background"),depth:P("grid.depth"),rect:W.rect,_88o:P("grid.cell.depth"),cellBorderColor:P("grid.cell.border.color"),_89o:P("grid.row.count"),_90o:P("grid.column.count"),block:P("grid.block"),_91o:P("grid.block.color"),_92o:P("grid.block.padding"),_93o:P("grid.block.width")}},_80o:function(f){var u=this,L=u._82o;if(!L)return fn.superClass._80o.call(u,f),void 0;var x,$,m=u._data,e=L.background,E=L.rect,g=L.block,w=L._91o,b=L._92o,l=L._93o,A=L._88o,r=L.cellBorderColor,p=L._89o,S=L._90o;if(e)if(vm(f,E.x,E.y,E.width,E.height,e),ao(f,e,L.depth,E),A)for(x=0;p>x;x++)for($=0;S>$;$++)E=m.getCellRect(x,$),E&&ao(f,e,A,E);else if(r){for(f.beginPath(),x=0;p>x;x++)for($=0;S>$;$++)E=m.getCellRect(x,$),E&&f.rect(E.x,E.y,E.width,E.height);f.strokeStyle=r,f.lineWidth=1,f.stroke()}if("h"===g)for(x=0;p>x;x++)E=Kl(m.getCellRect(x,0),m.getCellRect(x,S-1)),de(E,b),yb(f,w,E.x,E.y,E.width,E.height,l);else if("v"===g)for($=0;S>$;$++)E=Kl(m.getCellRect(0,$),m.getCellRect(p-1,$)),de(E,b),yb(f,w,E.x,E.y,E.width,E.height,l);u._39O(f,u._83o)}});var Xr=function(h,t){fm(Xr,this,[h,t])};ri(Xr,Gi,{_checkEmptyRect:!1,_81o:function(){var H=this._data,f=Xr.superClass._81o.call(this),c=H.s("text");if(c!=a){var Q,Y,m=H.s("text.font"),n=H.s("text.align"),x=H.s("text.vAlign"),s=Lm(m,c),k=s.width,e=s.height,r=H.getAnchor(),o=H.getWidth(),S=H.getHeight();"left"===n?Q=-o*r.x:"center"===n?Q=-o*r.x+(o-k)/2:"right"===n&&(Q=o*(1-r.x)-s.width),"top"===x?Y=-S*r.y:"middle"===x?Y=-S*r.y+(S-e)/2:"bottom"===x&&(Y=S*(1-r.y)-s.height);
var F,l=H.getMatrix();if(F=sq([l.tf(Q,Y),l.tf(Q+k,Y),l.tf(Q+k,Y+e),l.tf(Q,Y+e)]),f=Kl(f,F),f&&H.s("text.shadow")){var M=Hj(f);M.x+=H.s("text.shadow.offset.x"),M.y+=H.s("text.shadow.offset.y"),de(M,H.s("text.shadow.blur")),f=Kl(f,M)}}return f}});var _e=Bl.Interactor=function(n){this.gv=this._graphView=n};As("Interactor",n,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(M){this.gv.fi(M)},setCursor:function(U){Ye||this.gv.setCursor(U)},startDragging:function(M){var u=this;u._lastClientPoint=_o(M),u._lastLogicalPoint=u.gv.lp(M),ed(u,M)},clearDragging:function(){var i=this;i._lastClientPoint=i._lastLogicalPoint=i._logicalPoint=a},autoScroll:function(O){return this.gv.autoScroll(O,this._lastClientPoint)}});var jm=a,Of=function(r){jm.handleWindowTouchMove(r)},gg=function(R){jm.handleWindowTouchEnd(R),Q.removeEventListener(fb,Of,E),Q.removeEventListener(Sn,gg,E),jm=a},qs=function(A){jm.handleWindowMouseMove(A)},ei=function(I){jm.handleWindowMouseUp(I),Q.removeEventListener(jo,qs,E),Q.removeEventListener(Uq,ei,E),jm=a},tp=function(S,U){S!==jm&&(jm?Ye?jm.handleWindowTouchEnd(U):jm.handleWindowMouseUp(U):Ye?(Q.addEventListener(fb,Of,E),Q.addEventListener(Sn,gg,E)):(Q.addEventListener(jo,qs,E),Q.addEventListener(Uq,ei,E)),jm=S)},Po=function(E){var d=this;d.gv=E,d._is2d=E instanceof Bl.GraphView,d._is2d&&(d.filter=function(c){return E.isSelectable(c)&&E.isInteractive(c)}),E.getView(),["mousedown","mousemove","mouseleave","touchstart","touchmove",em].forEach(function(N){d.addListener(N)}),d.initImageResource()};ri(Po,_e,{enableVR:function(M){var O=this;if(!!O._vrEnable!==M)if(O._vrEnable=M,M)O.gv.vr.mp(O.onVRControllerChange,O);else if(O.gv.vr.ump(O.onVRControllerChange,O),O._vrRayPolyline){var m=O.gv.dm();m.remove(O._vrRayPolyline),m.remove(O._vrRayHitPoint),O._vrRayPolyline=i,O._vrRayHitPoint=i}},onVRControllerChange:function(C){var c=this,U=C.property,D=C.newValue,f=c.gv.vr.getController(D.id),H=f.getRay();H&&("gamepad.button.trigger"===U?"down"===D._62O?c.handle_mousedown(H):c.handleWindowMouseUp(H):"gamepad.pose"===U&&(c.handle_mousemove(H),c.handleWindowMouseMove(H)))},drawVRRay:function(M,k,E){var W,a=this,D=a.gv,f=a._vrRayPolyline,i=!1;if(f)W=a._vrRayHitPoint;else{var m=D.dm();a._vrRayPolyline=f=new S.Polyline,a._vrRayHitPoint=W=new S.Node,W.s({shape3d:"billboard","shape3d.transparent":!0,"shape3d.texture.scale":10,"shape3d.image":"coreInteractorRayHitImage"}),W.setAnchor3d(.5,.5,.499);var l=.2/D.vr.measureOflength;W.s3(l,l,l),f.s("intersect",!1),W.s("intersect",!1),m.add(f),m.add(W),i=!0}if(k){var F=E.world,O=E.worldNormal,h=F.x,e=F.y,V=F.z;f.s("shape.border.color","red"),f.setPoints([{x:M.origin.x,y:M.origin.z,e:M.origin.y},{x:h,y:V,e:e}]),W.s("3d.visible",!0),W.p3(h,e,V),W.lookAtDirection([O.x,O.y,O.z],"front")}else{f.s("shape.border.color","blue");var B=new S.Math.Vector3;B.copy(M.direction).setLength(1e3/a.gv.vr.measureOflength).add(M.origin),f.setPoints([{x:M.origin.x,y:M.origin.z,e:M.origin.y},{x:B.x,y:B.z,e:B.y}]),W.s("3d.visible",!1)}D.fi({kind:"vrRayIntersect",ray:M,data:k,intersect:E,polyline:f,hitNode:W,begin:i})},addListener:function(t){var v=this;v.gv.getView().addEventListener(t,function(u){x.preventDefault(u),v.disabled||v["handle_"+t](u)},E)},handleWindowTouchMove:function(s){this.handleWindowMouseMove(s)},handleWindowMouseMove:function(t){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",t):(this.handleDownInfo("onBeginDrag",t),this.isDragging=!0))},handleWindowTouchEnd:function(L){this.handleWindowMouseUp(L)},handleWindowMouseUp:function(u){if(this.isDragging&&(this.handleDownInfo("onEndDrag",u),this.isDragging=!1),this.downInfo){var g=this.handle("onUp",u);if(g&&g.data===this.downInfo.data){this.handleMissingUp(u);var e=this,O=2===u.button?"onContextMenu":"onClick";if(!e._dbclickTimer)return e._dbclickTimer=q(function(){delete e._dbclickTimer,e.handleClick(u,O,g),this.downInfo=a},300),void 0;Y(e._dbclickTimer),delete e._dbclickTimer,O="onDoubleClick",e.handleClick(u,O,g)}else this.handleDownInfo("onUp",u);this.downInfo=a}},handle_mouseleave:function(c){var B=this,A=B.gv,x=B.currentInfo?B.currentInfo.data:a;if(x){x.s("onLeave")&&x.s("onLeave")(c,x,A),B.fire("data","onLeave",c,x);var E=B.currentInfo?B.currentInfo.hits:a;if(E)for(var w in E)B.handleLeave(c,w);B.currentInfo=a}},handle_mousewheel:function(s){s.scrollDelta=s.wheelDelta/40,this.handle("onScroll",s)},handle_DOMMouseScroll:function(x){x.scrollDelta=2===x.axis?-x.detail:0,this.handle("onScroll",x)},handle_touchstart:function(J){this.handle_mousedown(J)},handle_touchmove:function(l){this.handle("onMove",l)},handle_mousedown:function(i){this.isDragging&&(this.handleDownInfo("onEndDrag",i),this.isDragging=!1),this.downInfo=this.handle("onDown",i),this.downInfo&&tp(this,i)},handle_mousemove:function(k){var Z=this,I=Z.gv;Z._hoverTimer&&(Y(Z._hoverTimer),delete Z._hoverTimer);var F,C,S,v=Z.handle("onMove",k),m=this.currentInfo?this.currentInfo.data:a,d=this.currentInfo?this.currentInfo.hits:a;if(v&&(C=v.data,S=v.hits,Z._hoverTimer=q(function(){Y(Z._hoverTimer),delete Z._hoverTimer,Z.handle("onHover",k,v)},I.getHoverDelay()||x.hoverDelay)),C!==m){if(m&&(m.s("onLeave")&&m.s("onLeave")(k,m,I),this.fire("data","onLeave",k,m)),C&&(C.s("onEnter")&&C.s("onEnter")(k,C,I),this.fire("data","onEnter",k,C)),d)for(F in d)this.handleLeave(k,F);if(S)for(F in S){var e=S[F];e.target.onEnter&&e.target.onEnter(k,C,I,e.point,e.width,e.height),this.fire(e.type,"onEnter",e.event,e.data,e.image,e.comp,e.point,e)}}else{if(d)for(F in d)S&&S[F]||this.handleLeave(k,F);if(S)for(F in S)if(!d||!d[F]){var e=S[F];e.target.onEnter&&e.target.onEnter(k,C,I,e.point,e.width,e.height),this.fire(e.type,"onEnter",e.event,e.data,e.image,e.comp,e.point,e)}}this.currentInfo=v},handle:function(H,n,d){var C,l=this,m=l.gv;if(l._is2d){if(d=d||m.getDataInfoAt(n,this.filter),!d)return;if(C=d.ui.interactiveInfo){var T,$=d.data;if($.s(H)&&$.s(H)(n,$,m),this.fire("data",H,n,$),"body"===d.part&&C.bodyInfo)T="body",d.hits=this.handleImage(T,m.getImage($),H,n,$,d.point,C.bodyInfo);else if("icons"===d.part&&C._38o){var o=C._38o[d.name];o&&o[d.index]&&(T="icons|"+d.name+"|"+d.index,d.hits=this.handleImage(T,d.icon,H,n,$,d.point,o[d.index]))}}return d}var $,G;if(!d)if(n&&n instanceof S.Math.Ray){var I=m.vr.intersectWorld(n);if($=I.data,G=I.intersect,l.drawVRRay(n,$,G),!$)return;var U=m.getData3dUI($);if(C=U.interactiveInfo,!C)return;d={data:$,part:G.part,ui:U}}else{if(d=m.getDataInfoAt(n),!d)return;d&&(d={data:d.data,part:d.part})}if(!G){$=d.data;var U=m.getData3dUI($);if(d.ui=U,C=U.interactiveInfo,!C)return d;if(G=m.intersectObject(n,$),!G)return}$.s(H)&&$.s(H)(n,$,m),this.fire("data",H,n,$);var z,a=G.part;return"body"!==a&&(z=$.s(a+".image")||$.s("shape3d."+a+".image")),z||(z=$.s("all.image")||$.s("shape3d.image")),C="object"==typeof z?C[z.uuid]:C[z],C&&C.bodyInfo?(d.part="body",d.interactiveInfo=C,d.point=G.uv.multiply({x:C.bodyInfo.rect.width,y:C.bodyInfo.rect.height}),d.image=z,d.hits=this.handleImage("body",z,H,n,$,d.point,C.bodyInfo),d):d},_handleLeaveOrMissing:function(J,X,k){var b="leave"===J?this.currentInfo:this.downInfo;if(b){var f=b.interactiveInfo||b.ui.interactiveInfo;if(f){var r,W,m=b.data;if(this._is2d){if(W=this.gv.lp(X),"body"===b.part&&f.bodyInfo)r="body","leave"===J?this.handleLeaveImage(k,r,this.gv.getImage(m),X,m,W,f.bodyInfo):this.handleMissingUpImage(r,this.gv.getImage(m),X,m,W,f.bodyInfo);else if("icons"===b.part&&f._38o){var C=f._38o[b.name];C&&C[b.index]&&(r="icons|"+b.name+"|"+b.index,"leave"===J?this.handleLeaveImage(k,r,b.icon,X,m,W,C[b.index]):this.handleMissingUpImage(r,b.icon,X,m,W,C[b.index]))}}else{if(!f.bodyInfo)return;var K=this.gv.intersectObject(X,m);W=K?K.uv.multiply({x:f.bodyInfo.rect.width,y:f.bodyInfo.rect.height}):{x:1/0,y:1/0},"leave"===J?this.handleLeaveImage(k,"body",b.image,X,m,W,f.bodyInfo):this.handleMissingUpImage("body",b.image,X,m,W,f.bodyInfo)}}}},handleClick:function(O,V,N){var q=this,H=this.downInfo;if(H&&N){var t,j=N.interactiveInfo||N.ui.interactiveInfo,d=N.data,J=this.gv;if(d.s(V)&&d.s(V)(O,d,J),q.fire("data",V,O,d),j)if(this._is2d){if(H.part===N.part){var s=J.lp(O);"body"===N.part&&j.bodyInfo&&(t="body",this.handleClickImage(t,J.getImage(d),V,O,d,s,j.bodyInfo,N))}}else{if(!j.bodyInfo)return;var i=J.intersectObject(O,d);if(!i)return;s=i.uv.multiply({x:j.bodyInfo.rect.width,y:j.bodyInfo.rect.height}),this.handleClickImage("body",H.image,V,O,d,s,j.bodyInfo,N)}}},handleDownInfo:function(x,d){if(this.downInfo){var X=this.downInfo,b=this.gv,D=X.interactiveInfo||X.ui.interactiveInfo;if(D){var V,q=X.data;if(q.s(x)&&q.s(x)(d,q,b),this.fire("data",x,d,q),this._is2d){var _=b.lp(d);if("body"===X.part&&D.bodyInfo)V="body",this.handleDownInfoImage(V,b.getImage(q),x,d,q,_,D.bodyInfo);else if("icons"===X.part&&D._38o){var Q=D._38o[X.name];Q&&Q[X.index]&&(V="icons|"+X.name+"|"+X.index,this.handleDownInfoImage(V,X.icon,x,d,q,_,Q[X.index]))}}else{if(!D.bodyInfo)return;var T=b.intersectObject(d,q);if(!T)return;_=T.uv.multiply({x:D.bodyInfo.rect.width,y:D.bodyInfo.rect.height}),this.handleDownInfoImage("body",X.image,x,d,q,_,D.bodyInfo)}}}},fire:function(h,W,Z,s,L,r,A,E){this.gv.fi({kind:W,type:h,event:Z,data:s,image:L,comp:r,view:this.gv,point:A,width:E?E.width:i,height:E?E.height:i})},handleImage:function(L,m,_,V,M,l,C){var e={};if(m&&(m=Nl(m))){var w=this.gv,H=C.rect,h=this.convertPoint(l,C);h.inRect&&(m[_]&&m[_](V,M,w,h,H.width,H.height),this.fire("image",_,V,M,m,i,h,H),e[L+"|image"]={target:m,type:"image",image:m,data:M,event:V,point:h,width:H.width,height:H.height});for(var E=C.compInfos,A=m,P=E.length-1;P>=0;P--){var $=E[P],Z=$.comp;h=this.convertPoint(l,$,A,Z,w,M),h.inRect&&(H=$.rect,Z[_]&&Z[_](V,M,w,h,H.width,H.height),this.fire("comp",_,V,M,m,Z,h,H),(m=H.image)&&(m[_]&&m[_](V,M,w,h,H.width,H.height),this.fire("image",_,V,M,m,i,h,H)),e[L+"|"+P]={target:Z,type:"comp",comp:Z,image:m,data:M,event:V,point:h,width:H.width,height:H.height},m&&(e[L+"|"+P+"|image"]={target:m,type:"image",image:m,data:M,event:V,point:h,width:H.width,height:H.height}))}}return e},handleLeave:function(R,X){return this._handleLeaveOrMissing("leave",R,X)},handleMissingUp:function(Z){return this._handleLeaveOrMissing("missing",Z)},handleLeaveImage:function(q,$,L,K,Q,Y,b){if(L&&(L=Nl(L))){var j=this.gv,d=b.rect,X=this.convertPoint(Y,b);q===$+"|image"&&(L.onLeave&&L.onLeave(K,Q,j,X,d.width,d.height),this.fire("image","onLeave",K,Q,L,i,X,d));for(var W=b.compInfos,g=L,C=W.length-1;C>=0;C--){var k=W[C],T=k.comp;X=this.convertPoint(Y,k,g,T,j,Q),d=k.rect,q===$+"|"+C&&(T.onLeave&&T.onLeave(K,Q,j,X,d.width,d.height),this.fire("comp","onLeave",K,Q,L,T,X,d)),(L=d.image)&&q===$+"|"+C+"|image"&&(L.onLeave&&L.onLeave(K,Q,j,X,d.width,d.height),this.fire("image","onLeave",K,Q,L,i,X,d))}}},handleMissingUpImage:function(Q,M,p,r,P,g){var O="onUp",G=this.downInfo.hits;if(G&&M&&(M=Nl(M))){var e=this.gv,c=g.rect,$=this.convertPoint(P,g);!$.inRect&&G[Q+"|image"]&&(M[O]&&M[O](p,r,e,$,c.width,c.height),this.fire("image",O,p,r,M,i,$,c));for(var u=g.compInfos,E=M,x=u.length-1;x>=0;x--){var w=u[x],s=w.comp;$=this.convertPoint(P,w,E,s,e,r),$.inRect||(c=w.rect,G[Q+"|"+x]&&(s[O]&&s[O](p,r,e,$,c.width,c.height),this.fire("comp",O,p,r,M,s,$,c)),(M=c.image)&&G[Q+"|"+x+"|image"]&&(M[O]&&M[O](p,r,e,$,c.width,c.height),this.fire("image",O,p,r,M,i,$,c)))}}},handleDownInfoImage:function(l,$,w,V,T,Y,n){var z=this.downInfo.hits;if(z&&$&&($=Nl($))){var C=this.gv,f=n.rect,h=this.convertPoint(Y,n);z[l+"|image"]&&($[w]&&$[w](V,T,C,h,f.width,f.height),this.fire("image",w,V,T,$,i,h,f));for(var s=n.compInfos,b=$,g=s.length-1;g>=0;g--){var L=s[g],q=L.comp;h=this.convertPoint(Y,L,b,q,C,T),f=L.rect,z[l+"|"+g]&&(q[w]&&q[w](V,T,C,h,f.width,f.height),this.fire("comp",w,V,T,$,q,h,f)),($=f.image)&&z[l+"|"+g+"|image"]&&($[w]&&$[w](V,T,C,h,f.width,f.height),this.fire("image",w,V,T,$,i,h,f))}}},handleClickImage:function(I,t,j,L,s,H,v,Y){var _=this.downInfo.hits,Q=Y.hits;if(_&&t&&(t=Nl(t))){var P=this.gv,w=v.rect,f=this.convertPoint(H,v);_[I+"|image"]&&(t[j]&&t[j](L,s,P,f,w.width,w.height),this.fire("image",j,L,s,t,i,f,w));for(var K=v.compInfos,U=t,o=K.length-1;o>=0;o--){var W=K[o],y=W.comp;f=this.convertPoint(H,W,U,y,P,s),w=W.rect,_[I+"|"+o]&&Q[I+"|"+o]&&(y[j]&&y[j](L,s,P,f,w.width,w.height),this.fire("comp",j,L,s,t,y,f,w)),(t=w.image)&&_[I+"|"+o+"|image"]&&(t[j]&&t[j](L,s,P,f,w.width,w.height),this.fire("image",j,L,s,t,i,f,w))}}},initImageResource:function(){x.setImage("coreInteractorRayHitImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",opacity:.3,rotation:-1.593,rect:[.73315,.6933,14.5337,14.61341]},{type:"oval",background:"rgb(255,0,0)",borderWidth:1,borderColor:"rgb(250,120,120)",rotation:-1.593,rect:[3.56695,3.75073,8.8661,8.49856]}]})},convertPoint:function($,o,T,C,L,P){var N=o.rect,u=o.matrix.applyInverse($).sub(N),X=u.x>=0&&u.y>=0&&u.x<=N.width&&u.y<=N.height;if(!X)return u;if(C&&Cs(C.pixelPerfect,P,L)){var N,k=1;this._is2d?(k=L.getZoom(),N=bg($.x,$.y,i,k)):N=bg($.x,$.y);var M=!1,J=N.x,z=N.y,y=N.width,c=N.height,F=x.hitMaxArea,v=y*c*k*k;if(v>F){var G=Math.sqrt(F/v);k*=G}y*=k,c*=k,2>y&&(y=2),2>c&&(c=2),J*=k,z*=k;var O=So(y,c),g=new Lj(0,-J,-z,k,k);g.append(o.matrix),L._drawForChecking=!0,C.transform=g;var Z=T.comps;T.comps=[C],jb(O,T,0,0,y,c,P,self),T.comps=Z,delete C.transform,L._drawForChecking=!1;try{for(var B=0,s=O.getImageData(0,0,y,c).data;B<s.length;B+=4)if(0!==s[B+3]){M=!0;break}O.restore()}catch(Y){qi=a,M=!1}u.inRect=M}else u.inRect=!0;return u}});var $n=Bl.DefaultInteractor=function(Y){fm($n,this,[Y])};As("DefaultInteractor",_e,{handle_mousedown:function(n){yn(n);var S=this,E=S.gv,F=E.getDataAt(n);!E.setFocus(n)||E._editing||E._scrolling||(uc(n)?E.handleDoubleClick(n,F):E.handleClick(n,F),!oj()&&F&&(E.isMovable(F)||E.isInteractive(F))||!E.isPannable()||!Rl(n)||Ql(n)||(S._tx=E.tx(),S._ty=E.ty(),S.startDragging(n)))},handleWindowMouseUp:function(t){var q=this,c=q.gv;c._panning&&(delete c._panning,c.onPanEnded(),q.fi({kind:"endPan",event:t})),delete q._tx,delete q._ty,q.clearDragging()},handle_mousemove:function(p){var G=this,N=G.gv;G._hoverTimer&&(Y(G._hoverTimer),delete G._hoverTimer),G._hoverTimer=q(function(){G.fi({kind:"hover",event:p}),Y(G._hoverTimer),delete G._hoverTimer},N.getHoverDelay()||x.hoverDelay)},handle_touchmove:function(B){this.handle_mousemove(B)},handleWindowMouseMove:function(A){var Z=this,K=Z.gv,I=Z._lastClientPoint;Z.fi({kind:K._panning?"betweenPan":"beginPan",event:A}),K._panning=1,K.setTranslate(Z._tx+A.clientX-I.x,Z._ty+A.clientY-I.y)},handle_mousewheel:function(Y){this.gv.handleScroll(Y,Y.wheelDelta)},handle_DOMMouseScroll:function(r){2===r.axis&&this.gv.handleScroll(r,-r.detail)},handle_keydown:function(U){this.gv.handleKeyDown(U)}});var Gb=Bl.SelectInteractor=function(j){fm(Gb,this,[j])};As("SelectInteractor",_e,{_42:function(){var T=this,m=T.gv,V=m.getZoom(),U=T.mark,I=T.div;I||(I=T.div=we(),Oc(T.getView(),I));var Y={};Y.x=U.x*V+m.tx(),Y.y=U.y*V+m.ty(),Y.width=U.width*V,Y.height=U.height*V,dp(I,Y),this.intersects()?(I.style.border="",I.style.background=m.getRectSelectBackground()):(I.style.background="",I.style.border="1px solid "+m.getRectSelectBorderColor())},handle_mousedown:function(r){var E=this,Z=E.gv;if(E._57I=a,E.pendingClickThrough=a,!(Z._editing||Z._scrolling||oj())){var V=Z.getDataAt(r),C=Z.sm();V?Ql(r)?C.co(V)?C.rs(V):C.as(V):C.co(V)?V instanceof Be&&V.isClickThroughEnabled()&&Rl(r)&&(E.pendingClickThrough=_o(r)):C.ss(V):Ql(r)||!Z.isPannable()?Rl(r)&&(Ql(r)||C.cs(),Z.isRectSelectable()&&(E.startDragging(r),Z._77O=1)):Rl(r)&&(E._57I=_o(r))}},handle_mouseup:function(y){var p=this,C=p.gv,H=p._57I;if(H&&(Og(H,_o(y))<=1&&C.sm().cs(),p._57I=a),p.pendingClickThrough){if(Og(p.pendingClickThrough,_o(y))<=1){var U=C.getDataAt(y);if(U instanceof Be&&U.isClickThroughEnabled()){var x=C.getDataAt(y,function(p){var Z=p.getParent()===U&&C.isSelectable(p,!0);return Z});x&&(y.clickThrough=!0,C.sm().ss(x))}}p.pendingClickThrough=a}},handleWindowMouseUp:function(p){this.clear(p)},handleWindowMouseMove:function(Y){var L=this,d=L.gv;L._logicalPoint=d.lp(Y),L.mark?(L.fi({kind:"betweenRectSelect",event:Y}),d.isPannable()&&L.autoScroll(Y),L.redraw()):L.fi({kind:"beginRectSelect",event:Y}),L.mark=sq(L._lastLogicalPoint,L._logicalPoint),L.redraw()},intersects:function(){var N=this,C=N._lastLogicalPoint,O=N._logicalPoint;return C.x>O.x||C.y>O.y},clear:function(S){var L=this,H=L.gv,r=L.mark;if(L._57I=a,L.pendingClickThrough=a,L._lastLogicalPoint){if(r){if(0!==r.width&&0!==r.height){var E=H.getDatasInRect(r,L.intersects());if(!E.isEmpty()){var X=H.sm(),Q=X.toSelection();E.each(function(n){X.co(n)?Q.remove(n):Q.add(n)}),X.ss(Q)}}Tn(L.div),delete L.div,delete L.mark,L.redraw(),L.fi({kind:"endRectSelect",event:S}),H.onRectSelectEnded()}L.clearDragging(),delete H._77O}},redraw:function(){var X=this;X._draw||(X._draw=1,q(function(){X.mark&&X._42(),delete X._draw},16))}});var Tb=Bl.MoveInteractor=function(k){fm(Tb,this,[k])};As("MoveInteractor",_e,{handle_mousedown:function(_){var x=this,O=x.gv;if(Rl(_)&&!O._editing&&!O._scrolling&&!oj()){var y=O.getSelectedDataAt(_);!y||O.isInteractive(y)&&!O.isMovable(y)?O._focusData=a:(x._data=y,O.handleMouseDown&&O.handleMouseDown(_,y),x.startDragging(_),O.isMovable(y)&&(O._moving=1))}},handleWindowMouseUp:function(D){var V=this,p=V.gv;p.handleMouseUp&&p.handleMouseUp(D,V._data),V.clear(D)},handleWindowMouseMove:function(E){var e=this,_=e._data,c=e.gv;if((!c._93O||!c._93O(E,_))&&c._moving){e._logicalPoint||e.fi({kind:"prepareMove",event:E});var f=e._logicalPoint?"betweenMove":"beginMove",i={kind:f,event:E},y=e._logicalPoint=c.lp(E);"beginMove"!==f||e._alreadyBeginTransaction||(e._alreadyBeginTransaction=!0,c.getDataModel().beginTransaction());var d=e._calcShift(f,E),a=d.x,n=d.y,u=e.gv.getMoveMode(E,_);u&&("x"===u?n=0:"y"===u?a=0:"xy"!==u&&(a=n=0)),c.moveSelection(a,n),e._lastLogicalPoint=y,e.autoScroll(E),e.fi(i)}},_calcShift:function(){var u=this,o=u._logicalPoint,G=u._lastLogicalPoint,S=o.x-G.x,_=o.y-G.y;return{x:S,y:_}},clear:function(e){var q=this,R=q.gv;q._lastLogicalPoint&&(q._lastLogicalPoint=q._data=R._moving=a,q._logicalPoint&&(q.fi({kind:"endMove",event:e}),R.onMoveEnded()),q.clearDragging()),q._alreadyBeginTransaction&&(q._alreadyBeginTransaction=!1,R.getDataModel().endTransaction())}});var Mk=Bl.TextEditInteractor=function(p){fm(Mk,this,[p]),this.init()};As("TextEditInteractor",_e,{init:function(){var p=this,L=this.input=H.createElement("input"),Z=L.style;L.text="text",Z.border="1px solid #d8d8d8",Z.position="absolute",Z.padding="2px 3px",Z.outline="none",Z.marginLeft="-90px",Z.marginTop="-16px",Z.backgroundColor="rgba(255,255,255, 0.9)",Z.fontSize="14px",Z.width="180px",Z.height="32px",Z.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Z.textAlign="center",Z.boxSizing="border-box",L.addEventListener("keyup",function(k){Jc(k)&&p.endTextEdit()});var U=this.textarea=H.createElement("textarea"),f=this.wrap=H.createElement("div");f.appendChild(U),Z=U.style,Z.margin=0,Z.padding="4px",Z.overflow="hidden",Z.boxSizing="border-box",Z.position="absolute",Z.outline="none",Z.backgroundColor="transparent",Z.resize="none",Z.textAlign="center",Z.fontSize="14px",Z.border="none",Z.borderWidth=0,Z.width="100%",Z.top="50%",Z=f.style,Z.boxSizing="border-box",Z.margin=0,Z.padding=0,Z.position="absolute",Z.boxShadow="0 0 13px rgba(16,142,233, 0.5)",Z.border="1px solid #d8d8d8",Z.backgroundColor="rgba(255,255,255, 0.9)",Z.width="180px",Z.marginLeft="-90px",U.addEventListener("keydown",function(b){return(Bp()||Ql())&&Jc(b)?(p.endTextEdit(),void 0):(p.calculateTextareaHeight(String.fromCharCode(b.keyCode)),void 0)});var z=function(D){D.stopPropagation()};L.addEventListener("mousedown",z),L.addEventListener("touchstart",z),U.addEventListener("mousedown",z),U.addEventListener("touchstart",z),p.SIZING_STYLE=["letter-spacing","line-height","padding-top","padding-bottom","font-family","font-weight","font-size","text-rendering","text-transform","width","text-indent","padding-left","padding-right","border-width","box-sizing"],p.HIDDEN_TEXTAREA_STYLE="visibility:hidden; min-height:0 !important;max-height:none !important;height:0 !important;visibility:hidden !important;overflow:hidden !important;position:absolute !important;z-index:-1000 !important;top:0 !important;right:0 !important",p.handleWindowClick=function(o){var H=p._editingDOM,l=H.getBoundingClientRect(),Z=_o(o);dh(l,Z)||p.endTextEdit()}},handle_mousedown:function(M){var D=this,R=D.gv;if(uc(M)&&!R._editing){var $=R.getDataAt(M);if($){var u=R.getTextEditInfo($);u&&(this._editInfo=u,this._editTarget=$,R._editing=!0,u.isMultiline?this.handleMultilineEdit():this.handleTextEdit())}}},handleMultilineEdit:function(){var y=this,I=y.gv,m=y._editTarget,A=y.getTargetValue(),D=y.textarea,f=y.wrap;this.hiddenTextarea||this.createHiddenTextarea(),(null===A||A===i)&&(A=""),D.value=A,y._editingDOM=D,I.getView().appendChild(f),this.layoutHTML(f,m),this.calculateTextareaHeight(),q(function(){D.focus(),Q.addEventListener("mousedown",y.handleWindowClick),Q.addEventListener("touchstart",y.handleWindowClick)},10)},handleTextEdit:function(){var K=this,D=K.gv,N=K._editTarget,z=K.getTargetValue(),B=K.input;(null===z||z===i)&&(z=""),B.value=z,K._editingDOM=B,D.getView().appendChild(B),this.layoutHTML(B,N),q(function(){B.focus(),Q.addEventListener("mousedown",K.handleWindowClick),Q.addEventListener("touchstart",K.handleWindowClick)},10)},layoutHTML:function(Q,E){var w=this.gv,P=w.getZoom();if(E instanceof S.Node){var j=E.getRect();Q.style.left=(j.x+j.width/2)*P+w.tx()+"px",Q.style.top=(j.y+j.height/2)*P+w.ty()+"px"}else if(E instanceof S.Edge){var e=w.getDataUI(E),j=e._6I;Q.style.left=(j.x+j.width/2)*P+w.tx()+"px",Q.style.top=(j.y+j.height/2)*P+w.ty()+"px"}},endTextEdit:function(){var g=this,m=g._editInfo.isMultiline?g.wrap:g.input,t=g._editInfo.isMultiline?g.textarea:g.input;g.setTargetValue(t.value),g.gv.getView().removeChild(m),g.gv._editing=!1,delete g._editingDOM,Q.removeEventListener("mousedown",g.handleWindowClick),Q.removeEventListener("touchstart",g.handleWindowClick)},setTargetValue:function(q){var $=this,I=$._editTarget,j=$._editInfo,D=j.accessType,u=j.name;if(u&&D||(D="p",u="name"),"p"===D){var Q=S.Default.setter(u);I[Q](q)}else"a"===D?I.a(u,q):I.s(u,q)},getTargetValue:function(){var B=this,U=B._editTarget,q=B._editInfo,L=q.accessType,x=q.name;if(x&&L||(L="p",x="name"),"p"===L){var N=S.Default.getter(x);return U[N]()}return"a"===L?U.a(x):U.s(x)},createHiddenTextarea:function(){this.hiddenTextarea=H.createElement("textarea"),this.hiddenTextarea.setAttribute("style","margin:0; padding:0; position:absolute; overflowY:scroll; resize:none; box-sizing:border-box;"),this.hiddenTextarea.setAttribute("rows","1"),this.gv.getView().appendChild(this.hiddenTextarea)},calculateHTMLStyle:function(U,h){if(h&&this.computedStyleCache)return this.computedStyleCache;var e=this,d=Q.getComputedStyle(U),E=d.getPropertyValue("box-sizing")||d.getPropertyValue("-moz-box-sizing")||d.getPropertyValue("-webkit-box-sizing"),V=parseFloat(d.getPropertyValue("padding-bottom"))+parseFloat(d.getPropertyValue("padding-top")),r=parseFloat(d.getPropertyValue("border-bottom-width"))+parseFloat(d.getPropertyValue("border-top-width")),$=e.SIZING_STYLE.map(function(D){return D+":"+d.getPropertyValue(D)}).join(";"),u={sizingStyle:$,paddingSize:V,borderSize:r,boxSizing:E};return h&&(this.computedStyleCache=u),u},calculateTextareaHeight:function(p){p=p||"";var L=this,i=L.textarea,U=L.hiddenTextarea,F=L.wrap,v=32,E=L.calculateHTMLStyle(i,!1),$=E.paddingSize,D=E.borderSize,H=E.boxSizing,n=E.sizingStyle;U.setAttribute("style",n+";"+L.HIDDEN_TEXTAREA_STYLE),U.value=i.value+p;var d=U.scrollHeight;"border-box"===H?d+=D:"content-box"===H&&(d-=$),i.style.height=d+"px",i.style.marginTop=0-.5*d+"px",F.style.height=Math.max(d,v)+"px",F.style.marginTop=d*-.5+"px"}});var bc=Bl.ScrollBarInteractor=function(B){fm(bc,this,[B])};As("ScrollBarInteractor",_e,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(D){var o=this.gv.getViewRect();return this._41o()&&(o.x+o.width-this.gv.lp(D).x)*this.gv.getZoom()<Uj},isH:function(k){var p=this.gv.getViewRect();return this._40o()&&(p.y+p.height-this.gv.lp(k).y)*this.gv.getZoom()<Uj},handle_mousemove:function(r){this.handle_touchmove(r)},handle_touchmove:function(z){if(!ye&&Rl(z)&&this.gv.isScrollBarVisible()){var B=this,O=B.isV(z),N=B.isH(z);(O||N)&&B.gv.showScrollBar(),B.gv._scrolling=O||N}},handleWindowMouseUp:function(y){this.handleWindowTouchEnd(y)},handleWindowTouchEnd:function(S){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=a,this.fi({kind:"endScroll",event:S})},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(i){var j=this;if(j.gv.setFocus(i),yn(i),j.handle_touchmove(i),!(zg(i)>1)&&j.gv._scrolling&&j.gv.isScrollBarVisible()){j._cp=_o(i),j._tx=j.gv.tx(),j._ty=j.gv.ty();var o=j.isV(i);j._state=o?"vScroll":"hScroll",ed(j,i),j.fi({kind:"beginScroll",event:i})}},handleWindowMouseMove:function(J){this.handleWindowTouchMove(J)},handleWindowTouchMove:function(h){var b=_o(h),$=this.gv.getViewRect(),v=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-b.y)*v.height/$.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-b.x)*v.width/$.width),this.fi({kind:"betweenScroll",event:h})}});var yh=Bl.TouchInteractor=function(u,p){p=p||{},p.selectable===i&&(p.selectable=!0),p.movable===i&&(p.movable=!0),p.pannable===i&&(p.pannable=!0),p.pinchable===i&&(p.pinchable=!0),p.editable===i&&(p.editable=!0),this.params=p,fm(yh,this,[u])};As("TouchInteractor",_e,{ms_edit:1,setUp:function(){var j=this;yh.superClass.setUp.call(j),Ye&&j.params.editable&&j.gv.setEditInteractor(j)},tearDown:function(){var M=this;yh.superClass.tearDown.call(M),Ye&&M.params.editable&&M.gv.setEditInteractor(a)},clear:function(j){var m=this,p=m.gv;p._moving&&(m.fi({kind:"endMove",event:j}),delete p._moving,p.onMoveEnded(),p.dm().endTransaction()),p._panning&&(m.fi({kind:"endPan",event:j}),delete p._panning,p.onPanEnded()),p._pinching&&(m.fi({kind:"endPinch",event:j}),delete p._pinching,p.onPinchEnded()),p._editing&&(m._46O(j),m._77I=m._node=m._edge=m._shape=m._rect=m._89I=m._index=p._editing=a),m._moving=m._panning=m._pinching=m._editing=m._57I=m._data=m._beginHistory=a,m.clearDragging()},handle_touchstart:function(f){var K=this;if(!K.gv._editing){yn(f),K._57I=a;var E=K.params,C=K.gv,c=C.sm(),Z=C.getDataAt(f),r=zg(f);if(1===r){if(uc(f))return C.handleDoubleClick(f,Z),void 0;C.handleClick(f,Z),Z&&(C.handleMouseDown&&C.handleMouseDown(f,Z),K._data=Z),E.selectable||(Z=a),Z?(c.co(Z)||c.ss(Z),E.editable&&C.isEditable(Z)&&K._79I(f,Z,!0)?(K._editing=1,K.startDragging(f)):E.movable&&C.isMovable(Z)&&(K._moving=1,K.startDragging(f))):(K._57I=_o(f),E.pannable&&C.isPannable()&&(K._panning=1,K.startDragging(f),K._translate={x:C.tx(),y:C.ty()}))}else if(E.pinchable&&2===r){K._pinching=1,K.startDragging(f);var Q=C.getView(),j=C.getZoom(),m=Q.getBoundingClientRect(),s=f.touches[0],e=f.touches[1],n={x:(s.clientX+e.clientX)/2-m.left,y:(s.clientY+e.clientY)/2-m.top};n.x-=C.tx(),n.y-=C.ty(),n.x/=j,n.y/=j,K._p=n,K._d=Mg(f)}}},handle_touchend:function(R){var N=this,x=N.gv,A=N._57I,S=N._data;A&&(Og(A,_o(R))<=1&&x.sm().cs(),N._57I=a),S&&x.handleMouseUp&&x.handleMouseUp(R,S)},handleWindowTouchEnd:function(H){this.clear(H)},handleWindowTouchMove:function(u){var r=this,_=r.gv,A=zg(u);if(1===A){if(r._editing&&(r._beginHistory||(r._beginHistory=1,_.dm().beginTransaction()),_._editing=1,r._78I(u)),r._moving)r._beginHistory||(r._beginHistory=1,_.dm().beginTransaction()),r.handleMove(u);else if(r._panning){var n=_o(u);_.setTranslate(r._translate.x+n.x-r._lastClientPoint.x,r._translate.y+n.y-r._lastClientPoint.y),r.fi({kind:_._panning?"betweenPan":"beginPan",event:u}),_._panning=1}}else if(2===A&&r._pinching){var Q=Mg(u);_.handlePinch(r._p,Q,r._d),r._d=Q,r.fi({kind:_._pinching?"betweenPinch":"beginPinch",event:u}),_._pinching=1}},handleMove:function(T){var R=this,o=R.gv,I=o.lp(T);o._93O&&o._93O(T,R._data)||(o.moveSelection(I.x-R._lastLogicalPoint.x,I.y-R._lastLogicalPoint.y),R._lastLogicalPoint=I,R.autoScroll(T),R.fi({kind:o._moving?"betweenMove":"beginMove",event:T}),o._moving=1)}});var S=Q.ht,bp=S.graph._editor={Math:S.Math,Guide:{}};bp.getStyle=function(g){var R,N=bp.StyleMap;return N&&(R=N[g],R!==i)?R:bp.DefaultStyleMap[g]},bp.setStyle=function(t,v){var l=bp.StyleMap;l||(l=bp.StyleMap={}),l[t]=v},bp.inEdit=function(w){return w._inXEdit===!0},bp.startEdit=function($){$._inXEdit=!0,bp.Inject.doInject($)},bp._46O=function(m){m._inXEdit=!1,bp.Inject.undoInject(m)},bp.toScreenPosition=function(Z,V){var y=Z.tx(),B=Z.ty(),Y=Z._zoom;return new bp.Math.Vector2(V.x*Y+y,V.y*Y+B)},bp.checkHit=function(R,W,c){return R.distanceTo(W)<c?!0:!1},bp.toWorldPosition=function(_,r){var H=_.tx(),D=_.ty(),y=_._zoom;return{x:(r.x-H)/y,y:(r.y-D)/y}},bp.setAntialias=function(t,y){for(var e,v=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],C=0,q=v.length;q>C&&(e=v[C],!(e in t));C++);t[e],t[e]=y},bp.getTargetCornersOnScreen=function(L,C){if(!C)return null;var n,f=[];if(ue(C,L)){var A=Tl(L,C);n=[{x:A.x,y:A.y},{x:A.x+A.width,y:A.y},{x:A.x+A.width,y:A.y+A.height},{x:A.x,y:A.y+A.height}]}else{if(!C.getCorners)return null;n=C.getCorners()}return n.forEach(function(X){var O=bp.toScreenPosition(L,X);f.push(O.x,O.y)}),f},bp.log=function(){};var ek=bp.Inject={_modules:[]};ek.registAsModule=function(V,p){var Y={},W={};for(var y in V){var e=p.prototype[y];Y[y]=e}V.getBackup=function(R){return Y[R]},V.getBackups=function(){return Y},W.doInject=function(){for(var q in V)"getBackup"!==q&&(p.prototype[q]=V[q])},W.undoInject=function(){for(var n in V)"getBackup"!==n&&(p.prototype[n]=Y[n])},ek._modules.push(W)},ek.doInject=function(D){for(var C,m=ek._modules,L=0,r=m.length;r>L;L++)C=m[L],C.doInject(D)},ek.undoInject=function(q){for(var Y,x=ek._modules,F=0,z=x.length;z>F;F++)Y=x[F],Y.undoInject(q)};var _e=S.graph.EditInteractor=function(j){var X=this,i=H.createElement("canvas");i.className="editCanvas",i.style.position="absolute",X._styleMap={},X._canvas=i,X._context=i.getContext("2d"),_e.superClass.constructor.call(X,j),bp.setAntialias(X._context,!1),X._subModules=[new bp.Anchor(X),new bp.RotateX(X),new bp.Rect(X),new bp.Curve(X),new bp.MoveHelper(X)],X._gridGuide=new bp.Guide.Grid(X),X._rectGuide=new bp.Guide.Rect(X),X._hoverGuide=new bp.Guide.Hover(X)},lq=_e;S.Default.def(_e,S.graph.Interactor,{ms_edit:1,ms_fire:1}),n.defineProperties(_e.prototype,{editDetail:{get:function(){var t=!!this._editDetail;return t},set:function(r){var v=this,Z=v._editDetail;Z!==r&&(v._editDetail=r,v.gv._editing=r,v.fp("editDetail",Z,r),v.fp("pointsEditingMode",Z,r),v.fi({kind:r?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(u){(!this._editDetail||u)&&(this.gv._editing=u,u||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(Y){this._editing=Y,this.gvEditing=Y}},pointsEditingMode:{get:function(){return this.editDetail},set:function(H){var m=this;m.editDetail!==H&&(H?m._tryEnterEditDetailMode():m._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var I=this._gridEnabled;if(!I)return!1;var T=this.gv;return T?!0:!0},set:function(a){a!==this._gridEnabled&&(this._gridEnabled=a,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(G){G!==this._agEnabled&&(this._agEnabled=G,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}},hoverGuide:{get:function(){return this._hoverGuide}}}),_e.prototype.getSubModule=function(R){var I,N,K,D=this._subModules;for(N=0,K=D.length;K>N;N++)if(I=D[N],I.catalog===R)return I},_e.prototype.invokeSubModule=function(o,H){var u=this,Q=u._subModules;
if(Q)for(var d,v,t,D=Array.prototype.slice.call(arguments,2),x=0,w=Q.length;w>x;x++)if(d=Q[x],v=d[o],v&&(t=v.apply(d,D),t!=i&&H))return d},_e.prototype.invokeSubModuleInverse=function($,B){var p=this,v=p._subModules;if(v)for(var _,m,z,d=Array.prototype.slice.call(arguments,2),A=v.length-1;A>=0;A--)if(_=v[A],m=_[$],m&&(z=m.apply(_,d),z!=i&&B))return _},_e.prototype.setUp=function(){bp.log("setUp");var I=this,p=I.gv,S=p.getView(),E=I._canvas;_e.superClass.setUp.call(I),p.setEditInteractor(I),p._79O?S.insertBefore(E,p._79O):S.appendChild(E),bp.startEdit(p),I.invokeSubModule("setUp"),p.dm().mm(I._onDataModelChanged,I),p.dm().md(I._onDataPropertyChanged,I)},_e.prototype.tearDown=function(){bp.log("tearDown");var q=this,W=q.gv,V=W.getView();q._resetCustomCursorStyle(),_e.superClass.tearDown.call(q),W.dm().umm(q._onDataModelChanged,q),W.dm().umd(q._onDataPropertyChanged,q),W.setEditInteractor(null),V.removeChild(q._canvas),q._drawTimer&&(Y(q._drawTimer),q._drawTimer=null),bp._46O(W),q.invokeSubModule("tearDown")},_e.prototype._onDataModelChanged=function(I){var Q=this;("clear"===I.kind||"remove"===I.kind&&Q.editDetail&&I.data===Q.getSubModule("Curve").target)&&(Q.editDetail=!1,Q._42())},_e.prototype._onDataPropertyChanged=function(S){var A=this;if(A.editDetail){var r=A.getSubModule("Curve"),T=S.data;T===r.target&&(T._writing||r._handleDataChanged(S))}},_e.prototype.clear=function(){bp.log("clear")},_e.prototype.redraw=function(){this._42()},_e.prototype._42=function(){var O=this;O._drawTimer||(O._drawTimer=q(function(){O._drawTimer=null,O.drawImpl()},0))},_e.prototype.drawImpl=function(){var e;for(e in{_42:!0})break;return function(){var G=this,c=G._canvas,x=G.gv,H=x.getWidth(),K=x.getHeight(),m=G._context,u=S.Default.getInternal();(c.width!==H||c.height!==K)&&u.setCanvas(c,H,K),m.clearRect(0,0,c.width,c.height);var i=G._getValidSelection();m.save();var r=S.Default.devicePixelRatio;m.scale(r,r),G._gridGuide._42(),G.invokeSubModuleInverse(e,!1,m,x,i),G._rectGuide._42(),G._hoverGuide._42(),m.restore()}}(),_e.prototype._getValidSelection=function(){var B=this,R=B.gv,G=R.sm().getSelection(),k=[];return G.each(function(i){R.isVisible(i)&&R.isEditable(i)&&k.push(i)}),k},_e.prototype.handle_touchmove=function(l){return this.handle_mousemove(l)},_e.prototype.handle_mousemove=function(F){if(!S.Default.isDragging()){var H=this;if(H.editDetail||!oj())if(H.gvEditing=!1,H._checkEdit(F))H.gvEditing=!0;else{if(!H.getStyle("hoverGuideEnabled"))return;H.hoverData=H.gv.getDataAt(F),H._42()}}},_e.prototype.handle_touchstart=function(E){return this.handle_mousedown(E)},_e.prototype.handle_mousedown=function(F){yn(F);var h=this;if(h.editDetail||!oj()){if(uc(F)&&!F.clickThrough){if(h.editDetail){if(h._tryQuitEditDetailMode(F))return}else if(h._tryEnterEditDetailMode())return;h.gv.dm().beginTransaction();var S=h.invokeSubModule("handleDoubleClick",!0,F);if(h.gv.dm().endTransaction(),S)return}var a=h._checkEdit(F);a&&(h._downPosition=h._getLogicalPoint(F),h.gv.dm().beginTransaction(),a.startEdit(h,F),h.editing=!0)}},_e.prototype._checkEdit=function(Q){var I=this,J=I.gv,x=I._getLogicalPoint(Q),j=I.invokeSubModule("check",!0,J,Q,x)||null;return I._editMod=j,j},_e.prototype.handleWindowTouchMove=function(e){return this.handleWindowMouseMove(e)},_e.prototype.handleWindowMouseMove=function(X){var p=this,I=p._downPosition;if(I){var W=p._getLogicalPoint(X);if(W.distanceTo(I)<p.getStyle("moveSensitivity"))return;delete p._downPosition}var c=p._editMod;c&&c.handleEdit(p.gv,X)},_e.prototype._getLogicalPoint=function(Z){var n=this,T=S.Default.getLogicalPoint(Z,n._canvas);return new bp.Math.Vector2(T)},_e.prototype.handleWindowTouchEnd=function(B){return this.handleWindowMouseUp(B)},_e.prototype.handleWindowMouseUp=function(){var t;for(t in{_46O:!0})break;return function(V){var m=this;m.editing=!1,m.setCursor("default"),m.invokeSubModule(t,!1,V),m._42(),m.gv.dm().endTransaction()}}(),_e.prototype.handle_mousewheel=function(R){var B=this;yn(R),B.invokeSubModule("preHandleScroll",!0)||B.gv.handleScroll(R,R.wheelDelta)},_e.prototype.handleDelete=function(){var v=this;if(!v.editDetail){v.gv.dm().beginTransaction();var D=v.invokeSubModule("handleNormalStateDelete",!0);return v.gv.dm().endTransaction(),D||v.gv.removeSelection(),void 0}v.gv.dm().beginTransaction(),v.invokeSubModule("handleDelete",!0),v.gv.dm().endTransaction(),v._42()},_e.prototype.handle_keydown=function(A){var S=this;if((A.metaKey||A.ctrlKey)&&S._42(),oj(A)&&!S.editing)return S.gvEditing=!1,S.setCursor("default"),S._42(),void 0;var g=Jc(A);return S.editDetail?((g||Te(A))&&(S.editDetail=!1,S._42()),S.gv.dm().beginTransaction(),S.invokeSubModule("handle_keydown",!0,A),S.gv.dm().endTransaction(),void 0):(S.gv.dm().beginTransaction(),S.invokeSubModule("handleNormalStateKeyDown",!0,A),S.gv.dm().endTransaction(),g&&S._tryEnterEditDetailMode(),void 0)},_e.prototype.handle_keyup=function(G){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,G),this.gv.dm().endTransaction()},_e.prototype._tryEnterEditDetailMode=function(){var T=this;return!T.editDetail&&T.invokeSubModule("canEnterEditDetailMode",!0)&&1===T._getValidSelection().length?(T.editDetail=!0,T._42(),!0):void 0},_e.prototype._tryQuitEditDetailMode=function(d){var l=this;return l.editDetail?!d||l.invokeSubModule("canQuitEditDetailMode",!0,d)?(l.editDetail=!1,l._42(),!0):!1:!1},_e.prototype.setStyle=function(k,f,v){var z=this;v?bp.setStyle(k,f):z._styleMap[k]=f,"baseColor"===k&&(Rg=f),z.fp("styleChanged",null,{key:k,value:f,base:v}),z._42()},_e.prototype.getStyle=function(D){var H=this,j=H._styleMap[D];return j!==i?j:bp.getStyle(D)},_e.prototype.setCursor=function(q){this._resetCustomCursorStyle(),S.graph.EditInteractor.superClass.setCursor.call(this,q)},_e.prototype._resetCustomCursorStyle=function(){var C=this;if(C._customStyle){var H=this.gv.getView();H.classList&&H.classList.remove&&H.classList.remove(C._customStyle),C._customStyle=null}},_e.prototype._setRotateCursor=function(m){var b=this,$=b._cursorFactory;$||($=b._cursorFactory=new bp.CursorFactory(b));var u=$.getRotateCursor(m),B=b.gv.getView();b._resetCustomCursorStyle(),b._customStyle=u,B.classList&&B.classList.add&&B.classList.add(u)};var Nc=bp.Group=function(i){var x=this;x._entities=i,x._64O=0,x._position={x:0,y:0},x._scale={x:1,y:1},x._anchor={x:.5,y:.5},x._anchor2={x:.5,y:.5}};Nc.prototype={},Nc.prototype.constructor=Nc;var uj=null;Nc.findOrCreateGroup=function(I){if(uj&&uj.checkIsMe(I))return uj;var r=new bp.Group(I);return r.getKeyOb()?(uj=r,r):void 0},Nc.prototype.checkIsMe=function(k){var Z=this._entities;if(Z.length!==k.length)return!1;var O,R={},u=k.length;for(O=0;u>O;O++)R[k[O]._id]=!0;for(O=0;u>O;O++)if(!R[Z[O]._id])return!1;return!0},Nc.prototype.getRotation=function(){return this._64O},Nc.prototype.getPosition=function(){return this._position},Nc.prototype.getAnchor=function(){return this._anchor},Nc.prototype.getWidth=function(){return this._width},Nc.prototype.getScale=function(){return this._scale},Nc.prototype.getSize=function(){return{width:this._width,height:this._height}},Nc.prototype.getHeight=function(){return this._height},Nc.prototype.getKeyOb=function(){for(var Q=this._entities,T=Q.length-1;T>=0;T--){var f=Q[T];if(this.isNode(f))return f}},Nc.prototype.getAnchor2=function(){var o=this,K=o.rotateCenter;if(K)return K;var m=o.getKeyOb();if(!m)return o._anchor;var Y=o._anchor2,T=m.getMatrix();return T.tf({x:m.getWidth()*(Y.x-m.getAnchor().x),y:m.getHeight()*(Y.y-m.getAnchor().y)})},Nc.prototype.setAnchor2=function(H,l){var n=this,i=n.getKeyOb();if(i){var _,P=i.getMatrix();_="number"==typeof H?{x:H,y:l}:H;var $=P.tfi(_);n._anchor2={x:i.getAnchor().x+$.x/i.getWidth(),y:i.getAnchor().y+$.y/i.getHeight()}}},Nc.prototype.setRotation=function(){},Nc.prototype.beginRotate=function(X){this.rotateCenter=X.pos,this.rotateMode=X.groupRotateMode},Nc.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},Nc.prototype.addRotation=function(n,R){return"batch"===R?this._addRotationInBatchMode(n):"block"===R?this._addRotationInBlockMode(n):void 0},Nc.prototype._addRotationInBlockMode=function(t){var r=this,z=r.rotateCenter||r.getPosition();r._entities.forEach(function(n){if(r.isNode(n)){var c=n.getMatrix();c.translate(-z.x,-z.y),c.rotate(t),c.translate(z.x,z.y);var P=Math.sign(n.getScale().x);n.setRotation(J(c.b*P,c.a*P)),n.setPosition(c.tx,c.ty)}})},Nc.prototype._addRotationInBatchMode=function(P){var I=this,N=I._anchor2;I._entities.forEach(function(u){if(I.isNode(u)){var C=u.getAnchor(),K=u.getMatrix(),v=K.tf({x:u.getWidth()*(N.x-C.x),y:u.getHeight()*(N.y-C.y)}),O=new bp.Math.Matrix2d;O.set(K.a,K.b,K.c,K.d,K.tx,K.ty),O.translate(-v.x,-v.y),O.rotate(P),O.translate(v.x,v.y);var s=Math.sign(u.getScale().x);u.setRotation(J(O.b*s,O.a*s)),u.setPosition(O.tx,O.ty)}})},Nc.prototype.setPosition=function(P){var N,T,h,j,p=this,z=p._position,O=P.x-z.x,L=P.y-z.y,U=p._entities;for(T=0,h=U.length;h>T;T++)N=U[T],Td(N)&&(j=N.getPosition(),N.setPosition(j.x+O,j.y+L));p._position=P},Nc.prototype.setScale=function(l,i){var w=this,A=l/w._scale.x,Q=i/w._scale.y;w._adjustChildScaleOrSize(A,Q,"size"),w._scale={x:l,y:i}},Nc.prototype.getRect=function(){var E=this,s=E._position,V=E._width,k=E._height;return{x:s.x-V/2,y:s.y-k/2,width:V,height:k}},Nc.prototype.setSize=function(c,v){var l=this,c=Math.max(1,c),v=Math.max(1,v),w=c/l._width,o=v/l._height;l._adjustChildScaleOrSize(w,o,"size"),l._width=c,l._height=v},Nc.prototype._adjustChildScaleOrSize=function(o,$,m){var F,R,B,u,b,X,C,D,k,g,x,W,P,n,G=this,v=G._position,r=G._entities,Q=new bp.Math.Matrix2d;for(R=0,B=r.length;B>R;R++)if(F=r[R],G.isNode(F)){if(u=F.getPosition(),b=F.getRotation(),X=F.getWidth(),C=F.getHeight(),D=F.getScale(),x=D.x*X,W=D.y*C,Q.identity().scale(x,W).rotate(b).translate(u.x,u.y).translate(-v.x,-v.y).rotate(-G._64O),b=J(Q.b*Math.sign(x),Q.a*Math.sign(x)),Q.scale(o,$),k=Math.cos(b),g=Math.sin(b),Math.abs(k)<.001?(P=Q.b/g,n=-Q.c/g):(P=Q.a/k,n=Q.d/k),"scale"===m)F.setScale(P/X,n/C);else if("size"===m){var d=P/D.x,N=n/D.y;F.setScale(ch(P)*Math.abs(D.x),ch(n)*Math.abs(D.y)),F.setSize(Math.max(.1,Math.abs(d)),Math.max(.1,Math.abs(N)))}Q.rotate(G._64O).translate(v.x,v.y),F.setPosition(Q.tx,Q.ty)}},Nc.prototype.getMatrix=function(){var l=this,T=l._position,U=S.Default.getInternal(),b=l._scale;return new U.Mat(l._64O,T.x,T.y,b.x,b.y)},Nc.prototype.toGlobal=function(M){return this.getMatrix().tf(M)},Nc.prototype.getCorners=function(){var F=this,Q=F._width,A=F._height,L=F._anchor,e=-Q*L.x,u=-A*L.y,d=F.getMatrix();return[d.tf(e,u),d.tf(e,u+A),d.tf(e+Q,u+A),d.tf(e+Q,u)]},Nc.prototype.calcInfo=function(){var Q,T,O,K,t,X,l=this,R=[],z=l._entities,w=l._64O;for(K=0,t=z.length;t>K;K++)X=z[K],l.isNode(X)&&X.getCorners&&R.push.apply(R,X.getCorners());if(R.length){var q=Math.cos(-w),E=Math.sin(-w),y=1/0,d=-1/0,u=1/0,J=-1/0;for(K=0,t=R.length;t>K;K++)O=R[K],Q=O.x,T=O.y,O.x=q*Q-E*T,O.y=E*Q+q*T,y=Math.min(y,O.x),d=Math.max(d,O.x),u=Math.min(u,O.y),J=Math.max(J,O.y);l._width=(d-y)/l._scale.x,l._height=(J-u)/l._scale.y,q=Math.cos(w),E=Math.sin(w);var p=l._anchor;Q=y+(d-y)*p.x,T=u+(J-u)*p.y,l._position={x:q*Q-E*T,y:E*Q+q*T}}},Nc.prototype.isNode=function(x){return Td(x)?ue(x)?!1:!0:!1},Nc.prototype._42=function(E,W,L){var b,w,N,v,C,f,U,A,q=this,V=q._entities,F=q.rotateMode;for("batch"===F&&(A=q.getKeyOb()),b=0,w=V.length;w>b;b++)N=V[b],q.isNode(N)&&(f=N.getRect(),v=bp.toScreenPosition(L,{x:f.x,y:f.y}),C=bp.toScreenPosition(L,{x:f.x+f.width,y:f.y+f.height}),U={min:v,max:C},N===A&&(U.isKeyOb=!0),bp.Icons.DrawIcon(E,W,bp.Icons.GroupSubEntityRect,U))};var vh=bp.CurveActiving=function(k,U){this._curve=k,this._interactor=k._interactor;for(var u in U)this[u]=U[u]};vh.prototype={},vh.prototype.constructor=vh,n.defineProperties(vh.prototype,{point:{get:function(){return this._point},set:function(x){var Y=this;Y._point=x,Y.editingCtrl||Y._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(u){var P=this;P._pairs=u,P.editingCtrl&&P._firePointChange()}}}),vh.prototype._firePointChange=function(){var y=this,A=y.getCurrentEditingPoint();if(!A)return I.fi({kind:"selectPoint"}),void 0;var I=y._interactor,E=this._curve.target;if(E){var W=bp.getDataMatrix(E).invert(),u=A.e;A=W.apply(bp.toWorldPosition(I.gv,A)),A.e=u;var o=y._lastFirePoint;o&&Math.abs(A.x-o.x)<1e-5&&Math.abs(A.y-o.y)<1e-5&&(A.e==i&&o.e==i||Math.abs(A.e-o.e)<1e-5)||(y._lastFirePoint=A,I.fi({kind:"selectPoint",x:A.x,y:A.y,e:A.e}))}},vh.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},vh.prototype.getCurrentEditingPoint=function(){var N=this,U=N.editingCtrl;if(U){var $=N.pairs;if($){var V=$[U.pairId],n=V[U.type];if(n)return n}}return N._point};var xf=bp.CursorFactory=function(k){var D=this;D._interactor=k,D._rotateCursorStyles={}};xf.prototype={},xf.prototype.constructor=xf,xf.prototype.getRotateCursor=function(d){var z=this;0>d&&(d+=2*Math.PI);var f=z._interactor,N=f.getStyle("rotateCursorSize"),B=f.getStyle("rotateCursorRound"),c=Math.round(180*(d/Math.PI)/B);c*B>=360&&(c=0);var Y=z._rotateCursorStyles,H="htCustomRotateStyle_"+N+"_"+B+"_"+c;return Y[H]||(z._produceRotateCursor(H,N,B,c),Y[H]=!0),H},xf.prototype._produceRotateCursor=function(l,m,g,T){var c=this;c._interactor;var Z=c._canvas;Z||(Z=c._canvas=H.createElement("canvas")),Z.width=Z.height=m*devicePixelRatio,Z.style.width=Z.style.height=m+" px";var C=Z.getContext("2d");bp.setAntialias(C,!1),C.scale(devicePixelRatio,devicePixelRatio);var b,d,S,z,K,n=Math.round(m/2),X=""+n+" "+n+",auto !important;";b=Math.PI/180*T*g,C.clearRect(0,0,m,m),C.save(),C.scale(m/32,m/32),C.translate(16,16),C.rotate(b+Math.PI/2),C.beginPath(),C.moveTo(-8,0),C.lineTo(-8,3),C.lineTo(-5,3),C.moveTo(8,0),C.lineTo(8,3),C.lineTo(5,3),C.moveTo(-8,3),C.quadraticCurveTo(0,-6,8,3),C.restore(),C.strokeStyle="white",C.lineWidth=4,C.stroke(),C.strokeStyle="black",C.lineWidth=2,C.stroke(),d=JSON.stringify(Z.toDataURL()),z="cursor:url("+d+")"+X,1!==devicePixelRatio&&(S='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+m+'px" height="'+m+'px"><image xlink:href='+d+' width="'+m+'" height="'+m+'"/></svg>',z+="cursor:url(data:image/svg+xml;base64,"+btoa(S)+")"+X,z+="cursor:-webkit-image-set(url("+d+")"+devicePixelRatio+"x,url("+d+")1x)"+X),K=H.createElement("style"),K.textContent="body."+l+" *, ."+l+"{"+z+"}",H.head.appendChild(K)};var co=bp.Guide.Grid=function(F){var y=this;y._interactor=F,y._alignmentGuideId=0,y._xAlignmentGuide=[],y._yAlignmentGuide=[]};co.prototype={},co.prototype.constructor=co,n.defineProperties(co.prototype,{gridBlockSize:{get:function(){var h=this;return h._gridBlockSize||h._interactor.getStyle("gridBlockSize")},set:function(z){this._gridBlockSize=z,this._interactor._42()}},gridThickLinesEvery:{get:function(){var p=this;return p._gridThickLinesEvery||p._interactor.getStyle("gridThickLinesEvery")},set:function(E){this._gridThickLinesEvery=E,this._interactor._42()}},gridEnabled:{get:function(){var E=this,V=E._interactor;return V.gridEnabled&&E.isValidGrid()}}}),co.prototype._42=function(){var A=this,z=A._interactor;A.gridEnabled&&A.drawGrid(),z.alignmentGuideEnabled&&A.drawAlignmentGuide()},co.prototype.makeMatrix=function(){var o=this,y=o._interactor.getStyle("gridAngle"),q=o._interactor.getStyle("gridRotation"),l=new bp.Math.Matrix2d,L=Math.sin(y),b=Math.cos(y);return l.set(1,0,b,L,0,0),l.rotate(q),l},co.prototype.isValidGrid=function(){var i=this,j=Math.PI,U=i._interactor,p=U.gv;if(p._zoom<U.getStyle("gridZoomThreshold"))return!1;var o=U.getStyle("gridAngle"),m=Math.abs(180*(o%j/j)),d=1-1e-8;return d>m||m>180-d?!1:!0},co.prototype.drawAlignmentGuide=function(){var d=this,G=d._interactor,Z=G.gv,z=G._canvas,K=G._context,b=z.width,j=z.height,U=Z.tx(),P=Z.ty(),s=Z._zoom;K.beginPath(),K.strokeStyle=G.getStyle("gridAlignmentGuideColor"),K.lineWidth=1,d._xAlignmentGuide.forEach(function(g){var x=g.p*s+U;K.moveTo(x,0),K.lineTo(x,j)}),d._yAlignmentGuide.forEach(function(i){var a=i.p*s+P;K.moveTo(0,a),K.lineTo(b,a)}),K.stroke()},co.prototype.drawGrid=function(){function L(E,G,y,q){var D=bp.toScreenPosition(t,W.apply({x:E,y:G})),O=bp.toScreenPosition(t,W.apply({x:y,y:q}));o.moveTo(D.x,D.y),o.lineTo(O.x,O.y)}var E=this,Q=E._interactor,r=E.gridBlockSize,H=E.gridThickLinesEvery,m=Q.getStyle("gridThickColor"),g=Q.getStyle("gridLightColor"),t=Q.gv,U=Q._canvas,o=Q._context,F=U.width,i=U.height,W=E.makeMatrix(),j=W.applyInverse(bp.toWorldPosition(t,{x:0,y:0})),a=W.applyInverse(bp.toWorldPosition(t,{x:F,y:0})),s=W.applyInverse(bp.toWorldPosition(t,{x:0,y:i})),Y=W.applyInverse(bp.toWorldPosition(t,{x:F,y:i})),z=Math.min(j.x,a.x,s.x,Y.x),w=Math.max(j.x,a.x,s.x,Y.x),y=Math.min(j.y,a.y,s.y,Y.y),V=Math.max(j.y,a.y,s.y,Y.y);F=w-z,i=V-y;var K=Math.ceil(z/r),u=Math.floor(w/r),R=Math.ceil(y/r),b=Math.floor(V/r);t.tx(),t.ty(),t._zoom;var f,O,J;for(o.save(),o.lineWidth=1,o.beginPath(),o.strokeStyle=m,J=Math.ceil(K/H)*H;u>=J;J+=H)f=J*r,L(f,y,f,V);for(J=Math.ceil(R/H)*H;b>=J;J+=H)O=J*r,L(z,O,w,O);for(o.stroke(),o.beginPath(),o.strokeStyle=g,J=K;u>=J;J++)0!==J%H&&(f=J*r,L(f,y,f,V));for(J=R;b>=J;J++)0!==J%H&&(O=J*r,L(z,O,w,O));o.stroke(),o.restore()},co.prototype.getAlignmentGuides=function(){var l=this;return{x:l._xAlignmentGuide,y:l._yAlignmentGuide}},co.prototype.addAlignmentGuide=function(x,h,w){var d=this,y="x"===x?d._xAlignmentGuide:d._yAlignmentGuide,w=w?w:++d._alignmentGuideId,R={p:h,id:w};if(y.length){var B=d._findClosestAlignmentGuide(R.p,y);B.dis<0?y.splice(B.index+1,0,R):y.splice(B.index,0,R)}else y.push(R);return d._interactor._42(),w},co.prototype.findClosest=function(g,i,j){var b=this,P=b._interactor,H=P.gv;j&&(g=bp.toWorldPosition(H,g));var A,e,X,B=1/0,q=1/0,w=g.x,t=g.y;if(b.gridEnabled){var T=b.gridBlockSize,$=b.makeMatrix(),E=$.applyInverse(g);E=$.apply({x:Math.round(E.x/T)*T,y:Math.round(E.y/T)*T}),B=E.x-w,q=E.y-t,X=!0}if(P.alignmentGuideEnabled&&(A=b._findClosestAlignmentGuide(w,b._xAlignmentGuide).dis,e=b._findClosestAlignmentGuide(t,b._yAlignmentGuide).dis,Math.abs(A)<Math.abs(B)&&(B=A,X=!0),Math.abs(e)<Math.abs(q)&&(q=e,X=!0)),X){X=!1;var R=H._zoom,I=P.getStyle("smartGuideSensitivity")/R,l={};if(Math.abs(B)<I&&"y"!==i&&(l.x=j?B*R:B,X=!0),Math.abs(q)<I&&"x"!==i&&(l.y=j?q*R:q,X=!0),X)return l}},co.prototype._findClosestAlignmentGuide=function(r,K){if(!K.length)return{dis:1/0};for(var M,n=0,a=K.length-1;a-n>1;)M=Math.floor((n+a)/2),K[M].p<r?n=M:a=M;var h=K[n].p-r,j=K[a].p-r;return Math.abs(h)<=Math.abs(j)?{line:K[n],dis:h,index:n}:{line:K[a],dis:j,index:a}},co.prototype.removeAllAlignmentGuide=function(u){var r=this;"y"!==u&&(r._xAlignmentGuide=[]),"x"!==u&&(r._yAlignmentGuide=[]),r._interactor._42()},co.prototype.removeAlignmentGuide=function(W){for(var w,v,P,N=this,$=N._xAlignmentGuide,y=0;2>y;y++)for($=0===y?N._xAlignmentGuide:N._yAlignmentGuide,w=0,v=$.length;v>w;w++)if(P=$[w],P.id===W)return $.splice(w,1),N._interactor._42(),{axis:0===y?"x":"y",position:P.p};return!1},co.prototype.adjustAlignmentGuide=function(F,O){var b=this,H=b.removeAlignmentGuide(F);return H?(b.addAlignmentGuide(H.axis,O,F),!0):!1};var hi=bp.Guide.Rect=function(Y){var T=this;T._interactor=Y};hi.prototype={},hi.prototype.constructor=hi,hi.prototype.gatherRects=function(){var L,X,G,P,Q=this,N=Q._interactor.gv,R=[],d=[],Z={x:R,y:d},z={},A=N.getDataModel(),W=A.a("width"),g=A.a("height");W&&g&&(L=0,X=0,G=W,P=g,R.push({node:A,type:0,p:L},{node:A,type:1,p:L+G/2},{node:A,type:2,p:L+G}),d.push({node:A,type:0,p:X},{node:A,type:1,p:X+P/2},{node:A,type:2,p:X+P}),z[A._id||0]={x:L,y:X,width:G,height:P}),A.each(function(Y){if(Td(Y)&&!N.isSelected(Y)&&N.isVisible(Y)){var w=!1;if(N.sm().getSelection().each(function(k){w||(Y.isHostOn(k)?w=!0:Y.isDescendantOf(k)&&(w=!0))}),!w){var f=Y.getRect();L=f.x,X=f.y,G=f.width,P=f.height,R.push({node:Y,type:0,p:L},{node:Y,type:1,p:L+G/2},{node:Y,type:2,p:L+G}),d.push({node:Y,type:0,p:X},{node:Y,type:1,p:X+P/2},{node:Y,type:2,p:X+P}),z[Y._id]=f}}}),R.sort(function(E,h){return E.p-h.p}),d.sort(function(g,I){return g.p-I.p}),Q._grid=Z,Q._87I=z},hi.prototype.gatherLines=function(G,D,y){var o,$,u,f,K,j,l,d,k,g,e,E,a=this,Q=[a.findClosest({x:G.x,y:G.y},D),a.findClosest({x:G.x+G.w/2,y:G.y+G.h/2},D),a.findClosest({x:G.x+G.w,y:G.y+G.h},D)],H={},Y=a._87I;y=y||255;var Z,h;for(a._guideLine=[],o=0;2>o;o++)for(H={},0===o?(f="y",d=G.x,k=d+G.w):(f="x",d=G.y,k=d+G.h),$=0;3>$;$++)K=Q[$],K&&isFinite(K[f])&&(Z=1<<3*o+$,y&Z&&(j=K[f+"Line"],l=j.node,h=l._id||0,H[h]||(H[h]=!0,E=Y[h],"y"===f?(g=E.x,e=E.x+E.width):(g=E.y,e=E.y+E.height),u=j.p,a._guideLine.push({type:f,a:d,b:k,c:g,d:e,p:u,center:1===j.type}))))},hi.prototype._binarySearchClosest=function(w,U){if(!U.length)return{dis:1/0};for(var j,h=0,q=U.length-1;q-h>1;)j=Math.floor((h+q)/2),U[j].p<w?h=j:q=j;var F=U[h].p-w,P=U[q].p-w;return Math.abs(F)<=Math.abs(P)?{line:U[h],dis:F}:{line:U[q],dis:P}},hi.prototype.findClosest=function(z,U,M){var J=this,m=J._interactor,d=m.gv,v=J._grid;M&&(z=bp.toWorldPosition(d,z));var x,F=J._binarySearchClosest(z.x,v.x),Q=J._binarySearchClosest(z.y,v.y),V=F.dis,O=Q.dis,o=d._zoom,q=m.getStyle("smartGuideSensitivity")/o,u={};return Math.abs(V)<q&&"y"!==U&&(u.x=M?V*o:V,u.xLine=F.line,x=!0),Math.abs(O)<q&&"x"!==U&&(u.y=M?O*o:O,u.yLine=Q.line,x=!0),x?u:void 0},hi.prototype._42=function(){var r=this,c=r._guideLine;if(c&&!S.Default.isCtrlDown()){var A,b,U,p,f,F,R,W,h,H,o,J,P,t,z,K,u,i=r._interactor,$=i.gv,m=i._context,N=$.tx(),V=$.ty(),_=$._zoom,q=i.getStyle("guideLineTextSpacing");for(A=0,b=c.length;b>A;A++)U=c[A],W=U.type,h=U.p,H=U.a,o=U.b,J=U.c,P=U.d,t=Math.min(H,J),z=Math.max(o,P),"x"===W?(p=h*_+N,f=t*_+V,F=p,R=z*_+V):(p=t*_+N,f=h*_+V,F=z*_+N,R=f),bp.Icons.DrawIcon(i,m,bp.Icons.MoveLineGuide,{rect:[p,f,F,R],center:U.center}),P>=H&&o>=J||(t=H>P?P:o,z=H>P?H:J,u=z-t,"x"===W?(U.center2center||(p-=q,F=p),f=t*_+V,R=z*_+V,K=bp.Icons.MoveLineGuideDistanceV):"y"===W&&(U.center2center||(f-=q,R=f),p=t*_+N,F=z*_+N,K=bp.Icons.MoveLineGuideDistanceH),bp.Icons.DrawIcon(i,m,K,{x0:p,y0:f,x1:F,y1:R,dis:u}))}},hi.prototype.clear=function(){this._guideLine=null};var gd=bp.Guide.Hover=function(m){var U=this;U._interactor=m};gd.prototype={},gd.prototype.constructor=gd,n.defineProperties(gd.prototype,{}),gd.prototype._42=function(){var y=this._interactor;if(y.getStyle("hoverGuideEnabled")&&!y.gvEditing){var R=y.hoverData,J=y.gv;if(Td(R)&&!J.isSelected(R)){var q=R.getRect(),E=bp.toScreenPosition(J,{x:q.x,y:q.y}),O=bp.toScreenPosition(J,{x:q.x+q.width,y:q.y+q.height});bp.Icons.DrawIcon(y,y._context,bp.Icons.HoverDataRect,{min:E,max:O})}}},bp.DefaultStyleMap={baseColor:"rgb(51,153,255)",pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,keepAspectRatio:!1,rotateRound:Math.PI/2,shiftRotateRound:Math.PI/12,rotateSensitivity:Math.PI/60,rotateAsClock:!1,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,edgeHostEdgeMaxDistance:12,edgeHostEdgeHighlighColor:"#5d5d5d",edgeHostPointHighlighColor:"red",edgeHostHighlighPeriod:1500,guideLineTextSpacing:0,hoverGuideEnabled:!1,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var dq=bp.Icons={},Hk=1e4,Je=null,Rg=bp.DefaultStyleMap.baseColor,op="rgb(183,232,135)",qe="rgb(255,204,153)",Mj=6;S.Default.setImage("Icons.RectPoint",{width:Mj,height:Mj,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Rg}},rect:[0,0,Mj,Mj]}]}),dq.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var o=dq.GroupSubEntityRect.data;if(!o)return[];var s=o.min,k=o.max;return[s.x,s.y,s.x,k.y,k.x,k.y,k.x,s.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return dq.GroupSubEntityRect.data.isKeyOb?Rg:Rg}}}]};var Ic=4;dq.HoverDataRect={comps:[{type:"shape",points:{func:function(){var K=dq.HoverDataRect.data;if(!K)return[];var T=K.min,F=K.max,u=Ic;return T.x-=u,T.y-=u,F.x+=u,F.y+=u,[T.x,T.y,T.x,F.y,F.x,F.y,F.x,T.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Rg}},borderCap:"round",borderPattern:[1,4]}]},dq.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[dq.Line.data.P1.x,dq.Line.data.P1.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[dq.Line.data.P2.x,dq.Line.data.P2.y],Mj,Mj]}}}]},dq.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return dq.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},dq.Rect={comps:[{type:"shape",points:{func:function(){var V=dq.Rect.data;if(!V)return[];var O=V.LT,D=V.LB,W=V.RB,j=V.RT;return[O.x,O.y,D.x,D.y,W.x,W.y,j.x,j.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Rg}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},rect:{func:function(){return[[dq.Rect.data.LT.x,dq.Rect.data.LT.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},rect:{func:function(){return[[dq.Rect.data.LB.x,dq.Rect.data.LB.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},rect:{func:function(){return[[dq.Rect.data.RB.x,dq.Rect.data.RB.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},rect:{func:function(){return[[dq.Rect.data.RT.x,dq.Rect.data.RT.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},visible:{func:function(){return dq.Rect.data.L?!0:!1}},rect:{func:function(){return[[dq.Rect.data.L.x,dq.Rect.data.L.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},visible:{func:function(){return dq.Rect.data.R?!0:!1}},rect:{func:function(){return[[dq.Rect.data.R.x,dq.Rect.data.R.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},visible:{func:function(){return dq.Rect.data.T?!0:!1}},rect:{func:function(){return[[dq.Rect.data.T.x,dq.Rect.data.T.y],Mj,Mj]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return dq.Rect.data.rotation}},visible:{func:function(){return dq.Rect.data.B?!0:!1}},rect:{func:function(){return[[dq.Rect.data.B.x,dq.Rect.data.B.y],Mj,Mj]}}}]};var Eg=16;S.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:{func:function(){return Rg}},borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:{func:function(){return Rg}},shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),dq.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[dq.Anchor.data.POS.x,dq.Anchor.data.POS.y],Eg,Eg]}}}]},dq.TipShiftX=12,dq.TipShiftY=12;var Jo=[8,28];dq.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[dq.TipHelper.data.helperPos.x,dq.TipHelper.data.helperPos.y,Jo[0]*dq.TipHelper.data.size,Jo[1]]}},background:{func:function(){return Je.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return dq.TipHelper.data.text}},rect:{func:function(){return[dq.TipHelper.data.helperPos.x,dq.TipHelper.data.helperPos.y,Jo[0]*dq.TipHelper.data.size,Jo[1]]}},color:{func:function(){return Je.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var Fg=7;dq.ShapePoint={comps:[{type:"circle",visible:{func:function(){return!!dq.ShapePoint.data.dynamicVisible}},rect:{func:function(){var l=dq.ShapePoint.data.point,x=dq.ShapePoint.data.size||Fg;return[l,x+10,x+10]}},background:{func:function(){var z=Date.now(),h=dq.ShapePoint.data.dynamicPeriod||1500,w=Math.sin(z%h/h*Math.PI);return"rgba(27,124,22,"+.5*w+")"}},borderWidth:0},{type:"circle",rect:{func:function(){var x=dq.ShapePoint.data.point,b=dq.ShapePoint.data.size||Fg;return[x,b,b]}},background:{func:function(){var v=dq.ShapePoint.data.isEnd;return v?"rgba(27,124,222,0.7)":"#ffffff"}},borderWidth:1,borderColor:{func:function(){return dq.ShapePoint.data.color||Rg}}},{type:"rect",visible:{func:function(){return!!dq.ShapePoint.data.dynamicVisible}},background:"red",borderWidth:0,rotation:Math.PI/4,borderColor:{func:function(){return Rg}},rect:{func:function(){var F=5;return[dq.ShapePoint.data.point,F,F]}}}]},dq.ShapeBgCurve={comps:[{type:"shape",visible:{func:function(){return!!dq.ShapeBgCurve.data.dynamicVisible}},points:{func:function(){return dq.ShapeBgCurve.data.P}},segments:{func:function(){return dq.ShapeBgCurve.data.S}},background:null,borderWidth:6,borderColor:{func:function(){var G=Date.now(),C=dq.ShapeBgCurve.data.dynamicPeriod||1500,i=Math.sin(G%C/C*Math.PI);return"rgba(27,124,22,"+.3*i+")"}}},{type:"shape",points:{func:function(){return dq.ShapeBgCurve.data.P}},segments:{func:function(){return dq.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:{func:function(){return dq.ShapeBgCurve.data.color||Rg}}}]};var Uc=8;dq.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var v=dq.ShapeHighlighPoint.data;return[[v.x,v.y],Uc,Uc]}},background:{func:function(){return Je.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var Lf=10;dq.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var t=dq.ShapeHighlighRealPoint.data;return[[t.x,t.y],Lf,Lf]}},background:"#ffffff",borderWidth:2,borderColor:{func:function(){return Rg}}}]};var Ve=8;dq.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var m=dq.ShapeHighlighCtrlPoint.data,p=m.x,Q=m.y,z=Ve/2;return[p-z,Q-z,p-z,Q+z,p+z,Q+z,p+z,Q-z]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Je.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Je.getStyle("shapeCtrlPointBorderColor")||Rg}}}]};var pb=3;dq.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return dq.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:pb,borderColor:{func:function(){return Je.getStyle("curveHighlightColor")}}}]},dq.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return dq.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},dq.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return dq.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return dq.MoveLineGuide.data.center?op:qe}}}]};var mk=5;dq.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var E=dq.MoveLineGuideDistanceH.data,c=E.x0,D=E.y0;return[c,D-mk,c,D+mk]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:qe},{type:"shape",points:{func:function(){var v=dq.MoveLineGuideDistanceH.data,Q=v.x1,E=v.y1;return[Q,E-mk,Q,E+mk]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:qe},{type:"text",text:{func:function(){return Math.round(dq.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var D=dq.MoveLineGuideDistanceH.data;return[[(D.x0+D.x1)/2,D.y0-10],20,20]}},color:qe,font:"12px Arial",align:"center"}]},dq.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var Y=dq.MoveLineGuideDistanceV.data,F=Y.x0,X=Y.y0;
return[F-mk,X,F+mk,X]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:qe},{type:"shape",points:{func:function(){var s=dq.MoveLineGuideDistanceV.data,E=s.x1,j=s.y1;return[E-mk,j,E+mk,j]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:qe},{type:"text",text:{func:function(){return Math.round(dq.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var l=dq.MoveLineGuideDistanceV.data;return[[l.x0-10,(l.y0+l.y1)/2],20,20]}},color:qe,font:"12px Arial",align:"center"}]},S.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),dq.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var x=dq.EdgeElevationGuide.data,j=x.x,O=x.y,h=Je.getStyle("curveElevationIntersectSize"),L=Je.getStyle("curveElevationGuideShift");return j+=L[0],O+=L[1],[j-h,O-h,2*h,2*h]}}}]},S.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),S.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),dq.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return dq.ConnectGuide.data.rotation}},rect:{func:function(){var c=dq.ConnectGuide.data.connect;c.x,c.y;var A=Je.getStyle("connectGuideIntersectSize");return[[c.x,c.y],2*A,2*A]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var x=dq.ConnectGuide.data.cursorPos||dq.ConnectGuide.data.connect,_=Je.getStyle("connectGuideIntersectSize");return[[x.x,x.y],2*_-2,2*_-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var r=dq.ConnectGuide.data.connect,n=dq.ConnectGuide.data.cursorPos||r;return[r.x,r.y,r.x+.5*(n.x-r.x),r.y,n.x+.5*(r.x-n.x),n.y,n.x,n.y]}}}]},S.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),S.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),dq.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var J=dq.ConnectGuideGarbage.data.hover;return J?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var n=dq.ConnectGuideGarbage.data,T=Je.getStyle("connectGuideGarbageIntersectsize");return n.hover&&(T+=5),[[n.x,n.y],2*T,2*T]}}}]};var ld=6;dq.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return dq.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var W=dq.ShapeActivingCtrl.data;return[W.point.x,W.point.y,W.c1.x,W.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Rg}}},{type:"shape",visible:{func:function(){return dq.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var z=dq.ShapeActivingCtrl.data;return[z.point.x,z.point.y,z.c2.x,z.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:{func:function(){return Rg}}},{type:"shape",visible:{func:function(){return dq.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var h=dq.ShapeActivingCtrl.data.c1,R=h.x,b=h.y,W=ld/2;return"c1"===dq.ShapeActivingCtrl.data.hl&&(W+=.5),[R-W,b-W,R-W,b+W,R+W,b+W,R+W,b-W]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Je.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===dq.ShapeActivingCtrl.data.hl?Je.getStyle("shapeCtrlPointHighlightBorder")||Rg:Je.getStyle("shapeCtrlPointBorderColor")||Rg}}},{type:"shape",visible:{func:function(){return dq.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var i=dq.ShapeActivingCtrl.data.c2,o=i.x,y=i.y,h=ld/2;return"c2"===dq.ShapeActivingCtrl.data.hl&&(h+=.5),[o-h,y-h,o-h,y+h,o+h,y+h,o+h,y-h]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Je.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===dq.ShapeActivingCtrl.data.hl?Je.getStyle("shapeCtrlPointHighlightBorder")||Rg:Je.getStyle("shapeCtrlPointBorderColor")||Rg}}}]},dq.RoundPoint={comps:[{type:"circle",background:"rgb(247,247,247)",borderWidth:1,borderColor:{func:function(){return Rg}},rect:{func:function(){return[[dq.RoundPoint.data.x,dq.RoundPoint.data.y],Mj,Mj]}}}]},dq.AttachPoint={comps:[{type:"rect",background:{func:function(){return dq.AttachPoint.data.isAttach?"rgb(51,153,255)":"rgb(247,247,247)"}},borderWidth:1,rotation:Math.PI/4,borderColor:{func:function(){return Rg}},rect:{func:function(){var q=dq.AttachPoint.data.isAttach?Mj+4:Mj;return[[dq.AttachPoint.data.x,dq.AttachPoint.data.y],q,q]}}}]},bp.Icons.DrawIcon=function(a,E,$,_){$.width=$.height=Hk,$.data=_,Je=a,S.Default.drawImage(E,$,0,0,Hk,Hk)},bp.Icons.MapPoints=function(i,Q){for(var k=0,$=i.length;$>k;k++)i[k]/=Q},bp.roundTo=function(K,f,y){var v=Math.abs(K%f);return y>v||y>f-v?f*Math.round(K/f):K},bp.toFixed=function(M){return Math.round(100*M)/100},bp.getDataMatrix=function(t){if(t instanceof S.Shape){var c=new S.Math.Matrix2d,T=t.getPosition();return c.translate(-T.x,-T.y).scale(t.getScale().x,t.getScale().y).rotate(t.getRotation()).translate(T.x,T.y),c}return t.getMatrix?t.getMatrix():new S.Math.Matrix2d};var ak=bp.Math.Curve=function(){this._curves=[]};ak.prototype={},ak.prototype.constructor=ak,ak.prototype.createFromHtShape=function(U,s,m){s instanceof S.List&&(s=s.toArray());var e,f,Q,l,J,B,D,Y=this,E=null,G=null,C=0,h=bp.Math.Vector2,p=bp.Math.CubicBezier,K=function(E){return new h(U[E],U[E+1],m?m[E/2]:i)};for(f=0,Q=s.length;Q>f;f++){switch(l=s[f],J=null,l){case 1:G=K(C),E=G,C+=2;break;case 2:e=K(C),C+=2,J=new p(G,G.clone(),e.clone(),e),G=e;break;case 3:B=K(C),e=K(C+2),C+=4,J=new p(G,B.clone().sub(G).multiplyScalar(2/3).add(G),B.clone().sub(e).multiplyScalar(2/3).add(e),e),G=e;break;case 4:B=K(C),D=K(C+2),e=K(C+4),C+=6,J=new p(G,B,D,e),G=e;break;case 5:if(!E)break;J=new p(G,G.clone(),E.clone(),E),G=null,E=null}J&&(J._index=Y._curves.length,Y._curves.push(J))}},ak.prototype.checkPoint=function(p,q){var g,C,N,e,I,Z=this,v=Z._curves;for(g=0,C=v.length;C>g;g++)if(e=v[g],I=e.intersectRect(p,q,q),I.length)return N=0,I.forEach(function(z){N+=z.t}),N/=I.length,p=e.getPointAt(N),p.t=N,{bezier:e,intersection:p}},ak.prototype.insertKnot=function(G,c){var h=G.insertKnot(c),S=this,f=S._curves;f.splice(G._index,1,h[0],h[1])},ak.prototype._isCloseEnough=function(h,_){return Math.abs(h.x-_.x)<1e-6&&Math.abs(h.y-_.y)<1e-6},ak.prototype._isSamePoint=function(R,Y){return R===Y},ak.prototype.moveRealPoint=function(Y,D){var n=this,I=n._curves,L=D.clone().sub(Y);I.forEach(function(r){var E=r._p1;r._p2,r._p3;var B=r._p4;n._isSamePoint(E,Y)&&(r._p2.add(L),r._p1=D),n._isSamePoint(B,Y)&&(r._p3.add(L),r._p4=D)})},ak.prototype.moveCtrlDueToRealPointMovement=function(m,U){var $=this,s=$._curves,L=function(p){p.add(U),p.e&&U.e&&(p.e+=U.e)};s.forEach(function(T){var Q=T._p1;T._p2,T._p3;var N=T._p4;$._isSamePoint(Q,m)&&L(T._p2),$._isSamePoint(N,m)&&L(T._p3)})},ak.prototype.moveCtrlPoint=function(F,n,b){var H=F[b];if(H){H.e!==i&&(n.e=H.e);var L=this,z=L._curves;n.clone().sub(H),z.forEach(function(F){var j;"c2"===b?j="_p2":"c1"===b&&(j="_p3"),L._isSamePoint(F[j],H)&&(F[j]=n)}),F[b]=n}},ak.prototype.deleteRealPoint=function(n,b){var V,z,F,T,H,W,M,q=this,y=q._curves,s={},c=[],Y=bp.Math.CubicBezier;for(z=0,F=y.length;F>z;z++)V=y[z],T=V._p1,H=V._p2,W=V._p3,M=V._p4,(s[z]||!q._isSamePoint(T,n))&&(q._isSamePoint(M,n)?F>z+1&&q._isSamePoint(y[z+1]._p1,n)&&(b||c.push(new Y(T,H,y[z+1]._p3,y[z+1]._p4))):c.push(V));q._curves=c},ak.prototype.findPairs=function(x,$){var P,Y,c,D,T,j,q,b,S=this,w=S._curves,U={},n=[];for(Y=0,c=w.length;c>Y;Y++)P=w[Y],D=P._p1,T=P._p2,j=P._p3,q=P._p4,!U[Y]&&S._isSamePoint(D,x)&&($?n.push({point:D,r2:q}):n.push({point:D,c2:T})),S._isSamePoint(q,x)&&(b=$?{point:q,r1:D}:{point:q,c1:j},c>Y+1&&S._isSamePoint(w[Y+1]._p1,x)&&($?b.r2=w[Y+1]._p4:b.c2=w[Y+1]._p2,U[Y+1]=!0),n.push(b));return n},ak.prototype.toHtShape=function(){var m=this,z=m._curves,W=[],q=[],g={x:1/0,y:1/0};return z.forEach(function(O){var a=O._p1,R=O._p2,T=O._p3,M=O._p4;return m._isCloseEnough(a,g)||(W.push(1),q.push(a.clone())),g=M,m._isCloseEnough(a,R)&&m._isCloseEnough(T,M)?(W.push(2),q.push(M.clone()),void 0):(W.push(4),q.push(R.clone(),T.clone(),M.clone()),void 0)}),{segments:W,points:q}};var mn=bp.Math.CubicBezier=function(A,W,L,v){var z=this;z._id=bp.Math.CubicBezier._globalId++,z._p1=A,z._p2=W,z._p3=L,z._p4=v};mn._globalId=1,mn.prototype={},mn.prototype.constructor=mn,mn.prototype.toString=function(){return this._id},mn.prototype.intersectRect=function(s,j,A){var d=j/2,q=A/2,_=s.x,R=s.y,p=bp.Math.Vector2,S=new p(-d+_,-q+R),H=new p(d+_,q+R),z=new p(H.x,S.y),m=new p(S.x,H.y),I=this,P=I.intersectLine(S,z),M=I.intersectLine(z,H),F=I.intersectLine(H,m),U=I.intersectLine(m,S),V=P.concat(M).concat(F).concat(U);return V},mn.prototype.intersectLine=function(J,q){var $,a,D,E,b,x,H,r,m,h,O,I,P,F=this,s=J.clone().min(q),V=J.clone().max(q);E=F._p1,b=F._p2,x=F._p3,H=F._p4,$=E.clone().multiplyScalar(-1),a=b.clone().multiplyScalar(3),D=x.clone().multiplyScalar(-3),O=$.add(a).add(D).add(H),$=E.clone().multiplyScalar(3),a=b.clone().multiplyScalar(-6),D=x.clone().multiplyScalar(3),h=$.add(a).add(D),$=E.clone().multiplyScalar(-3),a=b.clone().multiplyScalar(3),m=$.add(a),r=E.clone(),P=new bp.Math.Vector2(J.y-q.y,q.x-J.x),I=J.x*q.y-q.x*J.y;for(var t=F.getRoots(P.dot(O),P.dot(h),P.dot(m),P.dot(r)+I),z=new Array,f=0,W=t.length;W>f;f++){var T=t[f];if(!(0>T||T>1)){var p=E.clone().lerp(b,T),u=b.clone().lerp(x,T),B=x.clone().lerp(H,T),n=p.lerp(u,T),N=u.lerp(B,T),l=n.lerp(N,T);l.t=T,J.x==q.x?s.y<=l.y&&l.y<=V.y&&z.push(l):J.y==q.y?s.x<=l.x&&l.x<=V.x&&z.push(l):l.x>=s.x&&l.y>=s.y&&l.x<=V.x&&l.y<=V.y&&z.push(l)}}return z},mn.prototype.solveTForPoint=function(v){var u,f,Q,G,E=this;u=E._p1.x-v.x,f=E._p2.x-v.x,Q=E._p3.x-v.x,G=E._p4.x-v.x;for(var l=E.getRoots(G-3*Q+3*f-u,3*Q-6*f+3*u,3*f-3*u,u),X=i,R=1/0,P=0,$=l.length;$>P;P++){var r=l[P];if(!(0>r||r>1)){var U=E._p1.clone().lerp(E._p2,r),o=E._p2.clone().lerp(E._p3,r),j=E._p3.clone().lerp(E._p4,r),B=U.lerp(o,r),T=o.lerp(j,r),h=B.lerp(T,r);h.t=r;var p=Math.abs(h.y-v.y);R>p&&(R=p,X=h)}}return X},mn.prototype.getPointAt=function(H){var K=this,J=K._p1,l=K._p2,G=K._p3,u=K._p4,L=J.clone().lerp(l,H),Y=l.clone().lerp(G,H),f=G.clone().lerp(u,H),$=L.lerp(Y,H),Z=Y.lerp(f,H);return $.lerp(Z,H)},mn.prototype.getRoots=function($,B,V,m){var i,T,W,b,D,w=new Array;if(Math.abs($)<1e-6){var i=B,T=V/i,W=m/i,b=T*T-4*W;if(b>0){var D=Math.sqrt(b);w.push(.5*(-T+D)),w.push(.5*(-T-D))}else 0==b&&w.push(.5*-T)}B/=$,V/=$,m/=$,i=(3*V-B*B)/3,T=(2*B*B*B-9*V*B+27*m)/27;var y=B/3,n=T*T/4+i*i*i/27,c=T/2;if(Math.abs(n)<=1e-6&&(n=0),n>0){var C,q,D=Math.sqrt(n);C=-c+D,q=C>=0?Math.pow(C,1/3):-Math.pow(-C,1/3),C=-c-D,C>=0?q+=Math.pow(C,1/3):q-=Math.pow(-C,1/3),w.push(q-y)}else if(0>n){var r=Math.sqrt(-i/3),M=Math.atan2(Math.sqrt(-n),-c)/3,v=Math.cos(M),K=Math.sin(M),S=Math.sqrt(3);w.push(2*r*v-y),w.push(-r*(v+S*K)-y),w.push(-r*(v-S*K)-y)}else{var C;C=c>=0?-Math.pow(c,1/3):Math.pow(-c,1/3),w.push(2*C-y),w.push(-C-y)}return w},mn.prototype._70I=function(){var U=this;return U._p1.distanceToSquared(U._p2)<1e-10&&U._p3.distanceToSquared(U._p4)<1e-10},mn.prototype.insertKnot=function(q){var W=this,A=W._p1,$=W._p2,i=W._p3,h=W._p4,I=A.clone().lerp($,q),b=$.clone().lerp(i,q),Y=i.clone().lerp(h,q),k=I.clone().lerp(b,q),X=b.clone().lerp(Y,q),y=k.clone().lerp(X,q);return W._70I()?(A.clone().lerp(h,q),[new bp.Math.CubicBezier(A,A.clone(),y.clone(),y),new bp.Math.CubicBezier(y,y.clone(),h.clone(),h)]):[new bp.Math.CubicBezier(A,I,k,y),new bp.Math.CubicBezier(y,X,Y,h)]};var gl=S.Default.getInternal().ui().EdgeUI,ij={_47O:function(X){var i=this,g=ij.getBackups()._47O;bp.inEdit(i.gv)||g.call(i,X)}};bp.Inject.registAsModule(ij,gl);var Gi=S.Default.getInternal().ui().NodeUI,jc={_47O:function(Z){var f=this,d=jc.getBackups()._47O;bp.inEdit(f.gv)||d.call(f,Z)},getSelectWidth:function(){var e=this,v=e.gv,w=e._data;if(v.isEditable(w)&&bp.inEdit(v))return 0;var x=jc.getBackup("getSelectWidth");return x.call(e)}};bp.Inject.registAsModule(jc,Gi);var Yp=S.graph.GraphView,he={_editPointSize:function(){var F=S.Default.isTouchable,Z=bp.getStyle("pointSize");return Z[F?0:1]}(),isPointEditable:function(c){var k=this;if(bp.inEdit(k))return k._pointEditableFunc?k._pointEditableFunc(c):!0;var o=he.getBackup("isPointEditable");o.call(k,c)},isEditable:function(D){var u,K=this,E=he.getBackup("isEditable");if(u=D instanceof bp.Group?!0:E.call(K,D),!bp.inEdit(K))return u;if(!(D instanceof S.Edge))return u;if(!D.s("2d.editable"))return!1;var l=K.getEditableFunc();return l?l(D):!0},_42:function(G,n){var q=this,F=he.getBackups()._42;if(F.call(q,G,n),bp.inEdit(q)){var H=q.getEditInteractor();H.drawImpl()}}};bp.Inject.registAsModule(he,Yp);var Sj=S.Default.getInternal().ui().ShapeUI,qq={_47O:function(d){var R=this,g=qq.getBackups()._47O;bp.inEdit(R.gv)||g.call(R,d)}};bp.Inject.registAsModule(qq,Sj);var $n=S.graph.DefaultInteractor,hq={handle_mousewheel:function(o){var c=this,Z=hq.getBackup("handle_mousewheel");bp.inEdit(c.gv)||Z.call(c,o)}};bp.Inject.registAsModule(hq,$n);var Tb=S.graph.MoveInteractor,Qe={_calcShift:function(z,C){var y=this,x=Qe.getBackup("_calcShift"),h=y.gv;if(!bp.inEdit(h))return x.call(y,z,C);var A=h.getEditInteractor(),u=A.getSubModule("Move").calcShift(z,C,y);return u||x.call(y,z,C)},clear:function(L){var k=this,D=Qe.getBackup("clear");D.call(k,L);var j=k.gv;if(bp.inEdit(j)){var l=j.getEditInteractor();l.getSubModule("Move").clear(L)}}};bp.Inject.registAsModule(Qe,Tb);var hi=bp.Rect=function(Z){this.catalog="Rect",this._interactor=Z};hi.prototype={},hi.prototype.constructor=hi,hi.prototype.gatherInfo=function(X,Q){var P=this;if(1===Q.length){var H=Q[0];return H instanceof S.Shape&&H._70I()?P.gatherLine(X,H):ue(H,X)?!1:P.gatherSingleTarget(X,H)}return Q.length>1?P.gatherMultiTargets(X,Q):!1},hi.prototype.gatherSingleTarget=function(g,o){if(o.getCorners){var c,H=this,S=H.info;H.target=o,c=H.screenInfo={};var e=o.getCorners();S.LT=new bp.Math.Vector2(e[0]),S.LB=new bp.Math.Vector2(e[1]),S.RB=new bp.Math.Vector2(e[2]),S.RT=new bp.Math.Vector2(e[3]),S.T=S.LT.clone().add(S.RT).divideScalar(2),S.B=S.LB.clone().add(S.RB).divideScalar(2),S.L=S.LT.clone().add(S.LB).divideScalar(2),S.R=S.RT.clone().add(S.RB).divideScalar(2);for(var j in S)c[j]=bp.toScreenPosition(g,S[j]);var I=H._interactor,$=I.getStyle("checkSize"),i=function(C,i,X){var r=i.clone().sub(C).setLength(-$),b=X.clone().sub(C).setLength(-$),N=r.add(b).add(C);return N};return c.rotLT=i(c.LT,c.RT,c.LB),c.rotLB=i(c.LB,c.LT,c.RB),c.rotRB=i(c.RB,c.LB,c.RT),c.rotRT=i(c.RT,c.LT,c.RB),c.rotT=c.rotLT.clone().add(c.rotRT).divideScalar(2),c.rotB=c.rotLB.clone().add(c.rotRB).divideScalar(2),c.rotL=c.rotLT.clone().add(c.rotLB).divideScalar(2),c.rotR=c.rotRT.clone().add(c.rotRB).divideScalar(2),c.rotation=o.getRotation(),H.gatherConnectInfo(),!0}},hi.prototype.gatherConnectInfo=function(){var t=this,n=t.target,T=t._interactor,R=t.screenInfo,S=T.gv;if(S.isConnectActionVisible(n)&&T.getStyle("connectGuideVisible")){var H;n.s&&(H=n.s("connectGuideShift")),H||(H=T.getStyle("connectGuideShift"));var Y=n.getAnchor(),V=n.getSize(),C=n.toGlobal({x:V.width*(H[0]-Y.x),y:V.height*(H[1]-Y.y)});C=bp.toScreenPosition(S,C),R.P1?C.add(R.P2.clone().sub(R.P1).setLength(H[2])):(C.add(R.RT.clone().sub(R.LT).setLength(H[2])),C.add(R.LB.clone().sub(R.LT).setLength(H[3]))),R.connect=C}},hi.prototype.gatherMultiTargets=function(u,o){var n=bp.Group.findOrCreateGroup(o);if(!n)return!1;var I=this;return I.editing&&"rotate"!==I.editing.mode||n.calcInfo(),I.gatherSingleTarget(u,n)},hi.prototype.gatherLine=function(B,W){this.target=W;var $=this.screenInfo={},f=W.getPoints(),v=bp.getDataMatrix(W);return $.P1=bp.toScreenPosition(B,v.apply(f.get(0))),$.P2=bp.toScreenPosition(B,v.apply(f.get(1))),this.gatherConnectInfo(),!0},hi.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],hi.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],hi.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],hi.prototype.check=function(j,w,e){if(S.Default.isLeftButton(w)){var x=this;if(x.editing=null,x.tipInfo=null,x.screenInfo){var f=x.target,C=j.isEditable(f),p=x.screenInfo;if(C&&p.connect){var a=x._checkConnect(e);if(a)return a}if(p.P1)return x._checkLine(e);var L,d,P,m=null,X=x._interactor,z=X.getStyle("checkSize");if(C&&j.isRectEditable(f))for(d=0;d<bp.Rect.ResizeKeys.length;d++)if(P=bp.Rect.ResizeKeys[d],bp.checkHit(e,p[P],z)){m=P,L="resize";break}if(!m&&C&&j.isRotationEditable(f)&&!X.getStyle("rotateAsClock")){var s=X.getStyle("rotateCheckSize");for(d=0;d<bp.Rect.RotateKeys.length;d++)if(P=bp.Rect.RotateKeys[d],bp.checkHit(e,p[P],s)){m=P,L="rotate";break}}if(!m)return X.setCursor("default"),void 0;if("rotate"===L){var G,_=j.lp(w);if(f instanceof bp.Group){var c=X.getStyle("groupRotateModeKey");"string"==typeof c&&(c=[c]);for(var l=!1,v=0,Z=c.length;Z>v;v++)if(w[c[v]]){l=!0;break}var u=X.getStyle("groupRotateModeDefault");G=l?"batch"===u?"block":"batch":u}var g="batch"===G?f.getAnchor2():f.getPosition(),H=Math.atan2(_.y-g.y,_.x-g.x);X._setRotateCursor(H),x.editing={mode:L,key:m,pos:g,flipY:f.getScale().y<0,rotation:f.getRotation(),hitRot:H},G&&(x.editing.groupRotateMode=G)}else{var i=bp.Rect.ResizeKeys.indexOf(m),n=bp.Rect.ResizeDirection[i],r=Math.cos(f.getRotation()),J=Math.sin(f.getRotation()),o=n.x*Math.sign(f.getScale().x),A=n.y*Math.sign(f.getScale().y),W=Math.atan2(-J*o-r*A,r*o-J*A),V=(Math.round(W/(Math.PI/4))+8)%8,y=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][V];this._interactor.setCursor(y);var I=f.getWidth(),q=f.getHeight(),D=f.getAnchor();x.editing={mode:L,key:m,rect:{x:-I*D.x,y:-q*D.y,width:I,height:q},anchor:D,matrix:f.getMatrix()}}return m}}},hi.prototype._checkLine=function(a){var q=this;q.screenInfo;var x,g=q._interactor.getStyle("checkSize");if(bp.checkHit(a,q.screenInfo.P1,g))x="P1";else{if(!bp.checkHit(a,q.screenInfo.P2,g))return this._interactor.setCursor("default"),void 0;x="P2"}return q.editing={mode:"line",key:x},x},hi.prototype._checkConnect=function(M){var V=this,i=V.screenInfo,G=V._interactor,a=G.getStyle("connectGuideIntersectSize"),$=i.connect,m=M.x,c=$.x;if(c>m&&a>c-m&&Math.abs($.y-M.y)<a||m>=c&&bp.checkHit(M,$,a)){var A="connect",l=x.getConnectAction(G.gv);if(V.editing={mode:A},l&&l.delete)if(V.target instanceof bp.Group){var U=!0;G.gv.sm().getSelection().each(function(d){l.delete.visible.call(null,G.gv,d)||(U=!1)}),V.editing.hasDeleteAction=U}else l.delete.visible.call(null,G.gv,V.target)&&(V.editing.hasDeleteAction=!0);return G.setCursor("default"),A}},hi.prototype._fireEditEvent=function(b,g){var x=this._interactor,z=this.editing;if(z){var l=z.mode;l="rotate"===l?"Rotation":"connect"===l?"Connection":l[0].toUpperCase()+l.slice(1),x.fi({kind:b+"Edit"+l,event:g})}},hi.prototype.startEdit=function(q,I){q.startDragging(I);var J=this;J._interactor.fi({kind:"prepareEdit",event:I});var A=J.editing,G=J.target;if(A){if(J._fireEditEvent("begin",I),"rotate"===A.mode)return A.groupRotateMode&&G.beginRotate(A),void 0;if("connect"!==A.mode)("line"===A.mode||G&&0===G.getRotation())&&(J._inSmartGuide=!0,J._interactor.rectGuide.gatherRects());else if(A.hasDeleteAction){var H=q.gv,X=J._interactor.getStyle("connectGuideGarbageShift");A.garbageInfo={x:H.getWidth()*X[0]+X[2],y:H.getHeight()*X[1]+X[3],size:J._interactor.getStyle("connectGuideGarbageIntersectsize")},q._42()}}},hi.prototype._46O=function(U){var L,G,j=this,B=j.editing,q=j.target;if(B){if("connect"===B.mode&&!B.canceled&&!B.deleted)try{B.garbageInfo&&B.garbageInfo.hover?x.doDeleteConnectionAction(j._interactor.gv,q):x.doConnectAction(j._interactor.gv,q,B.target)}catch(F){console.error(F)}G=B.freezeFlag,L=j.editing.groupRotateMode,j._fireEditEvent("end",U),j.editing=null}j.tipInfo=null,j._inSmartGuide&&(j._interactor.rectGuide.clear(),j._inSmartGuide=!1),L&&q&&q.endRotate(),q instanceof S.Block&&(G===i?delete q._freezeSyncFromChildren:q._freezeSyncFromChildren=G,q.updateFromChildren())},hi.prototype.handleNormalStateDelete=function(){var J=this,P=J.editing;if(P&&"connect"===P.mode&&!P.canceled&&!P.deleted){if(P.garbageInfo){try{x.doDeleteConnectionAction(J._interactor.gv,J.target)}catch(M){console.error(M)}P.garbageInfo=null}return P.cursorPos=null,P.targetCorners=null,P.deleted=!0,J._interactor._42(),!0}},hi.prototype.handleNormalStateKeyDown=function(m){var w=this,V=w.editing;return!V||"connect"!==V.mode||V.canceled||V.deleted?void 0:S.Default.isEsc(m)?(V.cursorPos=null,V.targetCorners=null,V.canceled=!0,w._interactor._42(),!0):void 0},hi.prototype.handleEdit=function(x,J){var H=this,B=H.editing;if(B){var P,N,s,O,W,e=H.target,k=B.key,l=B.mode,K=x.lp(J),I=H._interactor;if("connect"===l){if(B.canceled)return;if(B.deleted)return;B.cursorPos=I._getLogicalPoint(J);var n=B.garbageInfo;return n&&bp.checkHit(B.cursorPos,n,n.size)?(n.hover=!0,B.target=null,B.targetCorners=null):(n&&(n.hover=!1),B.target=x.getDataAt(K,function(l){return x.isSelectable(l)?Td(l)?!0:!1:!1})||null,B.targetCorners=bp.getTargetCornersOnScreen(x,B.target)),I._42(),void 0}if("rotate"===l){var F,j,v=B.pos,w=Math.atan2(K.y-v.y,K.x-v.x);if(B.groupRotateMode?j=w-B.hitRot:(F=w-B.hitRot,j=B.rotation+F),j%=2*Math.PI,0>j&&(j+=2*Math.PI),!S.Default.isCtrlDown(J)){var R,z;Bp(J)?(R=I.getStyle("shiftRotateRound"),z=R/2):(R=I.getStyle("rotateRound"),z=I.getStyle("rotateSensitivity")),j=bp.roundTo(j,R,z)}B.groupRotateMode?(F=j-(B.lastRotation||0),0!==F&&(e.addRotation(F,B.groupRotateMode),B.lastRotation=j)):e.setRotation(j),I._setRotateCursor(w),j>Math.PI&&(j-=2*Math.PI);var Y=180*(j/Math.PI);Y=Y.toFixed(2),P=""+Y+"°"}else if("resize"===l){var p=B.rect;s=p.x,O=p.y;var i,X=p.width,h=p.height,f=B.anchor,r=B.matrix,c=e.s&&e.s("keepAspectRatio")||I.getStyle("keepAspectRatio");Bp(J)&&(c=!c);var Q=H._unionPointMode1,E=H._unionPointMode2;if(H._inSmartGuide&&!S.Default.isCtrlDown(J)&&!c){var $;"L"===k||"R"===k?$="x":("T"===k||"B"===k)&&($="y"),H._adsorbedToClosest(K,$),W=!0}i=r.tfi(K);var C;"LT"===k?(p=Q(i,{x:s+X,y:O+h},X,h,c),C=9):"T"===k?(p=E({x:s,y:i.y},{x:s+X,y:O+h},X,h,c,"v"),C=1):"RT"===k?(p=Q(i,{x:s,y:O+h},X,h,c),C=33):"L"===k?(p=E({x:i.x,y:O},{x:s+X,y:O+h},X,h,c,"h"),C=8):"R"===k?(p=E({x:s,y:O},{x:i.x,y:O+h},X,h,c,"h"),C=32):"LB"===k?(p=Q(i,{x:s+X,y:O},X,h,c),C=12):"B"===k?(p=E({x:s,y:O},{x:s+X,y:i.y},X,h,c,"v"),C=4):"RB"===k&&(p=Q(i,{x:s,y:O},X,h,c),C=36);var d=r.tf(p.x+p.width*f.x,p.y+p.height*f.y);e instanceof S.Block&&(B.hasOwnProperty("freezeFlag")||(B.freezeFlag=e._freezeSyncFromChildren,e._freezeSyncFromChildren=!0)),e.setPosition(d),e.setSize(p.width,p.height),W&&(N=e.getRect(),I.rectGuide.gatherLines({node:e,x:N.x,y:N.y,w:N.width,h:N.height},$,C)),P=""+Math.round(p.width)+" * "+Math.round(p.height)}else if("line"===l){if(Bp(J)){var g=e.getPoints(),U="P1"===k?g.get(1):g.get(0),Z={x:K.x-U.x,y:K.y-U.y},G=I.getStyle("shiftLineRotateRound"),V=H._shiftDirList;if(!V||H._shiftRotateRound!==G){H._shiftRotateRound=G,H._shiftDirList=V=[];for(var a=0;a<Math.PI;a+=G)V.push({x:M(a),y:b(a)})}for(var T,L=0,u=0,_=V.length;_>u;u++){var A=V[u],q=A.x*Z.x+A.y*Z.y;Math.abs(q)>Math.abs(L)&&(L=q,T=A)}K={x:U.x+T.x*L,y:U.y+T.y*L},I.rectGuide.clear()}else H._inSmartGuide&&!S.Default.isCtrlDown(J)&&(H._adsorbedToClosest(K),W=!0);var y=bp.getDataMatrix(e).applyInverse(K);e.setPoint("P1"===k?0:1,y,!0);var o=e.getPoints(),t=o.get(0),m=o.get(1);s=t.x-m.x,O=t.y-m.y,P=" "+Math.round(Math.sqrt(s*s+O*O))+" ",W&&(N=e.getRect(),I.rectGuide.gatherLines({node:e,x:N.x,y:N.y,w:N.width,h:N.height}))}if(P){var D=S.Default.getLogicalPoint(J,I._canvas);D.x+=bp.Icons.TipShiftX,D.y+=bp.Icons.TipShiftY,H.tipInfo={helperPos:D,text:P,size:P.length}}H._fireEditEvent("between",J)}},hi.prototype._unionPointMode1=function(t,u,x,K,e){if(e&&x&&K){var F=t.x-u.x,O=t.y-u.y;Math.abs(F*K)<Math.abs(O*x)?(O=Math.sign(O)*Math.abs(F*K/x),t.y=u.y+O):(F=Math.sign(F)*Math.abs(O*x/K),t.x=u.x+F)}return S.Default.unionPoint(t,u)},hi.prototype._unionPointMode2=function(y,e,L,I,i,P){var Y=S.Default.unionPoint(y,e);if(i&&L&&I){var x;"v"===P?(x=Y.x+Y.width/2,Y.width=L*Y.height/I,Y.x=x-Y.width/2):(x=Y.y+Y.height/2,Y.height=I*Y.width/L,Y.y=x-Y.height/2)}return Y},hi.prototype._adsorbedToClosest=function(B,O){var K=this,l=K._interactor,z=l.rectGuide.findClosest(B,O),Q=l.gridGuide.findClosest(B,O),L=1/0,r=1/0;z&&(isFinite(z.x)&&(L=z.x),isFinite(z.y)&&(r=z.y)),Q&&(isFinite(Q.x)&&Math.abs(Q.x)<Math.abs(L)&&(L=Q.x),isFinite(Q.y)&&Math.abs(Q.y)<Math.abs(r)&&(r=Q.y)),isFinite(L)&&(B.x+=L),isFinite(r)&&(B.y+=r)},hi.prototype._42=function(h,O,q){var F=this;F.info={},F.screenInfo=null;var M=F._interactor;if(!M.editDetail&&F.gatherInfo(O,q)){var _=F.editing,g=_?_.groupRotateMode:null,K=F.screenInfo;"block"!==g&&(K.P1?bp.Icons.DrawIcon(M,h,bp.Icons.Line,K):bp.Icons.DrawIcon(M,h,bp.Icons.Rect,K),K.connect&&(bp.Icons.DrawIcon(M,h,bp.Icons.ConnectGuide,{rotation:K.rotation,connect:K.connect,cursorPos:_?_.cursorPos:null}),_&&(_.targetCorners&&bp.Icons.DrawIcon(M,h,bp.Icons.NodeHoverGuide,_.targetCorners),_.garbageInfo&&bp.Icons.DrawIcon(M,h,bp.Icons.ConnectGuideGarbage,_.garbageInfo))),F.tipInfo&&bp.Icons.DrawIcon(M,h,bp.Icons.TipHelper,F.tipInfo)),F.target instanceof bp.Group&&F.target._42(M,h,O)}};var zo=bp.Anchor=function(Y){this.catalog="Anchor",this._interactor=Y};zo.prototype={},zo.prototype.constructor=zo,zo.prototype.gatherInfo=function(Q,x){var l=this;if(1===x.length){var u=x[0];if(!u.getAnchor)return;if(u instanceof S.Shape&&u._70I())return;if(ue(u,Q))return;return l.gatherSingleTarget(Q,x[0])}return x.length>1?l.gatherMultiTargets(Q,x):!1},zo.prototype.gatherSingleTarget=function(K,N){var i=this;return i.info.POS=N.getPosition(),i.screenInfo.POS=bp.toScreenPosition(K,i.info.POS),i.target=N,!0},zo.prototype.gatherMultiTargets=function(o,e){var l=this,I=bp.Group.findOrCreateGroup(e);return I?(l.screenInfo.POS=bp.toScreenPosition(o,I.getAnchor2()),l.target=I,!0):!1},zo.prototype.isVisible=function(){var C=this,Z=C._interactor;if(Z.getStyle("anchorVisible")===!1)return!1;var P=C.target;if(P){if(this.editing)return!0;var a=P.getAnchor(),F=Z.getStyle("anchorOutsideVisibleThreshold");if(a.x<-F||a.x>1+F||a.y<-F||a.y>1+F)return!0;var s=P.getSize(),f=P.getScale(),o=Math.min(Math.abs(s.width*f.x),Math.abs(s.height*f.y));if(o*Z.gv._zoom<Z.getStyle("anchorHideThreshold"))return!1}return!0},zo.prototype.check=function(N,f,y){if(S.Default.isLeftButton(f)){var m=this,q=m._interactor;if(m.isVisible()&&q.getStyle("anchorMovable")!==!1){m.editing=null,m.tipInfo=null;var c=m.target;if(c&&N.isAnchorEditable(c)&&N.isEditable(c)){var H;if(m.screenInfo&&(H=m.screenInfo.POS)&&bp.checkHit(y,new bp.Math.Vector2(H),q.getStyle("checkSize"))){if(c instanceof bp.Group)return m.editing={},!0;var g=c.getWidth(),F=c.getHeight(),Z=c.getAnchor();return m.editing={rect:{x:-g*Z.x,y:-F*Z.y,width:g,height:F},anchor:Z,matrix:c.getMatrix()},!0}}}}},zo.prototype.startEdit=function(V,p){V.startDragging(p),V.fi({kind:"beginEditAnchor",event:p})},zo.prototype._46O=function(L){var e=this;e.editing&&(e.editing=null,e._interactor.fi({kind:"endEditAnchor",event:L})),e.tipInfo=null},zo.prototype.handleEdit=function(h,I){var J=this,W=J.target;if(W){var P=J.editing;if(P){var r=h.lp(I),N=J._interactor;if(W instanceof bp.Group)return W.setAnchor2(r),N._42(),void 0;var p=P.matrix,m=p.tfi(r),$=P.rect,D=(m.x-$.x)/$.width,T=(m.y-$.y)/$.height;if(!S.Default.isCtrlDown(I)){var z=N.getStyle("anchorRound"),R=N.getStyle("anchorSensitivity");D=bp.roundTo(D,z,R),T=bp.roundTo(T,z,R)}W.setAnchor(D,T,!0);var B=S.Default.getLogicalPoint(I,N._canvas);B.x+=bp.Icons.TipShiftX,B.y+=bp.Icons.TipShiftY;var C=""+D.toFixed(2)+", "+T.toFixed(2);J.tipInfo={helperPos:B,text:C,size:C.length},N.fi({kind:"betweenEditAnchor",event:I})}}},zo.prototype._42=function(L,J,g){var w=this;w.info={},w.screenInfo={};var K=w._interactor;K.editDetail||w.gatherInfo(J,g)&&w.isVisible()&&(bp.Icons.DrawIcon(K,L,bp.Icons.Anchor,w.screenInfo),w.tipInfo&&bp.Icons.DrawIcon(K,L,bp.Icons.TipHelper,w.tipInfo))};var ql=bp.RotateX=function(_){this.catalog="RotateX",this._interactor=_};ql.prototype={},ql.prototype.constructor=ql,ql.prototype.gatherInfo=function(D,N){var Q=this;if(1===N.length){var v=N[0];return v instanceof S.Shape&&v._70I()||ue(v,D)?!1:Q.gatherSingleTarget(D,v)}return N.length>1?Q.gatherMultiTargets(D,N):!1},ql.prototype.gatherSingleTarget=function(){var W=new S.Math.Vector2,r=new S.Math.Vector2,p=new S.Math.Vector2,x=new S.Math.Vector2,h=function(v,A){var X=v.x-A.x,J=v.y-A.y;return X*X+J*J};return function(k,f){if(f.getCorners){var i=this,A=f.getCorners(),j=15,F=f.getPosition();W.copy(A[0]),p.copy(A[1]),x.copy(A[3]),r.copy(W).add(x).divideScalar(2).add(W.sub(p).setLength(j/k.getZoom()));var u=Math.max(h(F,A[0]),h(F,A[1]),h(F,A[2]),h(F,A[3]));return i.info.POS=r.clone(),i.screenInfo.POS=bp.toScreenPosition(k,i.info.POS),i.screenInfo.LEN=Math.sqrt(u)*k.getZoom()+j,i.screenInfo.CENTER=bp.toScreenPosition(k,F),i.target=f,!0}}}(),ql.prototype.gatherMultiTargets=function(m,U){var X=this,q=bp.Group.findOrCreateGroup(U);if(!q)return!1;var X=this;return X.gatherSingleTarget(m,q)},ql.prototype.isVisible=function(){var r=this._interactor;if(!r.getStyle("rotateAsClock"))return!1;var q=this.target;if(!q)return!0;var s=r.gv;return s.isEditable(q)&&s.isRotationEditable(q)?!0:!1},ql.prototype.check=function(Z,x,i){var L=this,R=L._checkImpl(Z,x,i);return(R||L._clockPainted)&&L._interactor._42(),R},ql.prototype._checkImpl=function(X,x,F){if(S.Default.isLeftButton(x)){var H=this;H.editing=null,H.tipInfo=null;var T;if(H.screenInfo&&(T=H.screenInfo.POS)&&H.isVisible()){var g=H._interactor;
if(bp.checkHit(F,T,g.getStyle("checkSize"))){var y=H.target,Q=X.lp(x),C=y.getPosition(),l=Math.atan2(Q.y-C.y,Q.x-C.x);return g._setRotateCursor(l),H.editing={pos:C,rotation:y.getRotation(),hitRot:l,groupRotateMode:"block",screenInfo:{CENTER:H.screenInfo.CENTER,LEN:H.screenInfo.LEN}},!0}}}},ql.prototype.startEdit=function(w,N){w.startDragging(N),w.fi({kind:"beginEditRotation",event:N}),this.target instanceof bp.Group&&this.target.beginRotate(this.editing)},ql.prototype._46O=function(D){var w=this;w.editing&&(w.editing=null,w._interactor.fi({kind:"endEditRotation",event:D})),w.target instanceof bp.Group&&w.target.endRotate(),w.tipInfo=null},ql.prototype.handleEdit=function(p,J){var u=this,A=u.editing;if(A){var K,Y,B=u.target,M=p.lp(J),U=u._interactor,c=A.pos,f=Math.atan2(M.y-c.y,M.x-c.x),z=B instanceof bp.Group;if(z?Y=f-A.hitRot:(K=f-A.hitRot,Y=A.rotation+K),Y%=2*Math.PI,0>Y&&(Y+=2*Math.PI),!S.Default.isCtrlDown(J)){var P,L;Bp(J)?(P=U.getStyle("shiftRotateRound"),L=P/2):(P=U.getStyle("rotateRound"),L=U.getStyle("rotateSensitivity")),Y=bp.roundTo(Y,P,L)}z?(K=Y-(A.lastRotation||0),0!==K&&(B.addRotation(K,A.groupRotateMode),A.lastRotation=Y)):B.setRotation(Y),U._setRotateCursor(f),Y>Math.PI&&(Y-=2*Math.PI);var W=180*(Y/Math.PI),w=""+W.toFixed(2)+"°",m=S.Default.getLogicalPoint(J,U._canvas);m.x+=bp.Icons.TipShiftX,m.y+=bp.Icons.TipShiftY,u.tipInfo={helperPos:m,text:w,size:w.length},U.fi({kind:"betweenEditRotation",event:J})}},ql.prototype._42=function($,w,d){var X=this;X._clockPainted=!1,X.info={},X.screenInfo={};var L=X._interactor;L.editDetail||X.gatherInfo(w,d)&&X.isVisible()&&(bp.Icons.DrawIcon(L,$,bp.Icons.RoundPoint,X.screenInfo.POS),X.tipInfo&&bp.Icons.DrawIcon(L,$,bp.Icons.TipHelper,X.tipInfo),X.editing&&X.drawClock($))},ql.prototype.drawClock=function(L){L.save();var Y=this;Y._clockPainted=!0;var u=Y.editing||{},I=u.screenInfo||Y.screenInfo,V=I.LEN,m=V+8,h=V+18;L.save(),L.translate(I.CENTER.x,I.CENTER.y),L.beginPath(),L.strokeStyle="rgb(150, 150, 150)";for(var D,S,R,e,x,N=0;360>N;N++)D=N*Math.PI/180,0===N%5&&(S=b(D)*V,R=M(D)*V,e=b(D)*m,x=M(D)*m,L.moveTo(S,R),L.lineTo(e,x)),0===N%45&&(S=b(D)*V,R=M(D)*V,e=b(D)*h,x=M(D)*h,L.moveTo(S,R),L.lineTo(e,x));L.stroke(),L.rotate(-K);var C=u.lastRotation||Y.target.getRotation();L.beginPath(),L.fillStyle="rgba(255, 0, 0, 0.1)",L.strokeStyle="rgb(157, 157, 157)",L.moveTo(0,0),L.arc(0,0,h,0,C,!1),L.fill(),L.beginPath(),L.moveTo(0+h,0),L.arc(0,0,h,0,C,!1),L.stroke(),L.restore()};var ak=bp.Curve=function(Q){this.catalog="Curve",this._interactor=Q};ak.prototype={},ak.prototype.constructor=ak,n.defineProperties(ak.prototype,{activing:{get:function(){return this._activing},set:function(w){var O=this;if(w)O._activing=new bp.CurveActiving(this,w);else{var D=O._activing;D&&D.dispose(),O._activing=null}}}}),ak.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},ak.prototype.setUp=function(){var u=this,y=u._interactor;y&&y.gv.mp(u._onGraphviewPropertyChanged,u)},ak.prototype._onGraphviewPropertyChanged=function(H){("zoom"===H.property||"translateX"===H.property||"translateY"===H.property)&&this._handleDataChanged()},ak.prototype.tearDown=function(){var U=this,k=U._interactor;k&&k.gv.ump(U._onGraphviewPropertyChanged,U)},ak.prototype.canEnterEditDetailMode=function(){var x=this,F=x._interactor,h=F._getValidSelection();if(1===h.length){var p=h[0],b=p instanceof S.Edge;if(p instanceof S.Shape||b){if(b){var g=p.s("edge.type");if(g&&"points"!==g)return}var P=F.gv;if(P.isPointEditable(p)&&P.isEditable(p))return x.target=p,!0}}},ak.prototype.canQuitEditDetailMode=function(x){var P=this,R=P._interactor._getLogicalPoint(x);return P._checkEditRealPoint(R)?void 0:P._interactor.gv.getDataAt(x)!==P.target?!0:void 0},ak.prototype.preHandleScroll=function(){var f=this.editing;return f&&f.inEdit?!0:void 0},ak.prototype.getCurrentSelectintStatus=function(){var W=this;if(W.activing&&!W.activing.selections){if(W.activing.status!=i)return W.activing.status;var s=function(V){var T=W.activing.status;W.activing.status=V,W._interactor.fp("shapePointStatus",T,V)},k=bp.Curve.PointType,y=W.activing.point,U=W.activing.pairs;if(!U||1!==U.length)return s(k.Mirrored);var R=U[0],l=R.c1&&R.c1.isNearEnough(y),D=R.c2&&R.c2.isNearEnough(y);if(!R.c1||!R.c2)return l||D?s(k.Straight):s(k.Disconnected);if(l&&D)return s(k.Straight);if(l||D)return s(k.Asymmetric);var J=R.c1.clone().sub(y),V=R.c2.clone().sub(y);return Math.abs(J.x*V.y-J.y*V.x)>1e-5||J.x*V.x>0?s(k.Disconnected):Math.abs(J.length()-V.length())>1e-5?s(k.Asymmetric):s(k.Mirrored)}},ak.prototype.handle_keydown=function(O){var S=this;if(S._interactor.editDetail){var Q=bp.Curve.PointType;"1"===O.key?S._setCurrentSelectionStatus(Q.Straight):"2"===O.key?S._setCurrentSelectionStatus(Q.Mirrored):"3"===O.key?S._setCurrentSelectionStatus(Q.Disconnected):"4"===O.key&&S._setCurrentSelectionStatus(Q.Asymmetric)}},ak.prototype.setCurrentSelectionStatus=function(w){var C=this,M=C._interactor;if(M){var K=M.gv;K.dm().beginTransaction(),this._setCurrentSelectionStatus(w),K.dm().endTransaction()}},ak.prototype._setCurrentSelectionStatus=function(g){var x=this,y=x.activing;if(y){var J=x.getCurrentSelectintStatus();if(null!==J&&J!==g){y.status=g;var I=x.activing.point,Q=x.activing.pairs;if(Q&&1===Q.length){var k=Q[0],C=x.screenInfo.curve,W=bp.Curve.PointType,T=function(){x._writeToHt(),x._interactor.fp("shapePointStatus",J,g)};if(g===W.Straight)return C.moveCtrlPoint(k,I,"c1"),C.moveCtrlPoint(k,I,"c2"),T(),void 0;if(J===W.Straight){var R=C.findPairs(I,!0),b=R[0],X=b.r1||I,f=b.r2||I,O=f.clone().sub(X).multiplyScalar(.25);return C.moveCtrlPoint(k,I.clone().sub(O),"c1"),C.moveCtrlPoint(k,I.clone().add(O),"c2"),T(),void 0}var c=k.c1,r=k.c2;if(c&&r){if(g===W.Mirrored)return C.moveCtrlPoint(k,I.clone().multiplyScalar(2).sub(r),"c1"),T(),void 0;if(g===W.Asymmetric&&J===W.Disconnected){var F=c.clone().sub(I).length(),O=I.clone().sub(r).setLength(F).add(I);return C.moveCtrlPoint(k,O,"c1"),T(),void 0}}y._firePointChange(),x._interactor.fp("shapePointStatus",J,g)}}}},ak.prototype._handleDataChanged=function(){var R="points,segments,shape,position,rotation,scale".split(",");return function(t){var d=this;if(d.screenInfo&&d.target){if(t&&R.indexOf(t.property)<0)return;var G=d._interactor;d.gatherSingleTarget(G.gv,d.target,!0),d.check(G.gv,null,new bp.Math.Vector2(G._lastClientPoint)),G._42()}}}(),ak.prototype.gatherSingleTarget=function(a,V,t){var X,i,I=this;I.screenInfo&&I.screenInfo.curve&&(i=I.screenInfo.curve._curves);var d=I.editing;X=d?I.screenInfo:I.screenInfo={};var q,l,Z=V instanceof S.Edge;Z?(q=V.s("edge.segments"),l=V.s("edge.points")||new S.List):(q=V._58O,l=V._59O),X.S=q;var L,N=X.P=[],m=bp.getDataMatrix(V);if(V instanceof S.Polyline&&(L=V.getElevation()||0,X.E=[]),l.each(function(h){X.E&&X.E.push(h.e||L),h=m.apply(h);var n=bp.toScreenPosition(a,h);N.push(n.x,n.y)}),Z){var E=bp.toScreenPosition(a,V._lastSourcePoint),e=bp.toScreenPosition(a,V._lastTargetPoint);N.splice(0,0,E.x,E.y),N.push(e.x,e.y)}if(!X.S||!X.S.size()){X.S=new S.List,X.S.add(1);for(var P=0;P<N.length/2-1;P++)X.S.add(2)}if((!d||t)&&I.convertToCubicBezier(i),I.activing&&(t||!I.editing||"realPoint"===I.editing.type)){var C=X.curve.findPairs(I.activing.point);I.activing.pairs=C}Z&&"points"!==V.s("edge.type")&&I._writeToHt()},ak.prototype._convertToNewPoint=function(a,g,i){var L,h,R;for(L=0,h=g.length;h>L;L++){if(R=g[L],R._p1.isNearEnough(a))return R._p1;if(R._p4.isNearEnough(a))return R._p4}if(i)for(L=0,h=Math.min(i.length,h);h>L;L++){if(R=i[L],R._p1===a)return g[L]._p1;if(R._p4===a)return g[L]._p4}},ak.prototype.convertToCubicBezier=function(B){var p,Y,M=this,L=new bp.Math.Curve,y=M.screenInfo;if(L.createFromHtShape(y.P,y.S,y.E),y.curve=L,M.activing){var V=L._curves;if(p=M.activing.point,Y=M._convertToNewPoint(p,V,B),Y&&(M.activing.point=Y),M.activing.selections){var g=-1,e=M.activing.selections;e.forEach(function(m){g++,Y=M._convertToNewPoint(m,V,B),Y&&(e[g]=Y)})}}},ak.prototype.check=function(J,O,t){if(!O||S.Default.isLeftButton(O)){var L=this;if(L._interactor.setCursor("default"),L.editing=null,L.highlight=null,L.tipInfo=null,L.edgeEditResult=null,L.screenInfo){if(oj())return L._interactor._42(),!0;if(L._checkEditCtrlPoint(t))return L._interactor._42(),!0;if(L._checkEditRealPoint(t))return L._interactor._42(),!0;if(L._checkEditElevation(t))return L._interactor._42(),!0;var f=L.screenInfo.curve,P=f.checkPoint(t,L._interactor.getStyle("curveIntersectSize"));if(P){var $=L.highlight={};$.type="insertKnot",$.bezier=P.bezier,$.point=P.intersection}return L._interactor._42(),!0}}},ak.prototype._checkEditRealPoint=function(E){var L,A,j,U,D,d,e=this,w=e.screenInfo.curve._curves,P=e._interactor.getStyle("curvePointIntersectSize"),T=1/0;for(P*=P,j=0,U=w.length;U>j;j++)L=w[j],D=L._p1,d=E.distanceToSquared(D),T>d&&(T=d,A=D),D=L._p4,d=E.distanceToSquared(D),T>d&&(T=d,A=D);if(T>P)return!1;var G=e.highlight={};return G.type="changeRealPoint",G.point=A,e.editing={type:"realPoint",point:A,shiftGuide:{point:A.clone(),dir:"x",limit:0}},e._interactor.setCursor("crosshair"),!0},ak.prototype._checkEditElevation=function(F){var S=this;if(!S._interactor.getStyle("curveElevationVisible"))return!1;var L=S.activing;if(!L)return!1;var V=L.getCurrentEditingPoint();if(!V)return!1;var a=S._interactor,p=a.getStyle("curveElevationGuideShift"),u=a.getStyle("curveElevationIntersectSize"),r=F.distanceToSquared({x:V.x+p[0],y:V.y+p[1]});if(!(r>u*u)){var U=S.highlight={};U.type="elevation";var P=new bp.Math.Vector2(F.x,F.y,V.e);return S.editing={type:"elevation",startPoint:P},S._interactor.setCursor("crosshair"),!0}},ak.prototype._checkEditCtrlPoint=function(G){var L=this;if(L.activing&&!L.activing.selections){var g=L.getCurrentSelectintStatus();if(g!==bp.Curve.PointType.Straight){var Z=L.activing.pairs;if(Z){var U=L._interactor.getStyle("curvePointIntersectSize");U*=U;var j,P,e,p,B,m,V,X,J,i=1/0;for(V=0,J=Z.length;J>V;V++)for(p=Z[V],X=0;2>X;X++)B=0===X?"c1":"c2",p[B]&&(m=G.distanceToSquared(p[B]),i>m&&(i=m,j=p,P=V,e=B));if(i>U)return!1;L.activing.hlpair=j,L.activing.hltype=e;var h=L.highlight={};return h.type="changeCtrlPoint",h.point=j[e],L.editing={type:"ctrlPoint",pair:j,pairId:P,ctrlType:e,direction:j[e].clone().sub(L.activing.point).normalize()},L._interactor.setCursor("crosshair"),!0}}}},ak.prototype.startEdit=function(f,h){f.startDragging(h);var P=this;P.highlight&&"insertKnot"===P.highlight.type&&(P.insertKnot(),P.gatherSingleTarget(P._interactor.gv,P.target),P.activing=null,P._checkEditRealPoint(P._interactor._getLogicalPoint(h)));var I=P._activing;if(I){var A=P.editing?P.editing.type:null;"ctrlPoint"===A?I.editingCtrl={pairId:P.editing.pairId,type:I.hltype}:"realPoint"===A&&(I.editingCtrl=!1)}var J=P.highlight,j=S.Default.isCtrlDown(h);if(!J||oj()){var r=P._interactor.gv;if(!r.setFocus(h)||r._scrolling)return;return r.isPannable()&&Rl(h)&&!j&&(P._pan={tx:r.tx(),ty:r.ty()},f.fi({kind:"beginPan",event:h})),void 0}if("changeRealPoint"===J.type){var U,W=P.activing?P.activing.point:null,m=P.activing?P.activing.selections:null;if(j&&P.activing)W===J.point?(m?(P.activing={point:m[0]},m.length>1&&(m.splice(0,1),P.activing.selections=m)):P.activing=null,P.editing=null):m&&(U=m.indexOf(J.point))>=0?(m.length>1?m.splice(U,1):delete P.activing.selections,P.editing=null):m?(m.push(W),P.activing={point:J.point,selections:m}):P.activing={point:J.point,selections:[W]};else if(m)W===J.point||((U=m.indexOf(J.point))>=0?(m.splice(U,1,W),P.activing={point:J.point,selections:m}):P.activing={point:J.point});else{var p;W===J.point&&(p=P.activing.status),P.activing={point:J.point},p&&(P.activing.status=p)}f.fi({kind:"beginEditPoint",event:h})}},ak.prototype.insertKnot=function(){var n=this,h=n.highlight,$=n.screenInfo.curve;$.insertKnot(h.bezier,h.point.t),n._writeToHt()},ak.prototype._writeToHt=function(){var o,m,q,u,p=this,l=p.screenInfo.curve,d=l.toHtShape(),y=d.points,a=[],Q=d.segments,b=p._interactor.gv,z=p.target,t=z instanceof S.Edge,G=bp.getDataMatrix(z).invert();u=z instanceof S.Polyline,u&&(q=z.getElevation());for(var P=0,M=y.length;M>P;P++)o=y[P],m=bp.toWorldPosition(b,o),m=G.apply(m),o.e!=i&&o.e!==q&&(m.e=o.e),a.push(m);if(z._writing=!0,t){z.s("edge.type","points"),z.setStyle("edge.segments",Q),z.setStyle("edge.points",a.slice(1,a.length-1)),z.setStyle("edge.source.offset.x",0),z.setStyle("edge.source.offset.y",0),z.setStyle("edge.target.offset.x",0),z.setStyle("edge.target.offset.y",0);var X=p._nextChangeEdgeHost;delete p._nextChangeEdgeHost,X&&("source"===X.type?z.setSource(X.host):z.setTarget(X.host)),p._writeEdgeHostAnchor("source",a[0]),p._writeEdgeHostAnchor("target",a[a.length-1])}else a.length?(z.setSegments(Q),z.setPoints(a,!0)):z.removeFromDataModel();delete z._writing},ak.prototype._writeEdgeHostAnchor=function(M,F){var f=this,E=f.target,I=f._calcHostAnchor(E,M,F);I.index!==i?(E.setStyle("edge."+M+".index",I.index),E.setStyle("edge."+M+".percent",i),E.setStyle("edge."+M+".anchor.x",i),E.setStyle("edge."+M+".anchor.y",i)):I.percent!==i?(E.setStyle("edge."+M+".percent",I.percent),E.setStyle("edge."+M+".index",i),E.setStyle("edge."+M+".anchor.x",i),E.setStyle("edge."+M+".anchor.y",i)):(E.s("edge."+M+".anchor.x",I.x),E.s("edge."+M+".anchor.y",I.y),I.offsetX||I.offsetY?(E.s("edge."+M+".offset.x",I.offsetX),E.s("edge."+M+".offset.y",I.offsetY)):(E.s("edge."+M+".offset.x",0),E.s("edge."+M+".offset.y",0)))},ak.prototype._calcHostAnchor=function(n,Z,F,s){s||(s="source"===Z?n.getSource():n.getTarget());var M=this._interactor.gv,E=M.calculateAttachPoint(s,F);if(E)return E.info;if(ck(s)){var h=M.calculateEdgePosition(s,F);return h}var v=s.getRotation(),g=s.getAnchor();if(ue(s,M)&&(v=0),v){var y=s.getMatrix(),T=y.tfi(F),Q=s.getSize();return{x:T.x/Q.width+g.x,y:T.y/Q.height+g.y}}var V=Tl(M,s),q={x:(F.x-V.x)/V.width,y:(F.y-V.y)/V.height};return q},ak.prototype._handlePanning=function(h){var S=this,b=S._pan;if(b){b.started=!0;var q=S._interactor,v=q.gv,T=q._lastClientPoint,X=_o(h);v.setTranslate(b.tx+X.x-T.x,b.ty+X.y-T.y),S.gatherSingleTarget(q.gv,S.target),q._42(),q.fi({kind:"betweenPan",event:h})}},ak.prototype.handleEdit=function(k,p){var U=this,q=U.editing;if(U._pan)return U._handlePanning(p),void 0;if(q){q.inEdit=!0;var V,A,X,o=U._interactor._getLogicalPoint(p),r=S.Default.isCtrlDown(p),l=S.Default.isShiftDown(p),x=q.type,M=U.activing;if(U._guideInfo=null,"ctrlPoint"===x&&l){var D=U.editing.direction.clone();V=M.point;var j=D.dot(o.clone().sub(V));o=D.setLength(j).add(V)}else if("ctrlPoint"===x||"realPoint"===x){var D;if("realPoint"===x&&l){var T=U.editing.shiftGuide;A=T.point;var Y=Math.abs(o.x-A.x),d=Math.abs(o.y-A.y);Y>d&&Y>T.limit&&"y"===T.dir&&(T.dir="x"),d>Y&&d>T.limit&&"x"===T.dir&&(T.dir="y"),D=T.dir,"x"===D?(o.y=A.y,T.limit=Math.max(T.limit,Y)):"y"===D&&(o.x=A.x,T.limit=Math.max(T.limit,d))}var Q=U._isEditEdgeSourceTarget();if(Q){var N=U._editEdgeSourceTarget(Q,o,r);N&&(U.edgeEditResult=N,X=N.tipText)}else if(!r){var y=U._guidingToEdit(o,D),_="realPoint"===x?U._interactor.gridGuide.findClosest(o,D,!0):null,f=1/0,C=1/0;_&&(_.x&&(f=_.x),_.y&&(C=_.y));var w=!1;y&&(y.xList&&(Math.abs(y.x)<=Math.abs(f)?(w=!0,f=y.x):delete y.xList),y.yList&&(Math.abs(y.y)<=Math.abs(C)?(w=!0,C=y.y):delete y.yList),w&&(U._guideInfo=y)),isFinite(f)&&(o.x+=f),isFinite(C)&&(o.y+=C),w&&(y.v=o)}}var z=U.screenInfo.curve;if("realPoint"===q.type){V=q.point,V.e!==i&&(o.e=V.e),z.moveRealPoint(V,o),q.point=o,U.highlight.point=o;var B=M.status,t=M.selections;if(U.activing={point:o,status:B},t){var G=o.clone().sub(V),O=0;t.forEach(function(n){var y=n.clone().add(G);z.moveRealPoint(n,y),t[O++]=y}),U.activing.selections=t}}else if("ctrlPoint"===q.type){var J=M.pairs,W=J[q.pairId];z.moveCtrlPoint(W,o,q.ctrlType);var b=M.status,a=bp.Curve.PointType;if((b===a.Mirrored||b===a.Asymmetric)&&W.c1&&W.c2){var V=new bp.Math.Vector2(M.point),I="c1"===q.ctrlType?"c2":"c1";if(b===bp.Curve.PointType.Mirrored)z.moveCtrlPoint(W,V.clone().multiplyScalar(2).sub(o),I);else if(b===a.Asymmetric){var j=W[I].clone().sub(V).length(),Z=V.clone().sub(W[q.ctrlType]).setLength(j).add(V);isNaN(Z.x)||z.moveCtrlPoint(W,Z,I)}}M._firePointChange()}else if("elevation"===q.type){A=q.startPoint;var H=A.e+(A.y-o.y)/k._zoom;U._setCurrentPointImpl("e",H),M._firePointChange(),X="E: "+bp.toFixed(H)}var K=S.Default.getLogicalPoint(p,U._interactor._canvas);if(K.x+=bp.Icons.TipShiftX,K.y+=bp.Icons.TipShiftY,!X){var n=bp.toWorldPosition(k,o);X=""+bp.toFixed(n.x)+", "+bp.toFixed(n.y)}U.tipInfo={helperPos:K,text:X,size:X.length},U._writeToHt(),U._interactor.fi({kind:"betweenEditPoint",event:p})}},ak.prototype._setCurrentPointImpl=function(J,B){var x=this,$=x._activing;if(!$)return!1;var I=x.target;if(!I)return!1;var t=$.getCurrentEditingPoint();if(!t)return!1;var F=$.editingCtrl;if(!F)var P=t.clone();if("e"===J)t.e=B;else{var q;if("x"===J||"y"===J){var D=$._lastFirePoint;q="x"===J?{x:B,y:D?D.y:0}:{x:D?D.x:0,y:B}}else"object"==typeof J?(q=J,J.e!==i&&(t.e=J.e)):(q={x:arguments[0],y:arguments[1]},arguments[2]!==i&&(t.e=arguments[2]));var T=bp.getDataMatrix(I);q=bp.toScreenPosition(x._interactor.gv,T.apply(q)),t.x=q.x,t.y=q.y}if(!F){var G=P.multiplyScalar(-1).add(t);t.e&&P.e&&(G.e=t.e-P.e),x.screenInfo.curve.moveCtrlDueToRealPointMovement(t,G)}return!0},ak.prototype.setCurrentPoint=function(C,a){return this._setCurrentPointImpl(C,a)?(this._writeToHt(),!0):!1},ak.prototype._isEditEdgeSourceTarget=function(){var u=this,D=u.target;if(!(D instanceof S.Edge))return!1;var G=u.editing.point,Y=u.screenInfo.curve._curves;return G===Y[0]._p1?"source":G===Y[Y.length-1]._p4?"target":!1},ak.prototype._editEdgeSourceTarget=function(A,d,Q){var R,z=this,k=z.target;if(R="source"===A?k.getSource():k.getTarget()){var q,W=z._interactor.gv,v=bp.toWorldPosition(W,d),p=z._calcHostAnchor(k,A,v,R);if(q=p.index!==i||p.percent!==i?p.distance*W.getZoom()>z._interactor.getStyle("edgeHostEdgeMaxDistance"):z._interactor.getStyle("edgeHostDetectPerFrame")?!0:p.x<0||p.x>1||p.y<0||p.y>1?!0:!1){var u=W.getDataAt(v,function(z){return W.isSelectable(z)?z===R?!1:k.canSetSourceTarget(z,A)?!0:!1:!1});if(u){var L=z._calcHostAnchor(k,A,v,u);R=u,z._nextChangeEdgeHost={type:A,host:u},p=L}}var b,Z,h;if(Q||p.x===i)(p.percent!==i||p.index!==i)&&(Z=p.point);else{var Y=z._interactor.getStyle("anchorRound"),V=z._interactor.getStyle("anchorSensitivity");b=W.calculateAttachPoint(R,v),b?p=b.info:(p.x=bp.roundTo(p.x,Y,V),p.y=bp.roundTo(p.y,Y,V)),Z=R.getAttachPosition(p.x,p.y,p.offsetX,p.offsetY)}Z&&(h=bp.toScreenPosition(W,Z),d.x=h.x,d.y=h.y),z._edgeHostGuideInfo={corners:bp.getTargetCornersOnScreen(W,R),attach:b?b.index:-1,host:R};var O;return p.percent!==i?O="percent: "+p.percent.toFixed(2):p.index!==i?O="index: "+p.index:(O=""+p.x.toFixed(2)+", "+p.y.toFixed(2),(p.offsetX||p.offsetY)&&(O+=" offset: "+p.offsetX.toFixed(2)+", "+p.offsetY.toFixed(2))),{host:R,anchor:p,tipText:O}}},ak.prototype._guidingToEdit=function(P,M){var d,h,F=this;if(d=F.screenInfo.curve){h=d._curves;var e,r,U,j,x,J,X,q,Q=1/0,m=1/0,_=[];for(F.editing&&"realPoint"===F.editing.type&&(q=F.editing.point),x=0,J=2*h.length;J>x;x++)X=h[Math.floor(x/2)][x%2?"_p4":"_p1"],_.indexOf(X)>=0||(_.push(X),q&&q===X||(U=X.x-P.x,j=X.y-P.y,Math.abs(U)<Math.abs(Q)?(Q=U,e=[X]):U===Q&&e.push(X),Math.abs(j)<Math.abs(m)?(m=j,r=[X]):j===m&&r.push(X)));var B=F._interactor.getStyle("smartGuideSensitivity");if((Math.abs(Q)>B||"y"===M)&&(e=null),(Math.abs(m)>B||"x"===M)&&(r=null),e||r){var A=!1,w={};if(e&&(A=!0,w.xList=e,w.x=Q),r&&(A=!0,w.yList=r,w.y=m),A)return w}}},ak.prototype._46O=function(e){var A=this;A.editing&&(A.editing=null,A._interactor.fi({kind:"endEditPoint",event:e})),A._guideInfo=null,A._edgeHostGuideInfo=null,A._pan&&(A._pan=null,A._interactor.fi({kind:"endPan",event:e})),A.tipInfo=null,A.edgeEditResult=null},ak.prototype._canDeletePoint=function($,C){var A=this.target;if(!(A instanceof S.Edge))return!0;var K=$._curves[0],L=$._curves[$._curves.length-1];return K._p1===C||L._p4===C?!1:!0},ak.prototype.handleDelete=function(){var M=this;if(M.activing&&M.screenInfo){var z=S.Default.isShiftDown(),O=M.screenInfo.curve;M._canDeletePoint(O,M.activing.point)&&O.deleteRealPoint(M.activing.point,z),M.activing.selections&&M.activing.selections.forEach(function(S){M._canDeletePoint(O,S)&&O.deleteRealPoint(S,z)}),M.activing=null,delete M.editing,delete M.tipInfo,delete M.edgeEditResult,delete M._pan,M._writeToHt(),M._interactor.fp("deleteShapePoint",!1,!0)}},ak.prototype.handleDoubleClick=function(A){var j=this,D=j._interactor._getLogicalPoint(A);if(j.screenInfo&&j._checkEditRealPoint(D)){var _=j.getCurrentSelectintStatus(),U=bp.Curve.PointType;return _=_===U.Mirrored?U.Straight:U.Mirrored,j._setCurrentSelectionStatus(_),j._interactor._42(),!0}},ak.prototype._drawHighlight=function(U){var k=this,g=k.highlight;if(g){var h=g.bezier,n=k._interactor;h&&bp.Icons.DrawIcon(n,U,bp.Icons.ShapeHighlightCurve,[h._p1.x,h._p1.y,h._p2.x,h._p2.y,h._p3.x,h._p3.y,h._p4.x,h._p4.y]);var V=g.point;V&&"insertKnot"===g.type&&bp.Icons.DrawIcon(n,U,bp.Icons.ShapeHighlighPoint,V)}},ak.prototype._drawGuide=function(V){var F=this,u=F._guideInfo;if(u){var X,D,O,q,L=u.v;for(X=0;2>X;X++)if(q=0===X?u.xList:u.yList)for(D=0,O=q.length;O>D;D++)bp.Icons.DrawIcon(F._interactor,V,bp.Icons.ShapeGuideLine,[L.x,L.y,q[D].x,q[D].y])}},ak.prototype._drawCurrentPoint=function(r){var v=this;if(v.activing){var _=v.activing,l=v.getCurrentSelectintStatus(),K=v._interactor;if(l!==bp.Curve.PointType.Straight){var F=_.pairs;_.hlpair,_.hltype;var X=_.selections,Y=_.editingCtrl;if(F&&!X){var w,M,c;for(M=0,c=F.length;c>M;M++)w=F[M],Y&&M===Y.pairId&&w[Y.type]?bp.Icons.DrawIcon(K,r,bp.Icons.ShapeActivingCtrl,{point:w.point,c1:w.c1,c2:w.c2,hl:Y.type}):bp.Icons.DrawIcon(K,r,bp.Icons.ShapeActivingCtrl,w)}}bp.Icons.DrawIcon(K,r,bp.Icons.ShapeHighlighRealPoint,v.activing.point),X&&X.forEach(function(t){bp.Icons.DrawIcon(K,r,bp.Icons.ShapeHighlighRealPoint,t)})}},ak.prototype.clear=function(){var b=this;b.editing=null,b._guideInfo=null,b.activing=null,b.highlight=null},ak.prototype._42=function(d){var y=this;y.info={},y.editing||(y.screenInfo=null);var c=y._interactor;if(!c.editDetail)return y.clear(),void 0;var Q=c.gv;if(!y.target||!Q.isSelected(y.target)||!Q.isVisible(y.target))return c.editDetail=!1,y.clear(),void 0;if(y.gatherSingleTarget(Q,y.target),bp.Icons.DrawIcon(c,d,bp.Icons.ShapeBgCurve,y.screenInfo),y._drawHighlight(d),y._drawCurrentPoint(d),y._getRealPoint().forEach(function(g){bp.Icons.DrawIcon(c,d,bp.Icons.ShapePoint,g)}),y._drawGuide(d),y.tipInfo&&bp.Icons.DrawIcon(c,d,bp.Icons.TipHelper,y.tipInfo),y._edgeHostGuideInfo){bp.Icons.DrawIcon(c,d,bp.Icons.NodeHoverGuide,y._edgeHostGuideInfo.corners);var O=y._edgeHostGuideInfo.host;if(O){var s=Q.getAttachPoints(O);if(s&&s.length)for(var _=0,m=s.length;m>_;_++){var U=s[_],z=O.getAttachPosition(U.x,U.y,U.offsetX,U.offsetY);z=bp.toScreenPosition(Q,z),z.isAttach=y._edgeHostGuideInfo.attach===_,bp.Icons.DrawIcon(c,d,bp.Icons.AttachPoint,z)}}}if(y._interactor.getStyle("curveElevationVisible")&&y.target instanceof S.Polyline&&y.activing){var A=y.activing.getCurrentEditingPoint();A&&bp.Icons.DrawIcon(c,d,bp.Icons.EdgeElevationGuide,A)}y.edgeEditResult&&y._drawEdgeHostHighlight(d,y.edgeEditResult.host,y.edgeEditResult.anchor)},ak.prototype._drawEdgeHostHighlight=function(e,M,C){this.drawEdgeHostHighlight(e,M,C),this._interactor.redraw()},ak.prototype.drawEdgeHostHighlight=function(n,j,X){if(ck(j)){var H,I,V,o,U=this,k=U._interactor,y=k.gv,T=y.getDataUI(j),s=bl(T),x=[];for(V=0,o=s.points.length;o>V;V++)I=bp.toScreenPosition(y,s.points.get(V)),x.push(I.x,I.y);s.segments&&(H=s.segments.toArray());var z=k.getStyle("edgeHostHighlighPeriod"),C=k.getStyle("edgeHostEdgeHighlighColor");bp.Icons.DrawIcon(k,n,bp.Icons.ShapeBgCurve,{P:x,S:H,color:C,dynamicVisible:X.index===i,dynamicPeriod:z}),C=k.getStyle("edgeHostPointHighlighColor");var a=Fr(T);for(V=0,o=a.length;o>V;V++){var l=a[V],q=bp.toScreenPosition(y,l);bp.Icons.DrawIcon(k,n,bp.Icons.ShapePoint,{point:{x:q.x,y:q.y},color:C,size:12,dynamicVisible:V===X.index,dynamicPeriod:z})}}},ak.prototype._getRealPoint=function(){var n,f=this.screenInfo,Q=f.P,D=f.S,w=-1,x=[],s=-1,G=D.length;return D.each(function(Y){s++;var O=1;if(3===Y)O=2;else if(4===Y)O=3;else if(5===Y)return;w+=O,n=s+1>=G?!0:1===D.get(s+1)?!0:!1,x.push({point:{x:Q[2*w],y:Q[2*w+1]},segmentIndex:s,pointIndex:w,isEnd:n})}),x},ak.prototype.getEditingPointsInfo=function(L){var C=this,S=C.activing;if(!S)return!1;var l=S.point;if(!l)return!1;var N=this._getRealPoint(),i=[{screen:l}];S.selections&&S.selections.forEach(function(v){i.push({screen:v})});var Q,x,o=N.length;return i.forEach(function(M){for(Q=0;o>Q;Q++)if(x=N[Q],M.screen.isNearEnough(x.point)){M.segmentIndex=x.segmentIndex,M.pointIndex=x.pointIndex,M.point=C.target.getPoints().get(x.pointIndex);break}}),L&&i.sort(function(X,y){return X.segmentIndex-y.segmentIndex}),i};var Gd=bp.MoveHelper=function(O){var V=this;V.catalog="Move",V._interactor=O};Gd.prototype={},Gd.prototype.constructor=Gd,Gd.prototype.calcShift=function(v,q,F){var p,_,P=this,l=P._interactor.gv,R=l.lp(q);if("beginMove"===v&&P._gatherGridInfo(F._lastLogicalPoint||R),p=P._target){var j=p.downPosition;if(j){var V=P._interactor.getStyle("moveSensitivity")/l._zoom;if(j.distanceTo(R)<V)return{x:0,y:0};delete p.downPosition}var O;_=S.Default.isShiftDown(q),_&&(R=P._dealShiftDown(R),O=p.shiftGuide.dir);var N,z=p.rawPos={x:p.pos.x+R.x-p.lp.x,y:p.pos.y+R.y-p.lp.y};if(S.Default.isCtrlDown(q)){if(N=P._calcShiftByAddon(),P._target.node instanceof bp.Group){var W=P._target.node;W._position.x+=N.x,W._position.y+=N.y}return N}for(var X,h=p.x+z.x,G=p.y+z.y,Y={x:h,y:G},s={x:h+p.w/2,y:G+p.h/2},C={x:h+p.w,y:G+p.h},n=P._interactor.rectGuide,y=P._interactor.gridGuide,Q=[n.findClosest(Y,O),n.findClosest(s,O),n.findClosest(C,O),y.findClosest(Y,O),y.findClosest(s,O),y.findClosest(C,O)],c=1/0,u=1/0,A=0,M=Q.length;M>A;A++)X=Q[A],X&&(h=X.x,G=X.y,isFinite(h)&&Math.abs(h)<Math.abs(c)&&(c=h),isFinite(G)&&Math.abs(G)<Math.abs(u)&&(u=G));if(isFinite(c)||(c=0),isFinite(u)||(u=0),N=P._calcShiftByAddon(c,u),P._target.node instanceof bp.Group){var W=P._target.node;W._position.x+=N.x,W._position.y+=N.y}var g=p.node;if(!ue(g,l)){var E=z.x+c,w=z.y+u;P._interactor.rectGuide.gatherLines({node:g,x:p.x+E,y:p.y+w,w:p.w,h:p.h},O)}return N}},Gd.prototype._calcShiftByAddon=function(r,p){var Z=this._target,m=Z.rawPos,h=Z.node.getPosition();return r=r||0,p=p||0,{x:m.x-h.x+r,y:m.y-h.y+p}},Gd.prototype._dealShiftDown=function(T){var _=this,p=_._target.shiftGuide,M=_._target.lp,R=Math.abs(T.x-M.x),a=Math.abs(T.y-M.y);R>a&&R>p.limit&&"y"===p.dir&&(p.dir="x"),a>R&&a>p.limit&&"x"===p.dir&&(p.dir="y");var D=p.dir;return"x"===D?(T.y=M.y,p.limit=Math.max(p.limit,R)):"y"===D&&(T.x=M.x,p.limit=Math.max(p.limit,a)),T},Gd.prototype._gatherGridInfo=function(G){var s,L=this,n=L._interactor,i=n._getValidSelection();if(i.length){if(1===i.length){if(s=i[0],!s.getRect)return L._target=null,void 0}else if(s=bp.Group.findOrCreateGroup(i),!s)return L._target=null,void 0}else{var i=n.gv.sm().getSelection();if(i.length&&(s=i.get(0),!s.getRect))return L._target=null,void 0}var X=s.getPosition(),j=s.getRect();L._target={node:s,x:j.x-X.x,y:j.y-X.y,w:j.width,h:j.height,lp:{x:G.x,y:G.y},pos:{x:X.x,y:X.y},shiftGuide:{dir:"x",limit:0},downPosition:new bp.Math.Vector2(G)},n.rectGuide.gatherRects()},Gd.prototype.clear=function(){var F=this;F._interactor.rectGuide.clear(),F._interactor._42()};var qm="directional",lk="point",es="spot",zf="light.color",ig=function(K,l){Tp(l)&&Yb.test(l)?He(K,l):$p(l)&&l.modelType?al(K,l):Zj[K]=l},Tm=function(q){if($p(q))return q.modelType?q.uuid?Zj[q.uuid]:(q.uuid=S.Math.generateUUID(),al(q.uuid,q),i):q;var w=Zj[q];return q&&w===i&&Yb.test(q)&&(Xl&&Xl[q]||He(q,q)),w},Vb=function(I,D){I.frameStack?I.frameStack.push(D):I.frameStack=[D],I.bindFramebuffer(I.FRAMEBUFFER,D)},pi=function(w){var b=w.frameStack;if(b){if(b.pop(),b.length)return w.bindFramebuffer(w.FRAMEBUFFER,b[b.length-1]),void 0;w.frameStack=null}w.bindFramebuffer(w.FRAMEBUFFER,null)};Gh(x,{graph3dViewAttributes:a,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:O/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:ym,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:O/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,graph3dMaxVectorCacheTime:50,setShape3dModel:ig,getShape3dModel:Tm,createMatrix:function(e,U){mr(e)||(e=[e]);for(var i=e.length-1;i>=0;i--){var h=e[i];U=cb(h.mat,h.s3,h.r3,h.rotationMode,h.t3,U)}return U},transformVec:function(s,F){return Hf(s,F)},glBindFrame:Vb,glUnbindFrame:pi,createBoxModel:function(){return{vs:Dd,ns:tk,uv:Ak,is:Ll}},createRoundRectModel:function($,X){return nl.roundRect($,X)},createStarModel:function(L,B){return nl.star(L,B)},createRectModel:function(X,G){return nl.rect(X,G)},createTriangleModel:function(m,$){return nl.triangle(m,$)},createRightTriangleModel:function(r,K){return nl.rightTriangle(r,K)},createParallelogramModel:function(f,t){return nl.parallelogram(f,t)},createTrapezoidModel:function(Q,F){return nl.trapezoid(Q,F)},createSmoothSphereModel:function(i,n,J,D,B,K,x){return Um(new Yi(i,n,J,D,B,K,x))},createSphereModel:function(P,b,u,U,K,l){return P?_k(P,b,u,U,K,l):x.createSmoothSphereModel()},createSmoothConeModel:function(A,k,r,L,f){return zq(A,k,r,L,f)},createConeModel:function(Y,K,u,q,y,g){return Y?Vc(Y,K,u,q,y,g):zq(g)},createSmoothCylinderModel:function(Y,y,h,K,L,i,$,G){return Um(new ie(Y,y,h,K,L,i,$,G))},createCylinderModel:function($,Z,_,v,F,L,V){return $?Ab($,Z,_,v,F,L,V):Nb(L,V)},createSmoothTorusModel:function(c,f,O,D,h,V){return Um(new uh(c,f,O,D,h,V))},createTorusModel:function(r,m,j,v,t,w,i){return r?vr(r,m,j,v,t,w,i):ps(w,i)},createExtrusionModel:function(f,E,p,L,Q,o,b,u){return Sc(f,E,p,L,Q,o,b,u)},createSmoothRingModel:function($,q,d,g,Q,y){for(var r=[],H=0;H<$.length-1;H+=2)r.push({x:$[H],y:$[H+1]});for($=vl(r,q,d)[0],r=[],H=0;H<$.length;H++){var k=$[H];r.push(new Cn(k.x,0,k.y))}return Um(new Wi(r,y,g,Q))},createTextGeometry:function(y,P){return Um(new sj(y,P))},loadFontFace:function(J,h){x.xhrLoad(J,function(o){if(!o)return h();var m;try{m=JSON.parse(o)}catch(d){m=JSON.parse(o.substring(65,o.length-2))}$q.loadFace(m),h&&h(m.familyName.toLowerCase())},h?null:{sync:!0})},createRingModel:function(l,p,C,P,L,B,N,A,S,U){for(var q=[],D=0;D<l.length-1;D+=2)q.push({x:l[D],y:l[D+1]});B=B||x.shapeSide,N=N||0,A=A||B;var J,H,d,n,F,t,G,m,E,u,D,K,o,g,Y,y,w,h,i=[],z=[],e=S?[]:a,T=S?[]:a,$=U?[]:a,X=U?[]:a,R=P?[]:a,v=P?[]:a,f=L?[]:a,O=L?[]:a,l=vl(q,p,C),j=Ir(l),I=0,W=2*Math.PI/B;return l.forEach(function(p){if(d=p.length,d>1){if(n=p[0],P)for(t=n.x,m=n.y,D=N;A>D;D++)K=D+1,o=D*W,g=K*W,Y=b(o),y=M(o),w=b(g),h=M(g),R.push(Y*t,m,-y*t,w*t,m,-h*t,0,m,0),v.push(.5-.5*Y,.5-.5*y,.5-.5*w,.5-.5*h,.5,.5);for(u=0;d>u;u++){for(F=p[u],t=n.x,G=F.x,m=n.y,E=F.y,J=I/j,I+=Og(n,F),H=I/j,D=N;A>D;D++)K=D+1,o=D*W,g=K*W,Y=b(o),y=M(o),w=b(g),h=M(g),i.push(Y*G,E,-y*G,w*G,E,-h*G,Y*t,m,-y*t,w*G,E,-h*G,w*t,m,-h*t,Y*t,m,-y*t),z.push(D/B,H,K/B,H,D/B,J,K/B,H,K/B,J,D/B,J),S&&D===N&&(e.push(0,m,0,0,E,0,Y*G,E,-y*G,Y*G,E,-y*G,Y*t,m,-y*t,0,m,0),T.push(0,.5-m,0,.5-E,2*G,.5-E,2*G,.5-E,2*t,.5-m,0,.5-m)),U&&K===A&&($.push(0,m,0,w*G,E,-h*G,0,E,0,w*G,E,-h*G,0,m,0,w*t,m,-h*t),X.push(1,.5-m,1-2*G,.5-E,1,.5-E,1-2*G,.5-E,1,.5-m,1-2*t,.5-m));
n=F}if(L)for(t=n.x,m=n.y,D=N;A>D;D++)K=D+1,o=D*W,g=K*W,Y=b(o),y=M(o),w=b(g),h=M(g),f.push(w*t,m,-h*t,Y*t,m,-y*t,0,m,0),O.push(.5-.5*w,.5+.5*h,.5-.5*Y,.5+.5*y,.5,.5)}}),{vs:i,uv:z,bottom_vs:f,bottom_uv:O,top_vs:R,top_uv:v,from_vs:e,from_uv:T,to_vs:$,to_uv:X}}},!0),Gh(W,{"3d.move.mode":i,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":i,"edge.gradient.color":i,"edge.source.t3":i,"edge.target.t3":i,"light.type":lk,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":O/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":wp,"wf.short":!1,"wf.mat":i,"wf.geometry":!1,batch:i,"transparent.mask":!1,brightness:i,"select.brightness":.7,"repeat.uv.length":i,alphaTest:.4,"highlight.visible":!0,"highlight.width":.8,"highlight.color":"rgba(190, 210, 250, 1)","color.empty":[0,0,0,0],"shape3d.vector.dynamic.maxsize":2048,"label.face":Ie,"label.t3":i,"label.r3":i,"label.texture.scale":2,"label.rotationMode":Rq,"label.light":!1,"label.blend":i,"label.reverse.flip":!1,"label.reverse.color":Np,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":Ie,"label2.t3":i,"label2.r3":i,"label2.texture.scale":2,"label2.rotationMode":Rq,"label2.light":!1,"label2.blend":i,"label2.reverse.flip":!1,"label2.reverse.color":Np,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":Ie,"note.t3":i,"note.r3":i,"note.texture.scale":2,"note.rotationMode":Rq,"note.light":!1,"note.blend":i,"note.reverse.flip":!1,"note.reverse.color":Np,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":Ie,"note2.t3":i,"note2.r3":i,"note2.texture.scale":2,"note2.rotationMode":Rq,"note2.light":!1,"note2.blend":i,"note2.reverse.flip":!1,"note2.reverse.color":Np,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:i,"shape3d.color":Mh,"shape3d.top.color":i,"shape3d.bottom.color":i,"shape3d.from.color":i,"shape3d.to.color":i,"shape3d.image":i,"shape3d.top.image":i,"shape3d.bottom.image":i,"shape3d.from.image":i,"shape3d.to.image":i,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":i,"shape3d.side.to":i,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":i,"shape3d.opacity":i,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Np,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":i,"shape3d.uv.scale":i,"shape3d.top.uv.offset":i,"shape3d.top.uv.scale":i,"shape3d.bottom.uv.offset":i,"shape3d.bottom.uv.scale":i,"shape3d.from.uv.offset":i,"shape3d.from.uv.scale":i,"shape3d.to.uv.offset":i,"shape3d.to.uv.scale":i,"shape3d.top.cap":i,"shape3d.bottom.cap":i,"shape3d.start.angle":0,"shape3d.sweep.angle":$,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":i,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":Mh,"all.image":i,"all.blend":i,"all.opacity":i,"all.reverse.flip":!1,"all.reverse.color":Np,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":i,"all.uv.offset":i,"all.uv.scale":i,"all.discard.selectable":!0,mat:i,"left.mat":i,"right.mat":i,"top.mat":i,"bottom.mat":i,"front.mat":i,"back.mat":i},!0);var Lp,Jp=!1,Qj=[0,0,0,0],Nk={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:ce,2:_i,3:Se,4:ep,5:Ie,6:No}},cg=function(K,t,a,x){if(t.getFaceVisible(K,a)){Oo(t,Sb(K,t.getFaceMat(K,a)||t.getMat(K)));var I=t._26I;t.getFaceReverseCull(K,a)?I.enable(I.CULL_FACE):I.disable(I.CULL_FACE),mb(I,t._prg.uFixPickReverseColor,Nk[a]),ui(I),mh(I,x,6),nf(I),Yf(t)}},bd=function(U){return U instanceof am},fo=function(f){return[f.x,f.e||0,f.y]},Ch=function(c,f,K){for(var f=gi(f),Q=f[0],X=f[1],U=f[2];K--;)c.push(Q,X,U)},Gg=function(V,E,n){for(var E=gi(E),h=E[0],Q=E[1],m=E[2],p=E[3];n--;)V.push(h,Q,m,p)},Rm=function(x,y,P){if(y)for(var D,H,W,n=y[0],o=y[1],T=y[2],O=y[4],m=y[5],J=y[6],j=y[8],M=y[9],V=y[10],l=y[12],d=y[13],g=y[14],z=P.length,f=0,f=0;z>f;f+=3)D=P[f],H=P[f+1],W=P[f+2],x.push(n*D+O*H+j*W+l,o*D+m*H+M*W+d,T*D+J*H+V*W+g);else On(x,P)},hs=function(L,U){var a=U.s("light.intensity"),B=gi(U.s(zf)),W=B[0],E=B[1],X=B[2];1!==a&&(W*=a,E*=a,X*=a),L.push(W,E,X,U.s("light.disabled")?1:0)},Kb=function(m,f,O){mb(f,O.uHeadlightRange,m._headlightRange);var U=m._headlightIntensity,w=gi(m._headlightColor);1!==U&&(w=[w[0]*U,w[1]*U,w[2]*U]),mb(f,O.uHeadlightColor,[w[0],w[1],w[2],m._headlightDisabled?1:0]);var t=m._59O,z=m._spots,L=m._dirs;if(t.length){var Q=[],g=[],V=[];t.forEach(function(_){hs(Q,_),On(g,m._transformPointToViewSpace(_.p3())),V.push(_.s("light.range"))}),f.uniform4fv(O.uPointColor,Q),f.uniform1fv(O.uPointRange,V),f.uniform3fv(O.uPointPosition,g)}if(z.length){var x=[],N=[],M=[],c=[],C=[],v=[];z.forEach(function(j){hs(x,j),On(N,m._transformPointToViewSpace(j.p3())),On(C,m._transformDirectionToViewSpace(j.p3(),j.s("light.center"))),M.push(j.s("light.range")),c.push(b(j.s("light.angle")/2)),v.push(j.s("light.exponent"))}),f.uniform4fv(O.uSpotColor,x),f.uniform1fv(O.uSpotRange,M),f.uniform1fv(O.uSpotAngle,c),f.uniform1fv(O.uSpotExponent,v),f.uniform3fv(O.uSpotPosition,N),f.uniform3fv(O.uSpotDirection,C)}if(L.length){var y=[],E=[];L.forEach(function(S){hs(y,S),On(E,m._transformDirectionToViewSpace(S.p3()))}),f.uniform4fv(O.uDirColor,y),f.uniform3fv(O.uDirDirection,E)}},Pd=function(V){return V>0&&0===(V-1&V)},ur=function(k){return k=w(0,t(O,k)),k=w(go,t(O-go,k))},nm=function(){return.05+X()/2},Nj=function(M,p,i,o){var s,t=M.getEye();return M.isOrtho()?(s=sm(M.getCenter(),t),s[0]+=o[0],s[1]+=o[1],s[2]+=o[2]):s=t,cs(p,i,o,s)},cs=function(e,M,n,g){var B=sg(e,M),z=sm(g,n,!0),s=sg(z,M);if(G(s)<go)return a;var d=(B-sg(n,M))/s;return[n[0]+z[0]*d,n[1]+z[1]*d,n[2]+z[2]*d]},Fb=function(E,j){return{x:2*E.x-j.x,y:2*E.y-j.y}},bo=function(A,Y,o,t){var V,Q;if(!A)return V=J(Y.y-o.y,o.x-Y.x),{x:Y.x+t*M(V),y:Y.y+t*b(V)};if(!o)return V=J(A.y-Y.y,Y.x-A.x),{x:Y.x+t*M(V),y:Y.y+t*b(V)};var m=sm([A.x,A.y,0],[Y.x,Y.y,0],!0),n=sm([o.x,o.y,0],[Y.x,Y.y,0],!0),E=-(m[0]+n[0])/2,c=-(m[1]+n[1])/2,y=C(E*E+c*c);if(go>y)return V=J(A.y-Y.y,Y.x-A.x),{x:Y.x+t*M(V),y:Y.y+t*b(V)};var x=A.x-Y.x,Z=A.y-Y.y,s=o.x-Y.x,f=o.y-Y.y,O=C(x*x+Z*Z),B=C(s*s+f*f);V=v(sg(m,n))/2,Q=m[1]*n[0]-m[0]*n[1]>0?-1:1,E/=y,c/=y;var H=t/M(V),L=w(O,B)/b(V);y=Math.min(H,L);var T={x:Y.x+Q*y*E,y:Y.y+Q*y*c};return o.b&&H>B/b(V)&&(T.adjust=!0),T},Xn=function(g){var L=g[1],A=g[2],H=g[3],Z=g[6],q=g[7],S=g[11];g[1]=g[4],g[2]=g[8],g[3]=g[12],g[4]=L,g[6]=g[9],g[7]=g[13],g[8]=A,g[9]=Z,g[11]=g[14],g[12]=H,g[13]=q,g[14]=S},Ri=function(O){var Q=O[0],i=O[1],B=O[2],c=O[3],S=O[4],L=O[5],X=O[6],v=O[7],G=O[8],t=O[9],R=O[10],D=O[11],p=O[12],r=O[13],V=O[14],$=O[15],k=Q*L-i*S,g=Q*X-B*S,J=Q*v-c*S,F=i*X-B*L,Z=i*v-c*L,m=B*v-c*X,W=G*r-t*p,U=G*V-R*p,h=G*$-D*p,E=t*V-R*r,w=t*$-D*r,s=R*$-D*V,n=k*s-g*w+J*E+F*h-Z*U+m*W;return n?(n=1/n,O[0]=(L*s-X*w+v*E)*n,O[1]=(B*w-i*s-c*E)*n,O[2]=(r*m-V*Z+$*F)*n,O[3]=(R*Z-t*m-D*F)*n,O[4]=(X*h-S*s-v*U)*n,O[5]=(Q*s-B*h+c*U)*n,O[6]=(V*J-p*m-$*g)*n,O[7]=(G*m-R*J+D*g)*n,O[8]=(S*w-L*h+v*W)*n,O[9]=(i*h-Q*w-c*W)*n,O[10]=(p*Z-r*J+$*k)*n,O[11]=(t*J-G*Z-D*k)*n,O[12]=(L*U-S*E-X*W)*n,O[13]=(Q*E-i*U+B*W)*n,O[14]=(r*g-p*F-V*k)*n,O[15]=(G*F-t*g+R*k)*n,void 0):a},Yc=function(T,o){if(o){var e=o[0],q=o[1],E=o[2];T[12]=T[0]*e+T[4]*q+T[8]*E+T[12],T[13]=T[1]*e+T[5]*q+T[9]*E+T[13],T[14]=T[2]*e+T[6]*q+T[10]*E+T[14],T[15]=T[3]*e+T[7]*q+T[11]*E+T[15]}},Xi=function(I,C){if(C){var Y=C[0],W=C[1],K=C[2];I[0]=I[0]*Y,I[1]=I[1]*Y,I[2]=I[2]*Y,I[3]=I[3]*Y,I[4]=I[4]*W,I[5]=I[5]*W,I[6]=I[6]*W,I[7]=I[7]*W,I[8]=I[8]*K,I[9]=I[9]*K,I[10]=I[10]*K,I[11]=I[11]*K}},wc=function(d,r,Z){var p=r[0],G=r[1],$=r[2],M=r[3],F=r[4],L=r[5],C=r[6],e=r[7],k=r[8],u=r[9],o=r[10],V=r[11],z=r[12],T=r[13],j=r[14],X=r[15],S=Z[0],b=Z[1],q=Z[2],l=Z[3];return d[0]=S*p+b*F+q*k+l*z,d[1]=S*G+b*L+q*u+l*T,d[2]=S*$+b*C+q*o+l*j,d[3]=S*M+b*e+q*V+l*X,S=Z[4],b=Z[5],q=Z[6],l=Z[7],d[4]=S*p+b*F+q*k+l*z,d[5]=S*G+b*L+q*u+l*T,d[6]=S*$+b*C+q*o+l*j,d[7]=S*M+b*e+q*V+l*X,S=Z[8],b=Z[9],q=Z[10],l=Z[11],d[8]=S*p+b*F+q*k+l*z,d[9]=S*G+b*L+q*u+l*T,d[10]=S*$+b*C+q*o+l*j,d[11]=S*M+b*e+q*V+l*X,S=Z[12],b=Z[13],q=Z[14],l=Z[15],d[12]=S*p+b*F+q*k+l*z,d[13]=S*G+b*L+q*u+l*T,d[14]=S*$+b*C+q*o+l*j,d[15]=S*M+b*e+q*V+l*X,d},Lk=function(b,N,d,g){var n,h,o,p,V,K,X,E,$,q,_=N[0],D=N[1],B=N[2],I=g[0],t=g[1],O=g[2],z=d[0],Y=d[1],L=d[2];return G(_-z)<go&&G(D-Y)<go&&G(B-L)<go?Kh(b):(X=_-z,E=D-Y,$=B-L,q=1/C(X*X+E*E+$*$),X*=q,E*=q,$*=q,n=t*$-O*E,h=O*X-I*$,o=I*E-t*X,q=C(n*n+h*h+o*o),q?(q=1/q,n*=q,h*=q,o*=q):(n=0,h=0,o=0),p=E*o-$*h,V=$*n-X*o,K=X*h-E*n,q=C(p*p+V*V+K*K),q?(q=1/q,p*=q,V*=q,K*=q):(p=0,V=0,K=0),b[0]=n,b[1]=p,b[2]=X,b[3]=0,b[4]=h,b[5]=V,b[6]=E,b[7]=0,b[8]=o,b[9]=K,b[10]=$,b[11]=0,b[12]=-(n*_+h*D+o*B),b[13]=-(p*_+V*D+K*B),b[14]=-(X*_+E*D+$*B),b[15]=1,b)},Am=function(z,s,o,t,G){var H=1/k(s/2),W=1/(t-G);return z[0]=H/o,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=H,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=(G+t)*W,z[11]=-1,z[12]=0,z[13]=0,z[14]=2*G*t*W,z[15]=0,z},Cl=function(o,h,d,w,n,H,P){var j=1/(h-d),Z=1/(w-n),D=1/(H-P);return o[0]=-2*j,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*Z,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*D,o[11]=0,o[12]=(h+d)*j,o[13]=(n+w)*Z,o[14]=(P+H)*D,o[15]=1,o},up=function(x,p){var c=p[0],m=p[1],f=p[2],Y=p[3],G=c*c+m*m+f*f+Y*Y,d=G?1/G:0;return x[0]=-c*d,x[1]=-m*d,x[2]=-f*d,x[3]=Y*d,x},Yh=function(h,d){var z=d[0]+d[5]+d[10],Z=0;return z>0?(Z=2*Math.sqrt(z+1),h[3]=.25*Z,h[0]=(d[6]-d[9])/Z,h[1]=(d[8]-d[2])/Z,h[2]=(d[1]-d[4])/Z):d[0]>d[5]&d[0]>d[10]?(Z=2*Math.sqrt(1+d[0]-d[5]-d[10]),h[3]=(d[6]-d[9])/Z,h[0]=.25*Z,h[1]=(d[1]+d[4])/Z,h[2]=(d[8]+d[2])/Z):d[5]>d[10]?(Z=2*Math.sqrt(1+d[5]-d[0]-d[10]),h[3]=(d[8]-d[2])/Z,h[0]=(d[1]+d[4])/Z,h[1]=.25*Z,h[2]=(d[6]+d[9])/Z):(Z=2*Math.sqrt(1+d[10]-d[0]-d[5]),h[3]=(d[1]-d[4])/Z,h[0]=(d[8]+d[2])/Z,h[1]=(d[6]+d[9])/Z,h[2]=.25*Z),h},Gr=function(s,y,f){var Z=y[0],G=y[1],w=y[2],n=y[3],W=Z+Z,l=G+G,b=w+w,q=Z*W,p=Z*l,i=Z*b,I=G*l,U=G*b,L=w*b,X=n*W,S=n*l,j=n*b;return s[0]=1-(I+L),s[1]=p+j,s[2]=i-S,s[3]=0,s[4]=p-j,s[5]=1-(q+L),s[6]=U+X,s[7]=0,s[8]=i+S,s[9]=U-X,s[10]=1-(q+I),s[11]=0,s[12]=f[0],s[13]=f[1],s[14]=f[2],s[15]=1,s},Cq=function(){var e=[0,0,0],P=[0,0,0],o=[0,0,0],F=function(i,z,W){i[0]=z[1]*W[2]-z[2]*W[1],i[1]=z[2]*W[0]-z[0]*W[2],i[2]=z[0]*W[1]-z[1]*W[0]},l=function(C){return C[0]*C[0]+C[1]*C[1]+C[2]*C[2]},c=function(D){var w=Math.sqrt(l(D));D[0]/=w,D[1]/=w,D[2]/=w},L=function(X,w,k){X[0]=w[0]-k[0],X[1]=w[1]-k[1],X[2]=w[2]-k[2]};return function(I,O,s){var H=Dc();return L(o,I,O),0===l(o)&&(o[2]=1),c(o),F(e,s,o),0===l(e)&&(1===Math.abs(s[2])?o[0]+=1e-4:o[2]+=1e-4,c(o),F(e,s,o)),c(e),F(P,o,e),H[0]=e[0],H[4]=P[0],H[8]=o[0],H[1]=e[1],H[5]=P[1],H[9]=o[1],H[2]=e[2],H[6]=P[2],H[10]=o[2],H}}(),Dn=function(S,k){if(S.vr.enable){var V=S.vr.getViewMatrix(k);if(V)return V}return Lk(k?k:Dc(),S._eye,S._center,S._up)},Iq=function(F){if(F.vr.enable){var n=F.vr.getProjectMatrix();if(n)return n}var u=F.getAspect(),r=F._near,Y=F._far,S=Dc();if(F._ortho){var h=F._orthoWidth/2,o=h/u;Cl(S,-h,h,-o,o,r,Y)}else Am(S,F._fovy,u,r,Y);return S},Pc=function(S,L){if(!S)return a;var e=0,Z=1,H=2,f=[],m=0,I=S.length,s=I/3;if(L){for(;I>m;m++)f[m]=0;for(m=0;m<L.length;m+=3){var o=[],K=[],w=[];o[e]=S[3*L[m+1]+e]-S[3*L[m]+e],o[Z]=S[3*L[m+1]+Z]-S[3*L[m]+Z],o[H]=S[3*L[m+1]+H]-S[3*L[m]+H],K[e]=S[3*L[m+2]+e]-S[3*L[m+1]+e],K[Z]=S[3*L[m+2]+Z]-S[3*L[m+1]+Z],K[H]=S[3*L[m+2]+H]-S[3*L[m+1]+H],w[e]=o[Z]*K[H]-o[H]*K[Z],w[Z]=o[H]*K[e]-o[e]*K[H],w[H]=o[e]*K[Z]-o[Z]*K[e];for(var y=0;3>y;y++)f[3*L[m+y]+e]+=w[e],f[3*L[m+y]+Z]+=w[Z],f[3*L[m+y]+H]+=w[H]}}else for(m=0;s>m;m+=3){var o=[],K=[],w=[];o[e]=S[3*(m+1)+e]-S[3*m+e],o[Z]=S[3*(m+1)+Z]-S[3*m+Z],o[H]=S[3*(m+1)+H]-S[3*m+H],K[e]=S[3*(m+2)+e]-S[3*(m+1)+e],K[Z]=S[3*(m+2)+Z]-S[3*(m+1)+Z],K[H]=S[3*(m+2)+H]-S[3*(m+1)+H],w[e]=o[Z]*K[H]-o[H]*K[Z],w[Z]=o[H]*K[e]-o[e]*K[H],w[H]=o[e]*K[Z]-o[Z]*K[e];for(var y=0;3>y;y++)f[3*(m+y)+e]=w[e],f[3*(m+y)+Z]=w[Z],f[3*(m+y)+H]=w[H]}for(m=0;I>m;m+=3){var E=[];E[e]=f[m+e],E[Z]=f[m+Z],E[H]=f[m+H];var b=C(E[e]*E[e]+E[Z]*E[Z]+E[H]*E[H]);0===b&&(b=go),E[e]=E[e]/b,E[Z]=E[Z]/b,E[H]=E[H]/b,f[m+e]=E[e],f[m+Z]=E[Z],f[m+H]=E[H]}return new _p(f)},Ud=function(J,g,B,E){if(B||(B=J.createTexture()),g){var x=J.TEXTURE_2D,M=J.REPEAT,$=J.CLAMP_TO_EDGE,N=J.TEXTURE_MIN_FILTER;E!==J.NEAREST&&(E=J.LINEAR),pc(J,B),J.texImage2D(x,0,J.RGBA,J.RGBA,J.UNSIGNED_BYTE,g),yp(J,J.TEXTURE_MAG_FILTER,E);var w=g.naturalWidth||g.width,o=g.naturalHeight||g.height;Pd(w)&&Pd(o)&&!g.clampToEdge?(yp(J,J.TEXTURE_WRAP_S,M),yp(J,J.TEXTURE_WRAP_T,M),yp(J,N,J.LINEAR_MIPMAP_LINEAR),J.generateMipmap(x)):(yp(J,J.TEXTURE_WRAP_S,$),yp(J,J.TEXTURE_WRAP_T,$),yp(J,N,E)),pc(J,a)}return B},wb=function(f,k){var A=new Uint8Array(4);return k=k||f.createTexture(),pc(f,k),yp(f,f.TEXTURE_MIN_FILTER,f.LINEAR),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,1,1,0,f.RGBA,f.UNSIGNED_BYTE,A),k},vb=function(z){z._26I&&z._prg&&(z._26I.deleteProgram(z._prg),z._prg=a)},Ol=function(n,P,W,C){var w=n.createShader(W);return n.shaderSource(w,C),n.compileShader(w),n.attachShader(P,w),w},Rp=function(f){return f.createBuffer()},pc=function(H,S){H.bindTexture(H.TEXTURE_2D,S)},yp=function(j,H,K){j.texParameteri(j.TEXTURE_2D,H,K)},Wb=function(N,d){N.enable(N.POLYGON_OFFSET_FILL),N.polygonOffset(d[0],d[1])},ci=function(p){p.disable(p.POLYGON_OFFSET_FILL)},Fl=function(w,b){if(b){var b=gi(b);w.clearColor(b[0],b[1],b[2],b[3])}},Dk=function(v,J){mb(v,J.uFix,!0),Ho(v,J.aNormal)},fj=function(L,s){mb(L,s.uFix,!1),Dm(L,s.aNormal)},js=function(N,$,l,R,I,g,A,_){N._picking||(l?(mb(N,$.uBlend,!0),mb(N,$.uBlendColor,l)):mb(N,$.uBlend,!1),mb(N,$.uLight,R==a?!0:R),Sm(I)&&1!==I&&mb(N,$.uPartOpacity,I),mb(N,$.uReverseFlip,g==a?!1:g),mb(N,$.uFixPickReverseColor,A||Np)),_?N.enable(N.CULL_FACE):N.disable(N.CULL_FACE)},Wr=function(Y,P){Y._picking||mb(Y,P.uPartOpacity,1)},ui=function(){var C=[0,0,1,1];return function(w,p,e,S,s,_,T,y,d){return e?(mb(w,p.uTexture,!0),mb(w,p.uDiscardSelectable,Xq(S)?S:!0),Dm(w,p.aUv),vk(w,s,_,p.aUv,2),d?(mb(w,p.uBlendTexture,!0),w.activeTexture(w.TEXTURE1),pc(w,d),w.uniform1i(p.uBlendSampler,1)):(mb(w,p.uBlendTexture,!1),w.activeTexture(w.TEXTURE1),pc(w,w._emptyBlendTexture)),w.activeTexture(w.TEXTURE0),pc(w,e),w.uniform1i(p.uSampler,0),T?(C[0]=T[0],C[1]=T[1]):(C[0]=0,C[1]=0),y?(C[2]=y[0],C[3]=y[1]):(C[2]=1,C[3]=1),mb(w,p.uOffsetScale,C),void 0):(w.activeTexture(w.TEXTURE0),pc(w,w._emptyTexture),w.activeTexture(w.TEXTURE1),pc(w,w._emptyBlendTexture),void 0)}}(),nf=function(M,z,U){M.activeTexture(M.TEXTURE0),pc(M,a),M.activeTexture(M.TEXTURE1),pc(M,a),U&&(Ho(M,z.aUv),mb(M,z.uTexture,!1),mb(M,z.uBlendTexture,!1))},In=function(Y,$,Z,E,d,h){!Z||o||oo||Y.lineWidth(Z),E&&!Y._picking&&mb(Y,$.uFixPickReverseColor,E),d&&vk(Y,d,h,$.aPosition)},cc=function(U,r,W,p){Lp&&(p=U[Lp]),U.drawArrays(p==a?U.TRIANGLES:p,r,W);var t=U._renderInfo;t&&(t.calls++,t.vertices+=W,(p==a||p===U.TRIANGLES)&&(t.faces+=W/3),p===U.LINES&&(t.lines+=W/2))},mh=function(T,h,j,Q){Lp&&(Q=T[Lp]),T.drawElements(Q==a?T.TRIANGLES:Q,j,T.UNSIGNED_SHORT,h==a?0:2*h);var W=T._renderInfo;W&&(W.calls++,W.vertices+=j,(Q==a||Q===T.TRIANGLES)&&(W.faces+=j/3),Q===T.LINES&&(W.lines+=j/2))},nj=function(L,S,V,U,r){var E=L.ARRAY_BUFFER;L.bindBuffer(E,S),V&&L.bufferData(E,V,L.STATIC_DRAW),U!=a&&L.vertexAttribPointer(U,r?r:3,L.FLOAT,!1,0,0)},vk=function(F,D,V,q,h){return V?(Aj(F,F.ARRAY_BUFFER,D,V),q!=a&&F.vertexAttribPointer(q,h?h:3,F.FLOAT,!1,0,0),void 0):nj(F,D,V,q,h)},Qg=function(d,e,s){var l=d.ELEMENT_ARRAY_BUFFER;d.bindBuffer(l,e),s&&d.bufferData(l,s,d.STATIC_DRAW)},Ac=function(r,R,K){Aj(r,r.ELEMENT_ARRAY_BUFFER,R,K)},Aj=function(i,D,f,g){var O=g._bufId;O||(O=g._bufId=S.Math.generateIncreasingID());var f,h=i._bufPool;(f=h[O])&&f._buf?i.bindBuffer(D,f._buf):(f=h[O]={_buf:Rp(i)},i.bindBuffer(D,f._buf),i.bufferData(D,g,i.STATIC_DRAW)),f._fid=i._renderInfo.frame},mb=function(y,R,z){if(z!=a&&R!=a){z=gi(z);var N=z.length;3===N?y.uniform3fv(R,z):4===N?y.uniform4fv(R,z):16===N?y.uniformMatrix4fv(R,!1,z):Xq(z)?y.uniform1i(R,z?1:0):2===N?y.uniform2fv(R,z):y.uniform1f(R,z)}},Dm=function(V,g){g!=a&&g>=0&&V.enableVertexAttribArray(g)},Ho=function(B,r){r!=a&&r>=0&&B.disableVertexAttribArray(r)},Yf=function(D,q){var j=D.getGL(),h=D._prg;D._7O=D._8O.pop(),q&&(mb(j,h.uMVMatrix,D._7O),D._6O=q,mb(j,h.uNMatrix,q))},Fe=function(j,C){return C||(C=Dc()),fq(C,j),Ri(C),Xn(C),C},Oo=function(D,K){var j=D.getGL(),n=D._prg,C=D._7O;K&&(D._8O.push(of(C)),mb(j,n.uMMatrix,K),wc(C,C,K),D._7O=C),mb(j,n.uMVMatrix,C),mb(j,n.uNMatrix,Fe(C,D._6O))},Fc=function(D,G,v,R,A,Z){if(v){if(R){var n=v.value++,U=2147483648|n,O=[(255&U>>16)/255,(255&U>>8)/255,(255&U)/255,(255&U>>24)/255];v[n]={data:A,part:Z}}else O=Qj;return mb(D,G.uFixPickReverseColor,O),O}},gq=function(){var D={center:function(o,G,n,g,H){var X=-G[1]/2,q={x:-G[0]/2,y:X,width:G[0],height:G[1]},w=gc(o,q,n);return[w.x+g,-w.y-H,nm()]},front:function(A,r,V,Y,g){var z=-r[1]/2,e={x:-r[0]/2,y:z,width:r[0],height:r[1]},H=gc(A,e,V);return[H.x+Y,-H.y-g,r[2]/2+nm()]},back:function(v,H,w,G,X){var s=-H[0]/2,S=-H[1]/2,T={x:s,y:S,width:H[0],height:H[1]},n=gc(v,T,w);return[-n.x-G,-n.y-X,-H[2]/2-nm()]},left:function(A,S,h,m,D){var C=-S[1]/2,o={x:-S[2]/2,y:C,width:S[2],height:S[1]},L=gc(A,o,h);return[-S[0]/2-nm(),-L.y-D,L.x+m]},right:function(w,H,K,j,N){var q=-H[2]/2,I=-H[1]/2,r={x:q,y:I,width:H[2],height:H[1]},R=gc(w,r,K);return[H[0]/2+nm(),-R.y-N,-R.x-j]},top:function(u,E,L,X,I){var S={x:-E[0]/2,y:-E[2]/2,width:E[0],height:E[2]},Y=gc(u,S,L);return[Y.x+X,E[1]/2+nm(),Y.y+I]},bottom:function(X,N,I,v,O){var P=-N[2]/2,Z={x:-N[0]/2,y:P,width:N[0],height:N[2]},W=gc(X,Z,I);return[W.x+v,-N[1]/2-nm(),-W.y-O]}};return function(B,G,w,i,l,b){return D[i](B,G,w,l||0,b||0)}}(),Ai=function(q,o,$,r,D,p,H,L,U,x){if(D&&(o[0]+=D[0],o[1]+=D[1],o[2]+=D[2]),Yc(q,$),L){var d=Dc();if(dd(d,U,x),Hf(o,d),Yc(q,o),q.auto=L,q.pos=Hf([0,0,0],q),p){var P=q.mat2=Dc();dd(P,p,H)}}else dd(q,U,x),Yc(q,o),r===ce?ro(q,-K):r===_i?ro(q,K):r===Se?df(q,-K):r===ep?df(q,K):r===No&&ro(q,O),dd(q,p,H);return q},gr=function(B,F){var w=F.auto,U=F.mat2,u=B.gv;if(w){var x,I=Dc(),n=[0,0,0,0];x="string"==typeof w?[w.indexOf("x")<0?u._eye[0]:u._center[0],w.indexOf("y")<0?u._eye[1]:u._center[1],w.indexOf("z")<0?u._eye[2]:u._center[2]]:u._eye,Yh(n,Lk(Dc(),x,u._center,u._up)),Gr(I,up(n,n),F.pos),U&&wc(I,I,U),Oo(u,I)}else Oo(u,F)},Ze=function(d,x,v,w,Z){var i=d.s,I=d.gv,u=I.getGL(),G=I._prg,n=I._buffer,J=I._1O;Ud(u,qi,J),gr(d,v),js(u,G,i(x+".blend"),i(x+".light"),i(x+".opacity"),i(x+".reverse.flip"),i(x+".reverse.color"),i(x+".reverse.cull")),ui(u,G,J,Z,n.uv,lc),vk(u,n.vs,w,G.aPosition),vk(u,n.ns,gb,G.aNormal),Ac(u,n.is,oq),mh(u,0,oq.length),nf(u,G,J),Wr(u,G),Yf(I)},us=function(w,B,C){var f=w.gv,r=w.data,m=w[B]={blend:f.getBodyColor(r)||f.getFaceBlend(r,B),light:f.getFaceLight(r,B),color:f.getFaceColor(r,B),opacity:f.getFaceOpacity(r,B),transparent:f.getFaceTransparent(r,B),reverseFlip:f.getFaceReverseFlip(r,B),reverseColor:f.getFaceReverseColor(r,B),reverseCull:f.getFaceReverseCull(r,B),texture:f.getFaceImage(r,B),blendTexture:f.getFaceBlendImage(r,B),discardSelectable:f.getFaceDiscardSelectable(r,B)};if("csg"!==B){m.uv=f.getFaceUv(r,B)||C&&C[B+"Uv"],m.uvScale=f.getFaceUvScale(r,B)||C&&C[B+"UvScale"],m.uvOffset=f.getFaceUvOffset(r,B)||C&&C[B+"UvOffset"];var l=f.getFaceMat(r,B);l&&(m.mat=Sb(r,l))}return m},Hc=function(f,i,x,I,o){if(I){if(!o(I.transparent))return;var r=f.data,e=f.gv,$=e._buffer,c=e.getTexture(I.texture,r),p=e.getTexture(I.blendTexture,r);ui(i,x,c,I.discardSelectable,$.uv,I.tuv,I.uvOffset,I.uvScale,p),js(i,x,I.blend,I.light,I.opacity,I.reverseFlip,I.reverseColor,I.reverseCull),mb(i,x.uDiffuse,I.color||W["color.empty"]),vk(i,$.vs,I.vs,x.aPosition),vk(i,$.ns,I.ns,x.aNormal),cc(i,0,I.vs.length/3),Wr(i,x),nf(i,x,c)}},Ip=function(i,_,l,K,D,r){var Z,R,k,A,O,y,t,x,o,F,z,L=[K-_,D-l],v=i?i.length:0;for(k=0;v>k;k++){for(A=2,Z=i[k],O=Z[0],y=Z[1];A+1<Z.length;){if(t=Z[A],x=Z[A+1],R=rs(_,l,K,D,O,y,t,x,!0)){o=[t-O,x-y],F=Og(o),o[0]/=F,o[1]/=F,F=sg(L,o),F=F>0?r:-r,z=[o[0]*F,o[1]*F];break}O=t,y=x,A+=2}if(z)break}if(z)for(K=_+z[0],D=l+z[1],k=0;v>k;k++)for(A=2,Z=i[k],O=Z[0],y=Z[1];A+1<Z.length;){if(t=Z[A],x=Z[A+1],R=rs(_,l,K,D,O,y,t,x,!0))return[0,0];O=t,y=x,A+=2}return z?z:[K-_,D-l]},Qh=S.graph3d={},Db=function(h,n,K){ri(D+".graph3d."+h,n,K)},Mo="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<**1/2!-opjujtpQb)5dfw!+!yjsubNNv)4dfw!>!emspXw<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<emspXw!4dfw!hojzsbw<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNNv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",se="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!~<zujwjudfmgfSv!+!{zy/spmpDwof!>,!chs/eJ<*!spmpDwof!)sbfojMpUmfyfUqbNwof!>!spmpDwof<*!*!{z/dfWudfmgfs!-y/dfWudfmgfs)4dfw!-qbNwoFv!)fcvDfsvuyfu!>!spmpDwof!5dfw<*!mbnspOemspx!-yfusfWpUbsfnbd!)udfmgfs!>!dfWudfmgfs!4dfw<*!yjsubNxfjWv!-O!)opjudfsjEnspgtobsUftsfwoj!>!mbnspOemspx!4dfw<*!opjujtpQbsfnbDv!.!emspXw!)f{jmbnspo!>!yfusfWpUbsfnbd!4dfw|*qbNwoFftVv)!gj!QBNWOF`FTV!gfegj$!!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~~<esbdtje|*1/1!>>!x/eJ)gj!gjeof$!<ftvggjEv!>!eJ!ftmf$!~<ftvggjEv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw~<*!{zy/*!yjsubn!+!*!1/1!-sje!)5dfw!)!)f{jmbnspo!osvufs|!*!yjsubn!5ubn!oj!-sje!4dfw!oj!)opjudfsjEnspgtobsUftsfwoj!4dfw~!<*!*!SPUDBG`BNNBH!)ubpmg!-fvmbw!)sbfojMpUbnnbH!osvufs!|!*!fvmbw!5dfw!)sbfojMpUmfyfUqbNwof!5dfw~<*!x/fvmbw!-*!*!spudbGbnnbh!)4dfw!-{zy/fvmbw!)xpq!)5dfw!osvufs|!*!spudbGbnnbh!ubpmg!oj!-fvmbw!5dfw!oj!)sbfojMpUbnnbH!5dfw<1/3!>!SPUDBG`BNNBH!ubpmg!utopd!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<emspXw!4dfw!hojzsbw<opjujtpQbsfnbDv!4dfw!nspgjov<yjsubNxfjWv!5ubn!nspgjov!gjeof$!<zujwjudfmgfSv!ubpmg!nspgjov<qbNwoFv!fcvDsfmqnbt!nspgjov<qbNwoFftVv!mppc!nspgjov!QBNWOF`FTV!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Gh(x,{setBatchInfo:function(n,Y){Dp[n]=Y},getBatchInfo:function(d){return Dp[d]}},!0);var Or=[1,1,1],sh=[1,0,0,0,0,1,0,1,1,1,1,0],_c=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],Lq=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],En=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],ag=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],cl=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],bs=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],tq=function(B,i){Od(B,i,"_batchModelMap","_batchIndexMap"),om(B,i,"_wireframeModelMap","_wireframeIndexMap"),om(B,i,"_polylineModelMap","_polylineIndexMap"),om(B,i,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),om(B,i,"_polylineModelMapSwap","_polylineIndexMapSwap")},Od=function(A,m,g,q){if(!m)return A[g]={},A[q]={},void 0;var s=m._id,x=A[q],V=x[s];if(V){var j=A[g],P=V.batch,$=j[P],D=$.ds,N=V.index;if($.invalidate=!0,delete x[s],D.splice(N,1),Qp(D))return delete j[P],void 0;for(var B=V.begin,R=V.size,M=3*B,e=3*R,O=4*B,Z=4*R,I=$.vs,k=$.ps,H=$.uv,f=$.cs,F=$.bs,E=$.rs,L=$.ns,n=$.ls;N<D.length;N++)V=x[D[N]._id],V.index--,V.begin-=R;I.splice(M,e),k.splice(O,Z),H&&H.splice(2*B,2*R),f&&f.splice(O,Z),F&&F.splice(M,e),E&&E.splice(B,R),L&&L.splice(M,e),n&&n.splice(B,R)}},om=Od,Ue=function(G,$,H,C){if(!C)return a;var Z=$[C];if(!Z){var k=Dp[C]||xh,h=k.image?[]:a;Z=$[C]={vs:[],ns:[],uv:h,cs:h?a:k.color?a:[],bs:k.blend?[]:a,ps:[],rs:k.brightness?[]:a,ds:[]}}return Z.invalidate=!0,G[H._id]={index:Z.ds.length,begin:Z.vs.length/3,batch:C},Z.ds.push(H),Z},Gf=function($,e){return e!=a&&1!==e?[$[0]*e,$[1]*e,$[2]*e,$[3]]:$},Go=function(Y,w,M){var c=Y.getBrightness(w),K=gi(M.color||"white"),$=K[3]<1,l=Math.ceil(M.width)||1,r=($?"T":"O")+l,j=Y._wireframeIndexMap,D=Y._wireframeModelMap,q=D[r];q||(q=D[r]={vs:[],cs:[],ps:[],ds:[],T:$,W:l});var a,o=Y.getData3dUI(w),N=tl(o);if(M.geometry){if(!N)return;if(a=Bi(N),!a)return}else a=M.short?ke:kl;q.invalidate=!0;var t=q.vs,n=q.cs,f=q.ds,Z=j[w._id]={index:f.length,begin:t.length/3,batch:r};f.push(w);var y=Sb(w,M.mat),C=o._calcAnchorMat(w);C&&wc(y,y,C),Rm(t,y,a);var T=Z.size=t.length/3-Z.begin;Gg(n,Gf(K,c),T)},rf=function(M,V,K,A,b,u,W,Y,Z){var p=M.getBrightness(V);p==a&&(p=1);var E=Gf(gi(A),p),L=E[3]<1;u=Math.ceil(u)||1;var i=(L?"T":"O")+u;if(W){var h=W[0],N=(W[1]||h)+h;i+="-"+h+"-"+N,Z&&(i+="-"+Yl(Z)+"-"+p,Z=Gf(gi(Z),p))}var F=M._polylineIndexMap,T=M._polylineModelMap,P=T[i];P||(P=T[i]={vs:[],cs:[],ps:[],ds:[],ls:W?[]:a,T:L,W:u},W&&(P.D=h,P.G=N,P.A=Z)),P.invalidate=!0;var y,l=P.vs,Q=P.cs,R=P.ds,J=P.ls,d=F[V._id]={index:R.length,begin:l.length/3,batch:i};R.push(V),On(l,K);var m,x=d.size=l.length/3-d.begin,S=K.length,X=0,k=[];if(W||b)for(y=0;S>y;y+=6)m=Og([K[y],K[y+1],K[y+2]],[K[y+3],K[y+4],K[y+5]]),k.push(m),X+=m;if(X&&b){var H,q=Gf(gi(b),p),z=[q[0]-E[0],q[1]-E[1],q[2]-E[2],q[3]-E[3]],w=0;for(y=0;S>y;y+=6)H=w/X,Gg(Q,[E[0]+z[0]*H,E[1]+z[1]*H,E[2]+z[2]*H,E[3]+z[3]*H],1),w+=k[y/6],H=w/X,Gg(Q,[E[0]+z[0]*H,E[1]+z[1]*H,E[2]+z[2]*H,E[3]+z[3]*H],1)}else Gg(Q,E,x);if(W)for(w=Y||0,y=0;S>y;y+=6)J.push(w),w+=k[y/6],J.push(w)},$g=function(R,c,O){if(c)for(var N=4*c.begin,C=O[c.batch].ps,g=0;g<c.size;g++)C[N++]=R[0],C[N++]=R[1],C[N++]=R[2],C[N++]=R[3]},vo=function(b,U){var v=U+["32"],Q=b[U],P=b[v];Q?P&&P.length===Q.length?(P.set(Q),P._bufId=null):b[v]=new _p(Q):delete b[v]},ip=function(g,A,D,X,m,N,L,v,s){if(mr(D))D.forEach(function(p){ip(g,A,p,X,m,N,L,v,s)});else if(Tp(D))ip(g,A,tl(X,D),X,m,N,L,v,s);else if($p(D)){var O,k=Cs(D.mat,A,g),l=Cs(D.s3,A,g),i=Cs(D.t3,A,g),h=Cs(D.r3,A,g);if((l||h||i||k)&&(O=cb(k,l,h,Cs(D.rotationMode,A,g),i),N.push(O)),D.shape3d)ip(g,A,D.shape3d,X,m,N,L,v,D);else{var $=X.s;s=s||xh;var H=N[0],G=N.length,Q=$("shape3d.color",D.color,s.color);if(m||(m=$("shape3d.blend",D.blend,s.blend)),G>1){H=of(H);for(var e=1;G>e;e++)wc(H,H,N[e])}D.vs&&$(ff,D.visible,s.visible)&&ac(H,L,v,D.vs,D.uv,D.is,m,Q),D.top_vs&&$(cq,D.topVisible,s.topVisible)&&ac(H,L,v,D.top_vs,D.top_uv,D.top_is,m,$("shape3d.top.color",D.topColor,s.topColor)||Q),D.bottom_vs&&$(Cj,D.bottomVisible,s.bottomVisible)&&ac(H,L,v,D.bottom_vs,D.bottom_uv,D.bottom_is,m,$("shape3d.bottom.color",D.bottomColor,s.bottomColor)||Q),D.from_vs&&$(Al,D.fromVisible,s.fromVisible)&&ac(H,L,v,D.from_vs,D.from_uv,D.from_is,m,$("shape3d.from.color",D.fromColor,s.fromColor)||Q),D.to_vs&&$(Xc,D.toVisible,s.toVisible)&&ac(H,L,v,D.to_vs,D.to_uv,D.to_is,m,$("shape3d.to.color",D.toColor,s.toColor)||Q)
}O&&N.pop()}},ac=function(n,y,u,_,p,B,M,J){var G,k=y.cs,h=y.uv,v=y.bs;if(B){G=B.length;for(var D=0;G>D;D++){var C=B[D];Rm(u,n,[_[3*C],_[3*C+1],_[3*C+2]]),h&&On(h,[p[2*C],p[2*C+1]])}}else G=_.length/3,Rm(u,n,_),h&&On(h,p);k&&Gg(k,J,G),v&&(M?Ch(v,M,G):On(v,Or,G))},jr=function(I,e,o,E){var C=[];E?ip(I.gv,I.data,E,I,I.getBodyColor(),[e],o,C):(cm(I,ce,e,o,C),cm(I,_i,e,o,C),cm(I,Ie,e,o,C),cm(I,No,e,o,C),cm(I,Se,e,o,C),cm(I,ep,e,o,C),cm(I,"csg",e,o,C)),C.length&&(On(o.vs,C),On(o.ns,Pc(C)))},cm=function(Q,x,f,N,A){var p=Q[x];if(p){var R=p.tuv;if(R){var o,n,$,d,w=p.uvScale,V=p.uvOffset;if(w)for(o=R.length,n=w[0],$=w[1],d=0;o>d;d+=2)R[d]*=n,R[d+1]*=$;if(V)for(o=R.length,n=V[0],$=V[1],d=0;o>d;d+=2)R[d]+=n,R[d+1]+=$}ac(f,N,A,p.vs,R,a,p.blend,p.color)}},Dl=function(l,f,I,v,p,a,N,M){var r,w=I.cs,h=I.uv,A=I.bs;if(l.getFaceVisible(f,a)){var e=l.getFaceMat(f,a);if(e&&(p=Sb(f,e)),Rm(N,p,M),w&&Gg(w,l.getFaceColor(f,a),6),h){var H=l.getFaceUv(f,a)||v[a+"Uv"],U=l.getFaceUvScale(f,a)||v[a+"UvScale"],L=l.getFaceUvOffset(f,a)||v[a+"UvOffset"];H=H?[H[6],H[7],H[0],H[1],H[2],H[3],H[2],H[3],H[4],H[5],H[6],H[7]]:sh;var X=H[0],E=H[1],i=H[2],G=H[3],o=H[4],J=H[5],s=H[6],m=H[7],j=H[8],x=H[9],C=H[10],$=H[11];if(U){var Q=U[0],D=U[1];X*=Q,E*=D,i*=Q,G*=D,o*=Q,J*=D,s*=Q,m*=D,j*=Q,x*=D,C*=Q,$*=D}if(L){var F=L[0],c=L[1];X+=F,E+=c,i+=F,G+=c,o+=F,J+=c,s+=F,m+=c,j+=F,x+=c,C+=F,$+=c}h.push(X,E,i,G,o,J,s,m,j,x,C,$)}A&&(r=l.getBodyColor(f)||l.getFaceBlend(f,a),r?Ch(A,r,6):On(A,Or,6))}},Fm=function(d,b,$,R){var E=d.getGL(),Y=d._prg,p=d._buffer;if(!d.drawFilter&&!je(b)){Oo(d),Dk(E,Y);for(var c in b){var S=b[c];if(!(R&&!S.T||!R&&S.T)){S.invalidate?(S.invalidate=!1,vo(S,"vs"),vo(S,"cs"),vo(S,"ls"),vo(S,"ps")):$&&vo(S,"ps");var X=S.vs32,h=$?S.ps32:S.cs32;In(E,Y,S.W,a,p.vs,X);var J=S.D,G=!d._dashDisabled&&J;mb(E,Y.uAlphaTest,W.alphaTest),G&&(mb(E,Y.uDash,!0),mb(E,Y.uDashDistance,J),mb(E,Y.uDashGapDistance,S.G),Dm(E,Y.aLineDistance),vk(E,p.lineDistance,S.ls32,Y.aLineDistance,1),mb(E,Y.uDiffuse,S.A||W["color.empty"]));var j=!d._batchColorDisabled;j&&(mb(E,Y.uBatchColor,!0),Dm(E,Y.aBatchColor),vk(E,p.batchColor,h,Y.aBatchColor,4)),ui(E),cc(E,0,X.length/3,E.LINES),nf(E),j&&(mb(E,Y.uBatchColor,!1),Ho(E,Y.aBatchColor)),G&&(mb(E,Y.uDash,!1),Ho(E,Y.aLineDistance))}}fj(E,Y)}},mo=function(R,I,y){var J,t,F,s,v,d,T,O,m,Q,k,Y=R.getGL(),A=R._prg,M=R._buffer,e=R._batchModelMap;if(!je(e)){Oo(R);for(J in e)if(t=Dp[J]||xh,!(y&&!t.transparent||!y&&t.transparent)&&(F=e[J],I||!t.transparentMask)){var C=y&&t.autoSort!==!1&&(R._33Q||F.invalidate);if(F.invalidate?(F.invalidate=!1,vo(F,"vs"),vo(F,"ns"),vo(F,"cs"),vo(F,"rs"),vo(F,"ps"),vo(F,"bs"),vo(F,"uv")):I&&vo(F,"ps"),v=F.vs32,d=I?F.ps32:F.cs32,m=F.uv32,T=F.bs32,O=F.rs32,k=v.length/3,C&&(F.is=po(v,R.getEye())),k){s=t.light,Q=R.getTexture(t.image),js(Y,A,a,t.light,t.opacity,t.reverseFlip,t.reverseColor,t.reverseCull),d?R._batchColorDisabled||(mb(Y,A.uBatchColor,!0),Dm(Y,A.aBatchColor),vk(Y,M.batchColor,d,A.aBatchColor,4)):mb(Y,A.uDiffuse,t.color||W["color.empty"]);var H=t.alphaTest;mb(Y,A.uAlphaTest,H===i?W.alphaTest:H);var j=T&&!R._batchBlendDisabled;j&&(mb(Y,A.uBatchBlend,!0),Dm(Y,A.aBatchBlend),vk(Y,M.batchBlend,T,A.aBatchBlend));var E=O&&!R._batchBrightnessDisabled;E&&(mb(Y,A.uBatchBrightness,!0),Dm(Y,A.aBatchBrightness),vk(Y,M.batchBrightness,O,A.aBatchBrightness,1)),m?ui(Y,A,Q,t.discardSelectable,M.uv,m,t.uvOffset,t.uvScale):ui(Y),vk(Y,M.vs,v,A.aPosition),vk(Y,M.ns,F.ns32,A.aNormal),F.is?(Qg(Y,M.is,F.is),mh(Y,0,k)):cc(Y,0,k),m?nf(Y,A,Q):nf(Y),d&&!R._batchColorDisabled&&(mb(Y,A.uBatchColor,!1),Ho(Y,A.aBatchColor)),j&&(mb(Y,A.uBatchBlend,!1),Ho(Y,A.aBatchBlend)),E&&(mb(Y,A.uBatchBrightness,!1),Ho(Y,A.aBatchBrightness)),Wr(Y,A)}}}},po=function(M,g){for(var f=M.length/3,U=new Array(f),_=f/3,G=new Array(_),E=0;_>E;E++)G[E]=E;G.sort(function(w,L){var s=9*w,R=[(M[s]+M[s+3]+2*M[s+6])/4,(M[s+1]+M[s+4]+2*M[s+7])/4,(M[s+2]+M[s+5]+2*M[s+8])/4];s=9*L;var A=[(M[s]+M[s+3]+2*M[s+6])/4,(M[s+1]+M[s+4]+2*M[s+7])/4,(M[s+2]+M[s+5]+2*M[s+8])/4],J=Og(g,R)-Og(g,A);return J>0?-1:0>J?1:0});for(var E=0;_>E;E++){var s=3*E,S=3*G[E];U[s]=S,U[s+1]=S+1,U[s+2]=S+2}return new Yo(U)},Ei={obj:function(q,V){var Q={mat:q.mat,s3:q.s3,r3:q.r3,rotationMode:q.rotationMode,t3:q.t3,cube:q.cube==a?!0:q.cube,center:q.center==a?!0:q.center,ignoreMtls:q.ignoreMtls,ignoreTransparent:q.ignoreTransparent,ignoreColor:q.ignoreColor,ignoreImage:q.ignoreImage,ignoreNormal:q.ignoreNormal,prefix:q.prefix,flipY:q.flipY,flipFace:q.flipFace,reverseFlipMtls:q.reverseFlipMtls,finishFunc:function(g,n){if(g){var n=[];for(var W in g){var P=g[W];n.rawS3=P.rawS3,n.push(P),q.eachModel&&q.eachModel(W,P)}n.json=q,V(n)}else V()}};x.loadObj(q.obj,q.mtl,Q)}};x.getModelTypeHandlers=function(){return Ei},x.setModelTypeHandler=function(X,O){Ei[X]=O},x.getModelTypeHandler=function(N){return Ei[N]},x.handleModelLoaded=function(){},x.handleUnfoundModel=function(){};var Xl=a,Hn=a,Ur=function(m){Xl&&!m._loadingModelView_&&(Hn||(Hn={}),Hn[m._loadingModelView_=Vd()]=m)},He=function(P,r){Xl||(Xl={});var n=Xl[P];if(n){if(n.url===r)return;n.request.onload=ns,n.request.onerror=ns}var W=new wm;if(Xl[P]={request:W,url:r},r=x.beforeLoadURL(r),r.data){var q=x.parse(r.data);al(P,q,r)}else{W.onload=function(J){if(200===this.status||0===this.status){delete Xl[P];var i=x.parse(J.target.response||J.target.responseText);al(P,i,r)}else xs(P,x.handleUnfoundModel(P,r)||a)},W.onerror=function(){xs(P,x.handleUnfoundModel(P,r)||a)};var w={};w.url=encodeURI(r),w.sync=!1,W.send(w)}},al=function(e,H,Q){var V=H.modelType;if(!V)return xs(e,H),x.handleModelLoaded(e,H),void 0;var I=x.getModelTypeHandler(V);if(I){if(Xl||(Xl={}),Xl[e])return;Xl[e]=!0;var C=function(V){V?(xs(e,V),x.handleModelLoaded(e,V)):xs(e,x.handleUnfoundModel(e,Q)||a)};I(H,C)}else xs(e,x.handleUnfoundModel(e,Q)||a)},xs=function(Z,H){if(Zj[Z]=H,delete Xl[Z],je(Xl)&&(Xl=a,Hn)){for(var L in Hn){var B=Hn[L];B.invalidateAll&&B.invalidateAll(i,"modelLoaded",Z),B.redraw&&B.redraw(),B.iv(),delete B._loadingModelView_}Hn=a}if(H&&Hn)for(var L in Hn){var B=Hn[L];B.invalidateAll&&B.invalidateAll(i,"modelLoading",Z),B.redraw&&B.redraw(),B.iv()}},lc=new _p([0,0,0,1,1,1,1,0]),gb=new _p([0,0,1,0,0,1,0,0,1,0,0,1]),oq=new Yo([0,1,2,2,3,0]),Dd=new _p([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),Ll=new Yo([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),Ak=new _p([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),tk=Pc(Dd,Ll),ab=(new _p([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new Yo([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[ce,Ie,_i,No,Se,ep]),kl=[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5],ke=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],_k=function(N,F,B,I,a,R){R=R||16,N=N||16,F=F||0,B=B||N;var A,x,n,m,o,V,g,p,S=.5,J=[],r=[],k=$/N,Q=O/R;for(A=0;R>A;A++)for(o=A+1,m=A*Q,p=o*Q,x=F;B>x;x++)V=x+1,n=x*k,g=V*k,J.push(S*M(m)*b(n),S*b(m),-S*M(m)*M(n),S*M(p)*b(g),S*b(p),-S*M(p)*M(g),S*M(m)*b(g),S*b(m),-S*M(m)*M(g),S*M(m)*b(n),S*b(m),-S*M(m)*M(n),S*M(p)*b(n),S*b(p),-S*M(p)*M(n),S*M(p)*b(g),S*b(p),-S*M(p)*M(g)),r.push(x/N,A/R,V/N,o/R,V/N,A/R,x/N,A/R,x/N,o/R,V/N,o/R);if(I){var P=[],t=[];for(n=F*k,A=0;R>A;A++)o=A+1,m=A*Q,p=o*Q,P.push(0,0,0,S*M(p)*b(n),S*b(p),-S*M(p)*M(n),S*M(m)*b(n),S*b(m),-S*M(m)*M(n)),t.push(0,.5,F/N,o/R,F/N,A/R)}if(a){var v=[],E=[];for(n=B*k,A=0;R>A;A++)o=A+1,m=A*Q,p=o*Q,v.push(0,0,0,S*M(m)*b(n),S*b(m),-S*M(m)*M(n),S*M(p)*b(n),S*b(p),-S*M(p)*M(n)),E.push(1,.5,B/N,A/R,B/N,o/R)}return{vs:J,uv:r,from_vs:P,from_uv:t,to_vs:v,to_uv:E}},ps=function(U,V,o){U=U||.17,V=V||12,o=o||18,0>U?U=0:U>.25&&(U=.25);var s,i,y,R,x,T,H,S=.5,m=[],J=[],C=[],z=$/o,P=$/V,j=S-U;for(i=0;V>=i;i++)for(R=-O+i*P,T=b(R),x=M(R),s=0;o>=s;s++)y=s*z,H=j+U*T,m.push(b(y)*H,x*U,-M(y)*H),J.push(s/o,1-i/V);for(i=0;V>i;i++){var k=i*(o+1),I=(i+1)*(o+1);for(s=0;o>s;s++)C.push(k+s,I+s+1,I+s,k+s,k+s+1,I+s+1)}return{vs:m,uv:J,is:C}},vr=function(g,s,H,k,f,Q,h){h=h||12,g=g||18,s=s||0,H=H||g,Q=Q||.17,0>Q?Q=0:Q>.25&&(Q=.25);var B,l,v,P,q,E,Y,n,t,S,z=.5,F=[],G=[],W=$/g,d=$/h,T=z-Q;for(v=0;h>v;v++)for(P=v+1,Y=-O+v*d,n=-O+P*d,B=s;H>B;B++)l=B+1,q=B*W,E=l*W,t=T+Q*b(Y),S=T+Q*b(n),F.push(b(q)*t,M(Y)*Q,-M(q)*t,b(E)*t,M(Y)*Q,-M(E)*t,b(E)*S,M(n)*Q,-M(E)*S,b(q)*t,M(Y)*Q,-M(q)*t,b(E)*S,M(n)*Q,-M(E)*S,b(q)*S,M(n)*Q,-M(q)*S),G.push(B/g,1-v/h,l/g,1-v/h,l/g,1-P/h,B/g,1-v/h,l/g,1-P/h,B/g,1-P/h);if(k){var D=[],m=[];for(v=0;h>v;v++)P=v+1,Y=-O+v*d,n=-O+P*d,q=s*W,t=T+Q*b(Y),S=T+Q*b(n),D.push(b(q)*t,M(Y)*Q,-M(q)*t,b(q)*S,M(n)*Q,-M(q)*S,b(q)*T,0,-M(q)*T),m.push(.5+.5*b(Y),.5-.5*M(Y),.5+.5*b(n),.5-.5*M(n),.5,.5)}if(f){var o=[],L=[];for(v=0;h>v;v++)P=v+1,Y=-O+v*d,n=-O+P*d,q=H*W,t=T+Q*b(Y),S=T+Q*b(n),o.push(b(q)*t,M(Y)*Q,-M(q)*t,b(q)*T,0,-M(q)*T,b(q)*S,M(n)*Q,-M(q)*S),L.push(.5-.5*b(Y),.5-.5*M(Y),.5,.5,.5-.5*b(n),.5-.5*M(n))}return{vs:F,uv:G,from_vs:D,from_uv:m,to_vs:o,to_uv:L}},Nb=function(A,v){for(var G,C,B,Z=.5,f=16,y=[],z=[],w=[],K=$/f,q=0;f>=q;q++)G=q*K,C=b(G)*Z,B=M(G)*Z,y.push(C,-Z,B,C,Z,B),z.push(1-q/f,1,1-q/f,0);for(q=0;f>q;q++)w.push(2*q,2*q+1,2*q+3,2*q,2*q+3,2*q+2);if(v){var d=[],N=[],l=[];for(d.push(0,-Z,0),N.push(.5,.5),q=0;f>=q;q++)G=q*K,C=b(G),B=M(G),d.push(C*Z,-Z,-B*Z),N.push(.5+.5*C,.5+.5*B);for(q=0;f>q;q++)l.push(0,q+2,q+1)}if(A){var W=[],H=[],U=[];for(W.push(0,Z,0),H.push(.5,.5),q=0;f>=q;q++)G=q*K,C=b(G),B=M(G),W.push(C*Z,Z,-B*Z),H.push(.5+.5*C,.5-.5*B);for(q=0;f>q;q++)U.push(0,q+1,q+2)}return{vs:y,uv:z,is:w,bottom_vs:d,bottom_uv:N,bottom_is:l,top_vs:W,top_uv:H,top_is:U}},Ab=function(K,f,Y,o,E,S,N){K=K||12,f=f||0,Y=Y||K;for(var s,e,d,A,v,t,c,Q,G=.5,O=[],l=[],k=$/K,F=f;Y>F;F++)s=F+1,e=F*k,d=s*k,A=b(e)*G,v=M(e)*G,t=b(d)*G,c=M(d)*G,O.push(A,-G,-v,t,-G,-c,A,G,-v,t,-G,-c,t,G,-c,A,G,-v),l.push(F/K,1,s/K,1,F/K,0,s/K,1,s/K,0,F/K,0);if(N){var P=[],x=[];for(F=f;Y>F;F++)e=k*F,d=k*(F+1),A=b(e),v=M(e),t=b(d),c=M(d),P.push(A*G,-G,-v*G,0,-G,0,t*G,-G,-c*G),x.push(.5+.5*A,.5+.5*v,.5,.5,.5+.5*t,.5+.5*c)}if(S){var g=[],w=[];for(F=f;Y>F;F++)e=k*F,d=k*(F+1),A=b(e),v=M(e),t=b(d),c=M(d),g.push(A*G,G,-v*G,t*G,G,-c*G,0,G,0),w.push(.5+.5*A,.5-.5*v,.5+.5*t,.5-.5*c,.5,.5)}if(o){var L=[],m=[];e=k*f,A=b(e)*G,v=M(e)*G,Q=f/K,L.push(0,G,0,0,-G,0,A,-G,-v,A,-G,-v,A,G,-v,0,G,0),m.push(0,0,0,1,Q,1,Q,1,Q,0,0,0)}if(E){var T=[],V=[];e=k*Y,A=b(e)*G,v=M(e)*G,Q=Y/K,T.push(0,-G,0,0,G,0,A,G,-v,A,G,-v,A,-G,-v,0,-G,0),V.push(1,1,1,0,Q,0,Q,0,Q,1,1,1)}return{vs:O,uv:l,bottom_vs:P,bottom_uv:x,top_vs:g,top_uv:w,from_vs:L,from_uv:m,to_vs:T,to_uv:V}},zq=function(T,S,r,s,e){S=S||18,r=r||0,s=s==a?$:s,e=e==a?.5:e;for(var v,Q,J,o,K,w,Z=[0,.5,.75,.875,.9375],n=[],N=[],W=[],m=s/S,D=0;D<Z.length;D++){var k=0===D%2?0:.5;for(v=0;S>=v;v++)Q=(v+k)*m+r,J=1-Z[D],n.push(b(Q)*e*J,-e+2*Z[D]*e,-M(Q)*e*J),N.push((v+k)/S,J)}for(D=0;D<Z.length-1;D++){var B=D*(S+1),i=(D+1)*(S+1);for(v=0;S>v;v++)W.push(B+v,i+v+1,i+v,B+v,B+v+1,i+v+1)}for(w=n.length/3-(S+1),v=0;S>v;v++)n.push(0,e,0),N.push((v+.5)/S,0);for(v=0;S>v;v++)W.push(w+v,w+v+1,w+(S+1)+v);if(T){var f=[],O=[],Y=[];for(f.push(0,-e,0),O.push(.5,.5),v=0;S>=v;v++)Q=v*m+r,o=b(Q),K=M(Q),f.push(o*e,-e,-K*e),O.push(.5+.5*o,.5+.5*K);for(v=0;S>v;v++)Y.push(0,v+2,v+1)}return{vs:n,uv:N,is:W,bottom_vs:f,bottom_uv:O,bottom_is:Y}},Vc=function(T,L,Q,o,z,Z){T=T||16,L=L||0,Q=Q||T;for(var l=.5,P=[],m=[],j=$/T,J=L;Q>J;J++){var s=J+1,C=j*J,X=j*s;P.push(b(C)*l,-l,-M(C)*l,b(X)*l,-l,-M(X)*l,0,l,0),m.push(J/T,1,s/T,1,(J+s)/2/T,0)}if(Z){var Y=[],U=[];for(J=L;Q>J;J++){C=j*J,X=j*(J+1);var r=b(C),S=M(C),w=b(X),N=M(X);Y.push(r*l,-l,-S*l,0,-l,0,w*l,-l,-N*l),U.push(.5+.5*r,.5+.5*S,.5,.5,.5+.5*w,.5+.5*N)}}if(o){var W=[],y=[];C=j*L,W.push(0,l,0,0,-l,0,b(C)*l,-l,-M(C)*l),y.push(0,0,0,1,L/T,1)}if(z){var v=[],t=[];C=j*Q,v.push(0,-l,0,0,l,0,b(C)*l,-l,-M(C)*l),t.push(1,1,1,0,Q/T,1)}return{vs:P,uv:m,bottom_vs:Y,bottom_uv:U,from_vs:W,from_uv:y,to_vs:v,to_uv:t}},Sc=function(N,d,V,K,o,X,k,_){for(var r=[],y=0;y<N.length-1;y+=2)r.push({x:N[y],y:N[y+1]});return Dr(r,d,V,K,o,X,k,_,!1)},nl={roundRect:function(W,C){return Sc([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],W,C,3)},star:function(Q,w){return Sc([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],Q,w)},rect:function(L,g){return Sc([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],L,g)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(Y,H){return Sc([0,-.5,.5,.5,-.5,.5],[1,2,2,5],Y,H)},rightTriangle:function(x,Z){return Sc([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],x,Z)},parallelogram:function(y,k){return Sc([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],y,k)},trapezoid:function(y,a){return Sc([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],y,a)}},Ih={sphere:1,cylinder:1,cone:1,torus:1},ls={torus:1,sphere:1},Qi=Gh(Hj(nl),{cylinder:1}),jd=Gh(Hj(nl),{cylinder:1,cone:1}),Wk=function(h,s,d){var A,v=Cs(h.anchor3d,d,s),r=Cs(h.mat,d,s),w=Cs(h.s3,d,s),L=Cs(h.t3,d,s),b=Cs(h.r3,d,s),l=w||b||L||r;if(v||l){A=of(s._6O);var R=l?cb(r,w,b,Cs(h.rotationMode,d,s),L):Dc();v&&Yc(R,[.5-v[0],.5-v[1],.5-v[2]]),Oo(s,R)}return A},Ej=function(k,W,u,n,N,A,f){if(mr(u))u.forEach(function(b){Ej(k,W,b,n,N,A,f)});else if(Tp(u))Ej(k,W,tl(n,u),n,N,A,f);else if($p(u))if(u.shape3d){var z=Wk(u,k,W);Ej(k,W,u.shape3d,n,N,A,u),z&&Yf(k,z)}else zc(k,W,u,n.s,N,A,f)},zc=function(O,Y,W,G,H,$,D){if(D=D||xh,!$||$(G("shape3d.transparent",W.transparent,D.transparent))){var w=Wk(W,O,Y);bj(W);var x=O._26I,p=O._prg,T=O._buffer,X=G("shape3d.color",W.color,D.color);H||(H=G("shape3d.blend",W.blend,D.blend));var Q,R=W.opacity==a?D.opacity:W.opacity,f=G("shape3d.opacity");Q=f!=a&&R!=a?R*f:R!=a?R:f,js(x,p,H,G("shape3d.light",W.light,D.light),Q,G("shape3d.reverse.flip",W.reverseFlip,D.reverseFlip),G("shape3d.reverse.color",W.reverseColor,D.reverseColor),G("shape3d.reverse.cull",W.reverseCull,D.reverseCull));var N=G("polygonOffset",W.polygonOffset,D.polygonOffset);W.vs&&G(ff,W.visible,D.visible)&&fi(x,p,T,X,O.getTexture(G("shape3d.image",W.image,D.image),Y),G("shape3d.discard.selectable",W.discardSelectable,D.discardSelectable),W.vs,W.uv,W.ns,W.is,G("shape3d.uv.offset",W.uvOffset,D.uvOffset),G("shape3d.uv.scale",W.uvScale,D.uvScale),N),W.top_vs&&G(cq,W.topVisible,D.topVisible)&&fi(x,p,T,G("shape3d.top.color",W.topColor,D.topColor)||X,O.getTexture(G("shape3d.top.image",W.topImage,D.topImage),Y),G("shape3d.top.discard.selectable",W.topDiscardSelectable,D.topDiscardSelectable),W.top_vs,W.top_uv,W.top_ns,W.top_is,G("shape3d.top.uv.offset",W.topUvOffset,D.topUvOffset),G("shape3d.top.uv.scale",W.topUvScale,D.topUvScale),N),W.bottom_vs&&G(Cj,W.bottomVisible,D.bottomVisible)&&fi(x,p,T,G("shape3d.bottom.color",W.bottomColor,D.bottomColor)||X,O.getTexture(G("shape3d.bottom.image",W.bottomImage,D.bottomImage),Y),G("shape3d.bottom.discard.selectable",W.bottomDiscardSelectable,D.bottomDiscardSelectable),W.bottom_vs,W.bottom_uv,W.bottom_ns,W.bottom_is,G("shape3d.bottom.uv.offset",W.bottomUvOffset,D.bottomUvOffset),G("shape3d.bottom.uv.scale",W.bottomUvScale,D.bottomUvScale),N),W.from_vs&&G(Al,W.fromVisible,D.fromVisible)&&fi(x,p,T,G("shape3d.from.color",W.fromColor,D.fromColor)||X,O.getTexture(G("shape3d.from.image",W.fromImage,D.fromImage),Y),G("shape3d.from.discard.selectable",W.fromDiscardSelectable,D.fromDiscardSelectable),W.from_vs,W.from_uv,W.from_ns,W.from_is,G("shape3d.from.uv.offset",W.fromUvOffset,D.fromUvOffset),G("shape3d.from.uv.scale",W.fromUvScale,D.fromUvScale),N),W.to_vs&&G(Xc,W.toVisible,D.toVisible)&&fi(x,p,T,G("shape3d.to.color",W.toColor,D.toColor)||X,O.getTexture(G("shape3d.to.image",W.toImage,D.toImage),Y),G("shape3d.to.discard.selectable",W.toDiscardSelectable,D.toDiscardSelectable),W.to_vs,W.to_uv,W.to_ns,W.to_is,G("shape3d.to.uv.offset",W.toUvOffset,D.toUvOffset),G("shape3d.to.uv.scale",W.toUvScale,D.toUvScale),N),Wr(x,p),w&&Yf(O,w)}},fi=function(S,C,e,d,r,m,J,z,s,E,N,k,A){J&&(A&&Wb(S,A),mb(S,C.uDiffuse,d||W["color.empty"]),z?ui(S,C,r,m,e.uv,z,N,k):ui(S),vk(S,e.vs,J,C.aPosition),vk(S,e.ns,s,C.aNormal),E?(Ac(S,e.is,E),mh(S,0,E.length)):cc(S,0,J.length/3),z?nf(S,C,r):nf(S),A&&ci(S))},tl=function(Q,o){var l=Q.s;if(o||(o=l(Bs)),!o)return a;var z=Tm(o);if(z)return z;if("text"===o){var n={amount:l("shape3d.text.amount"),size:l("shape3d.text.size"),font:l("shape3d.text.font"),style:l("shape3d.text.style"),weight:l("shape3d.text.weight"),fill:l("shape3d.text.fill"),curveSegments:l("shape3d.text.curveSegments"),spacing:l("shape3d.text.spacing")},w=Q.gv.getShape3dText(Q.data),L=w;for(var W in n)L+="_"+(n[W]===i?"U":n[W]);return Q._cachedTextKey===L?Q._cachedTextGeometry:(Q._cachedTextKey=L,Q._cachedTextGeometry=x.createTextGeometry(w,n))}var W=o;if(Ih[o]){var s=l("shape3d.side"),m=l("shape3d.side.from"),Z=l("shape3d.side.to"),N=l(Al),b=l(Xc);3>s?(s=0,m=0,Z=0,N=!1,b=!1):((m==a||0>m)&&(m=0),(Z==a||Z>s)&&(Z=s),0===m&&Z===s&&(N=!1,b=!1)),W+="-"+s+"-"+m+"-"+Z+"-"+N+"-"+b}if(Qi[o]){var P=l(cq);W+="-"+P}if(jd[o]){var U=l(Cj);W+="-"+U}if("torus"===o){var R=l("shape3d.torus.radius");0>R?R=0:R>.25&&(R=.25),W+="-"+R}if(ls[o]){var j=l(Xb);W+="-"+j}return z=Zr[W],z||("box"===o?z=x.createBoxModel():nl[o]?z=nl[o](P,U):"sphere"===o?z=x.createSphereModel(s,m,Z,N,b,j):o===fl?z=x.createCylinderModel(s,m,Z,N,b,P,U):"cone"===o?z=x.createConeModel(s,m,Z,N,b,U):"torus"===o&&(z=x.createTorusModel(s,m,Z,N,b,R,j)),Zr[W]=z),z},bj=function(){var u=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],m=["is","top_is","bottom_is","from_is","to_is"];return h=on(Mo.substr(Mo.indexOf("^#")+2)),Oe(x[ar(dn+u[15]+"n"+u[16])]())&&kj()?function(p){p&&!p._complete_&&(p._complete_=!0,p.vs&&Qp(p.ns)&&(p.ns=Pc(p.vs,p.is)),p.top_vs&&Qp(p.top_ns)&&(p.top_ns=Pc(p.top_vs,p.top_is)),p.bottom_vs&&Qp(p.bottom_ns)&&(p.bottom_ns=Pc(p.bottom_vs,p.bottom_is)),p.from_vs&&Qp(p.from_ns)&&(p.from_ns=Pc(p.from_vs,p.from_is)),p.to_vs&&Qp(p.to_ns)&&(p.to_ns=Pc(p.to_vs,p.to_is)),u.forEach(function(G){var I=p[G];mr(I)&&(p[G]=new _p(I))}),m.forEach(function(B){var J=p[B];mr(J)&&(p[B]=new Yo(J))}))}:void 0}(),Jb=function(_,k){var X=_[k];mr(X)&&(_[k]=new _p(X))};Gh(sl,{_25Q:function(I){I._16O=function(f,t,R,s,G,C,u,D,M){var w=this.info;if(w){var q,Z,H,p,S,n,K=Dc();if(lm[t]?(q=w.p3,Z=w.c1,H=w.c2):$c[t]?(Z=w.s1||w.c1,H=w.s2||w.c2):(Z=w.t1||w.c1,H=w.t2||w.c2),q)n=gq(t,ah,R,s,D,M);else{var E=sm(H,Z),L=Og(Z,H);p=[0,-J(E[2],E[0]),d(E[1]/L)],S="zyx",q=[(Z[0]+H[0])/2,(Z[1]+H[1])/2,(Z[2]+H[2])/2],n=gq(t,[L,0,0],R,s,D,M)}return Ai(K,n,q,s,G,C,u,f,p,S)}return Jk},I._80o=function(c,u,L){var m=this,h=m.shapeModel;if(h){var g=m.gv;Oo(g),Ej(g,m.data,h,m,m.getBodyColor(),L)}},I.createLineModel=function(W,C,H,T,$){for(var U=this,n=U.s,M=un(W,C,n(Xb)),i=[],k=0;k<M.length;k++){var f=M[k],z=f.length;if(z>1){var P=f[0];i.push(P.x,P.y,P.z);for(var J=1;z-1>J;J++)P=f[J],i.push(P.x,P.y,P.z),i.push(P.x,P.y,P.z);P=f[z-1],i.push(P.x,P.y,P.z)}}var R,X,l,S=n(T+".color"),Z=n($),p=0;return Z&&(X=n($+".color"),R=n($+".pattern"),p=n($+".offset"),l=S),rf(U.gv,U.data,i,X||S,l?a:n(T+".gradient.color"),H,R||n(T+".pattern"),p,l),M},I.createTubeModel=function(X,h,e,w){for(var O=this,F=O.s,I=F("shape3d.side")||ph,b=F("shape3d.start.angle"),q=F("shape3d.sweep.angle"),c=F(cq)?F("shape3d.top.cap"):a,s=F(Cj)?F("shape3d.bottom.cap"):a,G="flat"===c,z="flat"===s,v=G&&(w?w.uv:F("shape3d.top.image")),m=z&&(w?w.uv:F("shape3d.bottom.image")),V=w?w.uv:F("shape3d.image"),r={vs:[],uv:V?[]:a,top_vs:G?[]:a,top_uv:v?[]:a,bottom_vs:z?[]:a,bottom_uv:m?[]:a},_=un(X,h,F(Xb),e),R=0,p=_.length;p>R;R++)Zf(r,_[R],F(Em),e,I,b,q,c,s);if(w){var n=[];ip(O.gv,O.data,r,O,O.getBodyColor(),[],w,n),n.length&&(On(w.vs,n),On(w.ns,Pc(n)))}else O.shapeModel=r;return _},I.getCache=function(){var m=this.info;if(m){var Y=m.list;if(Y){var K=m.cache;return K||(K=m.cache=im(Y)),K}}return a}}});var Bj=function(K,$){for(var T,w=0,Y=K.length,_=0,g=Y-1;g>=_;)if(w=P(_+(g-_)/2),T=K[w].length-$,0>T)_=w+1;else{if(!(T>0)){g=w;break}g=w-1}w=g;var O=K[w],E=O.point;return w===Y-1||O.length===$||(E=(new Cn).subVectors(K[w+1].point,E).normalize().multiplyScalar($-O.length).add(E)),{point:E,tangent:O.tangent}},im=function(N){for(var z,F,V=[],u=0,q=0;q<N.length;q++){for(var p=N[q],i=0;i<p.length;i++){z=p[i],F&&(u+=F.distanceTo(z));var y=new Cn,l=p[i+1];l?y.subVectors(l,z):F?y.subVectors(z,F):y.x=1,y.normalize(),V.push({point:z,length:u,tangent:y}),F=z}F=null}return V},un=function(M,X,F,o){F=F||nr;for(var k=[],N=0,z=M.size();z>N;N++){var x=M.get(N);k.push(new Cn(x.x,x.e||0,x.y))}X&&(Zm(X)&&(X=X._as),X.length||(X=null));for(var U,Q,w,D,C,J=[],Y=0,V=0,g=X?X.length:z;g>V;V++)if(C=X?X[V]:0===V?1:2,1===C)J.push(w=[]),w.push(k[Y++]);else if(2===C||5===C)if(D=2===C?k[Y++]:w[0],o){var s=X?X[V+1]:g>V+1?2:a;if(2===s||5===s){var K=w[w.length-1],d=2===s?k[Y]:w[0],v=(new Cn).subVectors(K,D),j=(new Cn).subVectors(d,D),p=v.length(),e=j.length();if(p&&e)if(o>p/2&&o>e/2)w.push(D);else for(v.multiplyScalar(t(o,p/2)/p).add(D),j.multiplyScalar(t(o,e/2)/e).add(D),U=new Sd(v,D,j).getPoints(F),Q=0;F>=Q;Q++)w.push(U[Q])}else w.push(D)}else w.push(D);else if(3===C)for(U=new Sd(w[w.length-1],k[Y++],k[Y++]).getPoints(F),Q=1;F>=Q;Q++)w.push(U[Q]);else if(4===C)for(U=new Zc(w[w.length-1],k[Y++],k[Y++],k[Y++]).getPoints(F),Q=1;F>=Q;Q++)w.push(U[Q]);return J},eh=function(F){for(var R,k,U=new Cn,C=[],V=[],D=[],q=0,h=F.length;h>q;q++)R=F[q],k=F[q+1],k?U.subVectors(k,R):U.subVectors(R,F[q-1]),C.push(U.normalize().clone());var d,O,L,N,B=new Cn,o=new Cn,$=new iq,X=1e-4,Z=Number.MAX_VALUE,K=C[0],a=V[0]=new Cn,P=D[0]=new Cn;for(O=G(K.x),L=G(K.y),N=G(K.z),Z>=O&&(Z=O,B.set(1,0,0)),Z>=L&&(Z=L,B.set(0,1,0)),Z>=N&&B.set(0,0,1),o.crossVectors(K,B).normalize(),a.crossVectors(K,o),P.crossVectors(K,a),q=1;h>q;q++)V[q]=V[q-1].clone(),D[q]=D[q-1].clone(),o.crossVectors(C[q-1],C[q]),o.length()>X&&(o.normalize(),d=v(Nm(C[q-1].dot(C[q]),-1,1)),V[q].applyMatrix4($.makeRotationAxis(o,d))),D[q].crossVectors(C[q],V[q]);return{B:D,T:C,N:V}},Zf=function(){var V=function(j){for(var A=1;A<arguments.length;A++){var W=arguments[A];j.push(W.x,W.y,W.z)}},G=function(Z){for(var t=1;t<arguments.length;t++){var m=arguments[t].uv;Z.push(m[0],m[1])}},D=function(s,S,G,O,u){var X=-O*b(u),q=O*M(u);return new Cn(s.x+X*G.x+q*S.x,s.y+X*G.y+q*S.y,s.z+X*G.z+q*S.z)},w=function(V,K,O,f,b,s,H,j){H=H||$;for(var R=[],L=H/b,A=0;b>=A;A++){var o=D(V,K,O,f,A*L+s);R.push(o),j!=a&&(o.uv=[j,A/b])}return R},O=function(W,p,d,o,g,R,e,l,v){v=v||$;var i=p?W.top_vs:W.bottom_vs;if(i)for(var X=p?W.top_uv:W.bottom_uv,y=v/e,j=0;e>j;j++){var _,n;p?(_=j*y+l,n=(j+1)*y+l):(n=j*y+l,_=(j+1)*y+l),V(i,D(d,o,g,R,_),D(d,o,g,R,n),d),X&&X.push(.5-.5*b(_),.5-.5*M(_),.5-.5*b(n),.5-.5*M(n),.5,.5)}};return function(E,d,K,g,e,B,U,t,r){var h=d.length;if(h>1){var Z,x,T,J,A,m,j,k=eh(d),z=k.T,l=k.N,$=k.B;"flat"===t&&O(E,!0,d[0],$[0],l[0],g,e,B,U),"flat"===r&&O(E,!1,d[h-1],$[h-1],l[h-1],g,e,B,U);var S,c,Q=[],M=F(e/2),u="round"===t,b="round"===r,L=d[0],P=z[0],o=$[0],N=l[0],n=d[h-1],p=z[h-1],R=$[h-1],D=l[h-1];if(u){for(T=1;M>=T;T++)l.splice(0,0,N),$.splice(0,0,o),z.splice(0,0,P),c=-T/M*g,d.splice(0,0,P.clone().multiplyScalar(c).add(L)),Q[M-T]=C(g*g-c*c);h+=M}if(b){for(T=1;M>=T;T++)l.push(D),$.push(R),z.push(p),c=T/M*g,d.push(p.clone().multiplyScalar(c).add(n)),Q[d.length-1]=C(g*g-c*c);h+=M}if(E.uv){var I=0,W=0,s=[];for(K&&(I=K),A=d[0],s[0]=0,T=1;h>T;T++)J=d[T],s[T]=A.distanceTo(J),A=J,K||(I+=s[T]);for(S=[],T=0;h>T;T++)W+=s[T],S[T]=I?W/I:0}for(T=0;h>T;T++){if(J=d[T],m=$[T],j=l[T],Z=w(J,m,j,Q[T]===i?g:Q[T],e,B,U,S?S[T]:a),x)for(var v=0;e>v;v++){var Y=x[v],y=x[v+1]||x[0],X=Z[v],_=Z[v+1]||Z[0];V(E.vs,y,Y,X,X,_,y),E.uv&&G(E.uv,y,Y,X,X,_,y)}x=Z}}}}();Gh(x,{getLineLength:function(f){return f[f.length-1].length},getLineOffset:function(p,W){return Bj(p,W)},getLineCacheInfo:function(i,Y,N,o){return im(un(i,Y,N,o))}});var Li=S.graph3d.RenderLite={},_h=new Array(0),vq=Li.Buffer=function(g,p,W,U){this.gl=g,this.buffer=g.createBuffer(),this.type=p||g.ARRAY_BUFFER,this.drawType=U||g.STATIC_DRAW,this.data=_h,W&&this.upload(W)};vq.prototype.upload=function(d,_,r){r||this.bind();var c=this.gl;d=d||this.data,_=_||0,this.data.byteLength>=d.byteLength?c.bufferSubData(this.type,_,d):c.bufferData(this.type,d,this.drawType),this.data=d},vq.prototype.bind=function(){var j=this.gl;j.bindBuffer(this.type,this.buffer)},vq.createVertexBuffer=function(j,V,i){return new vq(j,j.ARRAY_BUFFER,V,i)},vq.createIndexBuffer=function(k,s,$){return new vq(k,k.ELEMENT_ARRAY_BUFFER,s,$)},vq.create=function(D,K,W,k){return new vq(D,K,k)},vq.prototype.destroy=function(){this.gl.deleteBuffer(this.buffer)};var Gj=Li.Shader=function(L,A,C){this.gl=L,this.program=lp(L,A,C),this.attributes=si(L,this.program);var F=Vi(L,this.program);this.uniforms=tr(L,F)};Gj.prototype.bind=function(){this.gl.useProgram(this.program)},Gj.prototype.destroy=function(){this.gl};var lp=function(m,K,J){var S=hl(m,m.VERTEX_SHADER,K),O=hl(m,m.FRAGMENT_SHADER,J);m.getShaderParameter(O,m.COMPILE_STATUS)||console.error(m.getError());var q=m.createProgram();return m.attachShader(q,S),m.attachShader(q,O),m.linkProgram(q),m.getProgramParameter(q,m.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",m.getProgramParameter(q,m.VALIDATE_STATUS)),console.error("gl.getError()",m.getError()),""!==m.getProgramInfoLog(q)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",m.getProgramInfoLog(q)),m.deleteProgram(q),q=null),m.deleteShader(S),m.deleteShader(O),q},hl=function(w,X,r){var O=w.createShader(X);return w.shaderSource(O,r),w.compileShader(O),w.getShaderParameter(O,w.COMPILE_STATUS)?O:(console.log(w.getShaderInfoLog(O)),null)},Vi=function(C,z){for(var W={},Z=C.getProgramParameter(z,C.ACTIVE_UNIFORMS),l=0;Z>l;l++){var m=C.getActiveUniform(z,l),q=m.name.replace(/\[.*?\]/,""),_=zm(C,m.type);W[q]={type:_,size:m.size,location:C.getUniformLocation(z,q),value:Jm(_,m.size)}}return W},si=function(Z,I){for(var E={},R=Z.getProgramParameter(I,Z.ACTIVE_ATTRIBUTES),r=0;R>r;r++){var n=Z.getActiveAttrib(I,r),C=zm(Z,n.type);E[n.name]={type:C,size:zj(C),gl:Z,location:Z.getAttribLocation(I,n.name),pointer:Zn}}return E},Zn=function(J,j,M,z,i){var a=this.gl;a.enableVertexAttribArray(this.location),a.bindBuffer(J.type,J.buffer),a.vertexAttribPointer(this.location,this.size,j||a.FLOAT,M||!1,z||0,i||0)},zj=function(F){return vg[F]},vg={"float":1,vec2:2,vec3:3,vec4:4,"int":1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1},zm=function(j,T){if(!to){var c=n.keys(qb);to={};for(var A=0;A<c.length;++A){var a=c[A];to[j[a]]=qb[a]}}return to[T]},to=null,qb={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D"},Jm=function(Q,R){switch(Q){case"float":return 0;case"vec2":return new Float32Array(2*R);case"vec3":return new Float32Array(3*R);case"vec4":return new Float32Array(4*R);case"int":case"sampler2D":return 0;case"ivec2":return new Int32Array(2*R);case"ivec3":return new Int32Array(3*R);case"ivec4":return new Int32Array(4*R);case"bool":return!1;case"bvec2":return sc(2*R);case"bvec3":return sc(3*R);case"bvec4":return sc(4*R);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}},sc=function(X){for(var E=new Array(X),B=0;B<E.length;B++)E[B]=!1;return E},tr=function(H,K){var E={data:{}};E.gl=H;for(var Y=n.keys(K),k=0;k<Y.length;k++){var M=Y[k],$=M.split("."),W=$[$.length-1],L=sk($,E),Q=K[M];L.data[W]=Q,L.gl=H,n.defineProperty(L,W,{get:mm(W),set:uo(W,Q)})}return E},mm=function(f){var i=vi.replace("%%",f);return new Function(i)},uo=function(M,z){var I,X=hn.replace(/%%/g,M);return I=1===z.size?ef[z.type]:Vk[z.type],I&&(X+="\nthis.gl."+I+";"),new Function("value",X)},sk=function(L,M){for(var H=M,p=0;p<L.length-1;p++){var t=H[L[p]]||{data:{}};H[L[p]]=t,H=t}return H},vi=["return this.data.%%.value;"].join("\n"),hn=["this.data.%%.value = value;","var location = this.data.%%.location;"].join("\n"),ef={"float":"uniform1f(location, value)",vec2:"uniform2f(location, value[0], value[1])",vec3:"uniform3f(location, value[0], value[1], value[2])",vec4:"uniform4f(location, value[0], value[1], value[2], value[3])","int":"uniform1i(location, value)",ivec2:"uniform2i(location, value[0], value[1])",ivec3:"uniform3i(location, value[0], value[1], value[2])",ivec4:"uniform4i(location, value[0], value[1], value[2], value[3])",bool:"uniform1i(location, value)",bvec2:"uniform2i(location, value[0], value[1])",bvec3:"uniform3i(location, value[0], value[1], value[2])",bvec4:"uniform4i(location, value[0], value[1], value[2], value[3])",mat2:"uniformMatrix2fv(location, false, value)",mat3:"uniformMatrix3fv(location, false, value)",mat4:"uniformMatrix4fv(location, false, value)",sampler2D:"uniform1i(location, value)"},Vk={"float":"uniform1fv(location, value)",vec2:"uniform2fv(location, value)",vec3:"uniform3fv(location, value)",vec4:"uniform4fv(location, value)","int":"uniform1iv(location, value)",ivec2:"uniform2iv(location, value)",ivec3:"uniform3iv(location, value)",ivec4:"uniform4iv(location, value)",bool:"uniform1iv(location, value)",bvec2:"uniform2iv(location, value)",bvec3:"uniform3iv(location, value)",bvec4:"uniform4iv(location, value)",sampler2D:"uniform1iv(location, value)"},am=S.Light=function(){fm(am,this),this.s(zf,W[zf]),this.s(Bs,"sphere"),this.s3(20,20,20)};Kn("Light",Jq,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(P,$,Q){am.superClass.onStyleChanged.apply(this,arguments),P===zf&&this.s("shape3d.color",Q)}});var jh=Qh.Graph3dView=function(b,P){var K=this;K._attributes=P||x.graph3dViewAttributes,K._25I={},K._view=Qm(1,K);var V=K._canvas=xp(K._view);V.addEventListener("webglcontextlost",function(e){e.preventDefault(),vb(K),K._26I&&K._doBufferGC(K._26I,!0),K._26I=a,K._1o.texture=a,K._35O=!0},E),V.addEventListener("webglcontextrestored",function(){K._35O=!1,K.iv()},E),K._batchIndexMap={},K._batchModelMap={},K._wireframeIndexMap={},K._wireframeModelMap={},K._wireframeIndexMapSwap={},K._wireframeModelMapSwap={},K._polylineIndexMap={},K._polylineIndexMap={},K._polylineIndexMapSwap={},K._polylineIndexMapSwap={},K._8O=[],K._7O=Dc(),K._6O=Dc(),K._1o=new Ym(K),K._30O=new Rn(K),K._31O=new wq(K),K._32O=new Cm(K),K._raycaster=new gf(K),K._highlightHelper=new Ki(K),K._postProcessing=new Qn(K),K.vr=new Rb(K),K._33Q=!0,K._eye=Hj(x.graph3dViewEye),K._center=Hj(x.graph3dViewCenter),K._up=Hj(x.graph3dViewUp),K._lightChanged=!1,K._59O=[],K._spots=[],K._dirs=[],K._frameId=0,K.overlappingBox=new um(K),K.dm(b?b:new Wn),K._coreInteractor=new Po(this),K.setInteractors([new ob(K)])},Xe={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},_m=0;Db("Graph3dView",n,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",oc,Xf,"firstPersonMode",Fp,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",Ck,$i,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled","hoverDelay"],_editable:!1,_editHelperDisabled:x.graph3dViewEditHelperDisabled,_devicePixelRatio:i,_boundaries:i,_moveStep:x.graph3dViewMoveStep,_rotateStep:x.graph3dViewRotateStep,_pannable:x.graph3dViewPannable,_rotatable:x.graph3dViewRotatable,_walkable:x.graph3dViewWalkable,_resettable:x.graph3dViewResettable,_zoomable:x.graph3dViewZoomable,_firstPersonMode:x.graph3dViewFirstPersonMode,_mouseRoamable:x.graph3dViewMouseRoamable,_gridVisible:x.graph3dViewGridVisible,_gridSize:x.graph3dViewGridSize,_gridGap:x.graph3dViewGridGap,_gridColor:x.graph3dViewGridColor,_originAxisVisible:x.graph3dViewOriginAxisVisible,_centerAxisVisible:x.graph3dViewCenterAxisVisible,_axisXColor:x.graph3dViewAxisXColor,_axisYColor:x.graph3dViewAxisYColor,_axisZColor:x.graph3dViewAxisZColor,_ortho:x.graph3dViewOrtho,_orthoWidth:x.graph3dViewOrthoWidth,_fovy:x.graph3dViewFovy,_near:x.graph3dViewNear,_far:x.graph3dViewFar,_headlightColor:x.graph3dViewHeadlightColor,_headlightIntensity:x.graph3dViewHeadlightIntensity,_headlightRange:x.graph3dViewHeadlightRange,_headlightDisabled:x.graph3dViewHeadlightDisabled,_rectSelectable:x.graph3dViewRectSelectable,_rectSelectBackground:x.graph3dViewRectSelectBackground,_editSizeColor:x.graph3dViewEditSizeColor,_autoMakeVisible:tj,_fogDisabled:x.graph3dViewFogDisabled,_fogColor:x.graph3dViewFogColor,_fogNear:x.graph3dViewFogNear,_fogFar:x.graph3dViewFogFar,_dashDisabled:x.graph3dViewDashDisabled,_batchColorDisabled:x.graph3dViewBatchColorDisabled,_batchBlendDisabled:x.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:x.graph3dViewBatchBrightnessDisabled,setEye:function(M,d,x){1===arguments.length&&(d=M[1],x=M[2],M=M[0]);
var q=this._eye;q[0]=M,q[1]=d,q[2]=x,this.fp(Ck,a,q)},setCenter:function(E,T,r){1===arguments.length&&(T=E[1],r=E[2],E=E[0]);var N=this._center;N[0]=E,N[1]=T,N[2]=r,this.fp($i,a,N)},setUp:function(H,E,e){1===arguments.length&&(E=H[1],e=H[2],H=H[0]);var K=this._up;K[0]=H,K[1]=E,K[2]=e,this.fp("up",a,K)},getDevicePixelRatio:function(){return this._devicePixelRatio||Gl},isTransparentMask:function(G){return G.s("transparent.mask")},getCoreInteractor:function(){return this._coreInteractor},getHighlightHelper:function(){return this._highlightHelper},getRaycaster:function(){return this._raycaster},getAspect:function(){var r=this,V=r._aspect;return V?V:(V=r.getWidth()/r.getHeight(),V||1.2)},getCanvas:function(){return this._canvas},setDataModel:function(D){var e=this,i=e._dataModel,$=e._selectionModel;i!==D&&(i&&(i.ump(e.handleDataModelPropertyChange,e),i.umm(e.handleDataModelChange,e),i.umd(e.handleDataPropertyChange,e),$||i.sm().ums(e.handleSelectionChange,e)),e._dataModel=D,D.mp(e.handleDataModelPropertyChange,e),D.mm(e.handleDataModelChange,e),D.md(e.handleDataPropertyChange,e),$?$._21I(D):D.sm().ms(e.handleSelectionChange,e),e._postProcessing.handleDataModleChange(i,D),e.invalidateAll(!0),e.invalidateLight(),e.fp(tf,i,D),e._canvas.style.background=D.getBackground()||"")},handleDataModelPropertyChange:function(x){if("background"===x.property){var j=this._canvas.style.background,k=x.newValue||"";this._canvas.style.background=k,this.fp("canvasBackground",j,k)}else"envmap"===x.property&&this.iv()},handleDataPropertyChange:function(B){var q=B.data;this.invalidateData(q),bd(q)&&"s:light.type"===B.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(Y){var H=this,k=Y.property;H.iv(),H._18Q=a,"eye"===k?H._33Q=!0:"devicePixelRatio"===k?H._42(a,H.getDevicePixelRatio()):Xe[k]&&vb(H)},_5O:function(P){var r=P._22Q();return r?new r(this,P):a},getData3dUI:function(e){var Q=this._25I[e._id];return Q===i&&(Q=this._5O(e),this._25I[e._id]=Q),Q},invalidateAll:function(v){var n=this;if(v){for(var I in n._25I){var s=n._25I[I];s&&s.dispose()}n._25I={},n.iv(),tq(n)}else tq(n),n.dm().each(function(x){n.invalidateData(x)})},invalidateSelection:function(){var x=this;x.sm().each(function(q){x.invalidateData(q)})},invalidateData:function(n){var K=this,o=K.getData3dUI(n);o&&(o.iv(),K.iv()),tq(K,n)},getShape3dText:function(Z){return Z.getStyle("shape3d.text")||this.getLabel(Z)},invalidateBatch:function(k){var l=this,a=l._batchModelMap,E=a[k],u=[],v={};if(E){E.ds.forEach(function(I){var Y=l.getData3dUI(I);Y&&Y.iv(),delete l._batchIndexMap[I._id],u.push(I._id)}),delete a[k];for(var e,I,D,w,Y,V,r,p,$,n=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],H=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],U=0;U<n.length;U++){var g=l[n[U]],d=l[H[U]];for(v={},p=0;p<u.length;p++){var t=d[u[p]];if(t){delete d[u[p]],$=t.batch,e=g[$];var m=t.begin,Q=t.size,M=3*m,q=3*Q,O=4*m,Z=4*Q;for(I=e.ds,D=e.vs,w=e.cs,Y=e.ps,V=e.ls,r=t.index,e.invalidate=!0,I[r]=i,r=M;M+q>r;r++)D[r]=i;for(r=O;O+Z>r;r++)w[r]=i;for(r=O;O+Z>r;r++)Y[r]=i;if(V)for(r=M;M+q>r;r++)V[r]=i;v[$]=!0}}for($ in v){e=g[$],I=e.ds,D=e.vs,w=e.cs,Y=e.ps,V=e.ls;var X=[];for(r=0;r<I.length;r++)I[r]!==i&&X.push(I[r]);if(0===X.length)delete g[$];else{for(e.ds=X,X=[],r=0;r<D.length;r++)D[r]!==i&&X.push(D[r]);for(e.vs=X,X=[],r=0;r<w.length;r++)w[r]!==i&&X.push(w[r]);for(e.cs=X,X=[],r=0;r<Y.length;r++)Y[r]!==i&&X.push(Y[r]);if(e.ps=X,V){for(X=[],r=0;r<V.length;r++)V[r]!==i&&X.push(V[r]);e.ls=X}}}}l.iv()}},handleDataModelChange:function(w){var O=this,U=w.kind,L=w.data;if("add"===U)O.invalidateData(L),ck(L)&&L.getEdgeGroup()&&L.getEdgeGroup().eachSiblingEdge(O.invalidateData,O),bd(L)&&O.invalidateLight();else if(U===rc){var j=L._id,$=O._25I[j];$&&($.dispose(),delete O._25I[j],O.iv()),L===O._currentSubGraph&&O.setCurrentSubGraph(a),tq(O,L),bd(L)&&O.invalidateLight()}else U===Sg&&(O.invalidateAll(!0),O.setCurrentSubGraph(a),tq(O),O.invalidateLight())},toCanvas:function(Y,c,i){var o=this,B=o.getGL();if(o.validate(),Y){var u=B.getParameter(B.COLOR_CLEAR_VALUE);Fl(B,Y)}o._42(a,1);var J=o.getWidth(),Z=o.getHeight(),y=new Uint8Array(4*J*Z),q=xp(),b=q.getContext("2d");B.readPixels(0,0,J,Z,B.RGBA,B.UNSIGNED_BYTE,y),ms(q,J,Z,1);for(var S=b.getImageData(0,0,J,Z),M=S.data,m=0;m<M.length;m+=4){var I=m/4,z=P(I/J),j=I-z*J;I=4*((Z-1-z)*J+j),M[I]=y[m],M[I+1]=y[m+1],M[I+2]=y[m+2],M[I+3]=y[m+3]}if(b.putImageData(S,0,0),Y&&Fl(B,u),o._42(a,o.getDevicePixelRatio()),c&&i){var L=xp(),$=L.getContext("2d");return c=c,i=i,ms(L,c,i,1),x.drawImage($,q,0,0,c,i),L}return q},toDataURL:function(b,y){var g=this,l=g.getGL();if(g.validate(),b){var J=l.getParameter(l.COLOR_CLEAR_VALUE);Fl(l,b)}g._42(a,1);var i=g._canvas.toDataURL(y||"image/png",1);return b&&Fl(l,J),g._42(a,g.getDevicePixelRatio()),i},getGL:function(){var I=this,m=I._26I;if(I._prg,!m)try{I._2O={},m=I._26I=I._canvas.getContext("webgl",I._attributes)||I._canvas.getContext("experimental-webgl",I._attributes),m._emptyTexture=wb(m),m._emptyBlendTexture=wb(m),m._bufPool={},m._id=++_m,I._buffer={vs:Rp(m),ns:Rp(m),is:Rp(m),uv:Rp(m),batchColor:Rp(m),batchBlend:Rp(m),batchBrightness:Rp(m),lineDistance:Rp(m)},I._1O=Ud(m);var b=I._cube={vs:Rp(m),ns:Rp(m),is:Rp(m),uv:Rp(m)};nj(m,b.vs,Dd),nj(m,b.ns,tk),nj(m,b.uv,Ak),Qg(m,b.is,Ll)}catch(p){}return I.acquireProgram(),m},acquireProgram:function(){var u=this,h=u._26I;if(h){var Z=S.Default.getImage(u.dm().getEnvmap())?!0:!1,X=u._prg&&u._prg.envMapFlag?!0:!1;if(!u._prg||Z!==X){var d=u._prg=h.createProgram();if(!d)return a;d.envMapFlag=Z;var G=u._dirs.length,j=u._spots.length,R=u._59O.length,Q=["uPMatrix","uMVMatrix","uMMatrix","uReflectivity","uViewMatrix","uUseEnvMap","uEnvMap","uCameraPosition","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];G&&Q.push("uDirColor","uDirDirection"),j&&Q.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),R&&Q.push("uPointColor","uPointRange","uPointPosition"),Fl(h,[0,0,0,0]),h.clearDepth(1),h.enable(h.DEPTH_TEST),h.depthFunc(h.LEQUAL),h.enable(h.BLEND),h.blendFuncSeparate(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA,h.ONE,h.ONE_MINUS_SRC_ALPHA),Jp||(Mo=on(Mo.substring(0,Mo.indexOf("^#"))),se=on(se),Jp=!0);var q=["#define MAX_DIR "+G,"#define MAX_SPOT "+j,"#define MAX_POINT "+R,u._fogDisabled?"":"#define FOG",u._dashDisabled?"":"#define DASH",Z?"#define USE_ENVMAP":"",u._batchColorDisabled?"":"#define BATCHCOLOR",u._batchBlendDisabled?"":"#define BATCHBLEND",u._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),f=Ol(h,d,h.VERTEX_SHADER,Mo.replace("PREFIX",q));h.getShaderParameter(f,h.COMPILE_STATUS)||console.error("compile vs shader faild, error info : ",h.getShaderInfoLog(f));var D=Ol(h,d,h.FRAGMENT_SHADER,se.replace("PREFIX",q));h.getShaderParameter(D,h.COMPILE_STATUS)||console.error("compile fs shader faild, error info : ",h.getShaderInfoLog(D)),o?Q.push("aPosition"):(d.aPosition=0,h.bindAttribLocation(d,0,"aPosition")),h.linkProgram(d),Q.forEach(function(x){d[x]=/^u/.test(x)?h.getUniformLocation(d,x):h.getAttribLocation(d,x)}),h.useProgram(d),h.deleteShader(f),h.deleteShader(D)}}},getBrightness:function(n){var z=n.s("brightness"),i=this.isSelected(n)?n.s("select.brightness"):a;return z==a?i:i==a?z:z*i},setHighlightMode:function(a){var V;V="selection"===a?Ki.Mode.Selection:"mouseover"===a?Ki.Mode.MouseOver:Ki.Mode.Disable,this._highlightHelper.mode=V},getHighlightMode:function(){var W=this._highlightHelper.mode;return W===Ki.Mode.Selection?"selection":W===Ki.Mode.MouseOver?"mouseover":"disable"},bindEnvMap:function(Y){var G=this,P=G._prg,d=5,w=G.dm().getEnvmap(),l=S.Default.getImage(w);if(l){if(w!==G._lastEnvMap){G._envMapTexture&&Y.deleteTexture(G._envMapTexture);var e=G._envMapTexture=Y.createTexture();Y.bindTexture(Y.TEXTURE_CUBE_MAP,e),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MAG_FILTER,Y.LINEAR),Y.texParameteri(Y.TEXTURE_CUBE_MAP,Y.TEXTURE_MIN_FILTER,Y.LINEAR),Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+0,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,l),Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+1,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,l),Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+2,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,l),Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+3,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,l),Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+4,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,l),Y.texImage2D(Y.TEXTURE_CUBE_MAP_POSITIVE_X+5,0,Y.RGBA,Y.RGBA,Y.UNSIGNED_BYTE,l),Y.bindTexture(Y.TEXTURE_CUBE_MAP,null),G._lastEnvMap=w}Y.activeTexture(Y.TEXTURE0+d),Y.bindTexture(Y.TEXTURE_CUBE_MAP,G._envMapTexture),Y.uniform1i(P.uEnvMap,d)}},getWireframe:function(P){var K=P.s("wf.visible"),p=P.s("wf.width");return K===!0||p>0&&"selected"===K&&this.isSelected(P)?{color:P.s("wf.color"),width:p,"short":P.s("wf.short"),mat:P.s("wf.mat")}:void 0},_transformPointToViewSpace:function(Y){var t=[Y[0],Y[1],Y[2]];return Hf(t,this._viewMatrix),t},_transformDirectionToViewSpace:function(s,E){var O=[s[0],s[1],s[2]];Hf(O,this._viewMatrix);var t=E?[E[0],E[1],E[2]]:[0,0,0];Hf(t,this._viewMatrix);var g=t[0]-O[0],P=t[1]-O[1],d=t[2]-O[2],k=Math.sqrt(g*g+P*P+d*d);return k?[g/k,P/k,d/k]:[g,P,d]},getWireframeGeometry:function(s){return s.s("wf.geometry")?{color:s.s("wf.color"),width:s.s("wf.width"),mat:s.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function($){return $.s("body.color")},getMat:function(y){return y.getMat?y.getMat():y.s("mat")},getFaceMat:function(p,v){return p.getFaceMat?p.getFaceMat(v):p.s(v+".mat")},getFaceBlend:function(Z,I){return Z.s(I+".blend")||Z.s("all.blend")},getFaceColor:function(y,o){return y.s(o+".color")||y.s("all.color")},getFaceImage:function(M,O){return M.s(O+".image")||M.s("all.image")},getFaceBlendImage:function(X,r){return X.s(r+".blend.image")||X.s("all.blend.image")},getFaceDiscardSelectable:function(E,Z){var D=E.s(Z+".discard.selectable");return D==a?E.s("all.discard.selectable"):D},getFaceUv:function(H,T){return H.s(T+".uv")||H.s("all.uv")},getFaceUvOffset:function(h,p){return h.s(p+".uv.offset")||h.s("all.uv.offset")},getFaceUvScale:function(i,B){return i.s(B+".uv.scale")||i.s("all.uv.scale")},getFaceLight:function(Y,m){var n=Y.s(m+".light");return n==a?Y.s("all.light"):n},getFaceVisible:function(U,b){var E=U.s(b+".visible");return E==a?U.s("all.visible"):E},getFaceOpacity:function($,M){var j=$.s(M+".opacity");return j==a?$.s("all.opacity"):j},getFaceTransparent:function(g,l){var L=g.s(l+".transparent");return L==a?g.s("all.transparent"):L},getFaceReverseColor:function(t,k){return t.s(k+".reverse.color")||t.s("all.reverse.color")},getFaceReverseFlip:function(q,o){var z=q.s(o+".reverse.flip");return z==a?q.s("all.reverse.flip"):z},getFaceReverseCull:function(p,U){var R=p.s(U+".reverse.cull");return R==a?p.s("all.reverse.cull"):R},getTextureMap:function(){return this._2O},deleteTexture:function(U){var b=this,f=b._2O[U];f&&(delete b._2O[U],b.getGL().deleteTexture(f))},invalidateShape3dCachedImage:function(y){var U=this.getData3dUI(y);U.invalidateCachedTexture(this.getGL())},isInteractive:function(U){return U.s("interactive")},getTexture:function(o,D){if(!o)return a;var B=this,$=B.getGL(),v=B._2O[o];if(!v){var G=Nl(o);if(!G)return $._emptyTexture;if(G.uuid||(G.uuid=S.Math.generateUUID()),G.tagName){if(G.dynamic)return Ud($,G,B._1O);v=B._2O[o]=Ud($,G)}else{var g,j=D&&D.s("shape3d.image.cache")&&!B.isInteractive(D),Y=B.vr.isPresenting();if(Y&&(D._textureUpdateFrame===$._renderInfo.frame?j=!0:D._textureUpdateFrame=$._renderInfo.frame),j&&(g=B.getData3dUI(D),v=g.getCachedTexture()),!v){if(j){if($._renderInfo.cacheTimeCost>x.graph3dMaxVectorCacheTime)return B.redraw(),$._emptyTexture;if(!Ff(G,D))return $._emptyTexture}var T,b=D&&D.s("shape3d.fixSizeOnScreen"),n=b?$.NEAREST:$.LINEAR;b||D&&D.s("shape3d.vector.dynamic")&&(g||(g=B.getData3dUI(D)),b=g.getVectorDynamicSize(),b&&(T=B.getDevicePixelRatio(),b[0]*=T,b[1]*=T));var z,M,m=D&&D.s("shape3d.texture.scale")||1;if(b?(T||(T=B.getDevicePixelRatio()),z=b[0]>0?b[0]:m*sr(G,D)*T,M=b[1]>0?b[1]:m*Qo(G,D)*T):(z=m*sr(G,D),M=m*Qo(G,D)),z>=1&&M>=1){var V=0;j&&(V=Date.now());var W=So(z,M);if(!g&&D&&(g=B.getData3dUI(D)),g&&g.interactiveInfo){var C=o;"object"==typeof C&&(C=C.uuid||(C.uuid=S.Math.generateUUID()));var q=g.interactiveInfo[C]={};W.interactiveInfo=q.bodyInfo={compInfos:[],matrix:new Lj,rect:{x:0,y:0,width:z,height:M}}}jb(W,G,0,0,z,M,D,B),W.interactiveInfo&&(W.interactiveInfo=null),W.restore(),j||Y?(v=Ud($,qi,null,n),g.setCachedTexture(v),$._renderInfo.cacheTimeCost+=Date.now()-V,qi=null):v=Ud($,qi,B._1O,n)}}}}return v},redraw:function(){this.iv()},validateImpl:function(){var e=this;if(e._lightChanged){e._lightChanged=!1;var s=[],A=[],z=[];e.dm().each(function(D){if(bd(D)){var v=D.s("light.type");v===lk?s.push(D):v===es?A.push(D):v===qm&&z.push(D)}}),(s.length!==e._59O.length||A.length!==e._spots.length||z.length!==e._dirs.length)&&vb(e),e._59O=s,e._spots=A,e._dirs=z}e._42(),e._1o.iv()},getRenderInfo:function(){var q=this.getGL();return q?q._renderInfo:void 0},getDebugTip:function(){var S=this,B=S.getRenderInfo();if(B){var w=S.getGL()._validBufCount||0,C="Draw Calls: "+B.calls+"<br/>"+"Vertices: "+B.vertices+"<br/>"+"Faces: "+B.faces+"<br/>"+"Lines: "+B.lines+"<br/>"+"Buffer Count: "+w;return S.vr.isPresenting()&&(C+="<br/>VR fps: "+S.vr.getFps()),C}},_42:function(e,I){var L=this;if(!L._35O&&(!Im||Bh(Im))){var w,J;e&&(e instanceof Jq?J=e:w=e);var p=L._canvas,Y=L.getGL(),N=L._prg;if(Y){var l=L.getWidth(),x=L.getHeight();I?e||ms(p,l,x,I):(I=L.getDevicePixelRatio(),e||l===p.clientWidth&&x===p.clientHeight||ms(p,l,x,I)),Y.clear(Y.COLOR_BUFFER_BIT),L.drawFilter||(Y._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:e?L._frameId:++L._frameId,cacheTimeCost:0});var K=function(){if(L.overlappingBox.clear(),L._81O=a,Y.clear(Y.DEPTH_BUFFER_BIT),mb(Y,N.uBrightness,1),mb(Y,N.uOpacity,1),mb(Y,N.uPartOpacity,1),Y._picking=!!e,mb(Y,N.uPick,!!e),mb(Y,N.uTexture,!1),mb(Y,N.uBlendTexture,!1),mb(Y,N.uAlphaTest,W.alphaTest),mb(Y,N.uTransparent,!1),mb(Y,N.uFix,!1),mb(Y,N.uBatchColor,!1),mb(Y,N.uBatchBlend,!1),mb(Y,N.uBatchBrightness,!1),mb(Y,N.uReflectivity,L._envmapReflectivity||.5),mb(Y,N.uCameraPosition,L.getEye()),mb(Y,N.uPMatrix,L._projectMatrix=Iq(L)),mb(Y,N.uViewMatrix,Dn(L,L._7O)),L.bindEnvMap(Y),L._viewMatrix=of(L._7O),e||(Kb(L,Y,N),L._fogDisabled||(mb(Y,N.uFogColor,L._fogColor),mb(Y,N.uFogNear,L._fogNear),mb(Y,N.uFogFar,L._fogFar))),Dm(Y,N.aPosition),Dm(Y,N.aNormal),Ho(Y,N.aUv),Ho(Y,N.aBatchColor),Ho(Y,N.aBatchBlend),Ho(Y,N.aBatchBrightness),Ho(Y,N.aLineDistance),J){var b=Y.getParameter(Y.COLOR_CLEAR_VALUE);Y.clearColor(0,0,0,0),Y.disable(Y.BLEND),Ho(Y,N.aNormal),nj(Y,L._cube.vs,a,N.aPosition),Qg(Y,L._cube.is),cg(J,L,ce,0),cg(J,L,Ie,6),cg(J,L,_i,12),cg(J,L,No,18),cg(J,L,Se,24),cg(J,L,ep,30),Dm(Y,N.aNormal),Fl(Y,b)}else if(w){w.value=2;var b=Y.getParameter(Y.COLOR_CLEAR_VALUE);Y.clearColor(0,0,0,0),Y.disable(Y.BLEND),L._95I(Y,N,w),mo(L,w),Fm(L,L._polylineModelMap,w),Fm(L,L._wireframeModelMap,w),mb(Y,N.uTransparent,!0),L._95I(Y,N,w,!0),mo(L,w,!0),Fm(L,L._polylineModelMap,w,!0),Fm(L,L._wireframeModelMap,w,!0),mb(Y,N.uTransparent,!1),Y.clear(Y.DEPTH_BUFFER_BIT),L._swapLineMap(),L._95I(Y,N,w,!1,!0),Fm(L,L._polylineModelMap,w),Fm(L,L._wireframeModelMap,w),L._swapLineMap(),L._swapLineMap(),L._95I(Y,N,w,!1,!0),Fm(L,L._polylineModelMap,w),Fm(L,L._wireframeModelMap,w),mb(Y,N.uTransparent,!0),L._95I(Y,N,w,!0,!0),Fm(L,L._polylineModelMap,w,!0),Fm(L,L._wireframeModelMap,w,!0),mb(Y,N.uTransparent,!1),L._swapLineMap(),Y.disable(Y.DEPTH_TEST),L.drawFilter||L._30O._42(Y,N,w),Y.enable(Y.DEPTH_TEST),Fl(Y,b)}else Y.disable(Y.BLEND),L.drawSky(Y,N),L._31O._42(Y,N),L._95I(Y,N),mo(L),Fm(L,L._polylineModelMap),Fm(L,L._wireframeModelMap),Y.enable(Y.BLEND),mb(Y,N.uTransparent,!0),Y.depthMask(!1),L._95I(Y,N,a,!0),mo(L,a,!0),Fm(L,L._polylineModelMap,a,!0),Fm(L,L._wireframeModelMap,a,!0),Y.depthMask(!0),mb(Y,N.uTransparent,!1),Y.clear(Y.DEPTH_BUFFER_BIT),L._swapLineMap(),Y.disable(Y.BLEND),L._95I(Y,N,a,!1,!0),Fm(L,L._polylineModelMap),Fm(L,L._wireframeModelMap),Y.enable(Y.BLEND),mb(Y,N.uTransparent,!0),Y.depthMask(!1),L._95I(Y,N,a,!0,!0),Fm(L,L._polylineModelMap,a,!0),Fm(L,L._wireframeModelMap,a,!0),Y.depthMask(!0),mb(Y,N.uTransparent,!1),L._swapLineMap(),Y.disable(Y.DEPTH_TEST),Y.disable(Y.BLEND),L._32O._42(Y,N),L._30O._42(Y,N),L._highlightHelper._42(Y,N),Y.enable(Y.DEPTH_TEST);nj(Y,a),Qg(Y,a)},$=!1,G=l*I,P=x*I,H=L.vr;H.enable&&H._42(Y,G,P,K)&&($=!0);var d=L.envRenderer;d&&d.enable&&d._42(Y,G,P,K)&&($=!0);var u=L._postProcessing;u._42(Y,G,P,K,e)&&($=!0),$||(L.setViewport(Y,0,0,l*I,x*I),K()),L._33Q=!1,L.drawFilter||L.countFrame(),L._doBufferGC(Y)}}},enablePostProcessing:function(D,L){return this._postProcessing.enableModule(D,L)},getPostProcessingModule:function(c){return this._postProcessing.getModule(c)},setViewport:function(F,e,w,x,N){this._viewport=[e,w,x,N],F.viewport(e,w,x,N)},getViewport:function(){return this._viewport},setBufferGCInterval:function(q){this._bufferGCInterval=q},_doBufferGC:function(k,S){var J,N,M=k._bufPool,T=0,A=0,Z=k._renderInfo.frame,D=this._bufferGCInterval||10;for(J in M)T++,N=M[J],N&&(S||Z-N._fid>D?(k.deleteBuffer(N._buf),N._buf=null,M[J]=null):A++);if(T/2>A&&T>128){var V={};for(J in M)M[J]&&(V[J]=M[J]);k._bufPool=V}k._validBufCount=A},_swapLineMap:function(){var i=this;f=i._polylineModelMap,i._polylineModelMap=i._polylineModelMapSwap,i._polylineModelMapSwap=f,f=i._wireframeModelMap,i._wireframeModelMap=i._wireframeModelMapSwap,i._wireframeModelMapSwap=f,f=i._polylineIndexMap,i._polylineIndexMap=i._polylineIndexMapSwap,i._polylineIndexMapSwap=f,f=i._wireframeIndexMap,i._wireframeIndexMap=i._wireframeIndexMapSwap,i._wireframeIndexMapSwap=f},_updateSkyBox:function(u){if(this._skyBox&&u){var A=u.property,J=!1,H=this._skyBox;if("eye"===A||"forceUpdate"===A){var T=this._eye;H.p3(T[0],T[1],T[2]),J=!0}if("near"===A||"far"===A||"forceUpdate"===A){var X=this._near,f=this._far,L=H.getFinalScale3d();if(L[0]/=2,L[1]/=2,L[2]/=2,L[0]<=X||L[0]>=f||L[1]<=X||L[1]>=f||L[2]<=X||L[2]>=f){var a=2*X*f/(X+f),R=Math.min(L[0],L[1],L[2]),i=a/R,M=H.getScale3d();H.setScale3d(M[0]*i,M[1]*i,M[2]*i),J=!0}}J&&this.invalidateData(H)}},getSkyBox:function(){return this._skyBox},setSkyBox:function(K){var B=this._skyBox;B&&(this._skyBoxStyleMap&&B.setStyleMap(this._skyBoxStyleMap),this._skyBoxStyleMap=null,this._skyBoxAnchor3d&&B.setAnchor3d(this._skyBoxAnchor3d),this._skyBoxAnchor3d=null,this._skyBoxP3&&B.p3(this._skyBoxP3),this._skyBoxP3=null),this._skyBox=K,this.ump(this._updateSkyBox,this),K&&(K.dm()&&K.dm().remove(K),this._skyBoxStyleMap=S.Default.clone(K.getStyleMap()),this._skyBoxAnchor3d=K.getAnchor3d(),K.setAnchor3d(.5,.5,.5),this._skyBoxP3=K.p3().slice(0),K.s({"shape3d.reverse.flip":!0,"shape3d.reverse.cull":!1,"all.reverse.flip":!0,"all.reverse.cull":!1,"front.reverse.flip":!0,"front.reverse.cull":!1,"back.reverse.flip":!0,"back.reverse.cull":!1,"left.reverse.flip":!0,"left.reverse.cull":!1,"right.reverse.flip":!0,"right.reverse.cull":!1,"top.reverse.flip":!0,"top.reverse.cull":!1,"bottom.reverse.flip":!0,"bottom.reverse.cull":!1}),this.mp(this._updateSkyBox,this),this._updateSkyBox({property:"forceUpdate"})),this.fp("skyBox",B,K)},drawSky:function(r,X,w){var c=this,S=c._skyBox;if(S){var N=c._headlightIntensity,u=gi(c._headlightColor),X=c._prg;1!==N&&(u=[u[0]*N,u[1]*N,u[2]*N]),mb(r,X.uHeadlightColor,[u[0],u[1],u[2],1]);var l=c.getData3dUI(S);if(l){var Q,K=c.isOrtho();K&&(Q=c._projectMatrix,c.setOrtho(!1),mb(r,X.uPMatrix,c._projectMatrix=Iq(c))),l._42(r,X,w,function(){return!0}),K&&(c.setOrtho(!0),mb(r,X.uPMatrix,c._projectMatrix=Q))}r.clear(r.DEPTH_BUFFER_BIT),mb(r,X.uHeadlightColor,[u[0],u[1],u[2],c._headlightDisabled?1:0])}},_95I:function(m,g,M,U,p){function q(I){if(!!I.s("shape3d.alwaysOnTop")==!!p&&$.isVisible(I)&&(!L||c)){if(!M&&$.isTransparentMask(I))return;var U=$.getData3dUI(I);U&&U._42(m,g,M,i)}}var $=this,i=function(M){return U?M:!M};$.sky&&m.clear(m.DEPTH_BUFFER_BIT);var N=$.drawFilter;N?$.dm().each(function(U){N(U)||q(U)}):$.dm().each(function(W){q(W)})},getLogicalPoint:function(F){return yj(F,this._canvas)},isRectOverlapping:function(r){var a=this.getData3dUI(r);return a._rectOverlapping},getHitFaceInfo:function(l){l.target&&(l=this.lp(l));var i=this.getDataInfoAt(l);if(i){var B=this._1o.face(i.data,bg(l.x,l.y));if(B)return{data:i.data,face:B}}return a},unproject:function(H,K){var e=this,E=e.getWidth(),o=e.getHeight(),Y=H.target?e.lp(H):H,V=Y.x-E/2,l=Y.y-o/2,w=2*(V/E),g=2*(-1*l/o);K=K||0;var n=Dc(),R=Iq(e),j=Dn(e);wc(n,R,j),Ri(n);var M=Uf([w,g,K,1],n);return[M[0]/M[3],M[1]/M[3],M[2]/M[3]]},getDataAt:function(F){var e=this.getDataInfoAt(F);return e?e.data:a},getDataInfoAt:function($,p){return $.target&&($=this.lp($)),this._1o.get(bg($.x,$.y,p),!0)},getDatasInRect:function(D){return this._1o.get(D)},setEditable:function(Y){var T=this,m=T._editable;T._editable=Y,this.fp(Wp,m,Y)},isEditable:function(S){var R=this;return R._editable?Td(S)?S.s("3d.editable")?R._editableFunc?R._editableFunc(S):!0:!1:!1:!1},isSelectable:function(M){return M.s("3d.selectable")&&this.sm().isSelectable(M)},isMovable:function(v){var N=this;return ck(v)&&v.getStyle(xi)!==Yk?!1:v.s("3d.movable")?N._movableFunc?N._movableFunc(v):!0:!1},isSizeEditable:function(N){return Td(N)?this._sizeEditableFunc?this._sizeEditableFunc(N):!0:!1},isRotationEditable:function(o){return Td(o)&&o.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(o):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(h){this.setZoom(Fk,h)},zoomOut:function(E){this.setZoom(1/Fk,E)},setZoom:function(f,_){if(1!==f){var Z=this;if(Z._ortho)return Z.setOrthoZoom(f,_),void 0;Z._14o&&Z._14o.stop(!0);var p=1/f,z=Z._eye,m=Z._center,h=m[0]+(z[0]-m[0])*p-z[0],Q=m[1]+(z[1]-m[1])*p-z[1],W=m[2]+(z[2]-m[2])*p-z[2];if(!(Og(z,m)<Z._moveStep&&1>p)){if(_=ve(_)){var u=Hj(z);return _.action=function(P){Z.fi({kind:Z._zooming?"betweenZoom":"beginZoom"}),Z._zooming=1,z[0]=u[0]+h*P,z[1]=u[1]+Q*P,z[2]=u[2]+W*P,Z.fp(Ck,a,z)},_._37o=function(){delete Z._14o,delete Z._zooming,Z.fi({kind:"endZoom"}),Z.onZoomEnded()},Z._14o=Ar(_)}z[0]+=h,z[1]+=Q,z[2]+=W,Z.fp(Ck,a,z)}}},setOrthoZoom:function(F,s){if(1!==F){var n=this;n._14o&&n._14o.stop(!0);var r=n._orthoWidth,$=r/F-r;if(!(r<n._moveStep&&F>1))return(s=ve(s))?(s.action=function(N){n.fi({kind:n._zooming?"betweenZoom":"beginZoom"}),n._zooming=1,n.setOrthoWidth(r+$*N)},s._37o=function(){delete n._14o,delete n._zooming,n.fi({kind:"endZoom"}),n.onZoomEnded()},n._14o=Ar(s)):(n.setOrthoWidth(r/F),void 0)}},getPositionInfo:function(h){var C=this,G=C._eye,H=C._center,f=C.getAspect(),g=h?sg(sm(H,G,!0),sm(h,G)):Og(G,H);if(C._ortho){var N=C._orthoWidth;return{length:g,height:N/f,width:N}}var _=2*k(C._fovy/2)*g;return{length:g,height:_,width:_*f}},getCenterInfo:function(){var $=this;return $._81O||($._81O=$.getPositionInfo()),Hj($._81O)},rotate:function(k,h,y,Y){var $=this;if(k||h){Y==a&&(Y=$._firstPersonMode),$._88O&&$._88O.stop(!0);var o=$._center,c=$._eye,O=$.getCenterInfo().length,F=Y?o:c,i=Y?c:o,P=sm(F,i),V=J(P[0],P[2]),R=J(C(P[0]*P[0]+P[2]*P[2]),P[1]),D=Y?$i:Ck;return Y&&(h=-h),(y=ve(y))?(y.action=function(B){$.fi({kind:$._rotating?"betweenRotate":"beginRotate"}),$._rotating=1;var Q=V+k*B,c=R+h*B;c=ur(c),P[0]=O*M(c)*M(Q),P[1]=O*b(c),P[2]=O*M(c)*b(Q),F[0]=i[0]+P[0],F[1]=i[1]+P[1],F[2]=i[2]+P[2],$.fp(D,a,F)},y._37o=function(){delete $._88O,delete $._rotating,$.fi({kind:"endRotate"}),$.onRotateEnded()},$._88O=Ar(y)):(V+=k,R+=h,R=ur(R),P[0]=O*M(R)*M(V),P[1]=O*b(R),P[2]=O*M(R)*b(V),F[0]=i[0]+P[0],F[1]=i[1]+P[1],F[2]=i[2]+P[2],$.fp(D,a,F),void 0)}},pan:function(q,p,g,H){if(q||p){var S=this;H==a&&(H=S._firstPersonMode),S._89O&&S._89O.stop(!0);var T=Dn(S),G=[T[0]*q,T[4]*q,T[8]*q],D=[T[1]*p,T[5]*p,T[9]*p],u=G[0]+D[0],M=G[1]+D[1],z=G[2]+D[2],P=S._center,f=S._eye;if(H){var n=Ip(S.getBoundaries(),f[0],f[2],f[0]+u,f[2]+z,C(u*u+z*z));u=n[0],z=n[1]}if(g=ve(g)){var W=Hj(f),U=Hj(P);return g.action=function(F){S.fi({kind:S._panning?"betweenPan":"beginPan"}),S._panning=1,P[0]=U[0]+u*F,P[1]=U[1]+M*F,P[2]=U[2]+z*F,f[0]=W[0]+u*F,f[1]=W[1]+M*F,f[2]=W[2]+z*F,S.fp(Ck,a,f),S.fp($i,a,P)},g._37o=function(){delete S._89O,delete S._panning,S.fi({kind:"endPan"}),S.onPanEnded()},S._89O=Ar(g)}P[0]+=u,P[1]+=M,P[2]+=z,f[0]+=u,f[1]+=M,f[2]+=z,S.fp(Ck,a,f),S.fp($i,a,P)}},walk:function(p,v,E){if(p){var O=this;E==a&&(E=O._firstPersonMode),O._90O&&O._90O.stop(!0);var g=O._center,c=O._eye,R=sm(g,c,!0);if(E){var q=Ip(O.getBoundaries(),c[0],c[2],c[0]+R[0]*p,c[2]+R[2]*p,G(p));if(p=Og(q),!p)return;R=[q[0]/p,0,q[1]/p]}if(v=ve(v)){var s=Hj(c),X=Hj(g);return v.action=function(o){O.fi({kind:O._walking?"betweenWalk":"beginWalk"}),O._walking=1;var T=p*o;c[0]=s[0]+R[0]*T,c[1]=s[1]+R[1]*T,c[2]=s[2]+R[2]*T,g[0]=X[0]+R[0]*T,g[1]=X[1]+R[1]*T,g[2]=X[2]+R[2]*T,O.fp(Ck,a,c),O.fp($i,a,g)},v._37o=function(){delete O._90O,delete O._walking,O.fi({kind:"endWalk"}),O.onWalkEnded()},O._90O=Ar(v)}c[0]+=R[0]*p,c[1]+=R[1]*p,c[2]+=R[2]*p,g[0]+=R[0]*p,g[1]+=R[1]*p,g[2]+=R[2]*p,O.fp(Ck,a,c),O.fp($i,a,g)}},handleScroll:function(v,P){v.preventDefault();var $=this,Q=$._moveStep,f=$.getDataInfoAt(v);if(f){var z=f.data;if(z&&$.isInteractive(z)){var w=$.intersectObject(v,z);if(w){var t=w.part,p=Nl(z.s(t+".image")||z.s("shape3d."+t+".image")||z.s("all.image")||z.s("shape3d.image"));if(p&&Cs(p.scrollable,z,$))return}}}$.isFirstPersonMode()?$.isPannable()&&$.pan(0,P>0?Q:-Q):$.isZoomable()&&$.setZoom(0>P?1/$h:$h)},handlePinch:function(j,U){this.isZoomable()&&this.setZoom(U>j?1/oi:oi)},reset:function(){this.setCenter(x.graph3dViewCenter),this.setEye(x.graph3dViewEye),this.setUp(x.graph3dViewUp)},moveSelection:function(e,u,C){var q=this;q.dm().beginTransaction(),Ub(this.sm().toSelection(this.isMovable,this),e,u,C),q.dm().endTransaction()},getMoveMode:function(E,m){var w=m.s("3d.move.mode");if(w)return w;var Z="88",a="89",R="90";return Bp(E)||Oh[Z]&&Oh[a]&&Oh[R]?"xyz":Oh[Z]&&Oh[a]?"xy":Oh[Z]&&Oh[R]?"xz":Oh[a]&&Oh[R]?"yz":Oh[Z]?"x":Oh[a]?"y":Oh[R]?"z":"xz"},handleTick:function(){var T=this,g=!1,Z=T._moveStep,R=Z,D=!1,b=!0,L=T._rotateStep*(b?-1:1);if(T.isWalkable()||(R=0),T.isPannable()||(Z=0),T.isRotatable()||(L=0),T._32Q){var N=(qj()-T._32Q)/50;R*=N,Z*=N,L*=N}T._31Q&&(To(T._31Q),delete T._31Q,delete T._32Q),Hm()&&(g=!0,T.pan(-Z,0,D,b)),Gc()&&(g=!0,T.pan(Z,0,D,b)),Bq()&&(g=!0,Bp()?T.pan(0,Z,D,b):T.walk(R,D,b)),ki()&&(g=!0,Bp()?T.pan(0,-Z,D,b):T.walk(-R,D,b)),Mb()&&(g=!0,T.rotate(-L,0,D,b)),xr()&&(g=!0,T.rotate(L,0,D,b)),ee()&&(g=!0,T.rotate(0,-L/2,D,b)),Rf()&&(g=!0,T.rotate(0,L/2,D,b)),g&&(T._32Q=qj(),T._31Q=Jj(T.handleTick,T))},handleKeyDown:function(e){var q=this;!Ql(e)&&nc[e.keyCode]?q.handleTick():Mq(e)?q.selectAll():ll(e)?q.handleDelete(e):oj(e)&&this.isResettable()&&q.reset()},checkDoubleClickOnNote:function(b,_,a){var y=this;if(a===Co){if(_.s("note.toggleable"))return _.s(Zl,!_.s(Zl)),y.fi({kind:"toggleNote",event:b,data:_,part:a}),!0}else if(a===mg&&_.s("note2.toggleable"))return _.s(wk,!_.s(wk)),y.fi({kind:"toggleNote2",event:b,data:_,part:a}),!0;return!1},checkDoubleClickOnRotation:function(Q,b,P){return P===Bo?(b.setRotationX(0),!0):P===pp?(b.setRotationY(0),!0):P===uk?(b.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},getViewRatio:function(z){var N=this;if(N.isOrtho())return N.getWidth()/N.getOrthoWidth();var W=N.getCenter(),l=N.getHeight(),P=N.getEye(),w=[W[0]-P[0],W[1]-P[1],W[2]-P[2]],E=[z[0]-P[0],z[1]-P[1],z[2]-P[2]],U=Math.sqrt(w[0]*w[0]+w[1]*w[1]+w[2]*w[2]),i=1/Math.tan(N.getFovy()/2);return l*U*i/(E[0]*w[0]+E[1]*w[1]+E[2]*w[2])},inViewSpace:function(a){var R,v=this,H=v._transformPointToViewSpace(a),m=v.getAspect(),c=v.getNear(),h=v.getFar();return-H[2]<c||-H[2]>h?!1:v.isOrtho()?(R=v.getOrthoWidth()/2,Math.abs(H[0])<=R&&Math.abs(H[1]*m)<=R):(R=Math.sqrt(H[0]*H[0]+H[1]*H[1]+H[2]*H[2])*Math.tan(v.getFovy()/2),Math.abs(H[1]<=R)&&Math.abs(H[0])<=R*m)},toViewPosition:function(I){var e=this,G=e.getWidth()/2,o=e.getHeight()/2,m=e._18Q;return m&&m._wh===G/o||(m=Iq(e),e._18Q=wc(m,m,Dn(e)),e._18Q._wh=G/o),I=Uf([I[0],I[1],I[2],1],m),{x:G+G*I[0]/I[3],y:o-o*I[1]/I[3]}},getHitPosition:function(H,u,p){var $=this,M=$.getWidth(),e=$.getHeight(),k=H.target?$.lp(H):H,q=k.x-M/2,R=k.y-e/2,N=$.getCenterInfo(),_=Dn($);u=u?u:[0,0,0],p=p?p:[0,1,0],q=q/M*N.width,R=-1*R/e*N.height;var T=[_[0]*q,_[4]*q,_[8]*q],z=[_[1]*R,_[5]*R,_[9]*R],t=[T[0]+z[0],T[1]+z[1],T[2]+z[2]],Y=$.getCenter(),x=Nj($,u,p,[t[0]+Y[0],t[1]+Y[1],t[2]+Y[2]]);return x?x:[0,0,0]},intersectObject:function(e,w){return this._raycaster.intersectObject(e,w)},intersectObjects:function(Q,L,l){return this._raycaster.intersectObjects(Q,L,l)},getLineLength:function(e){this.validate();var c=this.getData3dUI(e);if(c&&c.getCache){var d=c.getCache();if(d)return d[d.length-1].length}return 0},getLineOffset:function(Q,M){var s=this.getData3dUI(Q);if(s&&s.getCache){var v=s.getCache();if(v)return Bj(v,M)}return a},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},moveCamera:function(p,P,C){var k=this,E=k.getEye();E=[E[0],E[1],E[2]];var I=k.getCenter();if(I=[I[0],I[1],I[2]],p||(p=E),P||(P=I),k._flyAnim&&k._flyAnim.stop(!0),C=ve(C),!C)return k.setEye(p[0],p[1],p[2]),k.setCenter(P[0],P[1],P[2]),delete k._flyAnim,!0;var x=[p[0]-E[0],p[1]-E[1],p[2]-E[2]],Z=[P[0]-I[0],P[1]-I[1],P[2]-I[2]];return C.action=function(M){k.setCenter(I[0]+Z[0]*M,I[1]+Z[1]*M,I[2]+Z[2]*M),k.setEye(E[0]+x[0]*M,E[1]+x[1]*M,E[2]+x[2]*M)},C._37o=function(){delete k._flyAnim},k._flyAnim=Ar(C)},flyTo:function(){function h(Z,v,I){if(I instanceof S.Node){Y.fromArray(Sb(I,v.getMat(I)));var $=I.getAnchor3d();Z.push((new Eo).set(0-$.x,0-$.y,0-$.z).applyMatrix4(Y)),Z.push((new Eo).set(0-$.x,0-$.y,1-$.z).applyMatrix4(Y)),Z.push((new Eo).set(0-$.x,1-$.y,0-$.z).applyMatrix4(Y)),Z.push((new Eo).set(0-$.x,1-$.y,1-$.z).applyMatrix4(Y)),Z.push((new Eo).set(1-$.x,0-$.y,0-$.z).applyMatrix4(Y)),Z.push((new Eo).set(1-$.x,0-$.y,1-$.z).applyMatrix4(Y)),Z.push((new Eo).set(1-$.x,1-$.y,0-$.z).applyMatrix4(Y)),Z.push((new Eo).set(1-$.x,1-$.y,1-$.z).applyMatrix4(Y))}}var B=new Eo,m=new Eo,M=new Eo,x=new Eo,Y=new If,A=new S.Math.Quaternion,_=new Xp;return function(H,D,Q){var g=this;if(Q!==i)D={animation:D,ratio:Q};else{var C=typeof D;("boolean"===C||"object"===C&&D.duration)&&(D={animation:D})}D=D||{},B.fromArray(g.getEye()),m.fromArray(g.getCenter());var V,P,y=[],X=D.center,s=D.distance===i;if(X&&M.fromArray(X),H instanceof S.Node)X||M.fromArray(H.p3()),s&&(h(y,g,H),V=y.length);else{if(H||(H=g.dm().getDatas()),!H.length)return;if((s||!X)&&(y=[],H.forEach(function(f){h(y,g,f)}),V=y.length),!V)return;if(!X){for(M.set(0,0,0),P=0;V>P;P++)M.add(y[P]);M.multiplyScalar(1/V)}}if(g.setCenter(M.x,M.y,M.z),x.subVectors(B,m),D.direction||D.worldDirection){!D.worldDirection&&H instanceof S.Node?A.setFromEuler(_.set(H.r3(),H.getRotationMode(),!0)):A.set(0,0,0,1);var Z=x.length();x.fromArray(D.worldDirection||D.direction).applyQuaternion(A).setLength(Z)}if(s){for(var d,n,f,K,N,e=g.getNear(),J=10,Q=D.ratio||.8;J--;){for(g._eye[0]=x.x+M.x,g._eye[1]=x.y+M.y,g._eye[2]=x.z+M.z,d=Iq(g),wc(d,d,Dn(g)),K=!0,N=-1/0,P=0;V>P;P++){if(f=y[P],n=Uf([f.x,f.y,f.z,1],d),n[3]<e&&J){x.multiplyScalar(2),K=!1;break}N=Math.max(N,Math.max(Math.abs(n[0]),Math.abs(n[1]))/Q-n[3])}if(K)break}x.setLength(N+x.length()).add(M)}else x.setLength(D.distance).add(M);g._flyAnim&&g._flyAnim.stop(!0);var z=ve(D.animation);if(z){g.setEye(B.x,B.y,B.z),g.setCenter(m.x,m.y,m.z);var I=(new Eo).subVectors(x,B),E=(new Eo).subVectors(M,m),L=new Eo,T=new Eo;return z.action=function(F){L.copy(B).addScaledVector(I,F),T.copy(m).addScaledVector(E,F),g.setCenter(T.x,T.y,T.z),g.setEye(L.x,L.y,L.z)
},z._37o=function(){delete g._flyAnim},{lastEye:B,lastCenter:m,eye:x,center:M,animation:g._flyAnim=Ar(z)}}return g.setEye(x.x,x.y,x.z),delete g._flyAnim,{lastEye:B,lastCenter:m,eye:x,center:M}}}(),getBoundingBox:function(){function h(g,L,n){k.fromArray(Sb(n,L.getMat(n)));var t=n.getAnchor3d();g.push((new Eo).set(0-t.x,0-t.y,0-t.z).applyMatrix4(k)),g.push((new Eo).set(0-t.x,0-t.y,1-t.z).applyMatrix4(k)),g.push((new Eo).set(0-t.x,1-t.y,0-t.z).applyMatrix4(k)),g.push((new Eo).set(0-t.x,1-t.y,1-t.z).applyMatrix4(k)),g.push((new Eo).set(1-t.x,0-t.y,0-t.z).applyMatrix4(k)),g.push((new Eo).set(1-t.x,0-t.y,1-t.z).applyMatrix4(k)),g.push((new Eo).set(1-t.x,1-t.y,0-t.z).applyMatrix4(k)),g.push((new Eo).set(1-t.x,1-t.y,1-t.z).applyMatrix4(k))}var k=new If;return function(y){if(y=y||this.sm().getSelection(),y instanceof S.Node&&(y=[y]),0===y.length)return a;var x=[];y.forEach(function(b){h(x,this,b)},this);var v=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];return x.forEach(function(n){v[0]=Math.min(n.x,v[0]),v[1]=Math.min(n.y,v[1]),v[2]=Math.min(n.z,v[2]),s[0]=Math.max(n.x,s[0]),s[1]=Math.max(n.y,s[1]),s[2]=Math.max(n.z,s[2])}),{min:v,max:s}}}()}),Qh.RenderEnv=function(p){this.gv=p,this.enable=!1},n.defineProperties(Qh.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(j){this._debugOn=j,this.capture&&this.capture()}}}),n.assign(Qh.RenderEnv.prototype,{renderEnvToCube:function(Y,c,T,v){var D=this,X=D.gv;if(!Y||!c||!T)return D.enable=!1,D._42=null,void 0;D.enable=!0;var l=Math.floor(v/Y*c),z=X.getGL(),h=D._renderTargets;h?h.length<T&&(h=D._renderTargets=h.concat(new Array(T-h.length))):h=D._renderTargets=new Array(T);for(var H=0;T>H;H++)h[H]?h[H].setSize(z,v,l):h[H]=new Qh.RenderTarget(X,z,v,l);var B=!1;D.capture=function(){B=!0,X._42(),B=!1};var W=new Eo,o=new Eo,J=new Eo,G=new Eo,y=(new Eo).setY(0),F=2*Math.PI/T,e=Y/2/Math.tan(Math.PI/T),k=2*Math.atan2(c/2,e),I=Y/c;D._42=function(l,L,R,O){var H=D._debugOn;if(!B&&!H)return!1;W.copy(X.getEye()),G.copy(X.getCenter()).sub(W);var n=Math.atan2(G.z,G.x),b=X.getNear(),Z=X.getFovy(),M=X.getAspect();o.copy(X.getCenter());for(var K,r=0;T>r;r++)if(K=h[r],y.setZ(Math.cos(n)).setX(Math.sin(n)).multiplyScalar(e),n-=F,J.addVectors(W,y),X.setNear(e),X.setCenter([J.x,J.y,J.z]),X.setFovy(k),X.setAspect(I),H){var _=Math.round(L/T);l.viewport(_*r,0,_,R),O()}else Vb(l,K.frame),l.viewport(0,0,K.width,K.height),l.clear(l.COLOR_BUFFER_BIT),O(),pi(l),K.assureTexture();return X.setNear(b),X.setCenter([o.x,o.y,o.z]),X.setFovy(Z),X.setAspect(M),!0},D.capture()},getTextureInfo:function(n){var Y=this._renderTargets;if(!Y)return null;var E=this._renderTargets[n];return E?{index:n,texture:E.texture,textureName:E.uuid}:null}}),n.assign(Qh.Graph3dView.prototype,{renderEnvToCube:function(o,x,C,P){var y=this;y.envRenderer||(y.envRenderer=new Qh.RenderEnv(y)),y.envRenderer.renderEnvToCube(o,x,C,P)}}),Qh.RenderTarget=function(H,e,X,J,N){var m=this;N=N||{},m.uuid=S.Math.generateUUID(),m.gv=H,m.init(H,e,N),m.setSize(e,X,J)},n.assign(Qh.RenderTarget.prototype,{init:function(u,F,C){var D=this,$=D.texture=F.createTexture();F.activeTexture(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,$),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_S,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_WRAP_T,F.CLAMP_TO_EDGE),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MIN_FILTER,C.minFilter||F.LINEAR),F.texParameteri(F.TEXTURE_2D,F.TEXTURE_MAG_FILTER,C.magFilter||F.LINEAR),F.bindTexture(F.TEXTURE_2D,null),D.render=F.createRenderbuffer(),D.frame=F.createFramebuffer(),u._2O[D.uuid]=$},assureTexture:function(){var r=this,v=r.uuid,s=r.gv._2O;s[v]||(s[v]=r.texture)},setSize:function(s,q,S){var H=this;if(H.width!==q||H.height!==S){var B=s.RGBA,z=s.TEXTURE_2D,U=s.RENDERBUFFER,O=s.FRAMEBUFFER;pc(s,H.texture),s.texImage2D(z,0,B,q,S,0,B,s.UNSIGNED_BYTE,a),s.bindRenderbuffer(U,H.render),s.renderbufferStorage(U,s.DEPTH_COMPONENT16,q,S),Vb(s,H.frame),s.framebufferTexture2D(O,s.COLOR_ATTACHMENT0,z,H.texture,0),s.framebufferRenderbuffer(O,s.DEPTH_ATTACHMENT,U,H.render),pc(s,a),s.bindRenderbuffer(U,a),pi(s),H.width=q,H.height=S}},toCanvas:function(){var Q=this,T=Q.gv.getGL();Vb(T,Q.frame);var e=Q.width,c=Q.height,G=new Uint8Array(4*e*c);T.readPixels(0,0,e,c,T.RGBA,T.UNSIGNED_BYTE,G),pi(T);var z=H.createElement("canvas");z.width=e,z.height=c;var m=z.getContext("2d"),r=m.createImageData(e,c);return r.data.set(G),m.putImageData(r,0,0),z}});var Id=Qh.Interactor=function(H){this.gv=H};Db("Interactor",n,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var ob=Qh.DefaultInteractor=function(g){fm(ob,this,[g])};Db("DefaultInteractor",Id,{handle_contextmenu:function(t){yn(t)},handle_mousewheel:function(U){this.gv.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(v){2===v.axis&&this.gv.handleScroll(v,-v.detail)},handle_keydown:function(n){this.gv.handleKeyDown(n)},handle_mousedown:function(K){this.handle_touchstart(K)},handle_touchstart:function(z){yn(z);var K=this,f=K.gv,P=Rl(z),U=f.getDataInfoAt(z),v=U?U.data:a,D=U?U.part:a,i=f.sm(),n=Nq(z),L=zg(z);f.setFocus(z)&&(K._62O=a,K._57I=a,v?Ql(z)?i.co(v)?i.rs(v):i.as(v):i.co(v)||i.ss(v):P&&(Ql(z)?f.isRectSelectable()&&(K._62O=Eh):K._57I=_o(z)),K._31Q&&(To(K._31Q),delete K._31Q,delete K._32Q),K._62O||(f.isFirstPersonMode()&&(Bp(z)||L>2?K._62O="pan":f.isMouseRoamable()||Ye?(K._62O="roaming",K.foward=n&&Rl(z),K._32Q=qj(),K._31Q=Jj(K.tick,K)):P||(K._62O="roaming")),K._62O||(P&&n&&Kk[D]?(K._62O=D,K.p3=v.p3()):P&&n&&Td(v)&&f.isSelected(v)?f.isMovable(v)?(K._62O="move",K.p3=v.p3(),K.movedata=v):f.isInteractive(v)&&(K._62O="none"):Ye&&(L>2?K._62O="pan":2===L&&(K.dist=Mg(z),K._62O="pinch")))),K.point=f.lp(z),ed(K,z),uc(z)?f.handleDoubleClick(z,v,D):f.handleClick(z,v,D))},tick:function(){var r=this,H=r.gv,U=H._moveStep;r.point&&H.isWalkable()&&(r._32Q&&(U*=(qj()-r._32Q)/50),H.walk(r.foward?U:-U),r._32Q=qj(),r._31Q=Jj(r.tick,r))},handle_mouseup:function(R){this.handle_touchend(R)},handle_touchend:function(q){var Z=this._57I;Z&&(Og(Z,_o(q))<=1&&this.gv.sm().cs(),this._57I=a)},handleWindowMouseMove:function(y){this.handleWindowTouchMove(y)},handleWindowTouchMove:function(M){var B,u,f=this,t=f.gv,y=f._62O,q=f.point,H=t.dm(),n=t.lp(M),i=n.x-q.x,J=n.y-q.y,x=t.getWidth(),X=t.getHeight();if(x&&X){var z=-$*i/x,e=-$*J/X;if("roaming"===y)f.rotate(M,z/2,e/2);else if(y===Bo||y===pp||y===uk)t._86O||H.beginTransaction(),t.fi({kind:t._86O?"betweenEditRotation":"beginEditRotation",event:M}),t._86O=1,t.sm().each(function(I){if(Td(I)&&t.isRotationEditable(I)){var A=G(z)>G(e)?z:e;y===Bo?I.setRotationX(I.getRotationX()+A):y===pp?I.setRotationY(I.getRotationY()+A):y===uk&&I.setRotationZ(I.getRotationZ()+A)}});else if("move"===y||Kk[y]){y===wr||y===Tf||y===jk?(t._87O||H.beginTransaction(),t.fi({kind:t._87O?"betweenEditScale":"beginEditScale",event:M}),t._87O=1):(t._moving||H.beginTransaction(),t.fi({kind:t._moving?"betweenMove":"beginMove",event:M}),t._moving=1);var b,R=f.p3,l=t.getPositionInfo(R),E=Dn(t);b=y===ji?"x":y===pj?"y":y===Ke?"z":y===wr?"sx":y===Tf?"sy":y===jk?"sz":t.getMoveMode(M,f.movedata),i=i/x*l.width,J=-1*J/X*l.height;var V,N,s=[E[0]*i,E[4]*i,E[8]*i],F=[E[1]*J,E[5]*J,E[9]*J],p=s[0]+F[0],c=s[1]+F[1],P=s[2]+F[2],A=[R[0]+p,R[1]+c,R[2]+P],r=sm(t.getEye(),A,!0);if("xyz"===b?(V=A,t.moveSelection(p,c,P)):"xz"===b?(V=Nj(t,R,[0,1,0],A),V&&t.moveSelection(V[0]-R[0],0,V[2]-R[2])):"xy"===b?(V=Nj(t,R,[0,0,1],A),V&&t.moveSelection(V[0]-R[0],V[1]-R[1],0)):"yz"===b?(V=Nj(t,R,[1,0,0],A),V&&t.moveSelection(0,V[1]-R[1],V[2]-R[2])):"x"===b||"sx"===b?(r[0]=0,V=Nj(t,R,r,A),V&&(N=V[0]-R[0],"x"===b?t.moveSelection(N,0,0):t.sm().each(function(C){Td(C)&&t.isSizeEditable(C)&&(B=C.getScaleX()+N/100,u=B/C.getScaleX(),C.setScaleX(B),Bp(M)&&(C.setScaleY(C.getScaleY()*u),C.setScaleTall(C.getScaleTall()*u)))}))):"y"===b||"sy"===b?(r[1]=0,V=Nj(t,R,r,A),V&&(N=V[1]-R[1],"y"===b?t.moveSelection(0,N,0):t.sm().each(function(I){Td(I)&&t.isSizeEditable(I)&&(B=I.getScaleTall()+N/100,u=B/I.getScaleTall(),I.setScaleTall(B),Bp(M)&&(I.setScaleY(I.getScaleY()*u),I.setScaleX(I.getScaleX()*u)))}))):("z"===b||"sz"===b)&&(r[2]=0,V=Nj(t,R,r,A),V&&(N=V[2]-R[2],"z"===b?t.moveSelection(0,0,N):t.sm().each(function(O){Td(O)&&t.isSizeEditable(O)&&(B=O.getScaleY()+N/100,u=B/O.getScaleY(),O.setScaleY(B),Bp(M)&&(O.setScaleX(O.getScaleX()*u),O.setScaleTall(O.getScaleTall()*u)))}))),!V)return;f.p3=V}else if(y===Eh){var L=f.div;L||(L=f.div=we(),Oc(f.getView(),L),L.op=q,L.style.background=t.getRectSelectBackground()),t.fi({kind:t._rectSelecting?"betweenRectSelect":"beginRectSelect",event:M}),t._rectSelecting=1,L.rect=sq(L.op,n),dp(L,L.rect)}else if("pinch"===y&&2===zg(M)){t.fi({kind:t._pinching?"betweenPinch":"beginPinch",event:M}),t._pinching=1;var N=Mg(M);t.handlePinch(N,f.dist),f.dist=N}else"pan"===y||Bp(M)?f.pan(M,i,J):"none"===y||t.isFirstPersonMode()||(Rl(M)?f.rotate(M,z,e):(f.pan(M,i,0),t.isWalkable()&&(t.fi({kind:t._walking?"betweenWalk":"beginWalk",event:M}),t._walking=1,t.walk(J/t.getHeight()*t.getCenterInfo().height))));f.point=n}},pan:function(k,b,m){var W=this.gv;if(W.isPannable()){var c=W.getWidth(),P=W.getHeight();if(!c||!P)return;var v=W.getCenterInfo(),T=b/c*v.width,j=-1*m/P*v.height;W.fi({kind:W._panning?"betweenPan":"beginPan",event:k}),W._panning=1,W.pan(-T,-j)}},rotate:function(H,R,t){var v=this.gv;v.isRotatable()&&(v.fi({kind:v._rotating?"betweenRotate":"beginRotate",event:H}),v._rotating=1,v.rotate(R,t))},handleWindowMouseUp:function(g){this.handleWindowTouchEnd(g)},handleWindowTouchEnd:function(K){var U=this,L=U.gv,i=L.dm(),P=U.div;if(P){var M=L.getDatasInRect(P.rect);if(!M.isEmpty()){var H=L.sm(),G=H.toSelection();M.each(function(u){H.co(u)?G.remove(u):G.add(u)}),H.ss(G)}Tn(P)}L._moving&&(delete L._moving,L.fi({kind:"endMove",event:K}),L.onMoveEnded(),i.endTransaction()),L._panning&&(delete L._panning,L.fi({kind:"endPan",event:K}),L.onPanEnded()),L._rotating&&(delete L._rotating,L.fi({kind:"endRotate",event:K}),L.onRotateEnded()),L._86O&&(delete L._86O,L.fi({kind:"endEditRotation",event:K}),i.endTransaction()),L._87O&&(delete L._87O,L.fi({kind:"endEditScale",event:K}),i.endTransaction()),L._pinching&&(delete L._pinching,L.fi({kind:"endPinch",event:K}),L.onPinchEnded()),L._rectSelecting&&(delete L._rectSelecting,L.fi({kind:"endRectSelect",event:K}),L.onRectSelectEnded()),L._walking&&(delete L._walking,L.fi({kind:"endWalk",event:K}),L.onWalkEnded()),U.dist=U.point=U._62O=U.p3=U.movedata=U.div=U._57I=U._32Q=U._31Q=U.foward=a}});var fd=Qh.MapInteractor=function(A){fm(fd,this,[A]),this._minPhi=0,this._maxPhi=5*O/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01,this._panButton="right"};Db("MapInteractor",Id,{handle_contextmenu:function(b){yn(b)},handle_mousewheel:function(n){this.gv.handleScroll(n,n.wheelDelta/40)},handle_DOMMouseScroll:function(j){2===j.axis&&this.gv.handleScroll(j,-j.detail)},handle_keydown:function(v){this.gv.handleKeyDown(v)},handle_mousedown:function(s){this.handle_touchstart(s)},handle_touchstart:function(j){yn(j);var g=this,X=g.gv;if(X.setFocus(j)){X.lp(j);var T=X.getDataInfoAt(j),C=T?T.data:a,u=T?T.part:a;if(!C||!X.isInteractive(C)){var t=g.editing={point:X.lp(j)};Ye?t.touch=!0:(t.touch=!1,t.pan="left"===this.panButton===Rl(j)),ed(g,j)}uc(j)?X.handleDoubleClick(j,C,u):X.handleClick(j,C,u)}},handle_mouseup:function($){this.handle_touchend($)},handle_touchend:function(){},handleWindowMouseMove:function(o){this.handleWindowTouchMove(o)},handleWindowTouchMove:function(k){var V=this,H=V.gv,K=V.editing;if(K){var S=H.lp(k),G=K.point,q=S.x-G.x,W=S.y-G.y;if(!K.moved){if(Math.abs(q)<V.threshold&&Math.abs(W)<V.threshold&&!(k.touches&&k.touches.length>1))return;K.moved=!0}if(K.point=S,K.touch){var N=k.touches.length;if(2!==N)V.pan(k,q,W);else{if(1>=N)return;var Y=k.touches,n={x:Y[0].clientX,y:Y[0].clientY},d={x:Y[1].clientX,y:Y[1].clientY},v={x:d.x-n.x,y:d.y-n.y},j=K.lastCenter,Z=Math.atan2(v.y,v.x),i=K.theta,C=0;i==a?i=K.theta=Z:(C=Z-i,K.thetaStarted||Math.abs(C)>V.touchRotateThreshold?(K.thetaStarted=!0,K.theta=Z):C=0);var w=O*(n.y+d.y)/2/H.getHeight(),u=K.phi,c=0;u==a?u=K.phi=w:(c=w-u,K.phiStarted||Math.abs(c)>V.touchRotateThreshold?(K.phiStarted=!0,K.phi=w):c=0);var X,F=Math.sqrt(v.x*v.x+v.y*v.y),L=K.vlen;if(L){var h=n.x-j.x,J=n.y-j.y,t=d.x-j.x,T=d.y-j.y,f=Math.sqrt(h*h+J*J),g=Math.sqrt(t*t+T*T),z=L/2,M=V._sign2(f-z),l=V._sign2(g-z);0>M*l||0===M&&0===l?(X=1,K.vlen=F):(X||(X=F/L),K.scaleStarted||Math.abs(X-1)>V.touchScaleThreshold?(K.vlen=F,K.scaleStarted=!0):X=1)}else L=K.vlen=F,X=1;1!==X&&H.setZoom(X),(c||C)&&V.rotate(k,C,-c),K.lastCenter={x:(d.x+n.x)/2,y:(d.y+n.y)/2}}}else if(K.pan)V.pan(k,q,W);else{var Q=H.getWidth(),s=H.getHeight();if(!Q||!s)return;var E=-$*q/Q,A=-$*W/s;V.rotate(k,E,A)}}},_sign2:function(L){return Math.abs(L)<this._touchScaleCheckAccuracy?0:L>0?1:-1},handleWindowMouseUp:function(W){this.handleWindowTouchEnd(W)},handleWindowTouchEnd:function(X){var I=this,_=I.editing;if(I.editing=null,_){var F=I.gv;if(_.moved||_.pan!==("left"===this.panButton))F._panning=null,F._rotating=null,F.fi({kind:_.pan?"endPan":"endRotate",event:X});else{var p=F.getDataAt(X);p?F.sm().setSelection([p]):F.sm().clearSelection()}}},pan:function(e,t,w){var y=this,S=y.gv;if(S.isPannable()){var W=S.getWidth(),x=S.getHeight();if(W&&x){var C=S.getCenterInfo(),G=-t/W*C.width,H=1*w/x*C.height;S.fi({kind:S._panning?"betweenPan":"beginPan",event:e}),S._panning=1;var f=y.keepHorizon,k=y.editing.touch;if((k&&e.touches&&e.touches.length>1||!k&&Bp(e))&&(f=!f),!f)return S.pan(G,H);if(G||H){var E=Dn(S),M=[E[0]*G,E[4]*G,E[8]*G],i=[E[1],0,E[9]],J=Math.sqrt(i[0]*i[0]+i[2]*i[2]);J&&(i=[i[0]/J*H,0,i[2]/J*H]);var Z=M[0]+i[0],Q=M[1]+i[1],_=M[2]+i[2],R=S._center,d=S._eye;R[0]+=Z,R[1]+=Q,R[2]+=_,d[0]+=Z,d[1]+=Q,d[2]+=_,S.fp(Ck,a,d),S.fp($i,a,R)}}}},rotate:function(H,W,g){var T=this,F=T.gv;if(F.isRotatable()){var _=F._center,K=F._eye,c=sm(K,_),V=J(C(c[0]*c[0]+c[2]*c[2]),c[1]),b=V+g;b=Math.max(T.minPhi,Math.min(T.maxPhi,b)),g=b-V,F.fi({kind:F._rotating?"betweenRotate":"beginRotate",event:H}),F._rotating=1,F.rotate(W,g)}}}),n.defineProperties(fd.prototype,{panButton:{get:function(){return this._panButton},set:function(u){this._panButton=u}},minPhi:{get:function(){return this._minPhi},set:function(L){this._minPhi=L}},maxPhi:{get:function(){return this._maxPhi},set:function(i){this._maxPhi=i}},keepHorizon:{get:function(){return this._keepHorizon},set:function(C){this._keepHorizon=C}},threshold:{get:function(){return this._threshold},set:function(C){this._threshold=C}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(F){this._touchScaleThreshold=F}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(z){this._touchRotateThreshold=z}}});var Ym=function(e){this.gv=e};ri(Ym,n,{_iv:!0,iv:function(){this._iv=!0},face:function(i,u){var A=this,R=A.gv.getGL();if(!R||!Td(i))return a;var F=u.x,Z=u.width,r=u.height,t=A.height-u.y-r,b=P(Z/2),Y=new Uint8Array(4*Z*r),M=0;for(A.iv(),A.validate(i),Vb(R,A.frame),R.readPixels(F,t,Z,r,R.RGBA,R.UNSIGNED_BYTE,Y),pi(R),A.iv();b>=M;M++)for(var s=b-M,w=b+M,f=s;w>=f;f++)for(var g=s;w>=g;g++)if(f===s||f===w||g===s||g===w){var m=Nk.m[Y[4*(f*Z+g)]];if(m)return m}},get:function(X,f){this.validate();var x=this,q=x.gv.getGL();if(!q)return a;var z,I,l=X.x,o=X.width,e=X.height,s=x.height-X.y-e,N=P(o/2),n=new Uint8Array(4*o*e),c=0,B=n.length,$=f?a:new kg,K=f?a:{};if(Vb(q,x.frame),q.readPixels(l,s,o,e,q.RGBA,q.UNSIGNED_BYTE,n),pi(q),f){for(;N>=c;c++)for(var F=N-c,V=N+c,k=F;V>=k;k++)for(var b=F;V>=b;b++)if((k===F||k===V||b===F||b===V)&&(z=x.info(n,4*(k*o+b))))return z}else for(;B>c;c+=4)z=x.info(n,c),z&&(I=z.data,K[I._id]||($.add(I),K[I._id]=I));return $},info:function(D,l){return this.colorMap[(D[l]<<16)+(D[l+1]<<8)+D[l+2]+((127&D[l+3])<<24)]},validate:function(q){var G=this,Y=G.gv,g=Y.getGL();if(g){var j=Y.getWidth(),H=Y.getHeight(),z=g.RGBA,b=g.TEXTURE_2D,E=g.RENDERBUFFER,W=g.FRAMEBUFFER;G.texture||(G.texture=Ud(g),G.render=g.createRenderbuffer(),G.frame=g.createFramebuffer()),(G.width!==j||G.height!==H)&&(pc(g,G.texture),g.texImage2D(b,0,z,j,H,0,z,g.UNSIGNED_BYTE,a),yp(g,g.TEXTURE_MIN_FILTER,g.LINEAR),g.bindRenderbuffer(E,G.render),g.renderbufferStorage(E,g.DEPTH_COMPONENT16,j,H),Vb(g,G.frame),g.framebufferTexture2D(W,g.COLOR_ATTACHMENT0,b,G.texture,0),g.framebufferRenderbuffer(W,g.DEPTH_ATTACHMENT,E,G.render),pc(g,a),g.bindRenderbuffer(E,a),pi(g),G.width=j,G.height=H),G._iv&&(G._iv=!1,Vb(g,G.frame),Y._42(q||(G.colorMap={}),1),pi(g))}}});var wq=function(z){this.gv=z};ri(wq,n,{gap:0,size:0,_42:function(r,v){var C=this,$=C.gv,W=$._gridGap,E=$._gridSize;if($._gridVisible){if(C.gap!==W||C.size!==E){for(var n=[],Z=$._gridSize/2,U=W*Z,z=0;2*Z+1>z;z++){var R=6*z,B=6*(2*Z+1)+R;n[R]=-U,n[R+1]=0,n[R+2]=-U+z*W,n[R+3]=U,n[R+4]=0,n[R+5]=-U+z*W,n[B]=-U+z*W,n[B+1]=0,n[B+2]=-U,n[B+3]=-U+z*W,n[B+4]=0,n[B+5]=U}C.vs=new _p(n),C.gap=W,C.size=E}Oo($),Dk(r,v),ui(r),In(r,v,1,$._gridColor,$._buffer.vs,C.vs),cc(r,0,C.vs.length/3,r.LINES),nf(r),fj(r,v)}else C.vs=C.gap=C.size=a}});var Cm=function(Q){this.gv=Q};ri(Cm,n,{_42:function(X,$){var n=this.gv,Z=n._buffer.vs,M=n._axisXColor,K=n._axisYColor,i=n._axisZColor,N=n._originAxisVisible,A=n._centerAxisVisible;if(N||A){var W=o?X.TRIANGLES:X.TRIANGLE_FAN,H=X.LINES;if(Oo(n),Dk(X,$),ui(X),N){var s=n.getCenterInfo(),x=t(s.width,s.height)/5,g=.8*x,S=.05*x;In(X,$,1.5,M,Z,new _p([0,0,0,x,0,0,g,S,0,g,0,S,g,-S,0,g,0,-S,g,S,0,0,0,0,0,x,0,S,g,0,0,g,S,-S,g,0,0,g,-S,S,g,0,0,0,0,0,0,x,S,0,g,0,S,g,-S,0,g,0,-S,g,S,0,g])),cc(X,0,2,H),cc(X,1,6,W),In(X,$,a,K),cc(X,7,2,H),cc(X,8,6,W),In(X,$,a,i),cc(X,14,2,H),cc(X,15,6,W)}if(A){var h=n._center,I=h[0],O=h[1],v=h[2],s=n.getPositionInfo(h);x=t(s.width,s.height)/20,In(X,$,1.5,M,Z,new _p([I,O,v,I+x,O,v,I,O,v,I,O+x,v,I,O,v,I,O,v+x])),cc(X,0,2,H),In(X,$,a,K),cc(X,2,2,H),In(X,$,a,i),cc(X,4,2,H)}nf(X),fj(X,$)}}});var Ki=function(t){this.gv=t,this.onMouseOver=this.onMouseOver.bind(this),this.mode=Ki.Mode.Disable};Ki.Mode={Disable:0,Selection:1,MouseOver:2},ri(Ki,n,{onMouseOver:function(p){x.preventDefault(p);var o=this.gv.getDataAt(p);o!==this.mouseOverData&&(this.mouseOverData=o,this.gv.iv())},setFetchTargetFunc:function(x){this.fetchTargetFunc=x},_42:function(A,Y){var N,e=this,K=e._mode;if(K!==Ki.Mode.Disable&&(K===Ki.Mode.Selection?N=e.gv.sm().getSelection().toArray(function(I){return I.s("highlight.visible")}):K===Ki.Mode.MouseOver&&e.mouseOverData&&e.mouseOverData.s("highlight.visible")&&(N=[e.mouseOverData]),e.fetchTargetFunc&&(N=e.fetchTargetFunc(N)),N&&N.length)){var v=e.gv,x=v.vr.isPresenting(),Q=v.getWidth();if(x){var j=v.getWidth;Q/=2,v.getWidth=function(){return Q};var R=v.getViewport()}var V,O=v.getDevicePixelRatio(),B=Q*O,Z=v.getHeight()*O;(V=e._renderTarget)?V.setSize(A,B,Z):e._renderTarget=V=new Qh.RenderTarget(v,A,B,Z),Vb(A,V.frame),v.drawFilter=function(x){return N.indexOf(x)<0?!0:void 0},v._42({}),v.drawFilter=null,pi(A),x&&(v.getWidth=j,v.setViewport(A,R[0],R[1],R[2],R[3])),e.shader||(e.shader=new Li.Shader(A,lg.vs,lg.fs));var z=e.shader;if(e.shader.bind(),A.enable(A.BLEND),A.activeTexture(A.TEXTURE0+0),A.bindTexture(A.TEXTURE_2D,V.texture),z.uniforms.image=0,z.uniforms.textureSize=[B,Z],z.uniforms.edgeWidth=W["highlight.width"],e.highlightColor!==W["highlight.color"]){var U=Yl(e.highlightColor=W["highlight.color"]);e.highlightColorData=[U[0]/255,U[1]/255,U[2]/255,U[3]/255]}z.uniforms.edgeColor=e.highlightColorData,e.ibuffer?(e.ibuffer.upload(),e.vbuffer.upload()):(e.ibuffer=Li.Buffer.createIndexBuffer(A,new Uint16Array([0,2,1,1,2,3])),e.vbuffer=Li.Buffer.createVertexBuffer(A,new Float32Array([0,0,1,0,0,1,1,1]))),z.attributes.pos.pointer(e.vbuffer),A.drawElements(A.TRIANGLES,6,A.UNSIGNED_SHORT,0),A.disable(A.BLEND),A.bindTexture(A.TEXTURE_2D,null),A.useProgram(Y)}}}),n.defineProperties(Ki.prototype,{mode:{get:function(){return this._mode},set:function(z){var K=this._mode;z!==K&&(this._mode=z,z===Ki.Mode.MouseOver?this.gv.getView().addEventListener("mousemove",this.onMouseOver,!1):K===Ki.Mode.MouseOver&&this.gv.getView().removeEventListener("mousemove",this.onMouseOver))}}});var lg={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","uniform vec2 textureSize;","uniform float edgeWidth;","uniform vec4 edgeColor;","varying vec2 vUv;","float getCol(vec2 coord) {","return texture2D(image, coord).a;","}","void main() {","vec2 cc = vUv;","float center = getCol(cc);","float dx = edgeWidth / textureSize.x;","float dy = edgeWidth / textureSize.y;","vec2 coord;","float topLeft = getCol(cc+vec2(-dx, -dy));","float top = getCol(cc+vec2(0.0, -dy));","float topRight = getCol(cc+vec2(dx, -dy));","float left = getCol(cc+vec2(-dx, 0.0));","float right = getCol(cc+vec2(dx, 0.0));","float bottomLeft = getCol(cc+vec2(-dx, dy));","float bottom = getCol(cc+vec2(0.0, dy));","float bottomRight = getCol(cc+vec2(dx, dy));","float v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;","float h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;","float edge = sqrt(h * h + v * v);","edge = smoothstep(0.9, 1.0, edge);","if (edge < 0.5) {","discard;","}","gl_FragColor = edgeColor;","}"].join("\n")},Rn=function(b){this.gv=b},ji="edit_tx",pj="edit_ty",Ke="edit_tz",Bo="edit_rx",pp="edit_ry",uk="edit_rz",wr="edit_sx",Tf="edit_sy",jk="edit_sz",Kk={};Kk[ji]=1,Kk[pj]=1,Kk[Ke]=1,Kk[Bo]=1,Kk[pp]=1,Kk[uk]=1,Kk[wr]=1,Kk[Tf]=1,Kk[jk]=1,ri(Rn,n,{_42:function(Y,w,i){var u=this,V=u.gv,_=V.sm().ld();if(_&&V.isEditable(_)&&!V.isEditHelperDisabled()&&Td(_)&&(!V.isFirstPersonMode()||!V.isMouseRoamable()&&!Ye)){Oo(V);var z,Q,P=V.isMovable(_),f=V.isRotationEditable(_),r=V.isSizeEditable(_),S=V._axisXColor,D=V._axisYColor,n=V._axisZColor,j=V._editSizeColor,A=_.p3(),T=Og(V.getEye(),A)/10,o=T/(i?5:10),a=.7*T,m=.4*a,v=A[0],h=A[1],F=A[2];z=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],P&&u._17O(Y,w,_,i,ji,S,z,[v,h-o,F,v+a,h-o,F,v+a,h,F,v+a,h,F,v,h,F,v,h-o,F,v,h-o,F+o,v+a,h-o,F+o,v+a,h-o,F,v+a,h-o,F,v,h-o,F,v,h-o,F+o]),Q=v+a,r&&u._17O(Y,w,_,i,wr,j,z,[Q,h-o,F,Q+m,h-o,F,Q+m,h,F,Q+m,h,F,Q,h,F,Q,h-o,F,Q,h-o,F+o,Q+m,h-o,F+o,Q+m,h-o,F,Q+m,h-o,F,Q,h-o,F,Q,h-o,F+o]),Q+=m,f&&u._17O(Y,w,_,i,Bo,S,z,[Q,h-o,F,Q+m,h-o,F,Q+m,h,F,Q+m,h,F,Q,h,F,Q,h-o,F,Q,h-o,F+o,Q+m,h-o,F+o,Q+m,h-o,F,Q+m,h-o,F,Q,h-o,F,Q,h-o,F+o]),z=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],P&&u._17O(Y,w,_,i,pj,D,z,[v,h,F,v,h+a,F,v-o,h+a,F,v-o,h+a,F,v-o,h,F,v,h,F,v,h,F,v,h,F-o,v,h+a,F-o,v,h+a,F-o,v,h+a,F,v,h,F]),Q=h+a,r&&u._17O(Y,w,_,i,Tf,j,z,[v,Q,F,v,Q+m,F,v-o,Q+m,F,v-o,Q+m,F,v-o,Q,F,v,Q,F,v,Q,F,v,Q,F-o,v,Q+m,F-o,v,Q+m,F-o,v,Q+m,F,v,Q,F]),Q+=m,f&&u._17O(Y,w,_,i,pp,D,z,[v,Q,F,v,Q+m,F,v-o,Q+m,F,v-o,Q+m,F,v-o,Q,F,v,Q,F,v,Q,F,v,Q,F-o,v,Q+m,F-o,v,Q+m,F-o,v,Q+m,F,v,Q,F]),z=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],P&&u._17O(Y,w,_,i,Ke,n,z,[v,h,F,v,h,F+a,v,h-o,F+a,v,h-o,F+a,v,h-o,F,v,h,F,v,h-o,F,v-o,h-o,F,v-o,h-o,F+a,v-o,h-o,F+a,v,h-o,F+a,v,h-o,F]),Q=F+a,r&&u._17O(Y,w,_,i,jk,j,z,[v,h,Q,v,h,Q+m,v,h-o,Q+m,v,h-o,Q+m,v,h-o,Q,v,h,Q,v,h-o,Q,v-o,h-o,Q,v-o,h-o,Q+m,v-o,h-o,Q+m,v,h-o,Q+m,v,h-o,Q]),Q+=m,f&&u._17O(Y,w,_,i,uk,n,z,[v,h,Q,v,h,Q+m,v,h-o,Q+m,v,h-o,Q+m,v,h-o,Q,v,h,Q,v,h-o,Q,v-o,h-o,Q,v-o,h-o,Q+m,v-o,h-o,Q+m,v,h-o,Q+m,v,h-o,Q])}},_17O:function(A,v,q,i,I,V,W,Q){var F=this.gv._buffer;Fc(A,v,i,!0,q,I),js(A,v,a,!0,a,!0,a,!1),mb(A,v.uDiffuse,V),nj(A,F.vs,new _p(Q),v.aPosition),nj(A,F.ns,new _p(W),v.aNormal),ui(A),cc(A,0,12),nf(A),Wr(A,v)}});var gf=S.Raycaster=function(g){this.gv=g,this.maxTriangleTest=1/0};Kn("Raycaster",n,{intersect:function(S){var G=this,x=G.gv,g=x.getDataAt(S);return g?G.intersectObject(S,g):null},intersectObjects:function(B,U,h){var D,z,C,w,v=this,q=1/0,H=B.origin||(new Eo).fromArray(v.gv.getEye()),i=v.maxTriangleTest,Q=[];return U.forEach(function(z){h&&h(z)===!1||z.s("intersect")!==!1&&Q.push(z)}),Q.sort(function(c,T){return H.distanceToSquared2(c.p3())-H.distanceToSquared2(T.p3())}),v.countTriangles=0,Q.forEach(function(Y){v.countTriangles>i||(D=v.intersectObject(B,Y),D&&(z=H.distanceToSquared(D.world),q>z&&(C=Y,w=D,q=z)))}),v.countTriangles=0,{data:C,intersect:w}},intersectObject:function(j,V){if(j instanceof Nd)return this._intersectObjectImpl(j,V);var v,p,c=this,x=c.gv;p=x.unproject(j);var r=x.getEye();x.isOrtho()?(v=sm(x.getCenter(),r),v[0]+=v[0],v[1]+=v[1],v[2]+=v[2]):v=r,v=new Eo(v);var m=new Eo(p).sub(v).normalize(),k=new S.Math.Ray(v,m);return c._intersectObjectImpl(k,V)},_intersectObjectImpl:function(){function o(){var D=new Eo;return D.subVectors(O,N),z.subVectors(P,N),D.cross(z).normalize(),D}function M(C,o,h,O,v,z,D){return sn.barycoordFromPoint(C,o,h,O,Z),v.multiplyScalar(Z.x),z.multiplyScalar(Z.y),D.multiplyScalar(Z.z),v.add(z).add(D),v.clone()}var B=new If,g=new If,i=new Nd,f=new Eo,U=new Eo,u=new Eo,n=new Eo,V=new Eo,P=new Eo,N=new Eo,O=new Eo,y=new jl,p=new jl,G=new jl,z=new Eo,W={vs:Dd,is:Ll,uv:Ak},Z=new Eo;return function(x,h){var k=this.gv.getData3dUI(h),v=h.mat||k.mat;if(v){B.fromArray(v),g.getInverse(B),i.copy(x).applyMatrix4(g);var l,q,Q="body",X=k.shapeModel;if(X||(X=tl(k)),X||(h instanceof S.Node&&!(h instanceof S.Shape)?(l=!0,X=W):(q=!0,X=[k.left,k.front,k.right,k.back,k.top,k.bottom])),!X)return console.log("Can not find shape model."),null;mr(X)||(X=[X]);var r,_,R,I,J,m,a,z,D,w,C,H,K,Y,L,E,c=1/0,T=["","top_","bottom_"],e=!1;for(r=0,_=X.length;_>r;r++)if(K=X[r])for(R=0,I=T.length;I>R;R++)if(Y=T[R],a=K[Y+"vs"],z=K[Y+"is"],D=K[Y+"uv"]||K[Y+"tuv"],a){if(L=K[Y+"boundingBox"]){var C=i.intersectBox(L);if(!C)continue;if(i.origin.distanceTo(C)>c)continue;E=!1}else K[Y+"boundingBox"]=L=new S.Math.Box3,E=!0;for(J=0,m=z?z.length:a.length/3;m>J;J+=3)this.countTriangles++,z?(U.fromArray(a,3*z[J]),u.fromArray(a,3*z[J+1]),n.fromArray(a,3*z[J+2])):(U.fromArray(a,3*J),u.fromArray(a,3*(J+1)),n.fromArray(a,3*(J+2))),E&&(L.expandByPoint(U),L.expandByPoint(u),L.expandByPoint(n)),w=i.intersectTriangle(U,u,n,!0,f),w&&(H=i.origin.distanceTo(w),c>H&&(c=H,V.copy(w),P.copy(U),N.copy(u),O.copy(n),""!==Y?Q=Y.slice(0,-1):l?Q=ab[Math.floor(J/6)]:q&&(Q=ab[r]),D&&(e=!0,z?(y.fromArray(D,2*z[J]),p.fromArray(D,2*z[J+1]),G.fromArray(D,2*z[J+2])):(y.fromArray(D,2*J),p.fromArray(D,2*(J+1)),G.fromArray(D,2*(J+2))))))}if(!isFinite(c))return null;var F,t=V.clone().applyMatrix4(B);e&&(F=M(V,P,N,O,y,p,G));var A=o(P,N,O),d=o(P.applyMatrix4(B),N.applyMatrix4(B),O.applyMatrix4(B)),b=i.direction.dot(A);return b>0&&(A.multiplyScalar(-1),d.multiplyScalar(-1)),{world:t,local:V.clone(),worldNormal:d,normal:A,uv:F,part:Q}}}}()});var lh=function(V,R){this.gv=V,this.s=function(s,q,m){return q==a&&(q=m),q==a?R.getStyle(s):Cs(q,R,V)},this.data=R};ri(lh,n,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(p,z,P,w){var B=this,H=B.data;if(!(H instanceof Be)){var b,n,M,f,Q,k,s,K=B.gv,N=H._id,d=B.s("shape3d.alwaysOnTop")?null:B.s("batch"),y=K._batchIndexMap,Z=K._batchModelMap,g=K.isSelectable(H),c=K.getBrightness(H),J=c!=a&&1!==c;if(B.needValidate(p)){if(M=Ue(y,Z,H,d),B.validate(M,d?Dp[d]||xh:a),M&&(f=y[N],Q=f.size=M.vs.length/3-f.begin,s=M.rs))for(c=J?c:1,k=0;Q>k;k++)s.push(c);if(Td(H)){var h=K.getWireframeGeometry(H);if(h)Go(K,H,h);else{var W=K.getWireframe(H);W&&Go(K,H,W)}}B.labelInfo=B.label2Info=B.noteInfo=B.note2Info=B._38o=a,B._24O(Bn,"getLabel"),B._24O(pe,"getLabel2"),B._26O(Co,"getNote"),B._26O(mg,"getNote2"),B._15O(),B.interactiveInfo=K.isInteractive(H)?{}:a,B._iv=!1}J&&mb(p,z.uBrightness,c),mb(p,z.uAlphaTest,B.s("alphaTest")),mb(p,z.uUseEnvMap,H.s("envmap")?!0:!1),mb(p,z.uReflectivity,H.s("envmap")||.01),n=Fc(p,z,P,g,H,kq),n&&($g(n,y[N],Z),$g(n,K._polylineIndexMap[N],K._polylineModelMap),$g(n,K._wireframeIndexMap[N],K._wireframeModelMap)),y[N]||B._80o(p,z,w),K.isLabelVisible(H)&&((b=B.labelInfo)&&(Fc(p,z,P,g,H,Bn),B._28O(b,Bn,w)),(b=B.label2Info)&&(Fc(p,z,P,g,H,pe),B._28O(b,pe,w))),K.isNoteVisible(H)&&((b=B.noteInfo)&&(Fc(p,z,P,g,H,Co),B._29O(b,Co,w)),(b=B.note2Info)&&(Fc(p,z,P,g,H,mg),B._29O(b,mg,w))),(b=B._38o)&&B._99O(p,z,b,P,g,w),J&&mb(p,z.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return Jk},_80o:function(){},dispose:function(){},_calcAnchorMat:function(A){if(A.hasOwnProperty("_anchor")||A.hasOwnProperty("_anchorElevation")){var b=A.getAnchor3d(),c={x:b.x-.5,y:b.y-.5,z:b.z-.5},t=Dc();return Yc(t,[-c.x,-c.y,-c.z]),t}},getBodyColor:function(S){var w=this.data,G=this.gv.getBodyColor(w);return G?G:S?w.getStyle(S):a},_24O:function(E,v){var g=this,S=g.data,A=g.gv,P=g.s,w=A[v](S);if(w!=a){var O=P(E+".scale"),U=P(E+".max"),C=g[E+"Info"]={label:w,textureScale:P(E+".texture.scale"),color:A[v+"Color"](S),font:P(E+".font"),align:P(E+".align"),background:A[v+"Background"](S)},e=C.rect=Dq(C,w);U>0&&U<e.width&&(C.labelWidth=e.width,e.width=U),e.x=e.y=0,e.width*=O,e.height*=O,C.mat=g._16O(P(E+".autorotate"),P(E+".position"),e,P(E+".face"),P(E+".t3"),P(E+".r3"),P(E+".rotationMode"));var l=e.width/2,Q=e.height/2;C.vs=new _p([-l,Q,0,-l,-Q,0,l,-Q,0,l,Q,0]),e.width/=O,e.height/=O}},_26O:function(r,n){var U=this,$=U.data,j=U.gv,g=U.s,p=j[n]($);if(p!=a){var X=g(r+".scale"),A=this[r+"Info"]={note:p,textureScale:g(r+".texture.scale"),expanded:g(r+".expanded"),font:g(r+".font"),color:g(r+".color"),align:g(r+".align"),borderWidth:g(r+".border.width"),borderColor:g(r+".border.color"),background:j[n+"Background"]($)};if(A.expanded){var B=g(r+".max"),D=Dq(A,p);D.width+=6,D.height+=2,B>0&&B<D.width&&(A.labelWidth=D.width,D.width=B);var O={x:-D.width/2,y:-8-D.height,width:D.width,height:D.height+8}}else O={x:-6,y:-18,width:12,height:18};A.mat=U._16O(g(r+".autorotate"),g(r+".position"),a,g(r+".face"),g(r+".t3"),g(r+".r3"),g(r+".rotationMode")),A.rect=O,1!==X&&(O=Hj(O),O.x*=X,O.height*=X,O.y=-O.height,O.width*=X);var S=O.x,b=O.y,f=O.width,T=O.height;A.vs=new _p([S,-b,0,S,-b-T,0,S+f,-b-T,0,S+f,-b,0])}},_28O:function(e,b,t){if(t(this.s(b+".transparent"))){var W=e.rect,Z=e.textureScale,R=W.width*Z,i=W.height*Z;if(R>=1&&i>=1){var x=So(R,i);1!==Z&&(x.translate(x,W.x,W.y),x.scale(Z,Z),x.translate(x,-W.x,-W.y)),Qq(x,e),x.restore(),Ze(this,b,e.mat,e.vs,!0)}}},_29O:function(G,S,Z){if(Z(this.s(S+".transparent"))){var R=G.rect,$=G.textureScale,m=R.x,x=R.y,d=R.width*$,Y=R.height*$;if(d>=1&&Y>=1){R.x=R.y=0;var M=So(d,Y);1!==$&&M.scale($,$),lb(M,G),M.restore(),R.x=m,R.y=x,Ze(this,S,G.mat,G.vs,!1)}}},_99O:function(B,d,X,K,Z,h){if(X){var O=this,J=O.gv,w=O.data,V=J._buffer,F=J._1O,k=X.icons;for(var D in k){var U=k[D],Y=X.rects[D];if(Y&&h(Cs(U.transparent,w,J))){Fc(B,d,K,Z,w,D);var r=Cs(U.shape3d,w,J),A=r?[r]:Cs(U.names,w,J),I=A?A.length:0,W=Cs(U.textureScale,w,J)||1,R=Cs(U.light,w,J);R==a&&(R=r?!0:!1),js(B,d,Cs(U.blend,w,J),R,Cs(U.opacity,w,J),Cs(U.reverseFlip,w,J),Cs(U.reverseColor,w,J),Cs(U.reverseCull,w,J));for(var C=0;I>C;C++){var z=A[C],T=Y[C];if(gr(O,T.mat),r)Ej(J,w,tl(O,r),O);else{var H=Nl(z);if(H){var o=T.width*W,x=T.height*W;if(o>=1&&x>=1){var m=So(o,x);hc(m,H,Cs(U.stretch,w,J),0,0,o,x,w,J),m.restore(),Ud(B,qi,F),ui(B,d,F,Cs(U.discardSelectable,w,J),V.uv,lc),nj(B,V.vs,T.vs,d.aPosition),vk(B,V.ns,gb,d.aNormal),Ac(B,V.is,oq),mh(B,0,oq.length),nf(B,d,F)}}}Yf(J)}Wr(B,d)}}}}});var Un=function(s,C){fm(Un,this,[s,C])};ri(Un,lh,{_16O:function($,e,Z,Q,W,g,R,u,X){var L=this.data,n=L.getFinalScale3d(),K=gq(e,n,Z,Q,u,X);if(L.hasOwnProperty("_anchor")||L.hasOwnProperty("_anchorElevation")){var a=L.getAnchor3d();K[0]-=(a.x-.5)*n[0],K[1]-=(a.y-.5)*n[1],K[2]-=(a.z-.5)*n[2]}return Ai(Dc(),K,L.p3(),Q,W,g,R,$,L.getFinalRotation3d(),L.getRotationMode())},clear:function(){var C=this;C.faceMat=C.mat=C.shapeModel=C.left=C.right=C.front=C.back=C.top=C.bottom=C.csg=a},needValidate:function(b){if(this._iv)return this._validateFrameId=b._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var A=b._renderInfo.frame;if(this._validateFrameId!==A)return this._validateFrameId=A,!0
}return!1},validate:function(L,z){var e=this,l=e.gv,_=e.data,j=e.shapeName=e.s(Bs),T=tl(e,j);e._updateAutoRotation(),e._updateFixSize2d(),e._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(om(l,_,"_wireframeModelMap","_wireframeIndexMap"),om(l,_,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var S=Sb(_,l.getMat(_),T?e.s("shape3d.scaleable"):!0),U=e._calcAnchorMat(_);if(U&&wc(S,S,U),_.mat=S,e.clear(),T||!j)if(L){var H=[];T?ip(l,_,T,e,e.getBodyColor(),[S],L,H):(Dl(l,_,L,z,S,ce,H,_c),Dl(l,_,L,z,S,_i,H,Lq),Dl(l,_,L,z,S,Se,H,En),Dl(l,_,L,z,S,ep,H,ag),Dl(l,_,L,z,S,Ie,H,cl),Dl(l,_,L,z,S,No,H,bs)),H.length&&(On(L.vs,H),On(L.ns,Pc(H)))}else e.mat=S,(e.shapeModel=T)||(e._cubeUvs=null,e.vf(ce,0),e.vf(_i,16),e.vf(Ie,8),e.vf(No,24),e.vf(Se,32),e.vf(ep,40))},_updateAutoRotation:function(){var w=new Xp;return function(){var M=this,v=M.data,C=M.s("shape3d.autorotate");if(!C)return v._dynamicRotation&&delete v._dynamicRotation,void 0;var Z,y=M.gv;Z="string"==typeof C?[C.indexOf("x")<0?y._eye[0]:y._center[0],C.indexOf("y")<0?y._eye[1]:y._center[1],C.indexOf("z")<0?y._eye[2]:y._center[2]]:y._eye;var F=y._center,g=v.p3(),K=Cq([g[0]+Z[0]-F[0],g[1]+Z[1]-F[1],g[2]+Z[2]-F[2]],g,y._up),e=v.r3();w.set(0,0,0,v.getRotationMode(),!0).setFromRotationMatrix(K),Math.abs(e[0]-w.x)<1e-5&&Math.abs(e[1]-w.y)<1e-5&&Math.abs(e[2]-w.z)<1e-5||(v._dynamicRotation=[w.x,w.y,w.z])}}(),_updateFixSize2d:function(){var a=this,Q=a.data,p=a.s("shape3d.fixSizeOnScreen");if(!p)return Q._dynamicScale3d&&delete Q._dynamicScale3d,void 0;var B=a.gv;Q.getFinalScale3d();var Y=Sb(Q,B.getMat(Q)),C=Hf([0,0,0],Y),f=B.toViewPosition(C);if(!isNaN(f.x)&&!isNaN(f.y)){var _=Hf([1,0,0],Y),$=B.toViewPosition(_),T=Hf([0,1,0],Y),P=B.toViewPosition(T),A=$.x-f.x,D=P.y-f.y;if(A&&D){var X=Q._dynamicScale3d||[1,1,1],W=Nl(Q.s("shape3d.image")),N=p[0]>0?p[0]:W?sr(W,Q):20,F=p[1]>0?p[1]:W?Qo(W,Q):20,g=Math.abs(A/N),c=Math.abs(D/F);Math.abs(g-1)<.001&&Math.abs(c-1)<.001||(Q._dynamicScale3d=[X[0]/g,X[1]/c,X[2]])}}},_updateOverlapping:function(){var G=this,N=G.s("hide.overlapping.group");if(!N)return G._rectOverlapping&&(G._rectOverlapping=i),void 0;var D,v,y,F=G.gv,J=G.data,U=Sb(J,F.getMat(J)),B=1/0,A=1/0,g=-1/0,x=-1/0,c=J.getAnchor3d(),z=c.x,p=c.y,C=c.z;for(D=0;8>D;D++){if(v=Hf([(D>>2)-z,(1&D>>1)-p,(1&D)-C],U),y=F.toViewPosition(v),isNaN(y.x)||isNaN(y.y))return;B=Math.min(B,y.x),g=Math.max(g,y.x),A=Math.min(A,y.y),x=Math.max(x,y.y)}var e={x:B,y:A,w:g-B,h:x-A};G._rectOverlapping=F.overlappingBox.isOverlapping(N,e)},getVectorDynamicSize:function(){var I,P=this,M=P.s("shape3d"),G=P.data;if("billboard"===M||"plane"===M||(I=G._currentCubeElementId)!=a){var B,Z,c=P.gv,v=Sb(G,c.getMat(G)),X=G.getAnchor3d(),q=.5-X.x,_=.5-X.y,b=.5-X.z,w=P.s("shape3d.vector.dynamic.maxsize"),g=function(F,K){F[0]+=q,F[1]+=_,F[2]+=b,K[0]+=q,K[1]+=_,K[2]+=b;var l=c.toViewPosition(Hf(F,v)),G=c.toViewPosition(Hf(K,v)),u=l.x-G.x,n=l.y-G.y;return Math.min(w,Math.sqrt(u*u+n*n))};if("billboard"===M)B=g([-.5,0,0],[.5,0,0]),Z=g([0,-.5,0],[0,.5,0]);else if("plane"===M)B=g([-.5,0,0],[.5,0,0]),Z=g([0,0,-.5],[0,0,.5]);else if(G._currentCubeElementId!=a){var n=3*Ll[I+1],z=3*Ll[I],i=3*Ll[I+2];B=g([Dd[n],Dd[n+1],Dd[n+2]],[Dd[i],Dd[i+1],Dd[i+2]]),Z=g([Dd[n],Dd[n+1],Dd[n+2]],[Dd[z],Dd[z+1],Dd[z+2]])}return[B,Z]}},getCachedTexture:function(){var j=this,Q=j.data,g=Q._currentCubeElementId;return g!=a?j._cubeCachedImage?j._cubeCachedImage[g]:null:j._shape3dCachedImage},setCachedTexture:function(E){var e=this,v=e.data,H=v._currentCubeElementId;H!=a?(e._cubeCachedImage||(e._cubeCachedImage={}),e._cubeCachedImage[H]=E):e._shape3dCachedImage=E},invalidateCachedTexture:function(e){var V,Y,N,J=this;if((N=J._shape3dCachedImage)&&(e.deleteTexture(N),J._shape3dCachedImage=null),Y=J._cubeCachedImage){for(V in Y)e.deleteTexture(Y[V]);J._cubeCachedImage=null}},vf:function(V,v){var g=this;if(g.gv.getFaceVisible(g.data,V)){var Z=us(g,V);Z.mat&&(g.faceMat=!0);var H=Z.uv;if(H){var P=g._cubeUvs;P||(P=g._cubeUvs=new _p([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var K=0;8>K;K++)P[v+K]=H[K]}return Z}},_80o:function(P,Y,O){var M=this;if(M._rectOverlapping)return!0;var v=M.shapeModel;if(v||!M.shapeName){var d=M.gv,A=M.data,o=d._cube;Oo(d,M.mat),v?Ej(d,A,v,M,M.getBodyColor(),O):(nj(P,o.vs,a,Y.aPosition),nj(P,o.ns,a,Y.aNormal),Qg(P,o.is),M._18O(P,Y,M.left,0,O),M._18O(P,Y,M.front,6,O),M._18O(P,Y,M.right,12,O),M._18O(P,Y,M.back,18,O),M._18O(P,Y,M.top,24,O),M._18O(P,Y,M.bottom,30,O)),Yf(d),M.faceMat&&(M._18O(P,Y,M.left,0,O,!0),M._18O(P,Y,M.front,6,O,!0),M._18O(P,Y,M.right,12,O,!0),M._18O(P,Y,M.back,18,O,!0),M._18O(P,Y,M.top,24,O,!0),M._18O(P,Y,M.bottom,30,O,!0))}},_18O:function(k,L,F,M,H,C){if(F){if(!H(F.transparent))return;if(C&&!F.mat||!C&&F.mat)return;var P=this.data.s("polygonOffset");P&&Wb(k,P),C&&Oo(this.gv,F.mat);var O=this,U=O.data;U._currentCubeElementId=M;var e=O.gv,w=e.getTexture(F.texture,U),A=F.uv,J=F.uvScale,D=F.uvOffset,g=F.discardSelectable;w?A?ui(k,L,w,g,e._buffer.uv,O._cubeUvs,D,J):ui(k,L,w,g,e._cube.uv,a,D,J):ui(k),js(k,L,F.blend,F.light,F.opacity,F.reverseFlip,F.reverseColor,F.reverseCull),mb(k,L.uDiffuse,F.color||W["color.empty"]),mh(k,M,6),Wr(k,L),nf(k,L,w),C&&Yf(e),P&&ci(k),U._currentCubeElementId=null}}});var yd=function(u,C){fm(yd,this,[u,C])};ri(yd,lh,{_25Q:1,validate:function(V){var F=this,s=F.gv,v=F.data,q=F.s,e=q("edge.width"),d=v._40I,N=v._41I;if(F.shapeModel=F.info=a,d&&N){var g,G,n,C,P,k,I,W,U,T,u=v.isLooped(),h=q(xi),y=x.getEdgeType(h);if(y){var c=y(v,Cd(F,s,v,u,h),s,F._19Q);if(!c.points||c.points.isEmpty())return;k=F.info={},I=c.segments,P=c.points,W=P.size();for(var f=d.getElevation(),Q=N.getElevation(),l=0;W>l;l++){var E=P.get(l);E.e==a&&(E.e=f+(Q-f)*l/(W-1))}U=fo(P.get(0)),T=fo(P.get(W-1));var _=W%2;0===_?(k.c1=fo(P.get(W/2-1)),k.c2=fo(P.get(W/2))):k.p3=fo(P.get((W-_)/2)),k.s1=U,k.s2=fo(P.get(1)),k.t1=fo(P.get(W-2)),k.t2=T}else{P=new kg,k=F.info={};var O=q("edge.offset"),w=q("edge.center"),M=q("edge.source.t3"),R=q("edge.target.t3"),L=d.p3(),o=N.p3();if(M&&(L[0]+=M[0],L[1]+=M[1],L[2]+=M[2]),R&&(o[0]+=R[0],o[1]+=R[1],o[2]+=R[2]),h===Yk){I=q("edge.segments");var j=k.points=q(Wd)||ej;if(W=j.size()){U=fo(j.get(0)),T=fo(j.get(W-1)),!w&&O&&(n=sm(U,L,!0),O=t(O,Og(L,U)),L=[L[0]+n[0]*O,L[1]+n[1]*O,L[2]+n[2]*O],n=sm(o,T,!0),O=t(O,Og(T,o)),o=[o[0]-n[0]*O,o[1]-n[1]*O,o[2]-n[2]*O]);var _=W%2;0===_?(g=fo(j.get(W/2-1)),G=fo(j.get(W/2))):k.p3=fo(j.get((W-_)/2)),k.s1=L,k.s2=U,k.t1=T,k.t2=o}else!w&&O&&(n=sm(o,L,!0),C=Og(L,o),O=ol(O,C),L=[L[0]+n[0]*O,L[1]+n[1]*O,L[2]+n[2]*O],o=[o[0]-n[0]*O,o[1]-n[1]*O,o[2]-n[2]*O]),g=L,G=o;P.add({x:L[0],y:L[2],e:L[1]}),P.addAll(j),P.add({x:o[0],y:o[2],e:o[1]})}else{var i=Cd(F,s,v,u,h);if(F._19Q||(i=-i),u){var Y=L[0],m=L[1],z=L[2],D=d.getTall()/2+i;g=[Y-i,m+D,z],G=[Y+i,m+D,z],P.add({x:Y-i,y:z,e:m}),P.add({x:Y-i,y:z,e:m+D}),P.add({x:Y+i,y:z,e:m+D}),P.add({x:Y+i,y:z,e:m})}else{n=sm(o,L,!0),C=Og(L,o);var r={x:L[0],y:L[2]},A={x:o[0],y:o[2]},Z=bo(a,r,A,i),K=Z.x-r.x,X=Z.y-r.y;O=ol(O,C),n[0]*=O,n[1]*=O,n[2]*=O,g=[L[0]+n[0]+K,L[1]+n[1],L[2]+n[2]+X],G=[o[0]-n[0]+K,o[1]-n[1],o[2]-n[2]+X],w?(P.add({x:L[0],y:L[2],e:L[1]}),P.add({x:g[0],y:g[2],e:g[1]}),P.add({x:G[0],y:G[2],e:G[1]}),P.add({x:o[0],y:o[2],e:o[1]})):(P.add({x:g[0],y:g[2],e:g[1]}),P.add({x:G[0],y:G[2],e:G[1]}))}}k.c1=g,k.c2=G}k.list=q(Bs)===fl?F.createTubeModel(P,I,e/2,V):F.createLineModel(P,I,e,"edge","edge.dash")}}});var qr=function(L,$){fm(qr,this,[L,$])};ri(qr,Un,{_80o:function(n,b,M){var C=this,c=C.gv,x=C.shapeModel;Oo(c,C.mat),x?Ej(c,C.data,x,C,C.getBodyColor(),M):(Hc(C,n,b,C.left,M),Hc(C,n,b,C.front,M),Hc(C,n,b,C.right,M),Hc(C,n,b,C.back,M),Hc(C,n,b,C.top,M),Hc(C,n,b,C.bottom,M)),Yf(c)},validate:function(w,C){var z,h,J=this,c=J.s,R=J.data,Q=R.p3(),k=R._thickness/2,x=R.isClosePath(),K=R.getPoints(),Y=R.getSegments(),e=c(Xb),L=w&&w.uv;if(J.clear(),0>k)h=J.shapeModel=Dr(K,Y,c(cq),c(Cj),e,c(Em),R.getTall(),R.getShapeElevation(),x),c(ff)?c("shape3d.image")||delete h.uv:(delete h.vs,delete h.ns,delete h.uv),c("shape3d.top.image")||delete h.top_uv,c("shape3d.bottom.image")||delete h.bottom_uv;else if(c(Bs)===fl)z=vl(K,Y,e,x),h=J.shapeModel={vs:[]},c("shape3d.image")&&(h.uv=[],h.sum=c(Em)||Ir(z)||1,h.len=0),c(cq)&&!x&&(h.top_vs=[],c("shape3d.top.image")&&(h.top_uv=[])),c(Cj)&&!x&&(h.bottom_vs=[],c("shape3d.bottom.image")&&(h.bottom_uv=[])),J._12O(z,k);else{var r,l,b,N,S,P,X,B,O,o;if(z=vl(K,Y,e,x),S=J.vf(Ie,L,!1,C),k&&(P=J.vf(No,L,!1,C),X=x?a:J.vf(ce,L,!1,C),B=x?a:J.vf(_i,L,!1,C),O=J.vf(Se,L,!1,C),o=J.vf(ep,L,!1,C)),k){for(var y=0,G=z.length;G>y;y++)z[y]=J._tryRemoveBezierPoints(z[y],k);J._12O(z,k)}else S&&z.forEach(function(Q){if(N=Q.length,N>0)for(r=Q[0],b=1;N>b;b++)l=Q[b],J.addV(S.vs,r,l),r=l});J._20Q(z),w||(S&&(S.ns=Pc(S.vs),Jb(S,"vs"),Jb(S,Lo)),k&&(P&&(P.ns=Pc(P.vs),Jb(P,"vs"),Jb(P,Lo)),X&&(X.ns=Pc(X.vs),Jb(X,"vs"),Jb(X,Lo)),B&&(B.ns=Pc(B.vs),Jb(B,"vs"),Jb(B,Lo)),O&&(O.ns=Pc(O.vs),Jb(O,"vs"),Jb(O,Lo)),o&&(o.ns=Pc(o.vs),Jb(o,"vs"),Jb(o,Lo))))}var Z=J.mat=Dc();Yc(Z,Q),dd(Z,R.getFinalRotation3d(),R.getRotationMode());var s=R.getScale3d(),j=R._dynamicScale3d;j&&(s[0]*=j[0],s[1]*=j[1],s[2]*=j[2]),Xi(Z,s),Yc(Z,tm(Q)),w&&(jr(J,Z,w,h),J.clear())},_20Q:function(L){var N,h,u,d,r,f,I,A=this,Z=A.front,q=A.back,T=A.top,M=A.bottom,G=Z?Z.tuv:a,K=q?q.tuv:a,j=T?T.tuv:a,Q=M?M.tuv:a,b=0;(G||K||j||Q)&&(N=A.s(Em)||Ir(L)||1,L.forEach(function(P){if(h=P.length,h>0)for(f=P[0],u=1;h>u;u++)I=P[u],d=b/N,b+=Og(f,I),r=b/N,A._14O(Z,d,r),A._14O(q,1-r,1-d),A._14O(T,d,r),A._14O(M,d,r),f=I}))},_14O:function(I,x,b){if(I){var w=I.uv,G=I.tuv;if(G){if(w)var W=w[0]+(w[6]-w[0])*x,H=w[1]+(w[7]-w[1])*x,j=w[2]+(w[4]-w[2])*x,e=w[3]+(w[5]-w[3])*x,J=w[2]+(w[4]-w[2])*b,Q=w[3]+(w[5]-w[3])*b,r=w[0]+(w[6]-w[0])*b,F=w[1]+(w[7]-w[1])*b;else W=x,H=0,j=x,e=1,J=b,Q=1,r=b,F=0;G.push(j,e,J,Q,r,F,r,F,W,H,j,e)}}},_13O:function(o){var r=o.uv,j=o.tuv;j&&(r?j.push(r[2],r[3],r[4],r[5],r[6],r[7],r[6],r[7],r[0],r[1],r[2],r[3]):j.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(l,H){var K=l.length;if(4>K)return l;var B,q,S,Y,u,m,R=!1,v=function(D){return l[D]},x=function(w){return l[K-1-w]};for(u=0;1>=u;u++)for(m=u?x:v,q=m(0),S=m(1),B=2;K-1>B;B++)if(Y=m(B),!Y.remove)if(Y.b){var o=bo(q,S,Y,H);o.adjust?(Y.remove=!0,R=!0):(q=S,S=Y)}else q=S,S=Y;if(!R)return l;var Z=[];for(B=0;K>B;B++)l[B].remove||Z.push(l[B]);return Z},_12O:function(j,Q){var A,X,N,L,x,K=this;j.forEach(function(r){if(x=r.length,x>0)for(A={p:r[0],n:!0},L=1;x>L;L++)X=r[L],N=x-1>L?r[L+1]:a,K.addPoint(A,X,N,Q,r)})},addPoint:function(j,V,N,P,p){var r,H,$,S,s,h,u,d,k,x=this,M=j.p,J=j.f,Q=j.b,C=x.s("shape3d.side")||ph,z=x.s("shape3d.start.angle"),K=x.s("shape3d.sweep.angle"),E=x.shapeModel,i=x.data.isClosePath();if(j.n&&(j.n=!1,J=i&&p.length>2?bo(p[p.length-2],M,V,P):bo(a,M,V,P),Q=Fb(M,J),E?E.top_vs&&x._10O(Q,J,C,z,K,E.top_vs,E.top_uv):(r=x.left)&&(x.addV(r.vs,Q,J),x._13O(r))),H=N?bo(M,V,N,P):i&&p.length>2?bo(M,V,p[1],P):bo(M,V,a,P),$=Fb(V,H),E){var O,D,m=E.vs,Z=E.uv,f=E.sum;for(Z&&(O=E.len/f,E.len+=Og(M,V),D=E.len/f),h=x._9O(Q,J,C,z,K),u=x._9O($,H,C,z,K),d=0;C>d;d++)k=d+1,On(m,h[k]),On(m,u[d]),On(m,h[d]),On(m,u[d]),On(m,h[k]),On(m,u[k]),Z&&(S=d/C,s=k/C,Z.push(O,s,D,S,O,S,D,S,O,s,D,s));!N&&E.bottom_vs&&x._10O($,H,C,z,K,E.bottom_vs,E.bottom_uv,!0)}else!N&&(r=x.right)&&(x.addV(r.vs,H,$),x._13O(r)),(r=x.front)&&x.addV(r.vs,J,H),(r=x.back)&&x.addV(r.vs,$,Q),(r=x.top)&&x.addH(r.vs,J,H,$,Q,!0),(r=x.bottom)&&x.addH(r.vs,Q,$,H,J);j.p=V,j.f=H,j.b=$},_10O:function(F,w,I,N,c,O,y,L){var j,_,B=this,P=B.data,X=B._9O(F,w,I,N,c),i=(F.x+w.x)/2,n=(F.y+w.y)/2,Z=P.getShapeElevation(),A=0;for(A=0;I>A;A++)L?(On(O,X[A]),On(O,X[A+1])):(On(O,X[A+1]),On(O,X[A])),On(O,[i,Z,n]),y&&(L?(j=$*(A+1)/I+N,_=$*A/I+N):(j=$*A/I+N,_=$*(A+1)/I+N),y.push(.5-.5*b(_),.5-.5*M(_),.5-.5*b(j),.5-.5*M(j),.5,.5))},_9O:function(L,d,F,_,o){var U,n,B=this,S=B.data,Y=[],j=(L.x+d.x)/2,c=(L.y+d.y)/2,V=S.getTall()/2,s=S.getShapeElevation(),J=0;for(o=o||$;F>=J;J++)U=o*J/F+_,n=b(U),Y.push([j+(L.x-j)*n,s+V*M(U),c+(L.y-c)*n]);return Y},addV:function(F,S,k){var E=S.x,j=S.y,u=k.x,X=k.y,d=this.data,Q=d.getShapeElevation(),M=d.getTall()/2;F.push(E,Q-M,j,u,Q-M,X,u,Q+M,X,u,Q+M,X,E,Q+M,j,E,Q-M,j)},addH:function(s,N,t,r,H,c){var R=this.data,p=R.getTall()/2,f=R.getShapeElevation()+(c?p:-p);s.push(N.x,f,N.y,t.x,f,t.y,r.x,f,r.y,r.x,f,r.y,H.x,f,H.y,N.x,f,N.y)},vf:function(V,y,h,l){var L,Y=this,g=Y.gv.getFaceVisible(Y.data,V);return(h||g)&&(L=us(Y,V,l),L.vs=[],L.tuv=g&&(L.texture||y)?[]:a,L.visible=g),L}});var Jg=function(u,T){fm(Jg,this,[u,T])};ri(Jg,lh,{_25Q:1,validate:function(w){var J=this,T=J.data,_=J.s,Z=T.getPoints(),W=Z.size();if(J.shapeModel=J.info=a,W>1){var X=J.info={},M=T.getSegments(),B=T.getThickness(),U=fo(Z.get(0)),N=fo(Z.get(W-1)),m=W%2;0===m?(X.c1=fo(Z.get(W/2-1)),X.c2=fo(Z.get(W/2))):X.p3=fo(Z.get((W-m)/2)),X.s1=U,X.s2=fo(Z.get(1)),X.t1=fo(Z.get(W-2)),X.t2=N,X.list=_(Bs)===fl?J.createTubeModel(Z,M,B/2,w):J.createLineModel(Z,M,B,"shape.border","shape.dash")}var t=T.p3(),f=J.mat=Dc();Yc(f,t),dd(f,T.getFinalRotation3d(),T.getRotationMode());var i=T.getScale3d(),h=T._dynamicScale3d;h&&(i[0]*=h[0],i[1]*=h[1],i[2]*=h[2]),Xi(f,i),Yc(f,tm(t))},_80o:function(B,F,U){var Y=this,E=Y.shapeModel;if(E){var a=Y.gv;Oo(a,Y.mat),Ej(a,Y.data,E,Y,Y.getBodyColor(),U),Yf(a)}}});var Rb=S.graph3d.VR=function(o){var L=this;L.gv=o,L._controllers=[],L.switch=new ks(L),L._enable=!1,L._defaultCallLater=S.Default.callLater,L._defaultCancelLater=To,"undefined"!=typeof Q&&"VRFrameData"in Q&&(L._frameData=new Q.VRFrameData),L.measureOflength=1,L.eyesOffset=[0,0,0],L._orientation=new S.Math.Quaternion,L._lastHeadPose=[0,0,0],L._offsetToBeAdd=[0,0,0],L._fpsInfo={time:0,fps:0,frames:0}};ri(Rb,n,{ms_fire:!0,_42:function(F,l,M,i){var r=this,w=r.gv;if(!w.drawFilter&&r._deviceInAction){var O=r._device;if(O){var e=r._measureOflength;O.depthNear=w.getNear()*e,O.depthFar=w.getFar()*e;var I=r._offsetToBeAdd;if(r.eyesOffset[0]+=I[0],r.eyesOffset[1]+=I[1],r.eyesOffset[2]+=I[2],I[0]=0,I[1]=0,I[2]=0,O.isPresenting===!1)return r._controllers.forEach(function(s){s&&s.update()}),w.iv(),!1;var u=r._frameData;O.getFrameData(u);var W=u.pose.position;if(W){var d=r.toViewPosition(W);w.setEye(d),r._orientation.fromArray(u.pose.orientation);var p=new S.Math.Vector3(0,0,-10*r._scaleFactor);p.applyQuaternion(r._orientation),w.setCenter([d[0]+p.x,d[1]+p.y,d[2]+p.z])}r._controllers.forEach(function(X){X&&X.update()}),w.setViewport(F,0,0,l/2,M),r._viewMatrix=r._copyViewMatrix(u.leftViewMatrix),r._projectMatrix=r._copyProjectMatrix(u.leftProjectionMatrix),i(),w.setViewport(F,l/2,0,l/2,M),r._viewMatrix=r._copyViewMatrix(u.rightViewMatrix),r._projectMatrix=r._copyProjectMatrix(u.rightProjectionMatrix),i(),r._lastViewMatrix=r._viewMatrix,r._lastProjectMatrix=r._projectMatrix,r._viewMatrix=null,r._projectMatrix=null,r.submitFrame();var k=Date.now(),L=r._fpsInfo;return k-L.time>1e3?(L.fps=Math.round(1e3*(L.frames+1)/(k-L.time)),L.time=k,L.frames=0):L.frames++,!0}}},onVRDisplayPresentChange:function(){var t=this.isPresenting();this._injectGraphView(t),this.fp("present",!t,t)},getOrientation:function(){return this._orientation},addController:function(h){h=h||0;var w=this,c=w.getController(h);return c?c:(c=new Ee(w,h),w._controllers.push(c),c)},getController:function(x){x=x||0;for(var c=this._controllers,v=0,C=c.length;C>v;v++)if(c[v]&&c[v].id===x)return c[v];return null},removeController:function(d){d=d||0;for(var J=this._controllers,m=0,B=J.length;B>m;m++)if(J[m]&&J[m].id===d)return J.splice(m,1),!0;return!1},getLastHeadPose:function(){return this._lastHeadPose},toViewPosition:function(L,B){var j=this,r=j._scaleFactor,g=j._eyesOffset,p=j._lastHeadPose;return p[0]=L[0]*r,p[1]=L[1]*r,p[2]=L[2]*r,B?(B[0]=p[0]+g[0],B[1]=p[1]+g[1],B[2]=p[2]+g[2],B):[p[0]+g[0],p[1]+g[1],p[2]+g[2]]},addEyesOffset:function(e,g,J){var V=this._offsetToBeAdd;V[0]+=e,V[1]+=g,V[2]+=J},_copyViewMatrix:function(v){var X=this.dup(v),x=this._scaleFactor;X[12]*=x,X[13]*=x,X[14]*=x;var E=this._eyesOffset;if(E&&(E[0]||E[1]||E[2])){var G=E[0],A=E[1],F=E[2];X[12]-=X[0]*G+X[4]*A+X[8]*F,X[13]-=X[1]*G+X[5]*A+X[9]*F,X[14]-=X[2]*G+X[6]*A+X[10]*F}return X},shutdown:function(){var C=this._device;C&&C.isPresenting&&C.exitPresent()},isPresenting:function(){var M=this._device;return M&&M.isPresenting},_copyProjectMatrix:function(G){var i=this.dup(G),f=this._scaleFactor;return i[14]*=f,i},dup:function(q,x){for(var V=q.length,v=x||new Array(V);V--;)v[V]=q[V];return v},getViewMatrix:function(g){var b=this._viewMatrix;return b?this.dup(b,g):void 0},getProjectMatrix:function(){var K=this._projectMatrix;return K?this.dup(K):void 0},submitFrame:function(){var F=this;if(F._enable&&F._deviceInAction){var Y=F._device;Y&&Y.isPresenting&&(Y.submitFrame(),F.gv.iv())}},getFps:function(){return this._fpsInfo.fps},intersectWorld:function(T){var J=this.gv;return J.intersectObjects(T,J.dm().getDatas())},setDevice:function(t){var y=this;y._device=t},_injectGraphView:function(){var q,o,u;return function(w){var Z=this.gv;if(!w)return q&&(Z.getWidth=q,Z.getHeight=o,Z.getDevicePixelRatio=u),void 0;var y=this._device,m=y.getEyeParameters("left"),A=m.renderWidth,l=m.renderHeight;q=Z.getWidth,o=Z.getHeight,u=Z.getDevicePixelRatio,Z.getWidth=function(){return 2*A},Z.getHeight=function(){return l},Z.getDevicePixelRatio=function(){return 1}}}(),_injectCallLaterFunc:function(t){var u=this;if(!t)return Jj=S.Default.callLater=u._defaultCallLater,To=S.Default.cancelLater=u._defaultCancelLater,void 0;var u=this;Jj=S.Default.callLater=function(I,X,p,j){var k=u._device;return k&&k.isPresenting?j?q(function(){Jj(I,X,p)},j):k.requestAnimationFrame(function(){u._deviceInAction=!0,I.apply(X,p),u._deviceInAction=!1}):u._defaultCallLater(I,X,p,j)},To=S.Default.cancelLater=function(s,S){var H=u._device;return H&&H.isPresenting?S?Y(s):H.cancelAnimationFrame(s):u._defaultCancelLater(s,S)}}}),n.defineProperties(Rb.prototype,{enable:{get:function(){return this._enable},set:function(N){var L=this;L._enable!==N&&(L._enable=N,N?(L.switch.showButton(),L._injectCallLaterFunc(!0)):(L.shutdown(),L.switch.hideButton(),L._injectCallLaterFunc(!1)),L.fp("enable",!N,N))}},measureOflength:{get:function(){return this._measureOflength},set:function(k){this._measureOflength=k;var K=this._scaleFactor=1/k;this._controllers.forEach(function(w){w&&w._setScaleFactor(K)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(c){this._eyesOffset=c}},controllerModel:{get:function(){return this._controllerModel},set:function(N){var G;"object"==typeof N?(G=N.mtl,N=N.obj):(G=N+".mtl",N+=".obj");var z=this,t=z._controllerModel;t&&t.obj===N&&t.mtl===G||(t=z._controllerModel={obj:N,mtl:G},x.loadObj(N,G,{finishFunc:function(c,Y){z._controllerModel===t&&x.setShape3dModel("vrControllerModel",Y)}}))}},interactive:{get:function(){return!!this._interactive},set:function(i){!!i!=!!this._interactive&&(this._interactive=i,i&&this.addController(0),this.gv.getCoreInteractor().enableVR(i))}}});var Ee=function(P,e){function C(j){var q=navigator.getGamepads&&navigator.getGamepads();if(q)for(var f=0,U=0,N=q.length;N>f;f++){var e=q[f];if(e){var u=e.id;if("OpenVR Gamepad"===u||"OpenVR Controller"===u||0===u.indexOf("Oculus Touch")||0===u.indexOf("Spatial Controller")){if(U===j)return e;U++}}}}function o(Z,n,p){return Math.abs(Z[0]-n[0])<p&&Math.abs(Z[1]-n[1])<p&&Math.abs(Z[2]-n[2])<p?!0:!1}var Y=this;Y.vr=P,Y.id=e;var W,w,h=[0,0],f=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],r=new Jq;r.s("shape3d","vrControllerModel"),r.isController=!0,r.s("intersect",!1),Y.getGamepad=function(){return w},Y.isButtonPressed=function(X){for(var Y,O=0,C=f.length;C>O;O++)if(Y=f[O],Y.id===X)return Y.pressed;return!1},Y.getNode=function(){return r};var E=.003;Y.setRotationEpsilon=function(x){E=x};var _=5e-4,U=_;Y.setPositionEpsilon=function(e){_=e,U=e*Y.vr._scaleFactor},Y._setScaleFactor=function(O){r.s3(O,O,O),U=_*O},Y._setScaleFactor(Y.vr._scaleFactor);var b,u=new Fq,S=new If,t=[0,0,0],v=[0,0,0],D=new Xp,j=new Eo,g=new Nd;Y.getRay=function(){return b?(g.origin.fromArray(t),g.direction.copy(j),b=!1,g):g},Y.update=function(){if(W=w,w=C(e),W!=w&&console.log("gamepad changed",w),!w||w.pose===i)return w=null,r.s("3d.visible",!1),void 0;if(x.getShape3dModel("vrControllerModel")){r.dm()||P.gv.dm().add(r),r.s("3d.visible",!0);var V=w.pose;if(null!==V){V.position&&(Y.vr.toViewPosition(V.position,t),o(r.p3(),t,U)||(b=!0,r.p3(t))),V.orientation&&(u.fromArray(V.orientation),j.set(0,0,-1).applyQuaternion(u).normalize(),S.makeRotationFromQuaternion(u),D.set(0,0,0,r.getRotationMode(),!0).setFromRotationMatrix(S),v[0]=D.x,v[1]=D.y,v[2]=D.z,o(r.r3(),v,E)||(b=!0,r.r3(v))),b&&P.fp("gamepad.pose",null,{position:t,rotation:v,id:e});var k=w.axes;(h[0]!==k[0]||h[1]!==k[1])&&(h=[k[0],k[1]],P.fp("gamepad.axes",null,{id:e,axes:h}));var c,Q,p,X,s=w.buttons;for(c=0,Q=s.length;Q>c;c++)if(p=s[c],X=p.pressed,X!==f[c].pressed){f[c].pressed=X;var F={id:e},M="state";F[M]=F._62O=X?"down":"up",P.fp("gamepad.button."+f[c].id,null,F)}}}}},ks=function(J){this.vr=J,this._button=null};ri(ks,n,{showButton:function(){var V=this.assureButton();if(!V.parentNode){var j=this.vr.gv,A=j.getView();j._79O?A.insertBefore(V,j._79O):A.appendChild(V)}},hideButton:function(){var T=this._button;T&&T.parentNode&&T.parentNode.removeChild(T)},assureButton:function(){var U=this._button;return U?U:this._button=this.createButton(this.vr.gv)},createButton:function(o){function A(A,Q){A.textContent=Q&&Q.isPresenting?"关闭 VR 显示":"开启 VR 显示"}function i(Y){k.style.display="",k.style.cursor="pointer",k.style.left="calc(50% - 50px)",k.style.width="100px",A(k,Y),k.onmouseenter=function(){k.style.opacity="1.0"},k.onmouseleave=function(){k.style.opacity="0.5"},k.onclick=function(){Y.isPresenting?Y.exitPresent():Y.requestPresent([{source:o.getCanvas()}])},o.vr.setDevice(Y)}function U(){k.style.display="",k.style.cursor="auto",k.style.left="calc(50% - 75px)",k.style.width="150px",A(k,null),k.onmouseenter=null,k.onmouseleave=null,k.onclick=null,o.vr.setDevice(null)}function s(K){K.style.position="absolute",K.style.bottom="20px",K.style.padding="12px 6px",K.style.border="1px solid #fff",K.style.borderRadius="4px",K.style.color="#000",K.style.font="normal 13px sans-serif",K.style.textAlign="center",K.style.opacity="0.5",K.style.outline="none",K.style.zIndex="999"}if("getVRDisplays"in navigator){var k=this._button=H.createElement("button");return k.style.display="none",s(k),Q.addEventListener("vrdisplayconnect",function(O){i(O.display)},E),Q.addEventListener("vrdisplaydisconnect",function(){U()},E),Q.addEventListener("vrdisplaypresentchange",function(E){A(k,E.display),o.vr.onVRDisplayPresentChange()},E),navigator.getVRDisplays().then(function(z){z.length>0?i(z[0]):U()}),k}var w=H.createElement("a");return w.href="https://webvr.info",w.innerHTML="当前不支持 webvr",w.style.left="calc(50% - 90px)",w.style.width="180px",w.style.textDecoration="none",s(w),w}}),n.defineProperties(ks.prototype,{});var Qn=S.graph3d.PostProcessing=function(H){function c(){if(!p){var U=H.getGL();p=new Qh.RenderTarget(H,U),I=new Li.Shader(U,Q.vs,Q.fs),O=Li.Buffer.createIndexBuffer(U,new Uint16Array([0,2,1,1,2,3])),k=Li.Buffer.createVertexBuffer(U,new Float32Array([0,0,1,0,0,1,1,1]))}}var p,I,O,k,U=this,S={},$=!1;!function(){n.keys(Qn).forEach(function(L){S[L]=new Qn[L](H)})}(),U.getModule=function(z){return z?S[z]:U},U.getModuleList=function(){return n.keys(S)},U.handleDataModleChange=function(D,X){D&&(D.setPostProcessingData(U.serialize()),D.removeSerializeListener(U.onDataModelSerialize,U)),X&&(X.addSerializeListener(U.onDataModelSerialize,U),U.deserialize(X.getPostProcessingData()))},U.onDataModelSerialize=function(B){"serialize"===B.type?H.dm()._postProcessingData=U.serialize():"deserialize"===B.type&&U.deserialize(H.dm().getPostProcessingData())},U.serialize=function(){var Y,P,c,L={};for(Y in S)P=S[Y],L[Y]={enable:P.enable},c=P.serializeProperties,c&&c.forEach(function(E){L[Y][E]=P[E]});return L},U.deserialize=function(q){if(q){var $,n,M,m;for($ in q)if(n=S[$]){M=q[$],U.enableModule($,M.enable);for(m in M)"enable"!==m&&(n[m]=M[m])}}else{var $,n;for($ in S)n=S[$],n.enable=!1,n.resetProperties&&n.resetProperties()}},U.decodeShader=function(S){var N,W,c,G="",H="";for(c=0;c<S.length;c++)N=S[c],"%"===N?N="'":"a"===N?N='"':"]"===N&&(N="\\"),W=String.fromCharCode(N.charCodeAt(0)-1),c%2?H+=W:G=W+G;return H+G},U.createShader=function(T,H,K){var s=H.indexOf("^#"),O=U.decodeShader(H.substr(0,s)),t=U.decodeShader(H.substr(s+2));if(K){var x=K(O,t);x&&x.vs&&(O=x.vs),x&&x.fs&&(t=x.fs)}return new Li.Shader(T,O,t)},U.enableModule=function(x,y){var g,V,I,B=x.split(",");for(g=0,V=B.length;V>g;g++)I=B[g].trim(),S[I]&&(S[I].enable=y);$=!1;for(I in S)if(S[I].enable){$=!0;break}$&&c()};var Q={vs:["attribute vec2 pos;","varying vec2 vUv;","void main(void) {","gl_Position = vec4(pos.x * 2.0 - 1.0, -pos.y * 2.0 + 1.0, 0.0, 1.0);","vUv = vec2(pos.x, 1.0 - pos.y);","}"].join("\n"),fs:["precision highp float;","uniform sampler2D image;","varying vec2 vUv;","void main() {","gl_FragColor = texture2D(image, vUv);","}"].join("\n")};U._42=function(X,x,V,J,l){if($&&!l){p.setSize(X,x,V),Vb(X,p.frame),X.clear(X.COLOR_BUFFER_BIT|X.DEPTH_BUFFER_BIT),H.setViewport(X,0,0,x,V),J();var W,_=p;for(W in S)_=S[W]._42(X,_)||_;return pi(X),H.setViewport(X,0,0,x,V),X.clear(X.COLOR_BUFFER_BIT|X.DEPTH_BUFFER_BIT),I.bind(),X.activeTexture(X.TEXTURE0+0),X.bindTexture(X.TEXTURE_2D,_.texture),I.uniforms.image=0,O.upload(),k.upload(),I.attributes.pos.pointer(k),X.drawElements(X.TRIANGLES,6,X.UNSIGNED_SHORT,0),X.bindTexture(X.TEXTURE_2D,null),X.useProgram(H._prg),!0}}},ni=S.graph3d.PostProcessing.Bloom=function(U){function m(){var s=U.getWidth(),b=U.getHeight();if(s&&b){l=[s,b],M=!0;var w,m=U.getGL(),e=Math.round(l[0]/2),z=Math.round(l[1]/2);for(f=new Qh.RenderTarget(U,m,e,z),w=0;A>w;w++)i.push(new Qh.RenderTarget(U,m,e,z)),r.push(new Qh.RenderTarget(U,m,e,z)),e=Math.round(e/2),z=Math.round(z/2);var q=U._postProcessing;y=q.createShader(m,ni._34Q);for(var w=0;A>w;w++)H[w]=q.createShader(m,ni._35Q,function(E,X){return{fs:X.replace(/DEFINE_VALUE/g,O[w])}});t=q.createShader(m,ni._36Q,function(y,d){return{fs:d.replace(/NUM_MIPS/g,A)}}),k=q.createShader(m,ni.finalShader),I=Li.Buffer.createIndexBuffer(m,new Uint16Array([0,2,1,1,2,3])),V=Li.Buffer.createVertexBuffer(m,new Float32Array([0,0,1,0,0,1,1,1]))}}var W,N,h,I,V,x=this,q=!1,M=!1;this.serializeProperties="strength,threshold,radius".split(","),this.resetProperties=function(){W=1.5,N=.55,h=.4},n.defineProperties(x,{enable:{get:function(){return q},set:function(I){!!q!=!!I&&(q=I,I&&!M&&m())}},strength:{get:function(){return W},set:function(e){W=e}},threshold:{get:function(){return N},set:function(_){N=_}},radius:{get:function(){return h},set:function(R){h=R}}}),this.resetProperties();var f,y,t,k,l=[256,256],i=[],r=[],A=5,O=[3,5,7,9,11],H=[];x._42=function(C,d){function G(Y,F,o,q){Vb(C,F.frame),U.setViewport(C,0,0,F.width,F.height),q?q(C):C.clear(C.COLOR_BUFFER_BIT|C.DEPTH_BUFFER_BIT),R!==Y&&Y.bind();var Q=0;for(var T in o){var x=o[T];x instanceof WebGLTexture&&(C.activeTexture(C.TEXTURE0+Q),C.bindTexture(C.TEXTURE_2D,x),x=Q,Q++),Y.uniforms[T]=x}for(R!==Y&&(I.upload(),V.upload(),Y.attributes.pos.pointer(V),R=Y),C.drawElements(C.TRIANGLES,6,C.UNSIGNED_SHORT,0);Q--;)C.activeTexture(C.TEXTURE0+Q),C.bindTexture(C.TEXTURE_2D,null);pi(C)}if(q){M||m();var R;G(y,f,{smoothWidth:.01,luminosityThreshold:N,tDiffuse:d.texture});var v,z=f,a=Math.round(l[0]/2),e=Math.round(l[1]/2);for(v=0;A>v;v++)G(H[v],i[v],{colorTexture:z.texture,direction:[1,0],texSize:[a,e]}),G(H[v],r[v],{colorTexture:i[v].texture,direction:[0,1],texSize:[a,e]}),a=Math.round(a/2),e=Math.round(e/2),z=r[v];return G(t,i[0],{blurTexture1:r[0].texture,blurTexture2:r[1].texture,blurTexture3:r[2].texture,blurTexture4:r[3].texture,blurTexture5:r[4].texture,bloomStrength:W,bloomRadius:h,bloomTintColor:[1,1,1]}),G(k,d,{image:i[0].texture},function(I){I.enable(I.BLEND),I.blendEquation(I.FUNC_ADD),I.blendFunc(I.SRC_ALPHA,I.ONE)}),C.blendEquationSeparate(C.FUNC_ADD,C.FUNC_ADD),C.blendFuncSeparate(C.SRC_ALPHA,C.ONE_MINUS_SRC_ALPHA,C.ONE,C.ONE_MINUS_SRC_ALPHA),d}}};ni._34Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!jbtijqpmob!!i-jmhfiyqf!ug!m-psbpum<pDvuovjqgupvspn!!)tybjnnq!m>f!ss3pEm!puDEhjbgsgGv`tmfh<<v*o!jwg!p-sinu!egjmXpibuup!pmnvtn!j,o!petmjpuiztUfissifUtziupjmtep<ojvnovjmg!p-senm!pgimtpfbsui!UtznupjptupioXjjnevumi!<)qwfbustzijuophp!nwtf!d>3!!bwiVqwm<b!wupbjpem!gnb<j*o1)/*1!!|-1w/f1d!5-!1u/f1y!f-m1!/>1!)u5fdyfuwv!s>f!3sEp)m!puDEujvgqguvvtpf!-5!dwfVww!<**<!bwnfvdm4!!-m{vznyb/!m>f!ywffud!4))u!p1e/!3>:!:w-!!u1b/p6m9g8-<!*1!/522",ni._35Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d1j/t2j!p-on!viTjuhiihqj!fgxm0pnbvuT<ftwvbgsgzjjeo)h5!dwffwd!3>!!wsVpwm<pDvhobjsgGp`smnh!t~bn<qxm!f+s!31E/!3d!p>m,p!snUvfTyuuivhsjff<xv<oxj!g+p!s*n3!fwmfqdn3b!tu!f,y!T2jf{mfq<nbvto)j!g>p,s!nn!vwTffdt3v!gegjjsefd<ucjhpso/<*u$fetfgggjPowfv!!L.F!SwOVFwM!`-SfBsEvJuVyTf!UEsFpGmJpOdF!`)WEB3MfVsFvu$yeffug!j>o!f3!fTmJqHnNbBt!!E4FdGfJwOF<`cWhBsM/V*FufgtmgpgbPuw!vh!b,v!twtVjwb!o-Qfesgv)ujyof!Ugsmppmbpud!!y)-E!3jfos!vgumypfbuu!!>t!j2hfnmbq*n!b|t!s4fdufvwso<!y1!/+4!:f9{:j5T!w+o!jf!y+q!)o!p.j1u/d6f!s+j!ey!!>+!!uyf0t)g!gtPjwhvn!b3!d+f!wtj<h*nbbn*h*j0Ttgj!h-nyb)<ge~Qowbpjjtet!vnbbhj!o>)!*x!!|ubwpfmdg3!<j*ojw)Tujb{pfm!g>!!>2!/y1!!u0b!pumfgyT|j!{*f!<,,g!mjp!b<uT!VgJTEjBhSn`bM!F>O!SgFmLp!b=u!)jT!J<H2N!B>*!<j!gumopjb!u)!sxpfgjh<inuvTTvuni!h>j!fhxb!v+t!tcjhbso/Q*ewgV)w1!/-1f-s!vguTyjfhUnsbp*m<pdw!f)dE43!fesjvgugyvftuf!T>v!n",ni._36Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*d!j*twjVpwo!!-i6jfhsivqu!ygfmUpsbvum<c)wEb3sfzsjvouhy!fwuf!d+3!!*w1V/w2<!-vsopjmgppDsuno!jtUbnnpqpmmfcs)35Ed!fcwm!v+s!U*f3y/u1v)ssfp2u<dbvGonjpgppmsCnq!stfbmnq!m,f!s*3wEV!wc!m-v5sfUsfvyuuyvfsUfs3v<mcv)oEj3gfpssvnu!ytfbun!q+m!f*s13/E2!!c-msvpsmUpfDyuuovjsUfn4p<pmvco)j5gdpfswn!!+t!b*n5q/m1f)ss3pEu!dcbmGvnspUpfmyCuqvssffm5<!,v!o*jwgVpws!n-!4tfbsnvqumyffsU3sEv!mccm)vEs3Uffsyvuuvysffu6!<+!v*o1j/g2p!s-ns!ptmbpnDqumofjsU3nEp!pemjcs)u5Udffywu!v+s!f*<7/v1o)jsgppusdnb!GgnmpppbmuC!qcsmfpmpn!T,u!s*fwoVhwu!i-<3fvsovjugypfsUns!vgmmcp)bEu3!fcsmvpupynfSub!e+j!v*t1</2v!o-jsgppmspnD!uwofjdU4n!pcpmmpcp)n5Udjfowu!D+p!m*p9s/<1)gsmppubdub!GmnfpspqmCCmqpspfnmGb!d,u!p*sw)Vdwp!o-t2uf!sjvou!ygfmUpsbvum!cg)bEd3ufpssv*u!y|fug!m+p!b*u1!/n2j!s-ssppsmGpbDduuopjsU!n>p!p2m/c3)!5.d!fgwb!d+u!p*s1</2s)fsupvusdob!Gnnjpyp)mgCbqdsufpms!-)!!n+j!sisuphsoGfbsduuTpnsp-p!mccm!p>p!nsSpbmepjDvhtb*s<G`~mhwp|j!e*!)nobj",ni.finalShader="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f*dwjVtwj!p-of!hibjnhji)qE!3gfmspvbuuy<fuv!o>j!gsppsmnp!DthbbnsqGm`fmsh3E|!!j*n)bohjfb<n!webjspzwjo<hw!Vwwf!d3";var Oq=S.graph3d.PostProcessing.Dof=function(X){function H(){t=!0;var F=X.getGL();K=new Qh.RenderTarget(X,F),N=X._postProcessing.createShader(F,Oq._38Q),A=Li.Buffer.createIndexBuffer(F,new Uint16Array([0,2,1,1,2,3])),d=Li.Buffer.createVertexBuffer(F,new Float32Array([0,0,1,0,0,1,1,1]))}var K,N,A,d,s,F,r,R,Z=this,y=!1,t=!1;this.serializeProperties="aperture,maxblur,image".split(","),this.resetProperties=function(){this.aperture=.025,this.maxblur=1,this.image=null},n.defineProperties(Z,{enable:{get:function(){return y},set:function(u){!!y!=!!u&&(y=u,u&&!t&&H())}},image:{get:function(){return F},set:function(w){F!==w&&(F=w,s&&(X.getGL().deleteTexture(s),s=null),X.iv())}},maxblur:{get:function(){return r},set:function(p){r!==p&&(r=p,X.iv())}},aperture:{get:function(){return R},set:function(M){R!==M&&(R=M,X.iv())}}}),this.resetProperties(),Z._42=function(E,L){function f(D,G,s,u){Vb(E,G.frame),X.setViewport(E,0,0,G.width,G.height),u?u(E):E.clear(E.COLOR_BUFFER_BIT|E.DEPTH_BUFFER_BIT),W!==D&&D.bind();
var n=0;for(var b in s){var v=s[b];v instanceof WebGLTexture&&(E.activeTexture(E.TEXTURE0+n),E.bindTexture(E.TEXTURE_2D,v),v=n,n++),D.uniforms[b]=v}for(W!==D&&(A.upload(),d.upload(),D.attributes.pos.pointer(d),W=D),E.drawElements(E.TRIANGLES,6,E.UNSIGNED_SHORT,0);n--;)E.activeTexture(E.TEXTURE0+n),E.bindTexture(E.TEXTURE_2D,null);pi(E)}if(y){t||H();var W;if(!s){var C=Nl(this.image);if(!C||!C.tagName)return L;s=Ud(E,C)}var r=L.width,n=L.height;return K.setSize(E,r,n),f(N,K,{tColor:L.texture,tDepth:s,aspect:r/n,aperture:this.aperture,maxblur:this.maxblur}),K}}};Oq._38Q="~bu<u*szj/ctvpuqf!!.w!f1d/32!!q-pyt/<tpwqb)s3zdjfowh!!>w!fwdV3w!w<V*w1</2w!p-j1e/!1n!b-j1o/)2w!p,j!e1*/!3|!+h!mz`/Qtpptqj.u!j-p1o/!2>!!.w!f1d/53)!q+p!ty/^#~qs<f1d/j2t!j>p!ob!/isjphmipqD!hgbmspGb`um<hw<b1s/z2j5o!h0!!wmfpdd3!!>w!Vswp<mpvDohjbgspGs`nm!hcp<p*m!!5vstvfmEcfgqpuei!<+!v*o!jugdpfssns!ptdbundqfmqftsb3!E+!!u*D!p5m/p1s!<-1v/o1j!g)p3sdnf!wt!b)n!q,m!fzsy3/Ew!VuwE!f-qsupim<pDvuo!j)gEp3sfns!vgumypfbuu!!>n,b!ymcpmdvs<<*!v5osjvgmpcsgnp!eg!m+p!b*u!!ubdqffsssupvdsufd<fqvtobj!g+p!s*n!!:g3m/p1b.u!!-o:f3b/s1D.m!j)q3<dfvwo!j)g!p,s!nz!yg/mwpVbwu!!-gsbpsmDpmDjuq!<)Ev3ofjsgvpusynf!ug!m>p,b!um!pgdpd<v*t!<5svvomjcggppsen!!+g!m*p!buud!fbstsqpfdduud<fqdtpbo!t+u!!*g!m1p/b1u!!-V5o/q1b.d!l)E3pdxfowt!d)b!m,f!!z>y!/3w6V6w/!!-0s!p3m6p7D/u<!!)0E03!f1s/v/u2y!f.u?!!>g,s!bmdpudjp<o*!!)5fsyvdmmcvgepjeo!h+!!2**!uddpfostsup!dwufddf4q!tQbb!d+l!G*b!d:u3p/s1t!!->:!3w/f1d.4!))!33d6f7w/!!)+!!,3!6z7y//!w+V!w3!6-7s/p-m!p3D6u7!/)!E+3!f3s6v7u/y-f!u3!6>7,/!!m*p<dd<p*o!t5us!vwmfcdg5p!eV!o+q!b*d!luGdbfdsusppsdtu!d>f!qVtobq!b+d!l*E!p5x/o1t.d!b-m1f/!10!!)w3fddf5w)!!)Q!b,d!lzGyb/dwuVpws!t--s!p2m/p!D*u<!)gEm3pfbsuv!uvyofqub!d>l,S!HmCpBdUp<E*f!q5usiv)m!cdgppoet!u+!!j*o!!uwdffds5s!pwd!u*d!f|qt!bs!f+u!v*s!o:!3e/p1u.)!!-w:-3!/V1o!q)b3ddlfGwb!d)u!p,s!tz!y*/<wV~w!g-msppbmup!Dhuf!u)EEf3qfusiv)u!ydfpuo!t>u,!!jmop!dwf<d*3!!5tsdvsmfcfgopQep!t+j!u*j!puod!f*s!s|pd\nusdffuqvtsbo!!+v!o*q!b1d/l1S!H-C5B/U1p!E)f3qdufiw)!!)u!f,y!uzvys/fw3VEw)!!-usEpfmqpuDiu-!!)tEd3sffsfvouQypftuj!u>j,p!om!p*d!*<<*!~5sgvmmpcbgup!eq!f+s!t*q!fuddufjswsfpEdfuqdufiqUtpbW!j+f!x*[!):!3d/p1o!t-u:!3j/o1!!g)m3pdbfuw!!j)o!w,D!mzjyq/[w-V!wd!p-ostpum!pjDou!!g)mEp3bfus!voufybfsu-!!>d,p!omtpud!j<o*!!g8mspvbmuc!ggpbes!!+*!!*|!u!dsffsusvpsdou!d)f!qotfbb!s+!!+*!!g5b/s1!!*-!10/!1)!!))3!dgfbws!!).!!,o!fzbys/!w*V!w+!!-jsopwmDpmDjuq![)!E.3!fgsbvsu!y*f<u!~>,g!mmppbdu!<h*f!u8Wsjvfmxc[g)p!ed!p+o!t*u!!ujdof!sgsmppdbuud!feqftqbu!i+!!**!!|:3\n/s1f.u!v-s:o3!/q1f.s!t)q3fddfuwj!w)f!E,f!qzuyi/UwpVWwj!f-xs[p)m!peDfuq!u)iE-3!fosfvbusyDfmuj!q>-,!!gmbpsdDm<j*q!!8*s<vm~cgwppej!e+!!n*b!juod)f*s!s|pdwufddf3q!tebp!g+c!m*v!s1</1w!f-d53/!1b.t!q)f3ddufdwp!s)s!f,d!uz!y>/!wwVfwd!3-)s!p2m/p1D-u!!b)tEq3ffdsuv!u*y<fuj!g>!,)!vmtpfdEf<q*u!i8*s!v|mc!ggpmep!b+u!!*w!jufdxf[s!s>p!dhufdufWqjtfbx![+)!!*h!f:u3E/f1q!u-i:)3!/w1V.w!!)*3!d*f<w!!)g!m,p!bzuy!/gwbVdwu!p-ss!p>m!p)D!ug!p)dEv3tf!s,v!uwyjffux![>!,*!<mp!dep<g*c!m8vssv!m>c!gwpfed!3+!!)*!!dumdbfnsqs)p!dgubddfuqptsb!!++!!b*q!f5s/u1v.s!f--1!/.1n!b)y3cdmfvws!-)!!n,b!yzcym/vwsV!w*!!-*s<pm~pDfum!t)fE!3|fs!veupygfcum!v>s,!!>m!pwdfd<3*!!)8!sdvmmbcngqp)e!!u+f!y*u!vusdff3sEs)p!duuEdffqqutib-!!+w!f*d!3:)3w/V1w./!y--:!32//11!!).3!dwfVww!/)z!*,!!*z/yb/!w+V!wb!q-fsspumvpsDfu-!!).En3bfyscvmuvysf-u!!n>b,y!cmmpvds!<**!!*8<sv~mcwgfpde3!!+e!p*g!cumdvfss:s!p>d!uedpfgqctmbv!s+!!+*!!11//:1<!-w1f5d/31!!e)p3gdcfmwv!s)8!!,>!!zeyp/gwcVmwv!s-!s+p!m1p/D8u<!)wEf3df3s!veupygfcum!v>s,5!!m>p!dep<g*c!m8vssv!m+c!g1p/e5!<+!w*f!du5d!fdspsmp!d>u!dwffqdt5b)!!+1!/*1!!:*3</1d!p-m:!3,/>1!!u)f3ydufvws!f)3!E,)!!zuyD/pwmVpws!--!swpVmwp/Dyuz!!)*E<3fdspvmu!y,f>u!!u>f,y!umvpsdf3<E*)!!:usDvpmmcpgsp-e!!w+V!w*/!yuzd!f,s!s)p!dwufddf3q)t!b1!/+1!-*!!18/45/!1*.!!+-!6b2t/q1f!d)u3ddpfsws!f)d!u,!!*z!y+/!weVpwg!c-msvpsm!p*D<u!d)pEm3!f,s>v!uuyffyuu!v>s,f!3mEp)d!u<D*p!m:pssv-m!cwgVpwe/!y+z!!*,!!u)d!fwsfsdp3d)u!d1f/q2t6b-!!+1!/*4!86!2*/!1+.!!b-t8q4f/d1u.d!p)s3sdffdwu!!)*!!,+!!zeyp/gwcVmwv!s-!s*p<mpdDpum!!),E>3!fusfvyuuyvfsuf!3>E,)!!mupDdpm<p*s!-:!swvVmwc/gypze!!,+!!)*!!wufddf3s)s!p1d/u3d:f-q!t1b/!3+:!!**!!6+2!/b1t!q-f8d4u/d1p!s)s3fddfuw!!*)!!+,!!ezpyg/cwmVvws!!-*s<pmdppDmu!!,)>E!3uffsyvuuvysffu3!E>),!!umDppdmp<s*-!!:wsVvwm/cygzp!e,!!+)!!*w!fudd3f)s!s.p1d/u4d8f-q!t1b/!2+6!!**!!8+4!/b1t!q-f6d2u/d1p.s!s)f3dduf!w*!!)+!!,e!pzgyc/mwvVsw!!*-<spdmppmD!u,!>)!Eu3ffysuvvusyff3uE!)>!,u!Dmppmdps<-*!!w:Vswv/myczg!p,e!!)+!!w*f!du3d)f!s1s/p5d1u-d!f1q/t1b!!*+!!+*!!b8t4q/f1d.u!d-p6s2s/f1d.u!!)*3!d+f!we!p)g!c,m!vzsy!/*w<Vwd!p-ms!p,m>p!Duuf!y)uEv3sffs3vEu)y!fuuD!p>m,p!sm-p!dwV<w*/!y:zs!v,m!c)g!pwef!d+3!)*!!1u/d4f8s-s!p.d1u/d2f6q!t*b!!++!!b*t!q6f2d/u1d.p!s-s8f4d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!z:!s,v!m)c!gwpfed!3+)!!*1!/u3d:f-s!s.p1d/u3d:f!q*t!b+!!+b!t*q!f6d2u/d1p!s-s8f4d/u1!.*!!)+3!defpwg!c)m!v,s!!z*y</wdVpwm!!-,s>p!mupfDyuu!v)sEf33fEs)v!uuyDfpum!p>s,-!!mwpVdw/<y*z!!:,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s.p1d/u4d8f!q*t!b+!!+b!t*q!f8d4u/d1p!s-s6f2d/u1!!*)!3+d!fewp!g)c!m,v!sz!y*/<wVdwp!m-!s,p>m!puDfuy!u)vEs3ff3sEv)u!yufDup!m>p,s!-m!pwdVw</*y!zs!v,m!c)g!pwef!d+3!)*!!1u/d1f-s!s.p1d/u5d!f*q!t+b!!b+t!q*f!d8u4d/p1s.s!f-d6u2!/*1!!+)!3edpfgwc!m)v!s,!!*z<y/dwpVmw!!,->s!pumfpyDuuv!s)fE33Ef)s!vuuDypfmup!s>-,!!wmVpwd/y<z*!!,s!v)m!cwgfpde3!)+!!.*1!/u2d6f-s!s1p/d4u8d!f*q!t+b!!b+t!q*f!d:u3d/p1s.s!f-d:u3!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3EE3)f!suvDupymfpus!->!,w!Vmwp/dyz<!*,!!s)v!mwcfgdp3e)!!+.!1*/!3u:d-f!s1s/p3d:u!d*f!q+t!bb!t+q!f*d!u6d2p/s1s.f!d-u8!4*/!1+.!!e)p3gdcfmwv!s)!!*,<!zdyp/mw!V,w>!!-usfpymupvDsuf!3)EE)3!fusDvpumypfsu-!!>w,V!wm/pydz!<,*!!)s!vwmfcdg3p)e!!1+/!4*8!-u!d1f/s2s6p!d*u!d+f!qbttbq!f+d!u*d!p1s/s1f!d-u5!/*1!.+!!)e3pdgfcwm!v)s!!,*!<zyd/pwmV!w,!>-!supfmypuDvus!f)3E",Gh(x,{accordionViewExpandIcon:Jr(Ad),accordionViewCollapseIcon:Jr(Ad,!0),accordionViewLabelColor:Gm,accordionViewLabelFont:Bg,accordionViewTitleBackground:Zo,accordionViewSelectBackground:wp,accordionViewSelectWidth:3,accordionViewSeparatorColor:i,splitViewDividerSize:1,splitViewDividerBackground:Zo,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Ng,rect:[2,2,12,12],background:Ad}]},propertyViewLabelColor:An,propertyViewLabelSelectColor:Gm,propertyViewLabelFont:Bg,propertyViewExpandIcon:Jr(xd),propertyViewCollapseIcon:Jr(xd,!0),propertyViewBackground:Il,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:zs,propertyViewColumnLineColor:zs,propertyViewSelectBackground:wp,listViewLabelColor:An,listViewLabelSelectColor:Gm,listViewLabelFont:Bg,listViewRowLineVisible:!1,listViewRowLineColor:zs,listViewSelectBackground:wp,treeViewLabelColor:An,treeViewLabelSelectColor:Gm,treeViewLabelFont:Bg,treeViewExpandIcon:Jr(Pj),treeViewCollapseIcon:Jr(Pj,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:zs,treeViewSelectBackground:wp,treeViewDoubleClickToToggle:!0,tableViewLabelColor:An,tableViewLabelSelectColor:Gm,tableViewLabelFont:Bg,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:zs,tableViewColumnLineColor:zs,tableViewSelectBackground:wp,treeTableViewLabelColor:An,treeTableViewLabelSelectColor:Gm,treeTableViewLabelFont:Bg,treeTableViewExpandIcon:Jr(Pj),treeTableViewCollapseIcon:Jr(Pj,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:zs,treeTableViewColumnLineColor:zs,treeTableViewSelectBackground:wp,tableHeaderLabelColor:An,tableHeaderLabelFont:Bg,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Lg,tableHeaderBackground:Il,tableHeaderMoveBackground:vd,tableHeaderInsertColor:wp,tableHeaderSortDescIcon:Hg(xd,!0),tableHeaderSortAscIcon:Hg(xd),tabViewTabGap:1,tabViewLabelColor:Gm,tabViewLabelFont:Bg,tabViewTabBackground:Zo,tabViewSelectWidth:3,tabViewSelectBackground:wp,tabViewMoveBackground:vd,tabViewInsertColor:wp,toolbarLabelColor:An,toolbarLabelSelectColor:Gm,toolbarLabelFont:Bg,toolbarBackground:Il,toolbarSelectBackground:wp,toolbarItemGap:8,toolbarSeparatorColor:Di},!0);var hj={translateX:1,sortColumn:1},Wl={sortable:1,sortOrder:1,sortFunc:1},Cg={focusData:1},_j={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},mp={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},Sf=function(z,I){I.add(z),z.hasChildren()&&z.eachChild(function(K){Sf(K,I)})},zb=function(r,u,Q,w,M,l,W,p,D,f,y){var A,o=Q.getValueType(f),Y=Q.getAlign(f);if(Q.getEnumValues(f)){var H=Q.toEnumLabel(u,f),P=bh||0,K=0,_=l,q=x.getTextSize(w,H).width;return A=Nl(Q.toEnumIcon(u,f)),A&&(K=l+bh/2,"center"===Y?K+=(p-(P+q))/2:"right"===Y&&(K=K+p-(P+q)),Kr(r,A,K,W+D/2,f,y),_=K+bh/2),H!=a&&(A?sp(r,H,w,M,_,W,p-(_-l),D):sp(r,H,w,M,l,W,p,D,Y)),void 0}return u=Q.formatValue(u),u!=a?o===dr?(vm(r,l,W,p,D,u),void 0):o===Fn||!o&&Xq(u)?(A=Nl(u?xn:cf),Kr(r,A,l+p/2,W+D/2,f,y),void 0):(sp(r,u,w,M,l,W,p,D,Y),void 0):void 0},eb=function(W,I){var p=I.view,H=Xk(W),e=I.column||I.property;p.getDataModel().beginTransaction(),I.editor=W,W.info=I,p.setCurrentEditor(W),p.getView().insertBefore(H,p._79O),dp(W,I.editorRect),W.setFocus?W.setFocus():Rk(W),W.commitValue=function(u,A){W._17Q&&(W=W._17Q),A||p.setValue(I.data,e,W.getValue?W.getValue():W.value),W.close&&W.close(),Tn(H)},e.onEditorCreated&&e.onEditorCreated(I)},bb=function(z,Y,Q,g,b){var k=Cb(z,Q),S=Y.value,e=Y.view,X=b.getValueType(Y.data);return k.onblur=k.onchange=function(){e.endEditing()},"input"===z?(S=b.formatValue(S),S!=a&&(k.value=S),k.onkeydown=function(a){Jc(a)?e.endEditing():Te(a)&&e.endEditing(!0)},(X===dn||X===ii)&&k.addEventListener(Ld,x.numberListener,E)):z===Eh&&g.forEach(function(x){var i=H.createElement("option");i.innerHTML=b.toEnumLabel(x),i.value=x,b.isEnumEqual(S,x)&&(i.selected=!0),Oc(k,i)}),eb(k,Y),k},tn=S.widget={},Vo=function(E,O,F){ri(D+".widget."+E,O,F)};Gh(sl,{ms_value:function(F){F.getValue=function(D){var r=this.getItemById(D),T=r.element;return Tp(T)?T:T?T.getValue?T.getValue():T.value:r.selected},F.setValue=function(r,z){var j=this.getItemById(r);if(j){var L=j.element;L&&!Tp(L)?L.setValue?L.setValue(z):L.value=z:Xq(z)?(j.selected=z,this.iv()):(j.element=z,this.iv())}},F.v=function(n,z){var O=this;if(2===arguments.length)O.setValue(n,z);else{if(!$p(n))return O.getValue(n);for(var i in n)O.setValue(i,n[i])}return O}},_46o:function(V){V._icon=a,V._accessType=a,V._valueType=a,V._editable=!1,V._batchEditable=!0,V._align=ce,V._nullable=!0,V._emptiable=!1,V.setParent=os,V.formatValue=function(k){var T=this,Q=T._valueType;return T.getEnumValues()?T.toEnumLabel(k):Q===Fn?!!k:k!=a&&Q===dn?B(k):k},V.setEnum=function(Y,W,k,$,e,y,E){var C=this;Y&&!mr(Y)&&Y.values&&($=Y.editable,k=Y.icons,W=Y.labels,e=Y.strict,y=Y.maxHeight,E=Y.dropDownWidth,Y=Y.values),Zm(Y)&&(Y=Y._as),Zm(W)&&(W=W._as),Zm(k)&&(k=k._as),C._enumValues=Y,C._enumLabels=W,C._enumIcons=k,C._enumEditable=$,C._enumStrict=e==a?!0:e,C._enumMaxHeight=y,C._enumDropDownWidth=E,Y&&Y.length&&Sm(Y[0])&&(C._valueType=ii),C.fp("enum",!1,!0)},V.getEnumDropDownWidth=function(){return this._enumDropDownWidth},V.getEnumMaxHeight=function(){return this._enumMaxHeight},V.isEnumEditable=function(){return this._enumEditable},V.getEnumValues=function(){return this._enumValues},V.getEnumLabels=function(){return this._enumLabels},V.getEnumIcons=function(){return this._enumIcons},V.isEnumStrict=function(){return this._enumStrict},V.isEnumEqual=function($,s){return this._enumStrict?$===s:$==s},V.toEnumLabel=function(Y,W){var U=this,K=U.getEnumValues(W),X=U.getEnumLabels(W);if(K&&X)for(var P=0;P<K.length;P++)if(U.isEnumEqual(Y,K[P]))return X[P];return Y},V.toEnumIcon=function(N,h){var K=this,C=K.getEnumValues(h),O=K.getEnumIcons(h);if(C&&O)for(var c=0;c<C.length;c++)if(K.isEnumEqual(N,C[c]))return O[c];return i}},_45o:function(C){C._87o=function(U,R,K,g,n,f){if(U){var $=this,H=$._90I,s=we(1);$._columnLineVisible&&(n-=1),$._rowLineVisible&&(f-=1),0>=n||0>=f||($._90I||(H=$._90I={}),H[R]||(H[R]=new kg),dp(s,$.tx()+K,$.ty()+g,n,f),Oc(s,U),$._view.insertBefore(s,$._79O),U.onParentAdded&&U.onParentAdded(s),H[R].add(s))}},C._76o=function(){var c=this,j=c._90I;if(j){for(var H in j)j[H].each(function(g){Tn(g)});delete c._90I}},C._77o=function(E){var f=this;if(f._90I){var M=f._90I[E];M&&(M.each(function(M){Tn(M)}),delete f._90I[E])}}},_47o:function(I){I.getValue=function(C,Q){return Q.getValue?Q.getValue(C,Q,this):Bm(C,Q.getAccessType(),Q.getName())},I.setValue=function(P,r,z){if(r.isEmptiable(P)||""!==z||(z=i),r.isNullable(P)||z!=a){var W=this,R=r.getName(P),I=r.getAccessType(P),Z=r.getValueType(P);Z===dn&&Tp(z)?z=s(z):Z===ii&&Tp(z)?z=parseFloat(z):Z===Fn&&Tp(z)&&(z="true"===z),W._batchEditable&&r._batchEditable&&W.isSelected(P)?W.sm().each(function(K){r.setValue?r.setValue(K,r,z,W):rr(K,I,R,z)}):r.setValue?r.setValue(P,r,z,W):rr(P,I,R,z)}},I.setCurrentEditor=function(N){this.endEditing(),this._currentEditor=N,this.redraw()},I.isEditing=function(n,O){var t=this,K=t._currentEditor;if(!K)return!1;if(O){var F=K.info;return F?(F.column||F.property)===O&&F.data===n:!1}return!0},I.endEditing=function(e){var Q=this,E=Q._currentEditor;E&&(delete Q._currentEditor,E.commitValue&&E.commitValue(E.info,e),Q.redraw(),Q.getDataModel().endTransaction())},I.beginEditing=function(j){this.endEditing();var P=this,W=j.column||j.property;if(W.beginEditing)W.beginEditing(j);else{var K=j.data,t=j.value,r=P.getSelectBackground(K),y=W.getEnumValues(K),w=W.getSlider(K),Y=W.getColorPicker(K);if(w){var o=bi(tn.Slider,w);return o.setValue(t),o.getView().onblur=function(){P.endEditing()},o.isInstant()&&(o.onValueChanged=function(){P.setValue(K,W,o.getValue())}),eb(o,j),void 0}if(Y||W.getValueType(K)===dr){var n=bi(tn.ColorPicker,Y);return n.setValue(t),n.onClosed=function(){P.endEditing()},n.isInstant()&&(n.onValueChanged=function(m,B){P.setValue(K,W,B)}),eb(n,j),n.open(),void 0}if(y){if(tn.ComboBox){var V=new tn.ComboBox;V.setValue(t),V.setValues(y),V.setLabels(W.getEnumLabels(K)),V.setIcons(W.getEnumIcons(K)),V.setEditable(W.isEnumEditable(K)),V.setStrict(W.isEnumStrict(K)),V.setMaxHeight(W.getEnumMaxHeight(K)),V.setDropDownWidth(W.getEnumDropDownWidth(K)),V.onClosed=function(){P.endEditing()},eb(V,j),V.open()}else bb(Eh,j,r,y,W);return}var T=W.getValueType(K);if(T===Fn||Xq(t))return P.setValue(K,W,!t),void 0;if(W.getItemEditor(K)){var x=tg(W.getItemEditor(K)),u=new x(K,W,P,j),J=u.getView();return J._17Q=u,u.setValue(t),rb(J),eb(J,j),u.editBeginning&&u.editBeginning(),void 0}bb("input",j,r,a,W)}}},_44o:function(Z){Z.init=function(w){var _=this,D=_.th=new Wh(w),O=_._view=Qm(1,_);_.tv=_._tableView=w,Oc(O,D.getView()),Oc(O,w.getView()),D.mp(function(G){G.property===ss&&_.iv()}),_.iv()},Z.getTableView=function(){return this.tv},Z.getTableHeader=function(){return this.th},Z.getDataModel=function(){return this.tv.dm()},Z.getColumnModel=function(){return this.tv.getColumnModel()},Z.setColumns=function(n){this.tv.setColumns(n)},Z.addColumns=function(e){this.tv.addColumns(e)},Z.endEditing=function(){this.tv.endEditing()},Z.validateImpl=function(){var h=this,X=h.th,m=hm(X),W={x:0,y:0,width:h.getWidth(),height:m};dp(X,W),W.y=m,W.height=w(0,h.getHeight()-m),dp(h.tv,W)}},ms_vs:function(L){L._41o=function(){return this._29I.height<this._59I},L._43o=function(){var t=this;t._41o()&&(t._58I||(q(function(){t._94O()},qg),t.iv()),t._58I=new Date)},L._94O=function(){var a=this;if(a._58I){var b=new Date;b.getTime()-a._58I.getTime()>=qg?(delete a._58I,a.iv()):q(function(){a._94O()},qg)}},L._93I=function(){var Q=this,J=Q._27I;if(Q._58I||!Q._autoHideScrollBar){J||Oc(Q._79O,J=Q._27I=we());var T=Q._29I,p=T.height,r=Q._59I,_=Q.getScrollBarSize(),F=T.width-_-2,i=p*(-Q.ty()/r),A=p*(p/r),R=J.style;r>p?(qc>A&&(i=i+A/2-qc/2,0>i&&(i=0),i+qc>p&&(i=p-qc),A=qc),R.visibility=ic,R.background=Q.getScrollBarColor(),R.borderRadius=_/2+Af,dp(J,F,i,_,A)):R.visibility=Gk}else J&&(J.style.visibility=Gk)}},ms_hs:function(N){N._40o=function(){return this._29I.width<this._91I},N._42o=function(){var g=this;g._40o()&&(g._95O||(q(function(){g._94I()},qg),g.iv()),g._95O=new Date)},N._94I=function(){var A=this;if(A._95O){var N=new Date;N.getTime()-A._95O.getTime()>=qg?(delete A._95O,A.iv()):q(function(){A._94I()},qg)}},N._92I=function(){var A=this,f=A._28I;if(A._95O||!A._autoHideScrollBar){f||Oc(A._79O,f=A._28I=we());var P=A._29I,X=P.width,N=A._91I,b=A.getScrollBarSize(),n=P.height-b-2,x=X*(-A.tx()/N),v=X*(X/N),M=f.style;N>X?(qc>v&&(x=x+v/2-qc/2,0>x&&(x=0),x+qc>X&&(x=X-qc),v=qc),M.visibility=ic,M.background=A.getScrollBarColor(),M.borderRadius=b/2+Af,dp(f,x,n,v,b)):M.visibility=Gk}else f&&(f.style.visibility=Gk)}}}),ai(xn,Wo(16,16,[{type:is,rect:[1,1,14,14],background:wp},{type:Ml,rect:[1,1,14,14],width:1,color:Qk},{type:vp,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),ai(cf,Wo(16,16,{type:Ml,rect:[1,1,14,14],width:1,color:Qk})),ai(xe,Wo(16,16,[{type:Wj,rect:[2,2,12,12],borderWidth:1,borderColor:Qk,background:"#FFF"},{type:Wj,rect:[4,4,8,8],background:wp}])),ai(od,Wo(16,16,{type:Wj,rect:[2,2,12,12],borderWidth:1,borderColor:Qk})),sl._15Q=function(n){n._29I=Sr,n._59I=0,n._91I=0,n._5o=function(P){var I=this;I._30I=new kg,I._rows=new kg,I._rowMap={},I._31I=0,I._14I=0,I._view=Qm(1,I),I._canvas=xp(I._view),Oc(I._view,I._79O=we()),I.dm(P?P:new Wn)},n.getCheckIcon=function(J){var P=this.sm(),Q=P.co(J);return P.sg()?Nl(Q?xe:od):Nl(Q?xn:cf)},n.checkData=function(X){var R=this.sm(),M=R.co(X);R.sg()&&M||(this._32o=1,M?R.rs(X):R.as(X),delete this._32o)},n.getDataAt=function(Q){Q.target&&(Q=this.lp(Q));var N=P(Q.y/this._rowHeight),j=this._rows;return 0>N||N>=j.size()?a:j.get(N)},n.onDataDoubleClicked=function(){},n.onDataClicked=function(){},n.adjustTranslateX=function(){return 0},n.adjustTranslateY=function(p){var T=this.getHeight()-this._59I;return T>p&&(p=T),p>0?0:B(p)},n.onPropertyChanged=function(l){var A=this,S=l.property;_j[S]?A.ivm():Cg[S]||A.redraw(),S===nb?A._42o():S===rl&&A._43o()},n.getLabel=function(s){return s.toLabel()},n.getLabelFont=function(){return this._labelFont},n.getLabelColor=function(q){var D=this;if(D.isCheckMode()){if(D._focusData===q)return D._labelSelectColor}else if(D.isSelected(q))return D._labelSelectColor;return D._labelColor},n.getStartRowIndex=function(){return this._31I},n.getEndRowIndex=function(){return this._14I},n.getRowDatas=function(){return this._rows},n.getRowIndex=function(t){return this._rowMap[t._id]},n.getRowSize=function(){return this._rows.size()},n.getViewRect=function(){return Hj(this._29I)},n.isVisible=function(l){return this._visibleFunc?this._visibleFunc(l):!0},n.getCurrentSortFunc=function(){return this._sortFunc},n.setDataModel=function(E){var J=this,H=J._dataModel,Y=J._selectionModel;H!==E&&(H&&(H.umm(J.handleDataModelChange,J),H.umd(J.handleDataPropertyChange,J),H.umh(J.handleHierarchyChange,J),Y||H.sm().ums(J.handleSelectionChange,J)),J._dataModel=E,E.mm(J.handleDataModelChange,J),E.md(J.handleDataPropertyChange,J),E.mh(J.handleHierarchyChange,J),Y?Y._21I(E):E.sm().ms(J.handleSelectionChange,J),J.fp("dataModel",H,E))},n.validateModel=function(){var u=this;u._rows.clear(),u._rowMap={},u.buildChildren(u._dataModel._roots);var p=u._rows=u._rows.toList(u.isVisible,u),E=0,g=u.getCurrentSortFunc(),c=p.size();for(g&&p.sort(g);c>E;E++)u._rowMap[p.get(E)._id]=E},n.buildChildren=function(P){var J=this;P.each(function(n){J._rows.add(n),J.buildChildren(n._children)})},n.handleDataModelChange=function(){this.ivm()},n.handleDataPropertyChange=function(x){"parent"===x.property?this.ivm():this.invalidateData(x.data)},n.handleHierarchyChange=function(){this.ivm()},n.handleSelectionChange=function(u){u.datas.each(this.invalidateData,this),this.onSelectionChanged(u)},n.onSelectionChanged=function(m){var G=this,g=G.sm();!G.isAutoMakeVisible()||1!==g.size()||"set"!==m.kind&&"append"!==m.kind||G._32o||G.makeVisible(g.ld())},n.handleBackgroundClick=function(T){Rl(T)&&!this.isCheckMode()&&this.sm().cs()},n.makeVisible=function(R){R&&(this._23I=R,this.iv())},n.scrollToIndex=function(x){var p=this,m=p._29I,c=m.height,M=p._rowHeight,y=M*x;x>=0&&x<p._rows.size()&&c>0&&(y+M>m.y+c?p.ty(-y+c-M):y<m.y&&p.ty(-y))},n.autoScroll=function(K,q){var H=this,j=H._rowHeight,V=j,Z=j/4,b=H._29I,M=H.lp(K),D={x:H.tx(),y:H.ty()};return j>0&&b&&(M.x-b.x<V?H.translate(Z,0):b.x+b.width-M.x<V&&H.translate(-Z,0),M.y-b.y<V?H.translate(0,Z):b.y+b.height-M.y<V&&H.translate(0,-Z)),D.x=H.tx()-D.x,D.y=H.ty()-D.y,q&&(q.x+=D.x,q.y+=D.y),D},n.getTopRowOrderSelection=function(){var D=this.sm().getTopSelection(),b={},P=new kg;return D.each(function(z){b[z._id]=z}),this._rows.each(function(A){b[A._id]&&P.add(A)}),P},n.getRowOrderSelection=function(){var O=new kg;return this._rows.each(function($){this.isSelected($)&&O.add($)},this),O},n.ivm=function(){this.invalidateModel()},n.invalidateModel=function(){var H=this;H._96I||(H._96I=1,H._32I=1,delete H._24I),H.iv()},n.redraw=function(){var t=this;t._32I||(t._32I=1,delete t._24I,t.iv())},n.invalidateData=function(Z){var x=this;V?x.redraw():x._32I||(x._24I||(x._24I={}),x._24I[Z._id]=Z,x.iv())},n.getFocusData=function(){return this._focusData},n.setFocusDataById=function(y){this.setFocusData(this.dm().getDataById(y))},n.setFocusData=function(Q){var h=this,O=h._focusData;O!==Q&&(h._focusData=Q,h.fp("focusData",O,Q),O&&h.invalidateData(O),Q&&(h.invalidateData(Q),h.isAutoMakeVisible()&&h.makeVisible(Q)))},n.drawRowBackground=function(n,W,q,K,j,M,h){var z=this,X=z.isCheckMode();(W===z._focusData&&X||q&&!X)&&vm(n,K,j,M,h,z.getSelectBackground(W))},n.drawData=function(V,w,i){var R=this,Y=R._rowHeight,u=Y*i,h=R._29I,p=h.x,f=h.width;V.save(),V.beginPath(),V.rect(p,u,f,Y),V.clip(),R._87o(R.drawRow(V,w,R.isSelected(w),p,u,f,Y),i,p,u,f,Y),V.restore(),R._rowLineVisible&&vm(V,p,u+Y-1,f,1,R._rowLineColor)},n._12I=function(V){var H=this,h=H._31I,E=H._29I,m=E.x,R=E.y,y=E.width,K=E.height;for(V.beginPath(),V.rect(m,R,y,K),V.clip(),V.clearRect(m,R,y,K),H._76o(),H._93db(V);h<H._14I;h++)H.drawData(V,H._rows.get(h),h);H._92db(V)},n._13I=function(V){for(var e,J=this,a=J._rowHeight,x=J._29I,f=x.x,z=x.width,k=J._31I,N=J._30I;k<J._14I;k++)e=J._rows.get(k),J._24I[e._id]&&N.add({data:e,index:k});N.isEmpty()||(V.beginPath(),N.each(function(e){V.rect(f,e.index*a,z,a)}),V.clip(),N.each(function(A){V.clearRect(f,A.index*a,z,a)}),N.each(function(Q){J._77o(Q.index)}),J._93db(V),N.each(function(d){J.drawData(V,d.data,d.index)}),J._92db(V),N.clear())},n.preValidateModel=function(){this.endEditing&&this.endEditing()},n.validateImpl=function(){var e=this,n=e._canvas,$=e.getWidth(),b=e.getHeight(),l=e._rowHeight,j=e._32I;($!==n.clientWidth||b!==n.clientHeight)&&(ms(n,$,b),j=1);var t=L&&!c;e._96I&&!t&&(e.preValidateModel(),e.validateModel());var I=e._29I,A={x:-e.tx(),y:-e.ty(),width:$,height:b},v=e._rows.size(),Y=wo(n),Q=e._23I;j||$l(A,I)||(j=1),e._29I=A,e._59I=v*l+e.getScrollBarSize(),e._31I=P(A.y/l),e._14I=F((A.y+A.height)/l),e._31I<0&&(e._31I=0),e._14I>v&&(e._14I=v),e._99I&&j&&e._99I(),or(Y,e.tx(),e.ty(),1),j?e._12I(Y):e._24I&&e._13I(Y),e._93I(),e._92I(),Y.restore(),e._32I=e._24I=e._96I=a,Q&&(e.scrollToIndex(e.getRowIndex(Q)),delete e._23I),e.tx(e.tx()),e.ty(e.ty())}},sl._48o=function(u){u._rootVisible=!0,u._rootData=a,u._35o=function(){this._expandMap={},this._levelMap={}},u.validateModel=function(){var P=this,q=P._rootData;P._rows.clear(),P._levelMap={},P._rowMap={},P._currentLevel=0,q?P._rootVisible?P.isVisible(q)&&P.buildData(q):P.buildChildren(q):P.buildChildren(),delete P._currentLevel},u.buildData=function(w){var c=this,g=w._id,u=c._rows;c._rowMap[g]=u.size(),u.add(w),c._levelMap[g]=c._currentLevel,c.isExpanded(w)&&(c._currentLevel++,c.buildChildren(w),c._currentLevel--)},u.buildChildren=function(J){var a=this,s=J?J._children:a._dataModel._roots,o=a.getCurrentSortFunc();o&&a.isChildrenSortable(J)?s.toList(a.isVisible,a).sort(o).each(a.buildData,a):s.each(function(h){a.isVisible(h)&&a.buildData(h)})},u.getLevel=function(u){return this._levelMap[u._id]},u.getToggleIcon=function(A){var u=this,W=u._loader,U=u._collapseIcon;return W&&!W.isLoaded(A)?U:A.hasChildren()?u.isExpanded(A)?u._expandIcon:U:a},u.isCheckMode=function(){return this._checkMode!=a},u.isChildrenSortable=function(){return!0},u.handleDataModelChange=function(k){var p=this;k.kind===rc?delete p._expandMap[k.data._id]:k.kind===Sg&&(p._expandMap={}),p.ivm()},u.toggle=function(J){var n=this;n.isExpanded(J)?n.collapse(J):n.expand(J)},u.isExpanded=function(a){return 1===this._expandMap[a._id]},u.expand=function(X){var P=this,D=P._loader;P.isExpanded(X)||(D&&!D.isLoaded(X)&&D.load(X),P._expandMap[X._id]=1,P.ivm(),P.onExpanded(X))},u.onExpanded=function(){},u.collapse=function(u){var h=this;h.isExpanded(u)&&(delete h._expandMap[u._id],h.ivm(),h.onCollapsed(u))},u.onCollapsed=function(){},u.expandAll=function(L){if(L)this.expand(L),L.eachChild(function(A){this.expandAll(A)},this);else{var f=this;f._dataModel.each(function(N){N.hasChildren()&&(f._expandMap[N._id]=1)}),f.ivm()}},u.collapseAll=function(){this._expandMap={},this.ivm()},u.makeVisible=function(x){if(x){var U=this;if(!U._rootData||x.isDescendantOf(U._rootData)){for(var O=x._parent;O;)U.expand(O),O=O._parent;U._23I=x,U.iv()}}},u.checkData=function(G){var K,S=this,R=S._checkMode,l=S.sm(),O=l.co(G);if(!l.sg()||!O){if(S._32o=1,R===nn)O?l.rs(G):l.as(G);else if(R===Wq)K=new kg(G),K.addAll(G._children);else if("descendant"===R)K=new kg,Sf(G,K);else if("all"===R&&(K=new kg,Sf(G,K),!O))for(var T=G._parent;T;)K.add(T),T=T._parent;K&&(O?l.rs(K):l.as(K)),delete S._32o}},u._97I=function(G,j,l,W,J,k,T){var s=this,b=s._indent,n=s._levelMap[j._id],D=s.getIconWidth(j),K=Nl(s.getToggleIcon(j));K?(W+=b*n,Kr(G,K,W+b/2,J+T/2,j,s),W+=b):W+=b*(n+1),s._checkMode&&(Kr(G,s.getCheckIcon(j),W+b/2,J+T/2,j,s),W+=b),s.drawIcon(G,j,W,J,D,T),s.drawLabel(G,j,W+D,J,T)}},sl._14Q=function(F){F.getIcon=function(G){return G.getIcon()},F.getIconWidth=function(a){return this.getIcon(a)?this._indent:0},F.drawIcon=function(t,e,d,g,x,L){if(x){var Q=this,D=Q.getBodyColor(e),k=Nl(Q.getIcon(e),D);k&&(L-=Q.isRowLineVisible()?1:0,hc(t,k,lr,d,g,x,L,e,Q,D),yb(t,Q.getBorderColor(e),d,g,x,L))}},F.drawLabel=function(J,k,u,r,y){var s=this;sp(J,s.getLabel(k),s.getLabelFont(k),s.getLabelColor(k),u,r,0,y)}},sl._50o=function(r){r._98I=function(){var n=this,q=n._39o=new Wn;n._60I=new kg,q.mm(n._17o,n),q.md(n._18o,n),q.mh(n._19o,n)},r.setColumns=function(z){this._39o.clear(),this.addColumns(z)},r.addColumns=function(x){var C=this._39o;x.forEach(function(O){if(!(O instanceof Tq)){var $=tg(O.className);O=bi($?$:Tq,O)}C.add(O)})},r.onColumnClicked=function(){},r.onCheckColumnClicked=function(){},r._3Q=function($){for(var V,X=0,n=this._60I,E=n.size();E>X;X++)if(V=n.get(X),V.column===$)return V;return a},r.getColumnAt=function(w){var s=this._4Q(w);return s?s.column:a},r._4Q=function(E){for(var C=this,r=E.target?C.lp(E).x:E.x,S=C._60I,A=0;A<S.size();A++){var G=S.get(A),f=G.startX;if(r>=f&&r<f+G.column.getWidth())return G}return a},r.getToolTip=function(I){var L=this,t=L.getDataAt(I),D=L.getColumnAt(I);return t&&D?D.getToolTip(t,L):a},r.adjustTranslateX=function(W){var J=this.getWidth()-this._91I;return J>W&&(W=J),W>0?0:B(W)},r._99I=function(){var e=this,$=e._29I,j=e._60I;j.clear(),e._91I=0,e._39o._roots.each(function(V){if(V.isVisible()){var W=e._91I+V.getWidth();e._91I<=$.x+$.width&&W>=$.x&&j.add({column:V,startX:e._91I}),e._91I=W}}),e._91I+=e.getScrollBarSize()},r.drawData=function(E,O,x){var G=this,j=G._rowHeight,l=j*x,A=G.isSelected(O),k=G._29I,e=k.x,I=k.width;G.drawRowBackground(E,O,A,e,l,I,j),G._60I.each(function(U){var r=U.column,B=U.startX,S=r.getWidth();S>0&&!G.isEditing(O,r)&&(E.save(),E.beginPath(),E.rect(B,l,S,j),E.clip(),G._87o(G.drawCell(E,O,A,r,B,l,S,j),x,B,l,S,j),G._columnLineVisible&&vm(E,B+S-1,l,1,j,G._columnLineColor),E.restore())}),G._rowLineVisible&&vm(E,e,l+j-1,I,1,G._rowLineColor)},r.drawCell=function(W,z,p,I,Y,N,D,R){var P=this;if(I.drawCell)return I.drawCell(W,z,p,I,Y,N,D,R,P);var o=P.getValue(z,I);zb(W,o,I,P.getLabelFont(z,I,o),P.getLabelColor(z,I,o),Y,N,D,R,z,P)},r.getColumnModel=function(){return this._39o},r._17o=function(){this.redraw()},r._18o=function(f){var K=this;f.data===K._sortColumn&&Wl[f.property]?K.ivm():(K._42o(),K.redraw())},r._19o=function(){this.redraw()},r.getCurrentSortFunc=function(){var Z=this,J=Z._sortColumn;if(J&&J.isSortable()){var $=J.getSortFunc(),c=ko===J.getSortOrder()?1:-1;return $||($=Gp),function(K,u){return $.call(Z,Z.getValue(K,J),Z.getValue(u,J),K,u)*c}}return Z._sortFunc},r.isCellEditable=function(L,g,s){return g.isEditable()&&this.isEditable()?g.isCellEditable?g.isCellEditable(L,g,s,this):!0:!1},r._37O=function(g,Z){if(Rl(Z))for(var Q=this,M=Q.lp(Z),F=Q._60I,O=Q._rowHeight,J=Q._29I,N=J.x,l=J.y,u=J.width,S=J.height,m=0;m<F.size();m++){var D=F.get(m),v=D.startX,h=D.column,o=h.getWidth();if(h!==Q._31o&&h!==Q._4o&&M.x>=v&&M.x<v+o&&Q.isCellEditable(g,h,Z)){var T={x:v,y:Q.getRowIndex(g)*O,width:o,height:O},b={x:T.x+Q.tx(),y:T.y+Q.ty(),width:T.width,height:T.height},K=0,H=0;return T.x<N?K=T.x-N:T.x+T.width>N+u&&(K=T.x+T.width-N-u),K&&(Q.tx(Q.tx()-K),b.x-=K),T.y<l?H=T.y-l:T.y+O>l+S&&(H=T.y+O-l-S),H&&(Q.ty(Q.ty()-H),b.y-=H),Q.beginEditing({data:g,column:h,value:Q.getValue(g,h),event:Z,rect:T,editorRect:b,view:Q}),void 0}}}},tn.BaseItemEditor=function(I,A,Q,Z){this._data=I,this._column=A,this._master=Q,this._editInfo=Z},Vo("BaseItemEditor",n,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var Jf=S.Tab=function(){fm(Jf,this)};Kn("Tab",Ij,{ms_ac:["view","closable","disabled"],_icon:a,_closable:!1,_disabled:!1,setParent:os});var Tq=S.Column=function(){fm(Tq,this)};Kn("Column",Ij,{_46o:1,ms_ac:["accessType","valueType",ic,Wp,gh,Lc,"align",dr,"sortOrder",sd,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:ko,_sortFunc:a,_sortable:!0,_clickable:!0,setWidth:function(w){16>w&&(w=16);var G=this._width;this._width=w,this.fp(Lc,G,w)},getToolTip:function(f,n){return this.formatValue(n.getValue(f,this))}});var rq=S.Property=function(){fm(rq,this)};Kn("Property",Ij,{_46o:1,ms_ac:["accessType","valueType",Wp,gh,"categoryName",dr,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:a,getToolTip:function(k,S,A){var J=this;return S?J.formatValue(A.getValue(k,J)):A.getPropertyName(J)}}),tn.AccordionView=function(){var C=this;C._20o={},C._21o=new kg,C._10o=a,C._9o=a,C._11o=a,C._view=Qm(0,C),C.iv()},Vo("AccordionView",n,{ms_v:1,ms_fire:1,ms_ac:[Zh,Pq,"titleHeight",Bd,Jn,"titleBackground","selectWidth",Wf,"orientation","separatorColor"],_expandIcon:x.accordionViewExpandIcon,_collapseIcon:x.accordionViewCollapseIcon,_titleHeight:ib,_labelColor:x.accordionViewLabelColor,_labelFont:x.accordionViewLabelFont,_titleBackground:x.accordionViewTitleBackground,_selectBackground:x.accordionViewSelectBackground,_selectWidth:x.accordionViewSelectWidth,_orientation:"v",_separatorColor:x.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(C,r,u,q){var n=this,s=we();if(n._20o[C])throw C+" already exists";s.onmousedown=yn,s.style.cursor=Rr,s.addEventListener(Ye?jj:gn,function(w){yn(w)},E),s.addEventListener(Ye?Sn:Uq,function(i){yn(i),Rl(i)&&(n._10o===C?n.collapse():n.expand(C))},E),Oc(n._view,s),n._20o[C]={content:r,div:s,canvas:xp(s),icon:q},n._21o.add(C),u&&n.expand(C),n.iv()},remove:function(Y){var w=this,J=w._20o[Y];J&&(Tn(J.div),delete w._20o[Y],w._21o.remove(Y),w.iv())},clear:function(){var h=this;h._21o.toArray().forEach(h.remove,h),h._20o={},h._21o.clear(),h.iv()},isExpanded:function(X){return this._10o===X},expand:function(B){var H=this;H._20o[B]&&H._10o!==B&&(H._10o=B,H.onExpanded(B),H.iv())},onExpanded:function(){},collapse:function(){var h=this;h._10o&&(h.onCollapsed(h._10o),delete h._10o,h.iv())},onCollapsed:function(){},initCanvas:function(Q,Y,j){ms(Q,Y,j);var p=wo(Q);return or(p,0,0,1),p.clearRect(0,0,Y,j),p},drawTitle:function(i,Z,g,h,e){var M=this,f=Nl(e.icon),v=M.isExpanded(Z),s=M._titleHeight,W=M._titleBackground,m=M._selectWidth,b=M._separatorColor,T=Nl(v?M._expandIcon:M._collapseIcon),Q=m+4;
vm(i,0,0,g,h,W),v&&m&&vm(i,0,0,m,h,M._selectBackground),(v||M._21o.get(M._21o.size()-1)!==Z)&&vm(i,0,h-1,g,1,b?b:Vq(W)),f&&(Kr(i,f,Q+sr(f)/2,s/2),Q+=sr(f)+2),sp(i,Z,M.getLabelFont(Z),M.getLabelColor(Z),Q,0,0,s),T&&Kr(i,T,g-sr(T)/2-4,s/2)},validateImpl:function(){var t=this,q=t._view,z=0,F=0,B=t.getWidth(),V=t.getHeight(),u=t._titleHeight,T=t._21o.size()*u,Y=t._11o,l=t._9o;delete t._11o,delete t._9o,t._21o.each(function(P){var h,y,Z=t._20o[P],o=Z.content,I=t._10o===P;Ik(t)?(dp(Z.div,z,0,u,V),h=t.initCanvas(Z.canvas,u,V),$b(h,0,V),Hr(h,-K),t.drawTitle(h,P,V,u,Z),h.restore(),I?(y=w(0,B-T),o&&(t._11o=o,t._9o=Xk(o),dp(o,z+u,0,y,V)),z+=u+y):z+=u):(dp(Z.div,0,F,B,u),h=t.initCanvas(Z.canvas,B,u),t.drawTitle(h,P,B,u,Z),h.restore(),I?(y=w(0,V-T),o&&(t._11o=o,t._9o=Xk(o),dp(o,0,F+u,B,y)),F+=u+y):F+=u)});var Q=t._9o;Y&&Y!==t._11o&&Y.endEditing&&Y.endEditing(),Q&&Q!==l&&Oc(q,Q),l&&l!==Q&&Tn(l)}}),tn.SplitView=function(g,b,f,r){var O=this,d=O._dividerDiv=we(),s=O._60O=xp(),S=O._61O=xp(),H=s.style,X=S.style;O._view=Qm(1,O),Oc(O._view,d),H.msTouchAction=Ok,H.pointerEvents=Ok,H.cursor=Rr,X.msTouchAction=Ok,X.pointerEvents=Ok,X.cursor=Rr,g&&O.setLeftView(g),b&&O.setRightView(b),f&&O.setOrientation(f),r!=a&&O.setPosition(r),O.setStatus(Tj),new Cp(O)},Vo("SplitView",n,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:x.splitViewDividerSize,_dividerBackground:x.splitViewDividerBackground,_dragOpacity:x.splitViewDragOpacity,_toggleIcon:x.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(c,Y){var o=this,H=o._position;isNaN(c)||(Y||(o._82O=0>c?-1:c>1?1:0),o._position=c,o.fp(ec,H,c))},getLeftView:function(){return this._leftView},setLeftView:function(a){var d=this,D=d._leftView,w=d._view;if(d._leftView!==a){if(D&&D!==d._rightView){var E=Xk(D);E.parentNode===w&&Tn(E)}if(d._leftView=a,a){var W=Xk(a);W.parentNode!==w&&w.insertBefore(W,d._dividerDiv)}d.fp("leftView",D,a)}},getRightView:function(){return this._rightView},setRightView:function(G){var e=this,A=e._rightView,y=e._view;if(e._rightView!==G){if(A&&A!==e._leftView){var c=Xk(A);c.parentNode===y&&Tn(c)}if(e._rightView=G,G){var k=Xk(G);k.parentNode!==y&&y.insertBefore(k,e._dividerDiv)}e.fp("rightView",A,G)}},validateImpl:function(){var p=this,f=p._draggable,r=p._position,S=p.getWidth(),h=p.getHeight(),z=p._dividerSize,M=p._dividerBackground,l=Ye?18:8,Y=p._dividerDiv,c=p._82O,Q=p._60O,b=p._61O,A=p._toggleIcon,H=p._status,u=Y.style,k=null,I=Ye?20:4,P=A.comps[0];z>=l||0===z?p._coverDiv&&(Tn(p._coverDiv),delete p._coverDiv):p._coverDiv||(p._coverDiv=we(),o&&(p._coverDiv.style.background=uq),Oc(Y,p._coverDiv)),p._togglable?Q.parentNode||(Oc(Y,Q),Oc(Y,b)):(Tn(Q),Tn(b));var E=p._coverDiv,C=p._leftView,s=p._rightView;if(Ik(p)){if(z>S&&(z=S),H===Tj)if(1===c)var v=t(r,S),W=w(0,S-z-v);else-1===c?(W=t(-r,S),v=w(0,S-z-W)):(v=B((S-z)*r),W=w(0,S-z-v));else"cl"===H?(v=0,W=w(0,S-z)):"cr"===H&&(W=0,v=w(0,S-z));C&&dp(C,0,0,v,h),s&&dp(s,v+z,0,W,h),dp(Y,v,0,z,h),p._22o=v,E&&(dp(E,z/2-l/2,0,l,h),E.style.cursor=f?fk:""),Y.style.cursor=f?fk:"";var x=Y.clientHeight/2,a=Y.clientWidth;ms(Q,a,a),dp(Q,0,x-a-I,a,a),k=wo(Q),or(k,0,0,1),P.rotation=-K,jb(k,A,0,0,a,a),k.restore(),ms(b,a,a),dp(b,0,x+I,a,a),k=wo(b),or(k,0,0,1),P.rotation=K,jb(k,A,0,0,a,a),k.restore()}else{if(z>h&&(z=h),H===Tj)if(1===c)var i=t(r,h),$=w(0,h-z-i);else-1===c?($=t(-r,h),i=w(0,h-z-$)):(i=B((h-z)*r),$=w(0,h-z-i));else"cl"===H?(i=0,$=w(0,h-z)):"cr"===H&&($=0,i=w(0,h-z));C&&dp(C,0,0,S,i),s&&dp(s,0,i+z,S,$),dp(Y,0,i,S,z),p._22o=i,E&&(dp(E,0,z/2-l/2,S,l),E.style.cursor=f?yo:""),u.cursor=f?yo:"";var j=Y.clientWidth/2,a=Y.clientHeight;ms(Q,a,a),dp(Q,j-a-I,0,a,a),k=wo(Q),or(k,0,0,1),P.rotation=0,jb(k,A,0,0,a,a),k.restore(),ms(b,a,a),dp(b,j+I,0,a,a),k=wo(b),or(k,0,0,1),P.rotation=O,jb(k,A,0,0,a,a),k.restore()}u.background=M}});var Cp=function(X){this.sv=X,this.addListeners()};ri(Cp,n,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(z){var J=this,P=J.sv,a=P._dividerDiv,X=P._60O,H=P._61O,A=P._status,R=z.target;if(R===X)A===Tj?P.setStatus("cl"):"cr"===A&&P.setStatus(Tj);else if(R===H)A===Tj?P.setStatus("cr"):"cl"===A&&P.setStatus(Tj);else if(Nq(z)&&(R===a||R===P._coverDiv)&&(yn(z),P.isDraggable())){P.getLeftView(),P.getRightView();var o=J.maskDiv=we();if(o.style.left=0,o.style.top=0,o.style.width=P.getWidth()+"px",o.style.height=P.getHeight()+"px",P.getView().appendChild(o),!P.isContinuousLayout()){var F=J.resizeDiv=we();F.style.left=a.style.left,F.style.top=a.style.top,F.style.width=a.style.width,F.style.height=a.style.height,F.style.opacity=P.getDragOpacity(),F.style.background=P.getDividerBackground(),Oc(J.getView(),F)}J._lastAbsPosition=P._22o,J._86o=Ik(P)?_o(z).x:_o(z).y,ed(J,z)}},handleWindowTouchMove:function(y){Nq(y)&&this.update(y,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(I){var r=this;r.update(I,!0),r.sv.setStatus(Tj),r.maskDiv&&Tn(r.maskDiv),r.resizeDiv&&Tn(r.resizeDiv),r.maskDiv=r.resizeDiv=a},handle_mousedown:function(O){Rl(O)&&this.handle_touchstart(O)},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},update:function(M,J){var O=this,t=O.sv,S=Ik(t)?t.getWidth():t.getHeight(),l=t._dividerSize,V=O._lastAbsPosition-O._86o;Ik(t)?(V+=_o(M).x,V>S-l&&(V=S-l),0>V&&(V=0),O.resizeDiv&&(O.resizeDiv.style.left=V+Af)):(V+=_o(M).y,V>S-l&&(V=S-l),0>V&&(V=0),O.resizeDiv&&(O.resizeDiv.style.top=V+Af)),J&&S!==l&&(1===t._82O?t.setPosition(V,1):-1===t._82O?t.setPosition(V-S+l,1):t.setPosition(V/(S-l),1))}}),tn.TabView=function(){var N=this,p=N._view=Qm(1,N),D=N._91O=we(1),T=N._tabModel=new Wn,i=T.sm(),V=N.invalidate;N._7o=new kg,N._canvas=xp(D),Oc(p,D),Oc(p,N._92O=we(1)),i.setSelectionMode(Om),i.ms(N.handleSelectionChange,N),T.mm(V,N),T.md(V,N),T.mh(V,N),N._interactor=new El(N),N.iv()},Vo("TabView",n,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",Bd,Jn,"tabBackground","selectWidth",Wf,"moveBackground","insertColor"],_tabPosition:Se,_tabHeight:ib,_tabGap:x.tabViewTabGap,_labelColor:x.tabViewLabelColor,_labelFont:x.tabViewLabelFont,_tabBackground:x.tabViewTabBackground,_selectWidth:x.tabViewSelectWidth,_selectBackground:x.tabViewSelectBackground,_moveBackground:x.tabViewMoveBackground,_insertColor:x.tabViewInsertColor,_movable:!0,handleSelectionChange:function(){this._selectionChanged=!0,this.invalidate()},getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(z,J,y){var L,E=this._tabModel;return z instanceof Jf?(L=z,J&&L.setView(J)):(L=new Jf,L.setName(z),L.setView(J)),E.add(L),y&&E.sm().ss(L),L},getLabel:function(s){return s.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(N){this._23o=N,this.iv()},get:function(R){var c=this,j=c._tabModel;if(Sm(R))return j._roots.get(R);if(Tp(R)){var z;return j.each(function(e){R===c.getLabel(e)&&(z=e)}),z}return R instanceof Jf?R:a},select:function(I){this._tabModel.sm().ss(this.get(I))},remove:function(L){var Q=this;if(L=Q.get(L)){var j=Q._tabModel,f=j._roots.indexOf(L);Q._tabModel.remove(L),Q.selectByIndex(--f)}},getCurrentTab:function(){return this._8o},hideTabView:function(j,X){X.parentNode===this._92O&&(vj(X)?(X.style.display=Uh,X._tab_=j):Tn(X),el())},showTabView:function(U,G){vj(G)&&(G.style.display="block",G._tab_=U),G.parentNode!==this._92O&&(Oc(this._92O,G),el())},_24o:function(){var P,S=this,F=S._8o,r=S._9o,i=S._tabModel.sm().ld();i&&(P=Xk(i.getView())),P!==r&&(r&&(F.getView()&&F.getView().endEditing&&F.getView().endEditing(),S.hideTabView(F,r)),P&&S.showTabView(i,P)),S._8o=i,S._9o=P,F!==i&&S.onTabChanged(F,i)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(y,T){this.selectByIndex(--T)},selectByIndex:function(_){var A=this,e=A._tabModel,r=e.size();if(r&&!e.sm().ld()){_==a&&(_=0),_>=r&&(_=r-1),0>_&&(_=0);for(var z=_;z>=0;z--){var C=A.get(z);if(!C.isDisabled())return A.select(C),C}for(z=_+1;r>z;z++)if(C=A.get(z),!C.isDisabled())return A.select(C),C}},getTabWidth:function(j){var e=4,r=Nl(j.getIcon());r&&(e+=sr(r,j)+4);var N=this.getLabel(j);return N&&(e+=Lm(this.getLabelFont(j),N).width+4),j.isClosable()&&(e+=10),e},drawTab:function(j,T,n,t,C,R,f){var l,z=this,k=z._tabPosition,G=n+4,E=z._selectWidth,X=Nl(T.getIcon()),v=T.isDisabled(),L=z.getLabelColor(T),g=z.getLabelFont(T),S=z.getLabel(T),P=z._selectBackground,c=k===ce+"-vertical",I=k===_i+"-vertical";(c||I)&&(G=t+4),v&&(j.globalAlpha=jg),vm(j,n,t,C,R,f),T===z._8o&&E&&(k===Se?vm(j,n,t+R-E,C,E,P):k===ce?vm(j,n+C-E,t,E,R,P):k===_i?vm(j,n,t,E,R,P):c?vm(j,n+C-E,t,E,R,P):I?vm(j,n,t,E,R,P):vm(j,n,t,C,E,P));var A=C/2;if(c&&($b(j,A,t+R/2),Hr(j,O),$b(j,-A,-t-R/2)),X){var D=Qo(X,T),V=sr(X,T);if(c||I){var Z=n+C/2,Y=G+D/2;$b(j,Z,Y),Hr(j,K),$b(j,-Z,-Y),Kr(j,X,n+C/2,G+D/2,T,z),$b(j,Z,Y),Hr(j,-K),$b(j,-Z,-Y),G+=D+4}else Kr(j,X,G+V/2,t+R/2,T,z),G+=V+4}return c||I?($b(j,C/2,G+C/2),Hr(j,K),$b(j,-C/2,-G-C/2),sp(j,S,g,L,n,G,R,C),$b(j,C/2,G+C/2),Hr(j,-K),$b(j,-C/2,-G-C/2)):sp(j,S,g,L,G,t,C,R),c&&($b(j,A,t+R/2),Hr(j,-O),$b(j,-A,-t-R/2)),T.isClosable()&&(l=I?{x:n+C-12,y:t+R-12,width:12,height:12}:{x:n+C-12,y:t+2,width:12,height:12},this.drawCloseIcon(T,j,L,l)),v&&(j.globalAlpha=1),l},drawCloseIcon:function(I,a,g,N){var i=N.x,F=N.y;a.strokeStyle=g,a.lineWidth=1,a.beginPath(),a.moveTo(i+2,F+8),a.lineTo(i+8,F+2),a.moveTo(i+8,F+8),a.lineTo(i+2,F+2),a.stroke()},getTabAt:function(L){var h=this._interactor._8Q(L);return h?h.tab:null},validateImpl:function(){var t=this;t._24o();var c,_=t._canvas,H=t._tabPosition,E=t._91O,m=t._92O,J=t._tabModel,R=t.getWidth(),O=t.getHeight(),M=t._tabHeight,Y=t._7o,C=t._tabGap,r=H===Se,d=H===ce,T=H===_i,K=H===ce+"-vertical",F=H===_i+"-vertical",x=t._23o,g=0;if((d||T)&&J._roots.each(function(V){g=w(t.getTabWidth(V),g)}),r?(dp(E,0,0,R,M),c={x:0,y:M,width:R,height:w(0,O-M)}):d?(dp(E,0,0,g,O),c={x:g,y:0,width:w(0,R-g),height:O}):T?(dp(E,R-g,0,g,O),c={x:0,y:0,width:w(0,R-g),height:O}):K?(dp(E,0,0,M,O),c={x:M,y:0,width:w(0,R-M),height:O}):F?(dp(E,R-M,0,M,O),c={x:0,y:0,width:w(0,R-M),height:O}):(dp(E,0,O-M,R,M),c={x:0,y:0,width:R,height:w(0,O-M)}),dp(m,c),K||F){t._9o&&(c.x=0,dp(t._8o.getView(),c)),ms(_,M,O);var n=wo(_),y=0;if(or(n,0,t.ty(),1),n.clearRect(0,0,M,O),Y.clear(),J._roots.each(function(I){var P,E=t.getTabWidth(I);x&&x.tab===I||(P=t.drawTab(n,I,0,y,M,E,t._tabBackground)),Y.add({_75o:P,tab:I,startY:y,endY:y+E,height:E}),y+=E+C}),t._23Q=w(0,y-C),x){var N=x.position;t.drawTab(n,x.tab,0,x.startY,M,x.height,t._moveBackground),vm(n,0,N,M,1,t._insertColor)}if(n.restore(),t._selectionChanged){t._selectionChanged=!1;for(var v=t.ty(),L=0;L<Y.size();L++){var s=Y.get(L);if(s.tab===t._8o){if(s.endY+v<0){t.ty(-s.startY);break}if(s.startY+v>O){t.ty(O-s.endY);break}}}}t.ty(t.ty())}else if(d||T){t._9o&&(c.x=0,dp(t._8o.getView(),c)),ms(_,g,O);var n=wo(_),y=0;if(or(n,0,t.ty(),1),n.clearRect(0,0,g,O),Y.clear(),J._roots.each(function(R){var T;x&&x.tab===R||(T=t.drawTab(n,R,0,y,g,M,t._tabBackground)),Y.add({_75o:T,tab:R,startY:y,endY:y+M,height:M}),y+=M+C}),t._23Q=w(0,y-C),x){var N=x.position;t.drawTab(n,x.tab,0,x.startY,g,x.height,t._moveBackground),vm(n,0,N,g,1,t._insertColor)}if(n.restore(),t._selectionChanged){t._selectionChanged=!1;for(var v=t.ty(),L=0;L<Y.size();L++){var s=Y.get(L);if(s.tab===t._8o){if(s.endY+v<0){t.ty(-s.startY);break}if(s.startY+v>O){t.ty(O-s.endY);break}}}}t.ty(t.ty())}else{t._9o&&(c.y=0,dp(t._8o.getView(),c)),ms(_,R,M);var n=wo(_),P=0;if(or(n,t.tx(),0,1),n.clearRect(0,0,R,M),Y.clear(),J._roots.each(function(I){var o,J=t.getTabWidth(I);x&&x.tab===I||(o=t.drawTab(n,I,P,0,J,M,t._tabBackground)),Y.add({_75o:o,tab:I,startX:P,endX:P+J,width:J}),P+=J+C}),t._64I=w(0,P-C),x){var N=x.position;t.drawTab(n,x.tab,x.startX,0,x.width,M,t._moveBackground),vc(n,t._insertColor,N,0,M)}if(n.restore(),t._selectionChanged){t._selectionChanged=!1;for(var B=t.tx(),L=0;L<Y.size();L++){var s=Y.get(L);if(s.tab===t._8o){if(s.endX+B<0){t.tx(-s.startX);break}if(s.startX+B>R){t.tx(R-s.endX);break}}}}t.tx(t.tx())}for(var A=[],f=m.children,L=0;L<f.length;L++){var S=f[L],Z=S._tab_;Z&&!J.contains(Z)&&A.push(S)}A.forEach(function(q){m.removeChild(q)})}});var El=function(D){this.tv=D,this.addListeners()};ri(El,n,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function($){this.handleScroll($,10*($.wheelDelta/40))},handle_DOMMouseScroll:function(H){this.handleScroll(H,10*-H.detail)},handleScroll:function(I,H){yn(I);var Z=this.tv,O=Z._tabPosition;!Z._40o()||O!==Se&&O!==ep||Z.tx(this.tv.tx()+H),!Z._41o()||O!==ce&&O!==_i&&O!==ce+"-vertical"&&O!==_i+"-vertical"||Z.ty(this.tv.ty()+H)},_8Q:function(m){var E,q,j=this.tv,S=j._tabPosition,T=j._7o;if(S===Se||S===ep){var u=j.lp(m).x;for(E=0;E<T.size();E++)if(q=T.get(E),q.startX<=u&&u<=q.endX)return q}else if(S===ce||S===_i||S===ce+"-vertical"||S===_i+"-vertical"){var d=j.lp(m).y;for(E=0;E<T.size();E++)if(q=T.get(E),q.startY<=d&&d<=q.endY)return q}return a},isClickable:function(J){var $=this.tv,N=$._tabPosition,t=this._73o=this._8Q(J);return!$._40o()||N!==Se&&N!==ep?!$._41o()||N!==ce&&N!==_i&&N!==ce+"-vertical"&&N!==_i+"-vertical"?t&&(!t.tab.isDisabled()||$.isMovable()):!0:!0},handle_mousemove:function(g){var v=this;ye?v._74o=v._8Q(g):v.getView().style.cursor=v.isClickable(g)?Rr:""},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(h){var k=this,D=k.tv,d=D._tabPosition;yn(h),Rl(h)&&k.isClickable(h)&&(d===Se||d===ep?(k.x=_o(h).x,k.lp=D.lp(h),k.tx=D.tx()):(k.y=_o(h).y,k.lp=D.lp(h),k.ty=D.ty()),ed(k,h))},handleWindowMouseMove:function(Q){this.handleWindowTouchMove(Q)},handleWindowTouchMove:function(h){var D,n=this,A=n.tv,V=A._tabPosition,Y=n._73o;if(V===Se||V===ep){if(D=_o(h).x-n.x,!n._25o&&!n.moving&&G(D)>2&&(A._40o()&&!Ql(h)?n._25o=1:Y&&A.isMovable()&&(n.moving=1)),n._25o)A.tx(n.tx+D);else if(n.moving){var b=n.lp.x+D,S=A._tabGap/2;A._7o.each(function(f){var H=f.endX,v=b-f.startX<H-b;b>=f.startX&&H>=b&&A._7Q({tab:Y.tab,startX:Y.startX+D,width:Y.width,front:v,insertTab:f.tab,position:v?w(0,f.startX-S):t(A._64I,H+S)})})}}else if(D=_o(h).y-n.y,!n._25o&&!n.moving&&G(D)>2&&(A._41o()&&!Ql(h)?n._25o=1:Y&&A.isMovable()&&(n.moving=1)),n._25o)A.ty(n.ty+D);else if(n.moving){var y=n.lp.y+D,S=A._tabGap/2;A._7o.each(function(F){var b=F.endY,h=y-F.startY<b-y;y>=F.startY&&b>=y&&A._7Q({tab:Y.tab,startY:Y.startY+D,height:Y.height,front:h,insertTab:F.tab,position:h?w(0,F.startY-S):t(A._23Q,b+S)})})}},handleWindowMouseUp:function(K){this.handleWindowTouchEnd(K)},handleWindowTouchEnd:function(){var X=this,d=X.tv,i=d._tabPosition,p=d.getTabModel(),G=p._roots,y=X._73o;if(X.moving){var Y=d._23o;if(Y&&Y.insertTab!==Y.tab){var q=Y.tab,P=G.remove(q),E=G.indexOf(Y.insertTab);E>=0&&(Y.front||E++,E<=G.size()&&(G.add(q,E),p._38I(q,P,E)))}d._7Q(a),delete X.moving}else if(!X._25o&&y){q=y.tab;var M=X._74o;if(!M||M.tab===q)if(!q.isDisabled()&&dh(y._75o,X.lp)){var F=function(){var S=G.indexOf(q);p.remove(q),d.onTabClosed(q,S)};d.onTabClosing(q,F)&&F()}else q.isDisabled()||d._8o===q||p.sm().ss(q)}X._25o=X._73o=X._74o=i===Se||i===ep?X.x=X.lp=X.tx=a:X.y=X.lp=X.ty=a}}),tn.PropertyView=function(J){var b=this;b._view=Qm(1,b),b._canvas=xp(b._view),Oc(b._view,b._79O=we()),b._rows=new kg,b._28o=new kg,b._26o={},b._26Q={};var o=b._propertyModel=new Wn,R=b.ivm;o.mm(R,b),o.md(R,b),o.mh(R,b),b.dm(J?J:new Wn),new kh(b)},Vo("PropertyView",n,{ms_ac:[Bd,Lr,Jn,Wp,gh,"categorizable",gk,sd,Fp,Zh,Pq,Re,cj,wj,"selectRowIndex",Wf,"background",Vp,nh,cr,re,yl],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:Sr,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:bh,_background:x.propertyViewBackground,_expandIcon:x.propertyViewExpandIcon,_collapseIcon:x.propertyViewCollapseIcon,_scrollBarColor:dg,_scrollBarSize:Yq,_autoHideScrollBar:as,_selectBackground:x.propertyViewSelectBackground,_rowHeight:Mc,_rowLineVisible:x.propertyViewRowLineVisible,_rowLineColor:x.propertyViewRowLineColor,_10I:.5,_columnLineVisible:x.propertyViewColumnLineVisible,_columnLineColor:x.propertyViewColumnLineColor,_labelColor:x.propertyViewLabelColor,_labelSelectColor:x.propertyViewLabelSelectColor,_labelFont:x.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(A){0>A&&(A=0),A>1&&(A=1);var R=this,E=R._10I;R._10I=A,R.fp("columnPosition",E,A)},getPropertyName:function(P){return P.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(U,H,x){return x===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(N,p){return p===this._selectRowIndex?this._labelSelectColor:N.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(K){var e=this.getHeight()-this._59I;return e>K&&(K=e),K>0?0:B(K)},isExpanded:function(M){if(!M)return!0;var $=this._26o[M];return $?$.isExpanded:!(this._26Q[M]===!1)},toggle:function(i){var X=this;X.isExpanded(i)?X.collapse(i):X.expand(i)},expandAll:function(){this.validate();for(var J in this._26o)this.expand(J)},expand:function(P){if(P&&P!==Uh){var d=this,G=d._26o[P];G&&!G.isExpanded&&(G.isExpanded=!0,d.onExpanded(P),d.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var e in this._26o)this.collapse(e)},collapse:function(U){if(U&&U!==Uh){var v=this,$=v._26o[U];$&&$.isExpanded&&($.isExpanded=!1,v.onCollapsed(U),v.ivm())}},onCollapsed:function(){},getCategoryName:function(B){if(!this.isCategorizable())return Uh;var S=B.getCategoryName();return S?S:Uh},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(V){var w=this,o=w._dataModel;o!==V&&(o&&(o.umd(w.handlePropertyChange,w),w._selectionModel||o.sm().ums(w.handleSelectionChange,w)),w._dataModel=V,V.md(w.handlePropertyChange,w),w._selectionModel?w._selectionModel._21I(V):V.sm().ms(w.handleSelectionChange,w),w.fp(tf,o,V))},isVisible:function(r){return this._visibleFunc?this._visibleFunc(r):!0},onPropertyChanged:function(Q){var h=this,J=Q.property;mp[J]?h.ivm():h.iv(),J===rl&&h._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:ej},handlePropertyChange:function(x){this._27o===x.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var a=this;a._96I||(a.setSelectRowIndex(-1),a._96I=1,a.iv())},redraw:function(){this.iv()},validateModel:function(){var h=this,k=h._rows,G=h._28o,u={},g=new kg,S=h._27o;h.updateCurrentData(),S!==h._27o&&h.endEditing(),k.clear(),G.clear(),h.getRawProperties().each(function(c){if(h.isVisible(c)){g.add(c);var D=h.getCategoryName(c);u[D]||(G.add(D,D===Uh?0:i),u[D]={isExpanded:h.isExpanded(D),properties:new kg})}}),h._sortFunc&&g.sort(h._sortFunc);for(var X in h._26o)h._26Q[X]=h.isExpanded(X);h._26o=u,G.each(function(T){T!==Uh&&k.add(T);var B=u[T];B.isExpanded&&g.each(function(L){h.getCategoryName(L)===T&&(B.properties.add(L),k.add({property:L,data:h._27o}))},h)})},validateImpl:function(){var j=this;j._76o(),j._96I&&(j.validateModel(),delete j._96I);var i=j._canvas,e=j.getWidth(),Z=j.getHeight(),z=-j.ty(),T=j._rowHeight,X=j._indent,k=e-X,g=j._rows,U=g.size(),v=j._9I=X+k*j._10I,I=j._59I=U*T;ms(i,e,Z),j._29I={x:0,y:z,width:e,height:Z},j._31I=P(z/T),j._14I=F((z+Z)/T),j._31I<0&&(j._31I=0),j._14I>U&&(j._14I=U);var D,r=wo(i),M=j._background;or(r,0,-z,1),r.beginPath(),r.rect(0,z,e,Z),r.clip(),r.clearRect(0,z,e,Z),j._93db(r),M&&vm(r,0,0,X,I,M);for(var m=j._31I;m<j._14I;m++){var c=g.get(m),z=T*m;if(Tp(c))M&&vm(r,X,z,k,T,M),D=Nl(j.isExpanded(c)?j._expandIcon:j._collapseIcon),D&&hc(r,D,lr,0,z,X,T),r.save(),r.beginPath(),r.rect(X,z,k,T),r.clip(),j.drawCategoryName(r,c,m,X,z,k,T),r.restore();else{var w=c.property,q=c.data,D=Nl(w.getIcon()),t=j._selectRowIndex===m?j.getSelectBackground():a;if(D&&hc(r,D,lr,0,z,X,T),t&&vm(r,X,z,k,T,t),r.save(),r.beginPath(),r.rect(X,z,v-X,T),r.clip(),j.drawPropertyName(r,w,m,X,z,v-X,T),r.restore(),!j.isEditing(q,w)){var n=v+1,E=e-v-1;r.save(),r.beginPath(),r.rect(n,z,E,T),r.clip(),j._87o(j.drawPropertyValue(r,w,j.getValue(q,w),m,n,z,E,T,q),m,n,z,E,T),r.restore()}}j._rowLineVisible&&vm(r,X,z+T-1,k,1,j._rowLineColor)}j._columnLineVisible&&(vm(r,v,0,1,I,j._columnLineColor),vm(r,e-1,0,1,I)),j._92db(r),j._93I(),r.restore(),j.ty(j.ty())},drawCategoryName:function(O,t,h,z,Y,G,R){sp(O,t,this.getCategoryFont(t),this.getCategoryColor(t),z,Y,G,R)},drawPropertyName:function(K,T,V,z,m,g,N){return T.drawPropertyName?(T.drawPropertyName(K,T,V,z,m,g,N,this),void 0):(sp(K,this.getPropertyName(T),this.getPropertyFont(T,V),this.getPropertyColor(T,V),z,m,g,N),void 0)},drawPropertyValue:function(p,T,r,E,c,F,t,k,y){return T.drawPropertyValue?T.drawPropertyValue(p,T,r,E,c,F,t,k,y,this):(zb(p,r,T,this.getLabelFont(T,r,E),this.getLabelColor(T,r,E),c,F,t,k,y,this),void 0)},isPropertyEditable:function(J){return J.isEditable()&&this.isEditable()},setProperties:function(i){this._propertyModel.clear(),this.addProperties(i)},addProperties:function(o){if(o){var V=this._propertyModel;o.forEach(function(i){if(!(i instanceof rq)){var z=tg(i.className);i=bi(z?z:rq,i)}V.add(i)})}},getRowIndexAt:function(v){var S=this,B=P(S.lp(v).y/S._rowHeight);return B>=0&&B<S._rows.size()?B:-1},getPropertyAt:function(H){var M=this,T=M.getRowIndexAt(H);return T>=0?M._rows.get(T).property:a},getToolTip:function(G){var N=this,V=N.getPropertyAt(G),T=N._27o;return V&&T?V.getToolTip(T,N._9I<N.lp(G).x,N):a}});var kh=function(u){this.pv=u,this.addListeners()};ri(kh,n,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(K){this.getView().style.cursor=K},clear:function(){var F=this;F._62O=F.cp=F.ty=F.p=a,F.setCursor(nn)},handle_mousedown:function(q){this.handle_touchstart(q)},handle_touchstart:function(P){var h=this,c=h.pv;yn(P),c.setFocus(P)&&(Rl(P)?(h.cp=_o(P),h.ty=c.ty(),h.p=c.getColumnPosition(),h.handle_touchmove(P)):c.setSelectRowIndex(c.getRowIndexAt(P)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(N){this.handle_touchend(N)},handle_touchend:function(t){var x=this;if(x.cp&&!x._62O){var X=x.pv,o=X.lp(t),s=o.x,h=o.y,M=X._indent,_=X.getRowIndexAt(t),i=X._9I;if(_>=0){var U=X._rowHeight,D=U*_,n=X._rows.get(_),y=n.property;if(Tp(n))Nl(X.isExpanded(n)?X._expandIcon:X._collapseIcon)&&s>=0&&M>=s&&h>=D&&D+U>=h?X.toggle(n):uc(t)&&X.toggle(n);else if(s>i&&X.isPropertyEditable(y,t)){var I={x:i+1,y:D,width:X.getWidth()-i-1,height:U},Z={x:I.x+X.tx(),y:I.y+X.ty(),width:I.width,height:I.height},b=0,T=X._29I;I.y<T.y?b=I.y-T.y:I.y+U>T.y+T.height&&(b=I.y+U-T.y-T.height),b&&(X.ty(X.ty()-b),Z.y-=b),X.beginEditing({data:n.data,property:y,value:X.getValue(n.data,y),event:t,rect:I,editorRect:Z,view:X})}}X.setSelectRowIndex(_)}x.clear()},handleWindowMouseMove:function(r){this.handleWindowTouchMove(r)},handleWindowTouchMove:function(J){var I=this,r=I.pv,C=I.ty,o=I.cp,g=_o(J),v=I._62O;if("p"===v)r.setTranslateY(C+g.y-o.y);else if("c"===v){var V=r.getWidth()-r._indent;if(V>16){var X=I.p-(o.x-g.x)/V,R=16/V;R>X&&(X=R),X>1-R&&(X=1-R),r.setColumnPosition(X)}}else"s"===v&&r.setTranslateY(C+(o.y-g.y)*r._59I/r._29I.height)},handle_mousemove:function(W){this.handle_touchmove(W)},handle_touchmove:function(C){if(!ye&&Rl(C)){var f=this,y=f.pv,q=G(y.lp(C).x-y._9I)<=(Ye?8:3);f.cp?f._62O||(q?(f._62O="c",ed(f)):G(_o(C).y-f.cp.y)>=2&&(f._62O=f.isV(C)?"s":"p",ed(f))):(q?f.setCursor(fk):f.setCursor(nn),f.isV(C)&&y._43o())}},isV:function(w){var p=this.pv,l=p._29I;return p._41o()&&l.x+l.width-p.lp(w).x<Uj},handle_mousewheel:function(d){this.handleScroll(d,d.wheelDelta/40)},handle_DOMMouseScroll:function(D){2===D.axis&&this.handleScroll(D,-D.detail)},handleScroll:function(T,b){var t=this.pv;yn(T),t.endEditing(),t.translate(0,b*t.getRowHeight())},handle_keydown:function(F){var C=this.pv,K=C._rows.size(),w=C._selectRowIndex+(ee(F)?-1:1);(ee(F)||Rf(F))&&(0>w&&(w=0),w>=K&&(w=K-1),C.setSelectRowIndex(w))}}),tn.ListView=function(y){this._5o(y),new Vn(this)},Vo("ListView",n,{ms_ac:[Bd,Lr,Jn,Vp,gk,nh,cr,sd,Fp,Re,cj,wj,Xf,Wf],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:bh,_rowHeight:Mc,_rowLineVisible:x.listViewRowLineVisible,_rowLineColor:x.listViewRowLineColor,_scrollBarColor:dg,_scrollBarSize:Yq,_autoMakeVisible:tj,_autoHideScrollBar:as,_selectBackground:x.listViewSelectBackground,_labelColor:x.listViewLabelColor,_labelSelectColor:x.listViewLabelSelectColor,_labelFont:x.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(H){var T=this,b=T._checkMode;T._checkMode=H,T.fp(aq,b,H)},drawRow:function(f,C,w,v,p,n,O){var e=this,T=0,S=e._indent,H=e.getIconWidth(C);e.drawRowBackground(f,C,w,v,p,n,O),e._checkMode&&(Kr(f,Nl(e.getCheckIcon(C)),T+S/2,p+O/2,C,e),T+=S),e.drawIcon(f,C,T,p,H,O),e.drawLabel(f,C,T+H,p,O)}});var Vn=function(m){this.list=m,this._lastSelectDataTime=qj(),this.addListeners()};ri(Vn,n,{ms_listener:1,getView:function(){return this.list._view},clear:function(B){var l=this,D=l.list;B&&"d"===l._62O&&!l.dragCancel&&D.handleDragAndDrop(B,"end"),D.draggingData&&(D.draggingData=null,D.redraw()),l.dragCancel=l._62O=l._isV=l._isH=l.cp=l.tx=l.ty=a},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(Z){var s=this,t=s.list;if(yn(Z),t.setFocus(Z)){var K=t.getDataAt(Z);s.cp=_o(Z),s.tx=t.tx(),s.ty=t.ty(),Rl(Z)?K&&t.handleDragAndDrop&&!s.isV(Z)&&!s.isH(Z)&&(t.draggingData=K,t.redraw(),t.handleDragAndDrop(Z,"prepare")):(K&&s._33o(Z,K),s.clear(Z))}},handleWindowMouseUp:function(J){this.clear(J)},handleWindowTouchEnd:function(G){this.clear(G)},handle_mouseup:function(a){this.handle_touchend(a)},handle_touchend:function(H){var p=this,t=p.list;if(!p._isV&&!p._isH&&p.cp&&!p._62O){var u=t.getDataAt(H);u?(t.isCheckMode()?p._34o(H,u):p._33o(H,u),uc(H)?t.onDataDoubleClicked(u,H):t.onDataClicked(u,H)):t.handleBackgroundClick(H)}p.clear(H)},handleWindowMouseMove:function(u){this.handleWindowTouchMove(u)},handleWindowTouchMove:function(k){var X=this,i=X.list,L=X._62O,W=X.tx,m=X.ty,B=X.cp,y=_o(k),c=i._29I;"p"===L?i.setTranslate(W+y.x-B.x,m+y.y-B.y):"v"===L?i.ty(m+(B.y-y.y)*i._59I/c.height):"h"===L?i.tx(W+(B.x-y.x)*i._91I/c.width):"d"===L&&(X.dragCancel||i.handleDragAndDrop(k,"between"))},handle_mousemove:function($){this.handle_touchmove($)},handle_touchmove:function(e){if(!ye&&Rl(e)){var V=this,S=V.list;if(V._isV=V.isV(e),V._isH=V.isH(e),V.cp){if(!V._62O){if(Og(_o(e),V.cp)<2)return;V._isV?V._62O="v":V._isH?V._62O="h":S.draggingData&&!this.dragCancel?(V._62O="d",S.handleDragAndDrop(e,"begin")):V._62O="p",V._62O&&"d"!==V._62O&&S.draggingData&&(S.draggingData=null,S.redraw()),ed(V)}}else V._isV&&S._43o(),V._isH&&S._42o()}},isV:function(A){var e=this.list,l=e._29I;return e._41o()&&l.x+l.width-e.lp(A).x<Uj},isH:function($){var n=this.list,w=n._29I;return n._40o()&&w.y+w.height-n.lp($).y<Uj},handle_mousewheel:function(d){this.handleScroll(d,d.wheelDelta/40,d.wheelDelta!==d.wheelDeltaX)},handle_DOMMouseScroll:function(J){this.handleScroll(J,-J.detail,1)},handleScroll:function(W,u,p){var J=this.list;yn(W),J.endEditing&&J.endEditing(),p&&J._41o()?J.translate(0,u*J.getRowHeight()):J._40o()&&J.translate(10*u,0)},handle_keydown:function(e){if(!x.isInput(e.target)){var p,A=this.list,Q=A.sm(),b=A._rows,m=b.size();if(Mq(e))A.selectAll();else if(ll(e))A.handleDelete&&A.handleDelete(e);else if(Te(e))"d"!==this._62O||this.dragCancel||(A.handleDragAndDrop(e,"cancel"),this.dragCancel=!0);else if(oj(e))A.isCheckMode()&&(p=A.getFocusData(),p&&A.checkData(p));else if(ee(e)||Rf(e)){var V=A.isCheckMode();if(p=V?A.getFocusData():Q.ld()){var k=A.getRowIndex(p);k>=0&&(ee(e)?0!==k&&(p=b.get(k-1),V?A.setFocusData(p):Q.ss(p)):k!==m-1&&(p=b.get(k+1),V?A.setFocusData(p):Q.ss(p)))}else m>0&&(p=b.get(0),V?A.setFocusData(p):Q.ss(p))}}},_34o:function(p,j){var I=this.list,D=I.lp(p).x;return D>=0&&D<=I._indent?(I.checkData(j),void 0):(I.setFocusData(j),void 0)},_33o:function(d,B){var y=this.list,p=y.sm(),s=p.ld();if(Ql(d))y.isSelected(B)?p.rs(B):p.as(B);else if(Bp(d))if(s)for(var T=y.getRowIndex(s),Z=y.getRowIndex(B);T!==Z;)T+=Z>T?1:-1,p.as(y._rows.get(T));else p.ss(B);else if(Rl(d)){var J=qj();if(p.contains(B)){var b=J-this._lastSelectDataTime;y.handleDataDoubleSelect&&b>500&&1500>b&&y.handleDataDoubleSelect(d,B)}p.ss(B),this._lastSelectDataTime=J}else p.contains(B)||p.ss(B)}}),tn.TreeView=function(e){var d=this;d._35o(),d._5o(e),new wl(d)},Vo("TreeView",n,{ms_ac:[Bd,Lr,Jn,"rootVisible",aq,"rootData",sd,Fp,Re,cj,wj,gk,Vp,nh,cr,Zh,Pq,Xf,Wf,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:a,_indent:bh,_rowHeight:Mc,_rowLineVisible:x.treeViewRowLineVisible,_rowLineColor:x.treeViewRowLineColor,_scrollBarColor:dg,_scrollBarSize:Yq,_autoHideScrollBar:as,_expandIcon:x.treeViewExpandIcon,_collapseIcon:x.treeViewCollapseIcon,_autoMakeVisible:tj,_selectBackground:x.treeViewSelectBackground,_labelColor:x.treeViewLabelColor,_labelSelectColor:x.treeViewLabelSelectColor,_labelFont:x.treeViewLabelFont,_doubleClickToToggle:x.treeViewDoubleClickToToggle,drawRow:function(M,V,U,Z,f,$,L){var S=this;S.drawRowBackground(M,V,U,Z,f,$,L),S._97I(M,V,U,0,f,$,L)},isOnToggleIcon:function(O){var a=this.getDataAt(O);if(a){var H=this.getIndent(),R=this.lp(O).x;if(Nl(this.getToggleIcon(a))){var o=H*this.getLevel(a);if(R>=o&&o+H>=R)return!0}}return!1}});var wl=function(Q){fm(wl,this,[Q])};ri(wl,Vn,{toggle:function(F,T,H,g){var U=this.list,K=U.lp(F).x;if(Nl(U.getToggleIcon(T))){var q=H*g;if(K>=q&&q+H>=K)return U.toggle(T),!0}return U.isDoubleClickToToggle()&&uc(F)?(U.toggle(T),!0):!1},_34o:function(U,y){var P=this.list,K=P.lp(U).x,H=P._levelMap[y._id],d=P._indent,C=d*(H+1);return K>=C&&C+d>=K?(P.checkData(y),void 0):(this.toggle(U,y,d,H)||P.setFocusData(y),void 0)},_33o:function(P,Y){var g=this,w=g.list;g.toggle(P,Y,w._indent,w.getLevel(Y))||wl.superClass._33o.call(g,P,Y)},handle_keydown:function(j){if(Mb(j)||xr(j)){var N=this.list,_=N._rows,H=N.isCheckMode(),E=N.sm(),v=H?N.getFocusData():E.ld();v?v.hasChildren()&&(Mb(j)?N.collapse(v):N.expand(v)):_.size()>0&&(v=_.get(0),H?N.setFocusData(v):E.ss(v))}else wl.superClass.handle_keydown.call(this,j)}});var mj=tn.TableView=function(f){this._98I(),this._5o(f),new Ce(this)};Vo("TableView",n,{ms_ac:[Bd,Lr,Jn,"sortMode",Wp,gh,Vp,nh,cr,re,yl,"sortColumn",sd,Fp,Re,cj,wj,Xf,Wf],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:ik,_editable:!0,_batchEditable:!1,_rowHeight:Mc,_rowLineVisible:x.tableViewRowLineVisible,_rowLineColor:x.tableViewRowLineColor,_columnLineVisible:x.tableViewColumnLineVisible,_columnLineColor:x.tableViewColumnLineColor,_scrollBarColor:dg,_scrollBarSize:Yq,_autoHideScrollBar:as,_autoMakeVisible:tj,_selectBackground:x.tableViewSelectBackground,_labelColor:x.tableViewLabelColor,_labelSelectColor:x.tableViewLabelSelectColor,_labelFont:x.tableViewLabelFont,getCheckColumn:function(){var o=this;if(!o._31o){var P=o._31o=new Tq;P.setEditable(!0),P.setWidth(40),P.getValue=o.getCheckColumValue,P.drawCell=o.drawCheckColumnCell}return o._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(Y){var l=this,e=l._39o,d=l.getCheckColumn();Y!==l.isCheckMode()&&(Y?e.add(d,0):e.remove(d),l.fp(aq,!Y,Y))},getCheckColumValue:function(D,H,N){return N.isSelected(D)
},drawCheckColumnCell:function(u,l,c,E,C,p,O,o,R){Kr(u,R.getCheckIcon(l),C+O/2,p+o/2,l,R)}});var Ce=function(P){fm(Ce,this,[P])};ri(Ce,Vn,{_34o:function(T,H){var I=this.list,e=I._31o;if(I.isCellEditable(H,e,T)){var K=I._3Q(e),z=I.lp(T).x;if(K&&z>=K.startX&&z<K.startX+e.getWidth())return I.checkData(H),void 0}I._37O(H,T),I.setFocusData(H)},_33o:function(y,V){this.list._37O(V,y),Ce.superClass._33o.apply(this,arguments)}});var _q=tn.TreeTableView=function(x){var O=this,V=O._4o=new Tq;O._35o(),O._98I(),O._5o(x),V.setDisplayName("Name"),V.setEditable(!0),V.setWidth(180),V.drawCell=bm,V.getValue=Yg,O._39o.add(V),new bf(O)},bm=function($,m,U,X,j,n,s,N,z){z._97I($,m,U,j,n,s,N)},Yg=function(S,u,w){return w.getLabel(S)};Vo("TreeTableView",n,{ms_ac:[Bd,Lr,Jn,"sortMode",Wp,gh,gk,aq,"rootData","rootVisible",sd,Fp,"sortColumn",Zh,Pq,Re,cj,wj,Xf,cr,Vp,nh,re,yl,Wf,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:ik,_checkMode:a,_editable:!0,_batchEditable:!1,_indent:bh,_rowHeight:Mc,_rowLineVisible:x.treeTableViewRowLineVisible,_rowLineColor:x.treeTableViewRowLineColor,_columnLineVisible:x.treeTableViewColumnLineVisible,_columnLineColor:x.treeTableViewColumnLineColor,_expandIcon:x.treeTableViewExpandIcon,_collapseIcon:x.treeTableViewCollapseIcon,_scrollBarColor:dg,_scrollBarSize:Yq,_autoHideScrollBar:as,_autoMakeVisible:tj,_selectBackground:x.treeTableViewSelectBackground,_labelColor:x.treeTableViewLabelColor,_labelSelectColor:x.treeTableViewLabelSelectColor,_labelFont:x.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var bf=function(f){fm(bf,this,[f])};ri(bf,Vn,{_34o:function(X,Q){var H=this.list,m=H._4o,o=H._3Q(m),d=H.lp(X).x;if(o){var s=H._indent,D=o.startX+s*H.getLevel(Q);if(Nl(H.getToggleIcon(Q))&&d>=D&&D+s>=d)return H.toggle(Q),void 0;if(H.isCellEditable(Q,m)&&(D+=s,d>=D&&D+s>=d))return H.checkData(Q),void 0}H._37O(Q,X),H.setFocusData(Q)},_33o:function(L,x){var R=this.list,O=R.lp(L).x;if(Nl(R.getToggleIcon(x))){var Q=R._3Q(R._4o);if(Q){var s=R._indent,z=Q.startX+s*R.getLevel(x);if(O>=z&&z+s>=O)return R.toggle(x),void 0}}R._37O(x,L),bf.superClass._33o.apply(this,arguments)}});var Wh=tn.TableHeader=function(V){var $=this,r=$._view=Qm(1,$),s=$._39o=V.getColumnModel(),k=$.iv;$.tv=$._tableView=V,$._60I=new kg,$._canvas=xp(r),r.style.background=x.tableHeaderBackground||"",r.style.height=Ap+Af,s.mm(k,$),s.md(k,$),s.mh(k,$),V.mp(function(Q){hj[Q.property]&&$.iv()},$),new Mr($),$.iv()};Vo("TableHeader",n,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",Bd,Jn,gk,"moveBackground","insertColor",re,yl,"resizable","movable"],_checkIcon:cf,_movable:!0,_resizable:!0,_labelColor:x.tableHeaderLabelColor,_labelFont:x.tableHeaderLabelFont,_columnLineColor:x.tableHeaderColumnLineColor,_columnLineVisible:x.tableHeaderColumnLineVisible,_sortDescIcon:x.tableHeaderSortDescIcon,_sortAscIcon:x.tableHeaderSortAscIcon,_moveBackground:x.tableHeaderMoveBackground,_insertColor:x.tableHeaderInsertColor,_indent:bh,getCheckIcon:function(){return this._checkIcon},getTableView:function(){return this.tv},getLabel:function(s){return s.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(l){return l.getColor()||this._labelColor},getLabelAlign:function(w){return w._align},onPropertyChanged:function(){this.iv()},_5Q:function(g){this._61I=g,this.iv()},getLogicalPoint:function(l){return yj(l,this._canvas,this.tv.tx())},validateImpl:function(){var v=this,Z=v._canvas,t=v.getWidth(),j=v.getHeight(),W=v.tv,m=v._60I,n=v._61I,X=-W.tx(),l=0;(t!==Z.clientWidth||j!==Z.clientHeight)&&ms(Z,t,j),m.clear(),v._39o._roots.each(function(j){if(j.isVisible()){var C=l+j.getWidth();X+t>=l&&C>=X&&m.add({column:j,startX:l}),l=C}});var s=wo(Z);if(or(s,-X,0,1),s.beginPath(),s.rect(X,0,t,j),s.clip(),s.clearRect(X,0,t,j),m.each(function(y){var u=y.column,W=y.startX,H=u.getWidth();H>0&&(s.save(),s.beginPath(),s.rect(W,0,H,j),s.clip(),n&&n.column===u||v.drawColumn(s,u,W,0,H,j),v._columnLineVisible&&vm(s,W+H-1,0,1,j,v._columnLineColor),s.restore())}),n){var B=n.column,l=n.startX,G=n.position,p=B.getWidth();s.save(),s.beginPath(),s.rect(l,0,p,j),s.clip(),s.fillStyle=v._moveBackground,s.fill(),v.drawColumn(s,B,l,0,p,j),s.restore(),vc(s,v._insertColor,G,0,j)}s.restore()},_6Q:function(d){var D=this.tv;return D._31o===d&&D.sm().getSelectionMode()===fp},drawColumn:function(o,n,b,d,q,T){var z=this,J=z.tv,_=Nl(n.getIcon()),j=z.getLabelAlign(n);if(z._6Q(n)){var p=Nl(z._checkIcon);Kr(o,p,b+q/2,d+T/2,n,z)}else{var M=z.getLabel(n),V=z.getLabelFont(n),I=z.getLabelColor(n),u=Lm(V,M).width,k=_?z._indent:0;j===ce?(_&&hc(o,_,lr,b,d,k,T),sp(o,M,V,I,b+k,d,q,T,ce)):j===_i?(_&&hc(o,_,lr,b+q-u-k,d,k,T),sp(o,M,V,I,b,d,q,T,_i)):(_&&hc(o,_,lr,b+(q-u-k)/2,d,k,T),sp(o,M,V,I,b+(q-u+k)/2,d,0,T,ce))}if(n.isSortable()&&J.getSortColumn()===n&&(_=Nl(n.getSortOrder()===ko?z._sortAscIcon:z._sortDescIcon))){var G=sr(_,n)/2+2;Kr(o,_,j===_i?b+G:b+q-G,d+T/2,n,J)}}});var Mr=function(Z){var s=this;s.th=Z,s.tv=Z._tableView,s.addListeners()};ri(Mr,n,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(W){this.getView().style.cursor=W},handle_mousemove:function(U){if(!ye){var L=this;delete L._29o,L.setCursor(nn);for(var E=L.th,n=E._60I,Z=E.lp(U).x,f=n.size()-1;f>=0;f--){var C=n.get(f),W=C.column,M=C.startX+W.getWidth();if(E.isResizable()&&G(M-Z)<=(Ye?10:3))return L._29o=C,L.setCursor(fk),void 0;Z>C.startX&&M>Z&&(L._29o=C),(W.isClickable()||W.isSortable()||E.isMovable()||L.tv.getCheckColumn&&W===L.tv.getCheckColumn())&&Z>C.startX&&M>Z&&L.setCursor(Rr)}}},handle_mousedown:function(g){this.handle_touchstart(g)},handle_touchstart:function(y){var s=this;yn(y),s.tv.endEditing(),s.handle_mousemove(y),s._29o&&(s.x=_o(y).x,s.lx=s.th.lp(y).x,s.w=s._29o.column.getWidth(),ed(s,y))},handleWindowMouseMove:function(z){this.handleWindowTouchMove(z)},handleWindowTouchMove:function(I){var L=this,x=L.th,D=L.getView().style.cursor,v=L._29o,U=_o(I).x-L.x;if(L.resizing||L.moving||(D===fk?L.resizing=1:x.isMovable()&&D===Rr&&G(U)>2&&(L.moving=1)),L.resizing)v.column.setWidth(L.w+U);else if(L.moving){var S=L.lx+U;x._60I.each(function(T){var P=T.startX,n=P+T.column.getWidth();if(S>=P&&n>=S){var I={column:v.column,startX:v.startX+U,front:n-S>S-P,insertColumn:T.column};I.position=I.front?P:n,x._5Q(I)}})}},_16Q:function(N,K){var B=this,x=B.tv,j=B.th,r=j._checkIcon;if(j._6Q(N)){var d=Nl(r),D=B.lx,b=N.getWidth(),$=sr(d,N);if(D>=K+b/2-$&&K+b/2+$>=D){j.setCheckIcon(r===xn?cf:xn);var C=x.sm(),v=x._rows;return r===xn?C.rs(v):C.ss(v),x.onCheckColumnClicked(N),!0}}return!1},handleWindowMouseUp:function(c){this.handleWindowTouchEnd(c)},handleWindowTouchEnd:function(e){var D=this,I=D.tv,W=D.th,U=D._29o;if(D.moving){var k=W._61I;if(k&&k.insertColumn!==k.column){var G=k.column,v=I.getColumnModel()._roots,q=v.remove(G),y=v.indexOf(k.insertColumn);y>=0&&(k.front||y++,y<=v.size()&&(v.add(G,y),I.getColumnModel()._38I(G,q,y)))}W._5Q(a),delete D.moving}else if(!D.resizing&&U){G=U.column;var i=W.lp(e).x,M=U.startX,T=!0;if(W.onColumnClicked){var N=W.onColumnClicked(G,e,M);N===!1&&(T=!1)}if(T&&i>=M&&i<=M+G.getWidth()&&!D._16Q(G,M)){if(G.isSortable()){var d=I.getSortMode(),Q=G.getSortOrder();d===ik?I.getSortColumn()===G?(Q===Er&&I.setSortColumn(a),G.setSortOrder(Q===ko?Er:ko)):I.setSortColumn(G):"bistate"===d&&(I.getSortColumn()===G?G.setSortOrder(Q===ko?Er:ko):I.setSortColumn(G))}I.onColumnClicked(G,e,M)}}D._29o=D.resizing=D.x=D.lx=D.w=a}}),tn.TablePane=function(Z){this.init(new mj(Z))},Vo("TablePane",n,{ms_v:1,_44o:1}),tn.TreeTablePane=function(j){this.init(new _q(j))},Vo("TreeTablePane",n,{ms_v:1,_44o:1}),tn.Toolbar=function(l){var G=this,s=G._view=Qm(1,G),R=s.style;R.background=x.toolbarBackground||"",R.height=ib+Af,G._canvas=xp(s),G._30o=new kg,G._90I=new kg,G.setItems(l||[]),s.handleGroupSelectedChanged=function(W){if(W.isSelected()){var i=W.getGroupId();null!=i&&G._items.forEach(function(Z){var M=Z.element;M&&M!==W&&M.setSelected&&M.getGroupId&&M.getGroupId()===i&&M.setSelected(!1)})}},new fr(G)},Vo("Toolbar",n,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[pm,Bd,Jn,Lr,Wf,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:x.toolbarLabelColor,_labelSelectColor:x.toolbarLabelSelectColor,_labelFont:x.toolbarLabelFont,_selectBackground:x.toolbarSelectBackground,_itemGap:x.toolbarItemGap,_separatorColor:x.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(Z){var R=this.getItemInfoAt(Z);return R?R.item.toolTip:a},getLabelColor:function(d){return d&&d.selected&&d.type!==xn&&d.type!==qd?this._labelSelectColor:this._labelColor},onPropertyChanged:function(S){this.iv(),S.property===pm&&this._items.forEach(function(c){Zd(c)})},redraw:function(){this.iv()},addItem:function(t,H){var R=this._items;H==a?R.push(t):R.splice(H,0,t),this.fp(pm,a,R)},removeItem:function(M){if(M)for(var _=this._items,z=0;z<_.length;z++)M===_[z]&&(_.splice(z,1),this.fp(pm,a,_))},removeItemById:function(M){if(M!=a)for(var k=this._items,d=0;d<k.length;d++)if(M===k[d].id){var G=k.splice(d,1)[0];return this.fp(pm,a,k),G}},getItemById:function(R){if(R!=a)for(var E=this._items,C=0;C<E.length;C++){var h=E[C];if(R===h.id)return h}},setItemVisible:function(i,N){var L=this.getItemById(i);L&&(L.visible=N)},getItemInfos:function(){return this._30o},getItemInfoAt:function(x){var l=this,I=0,R=l._30o,Y=l.lp(x),c=Y.x,p=Y.y;if(p>=0&&p<=l.getHeight())for(;I<R.size();I++){var F=R.get(I);if(F.startX<=c&&c<=F.endX)return F}return a},drawItem:function(T,K,J,W,c){if(K.visible===!1)return 0;if(nk(K.visible)&&!K.visible())return 0;var l=this,P=K.disabled;P&&(T.globalAlpha=jg);var U=l.drawItemImpl(T,K,J,W,c),N=l._itemGap;return P&&(T.globalAlpha=1),this._currentItem!==K||"separator"===K||K.separator===!0||K.unfocusable||yb(T,l._separatorColor,J-N/2,0,U+N,W),U},drawItemImpl:function(Z,W,l,J,P){var m=this,O=m._view,K=m._itemGap,o=J/2,f=W.type,$=W.element,i=W.label;Tp($)&&(i=$,$=a);var p,q=m.getLabelFont(W),w=m.getLabelColor(W),x=W.selected,I=Nl(W.icon),G=sr(I,W),U=0,N=G+(i?Lm(q,i).width:0);if("separator"===W||W.separator===!0)return vc(Z,m._separatorColor,l,J/4,o),1;if($){I&&Kr(Z,I,l+G/2,o,W,m),sp(Z,i,q,w,l+G,0,0,J);var y=Xk($);P||m._90I.add(y),y.parentNode!==O&&Oc(O,y),$.iv&&$.iv(),$.validate&&$.validate();var j=y.getBoundingClientRect(),A=j.width,d=y.style;return rb(y),d.left=m.tx()+l+N+Af,d.top=(J-j.height)/2+Af,N+A}return f===qd?p=Nl(x?xe:od):f===xn&&(p=Nl(x?xn:cf)),p?(U=sr(p,W),Kr(Z,p,l+U/2,o,W,m),l+=U,N+=U):x&&vm(Z,l-K/2,0,N+K,J,m.getSelectBackground(W)),I&&Kr(Z,I,l+G/2,o,W,m),sp(Z,i,q,w,l+G,0,0,J),N},validateImpl:function(){var P=this,Q=P._canvas,g=P.getWidth(),d=P.getHeight(),f=P._30o,t=P._items;ms(Q,g,d);var s=wo(Q),e=P._itemGap,S=e/2;or(s,P.tx(),0,1),s.clearRect(0,0,g,d);var R=P._90I;P._90I=new kg,f.clear(),t.forEach(function(c){var W=P.drawItem(s,c,S,d);f.add({item:c,startX:S,endX:S+W,width:W}),W&&(S+=W+e)}),R.each(function(D){P._90I.contains(D)||Tn(D)});var D=P._64I;P._64I=w(0,S),s.restore(),P._stickToRight?(P._65O=0,s=wo(Q),S=g-P._64I+e,or(s,0,0,1),s.clearRect(0,0,g,d),f.clear(),t.forEach(function(k){var t=P.drawItem(s,k,S,d,!0);f.add({item:k,startX:S,endX:S+t,width:t}),t&&(S+=t+e)}),s.restore()):P.tx(P.tx()),D!==P._64I&&P.onSumWidthChanged(D,P._64I)},onSumWidthChanged:function(){},handleClick:function(K,V){var C=this,W=K.type,B=K.action,b=K.groupId,w=K.selected;K.disabled||(b!=a?w||(K.selected=!0,this._items.forEach(function(u){u.groupId===b&&K!==u&&(u.selected=!1)}),B&&K.action(K,C,V)):W===xn||"toggle"===W?(K.selected=!w,B&&K.action(K,C,V)):B&&K.action(K,C,V)),el(),C.iv()}});var fr=function(l){this.tb=l,this.addListeners()};ri(fr,n,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(X){this.handleScroll(X,10*(X.wheelDelta/40))},handle_DOMMouseScroll:function(g){this.handleScroll(g,10*-g.detail)},handleScroll:function(W,v){yn(W);var E=this.tb;E.isScrollable()&&!E._stickToRight&&(E.tx(E.tx()+v),vf())},handle_mousemove:function(R){var D=this;ye||D.setItem(R)},handle_mouseout:function(i){var e=this;i.target===e.getView()?e.tb.setCurrentItem(a):e.handle_mousemove(i)},handle_mousedown:function(y){this.handle_mousemove(y),this.handle_touchstart(y)},handle_touchstart:function(_){var A=this,E=A.tb,N=_.target;Rl(_)&&(N===A.getView()||N===E._canvas)&&(yn(_),E.setFocus(_)&&(this.setItem(_,!0),(E.isScrollable()||A.info&&!A.info.item.disabled)&&(A.x=_o(_).x,A.tx=E.tx(),ed(A,_))))},handleWindowMouseMove:function(G){this.handleWindowTouchMove(G)},handleWindowTouchMove:function(P){var I=this,n=I.tb;if(!n._stickToRight){var u=_o(P).x-I.x;!I._25o&&G(u)>2&&n.isScrollable()&&(I._25o=1),I._25o&&n.tx(I.tx+u)}},handleWindowMouseUp:function(O){this.handleWindowTouchEnd(O)},handleWindowTouchEnd:function(F){var S=this,G=S.tb,A=S.info,E=S.tb.getItemInfoAt(F);if(!S._25o&&A){var H=A.item;E&&E.item===H&&G.handleClick(H,F)}S._25o=S.x=S.tx=a,S.setItem()},setItem:function(Q,w){var Z=this,t=Z.tb,z=Z.info=Q?t.getItemInfoAt(Q):a,N=z?z.item:a;t.setCurrentItem(N),w&&N&&nk(N.onDown)&&N.onDown(Q)}}),tn.BorderPane=function(){this._view=Qm(1,this),this.iv()},Vo("BorderPane",n,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(V,S){this._12o("leftView",V),S!=a&&this.setLeftWidth(S)},getRightView:function(){return this._rightView},setRightView:function(O,U){this._12o("rightView",O),U!=a&&this.setRightWidth(U)},getTopView:function(){return this._topView},setTopView:function(E,m){this._12o("topView",E),m!=a&&this.setTopHeight(m)},getBottomView:function(){return this._bottomView},setBottomView:function(h,B){this._12o("bottomView",h),B!=a&&this.setBottomHeight(B)},getCenterView:function(){return this._centerView},setCenterView:function(B){this._12o("centerView",B)},_12o:function(h,W){var s=this,C="_"+h,G=s._view,z=s[C];z!==W&&(z&&(z.getView?Tn(z.getView()):Tn(z)),s[C]=W,W&&(W.getView?Oc(G,W.getView(),1):Oc(G,W,1)),s.fp(h,z,W))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var c=this,I=c._topView,G=c._bottomView,u=c._leftView,i=c._rightView,s=c._centerView,k=c.getWidth(),H=c.getHeight(),n=0,z=0,J=k,q=H,E=0,O=0,R=0,j=0;I&&(E=c._topHeight==a?hm(I):c._topHeight,z=E),G&&(O=c._bottomHeight==a?hm(G):c._bottomHeight,q=H-O),u&&(R=c._leftWidth==a?Rh(u):c._leftWidth,n=R),i&&(j=c._rightWidth==a?Rh(i):c._rightWidth,J=k-j);var m=w(0,J-n),P=w(0,q-z);I&&dp(I,0,0,k,E),G&&dp(G,0,q,k,O),u&&dp(u,0,z,R,P),i&&dp(i,J,z,j,P),s&&dp(s,n,z,m,P)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);